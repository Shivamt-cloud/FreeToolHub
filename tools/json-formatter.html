<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>JSON Formatter & Validator - FreeToolHub</title>
    <meta name="description" content="Format, validate, minify, and convert JSON data with advanced features. Professional JSON formatter with syntax highlighting and error detection.">
    <meta property="og:title" content="JSON Formatter & Validator - FreeToolHub">
    <meta property="og:description" content="Format, validate, minify, and convert JSON data with advanced features">
    <meta property="og:url" content="https://freetoolhub.in/tools/json-formatter.html">
    <meta property="og:type" content="website">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 text-gray-800">
    <!-- Header Container -->
    <div id="app-header"></div>
    
    <!-- Main Content -->
    <main class="min-h-screen pb-16" style="padding-top: 6rem;">
        <style>
            @media (min-width: 1024px) {
                main {
                    padding-top: 8.5rem !important;
                }
            }
        </style>
        <div class="max-w-7xl mx-auto px-6 py-8">
            <!-- Page Header with Share -->
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-8">
                <div>
                    <h1 class="text-4xl md:text-5xl font-bold text-gray-800 mb-2">üîß JSON Formatter & Validator</h1>
                    <p class="text-gray-600 text-lg">Format, validate, minify, and convert JSON data with advanced features</p>
                </div>
                <button onclick="shareTool()" class="mt-4 md:mt-0 bg-gradient-to-r from-blue-500 to-indigo-600 text-white px-6 py-3 rounded-lg hover:from-blue-600 hover:to-indigo-700 transition-all duration-300 flex items-center gap-2 shadow-lg">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.885 12.938 9 12.482 9 12c0-.482-.115-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"></path>
                    </svg>
                    Share Tool
                </button>
            </div>
            
            <!-- Breadcrumbs -->
            <nav class="mb-6 text-sm">
                <a href="/" class="text-blue-600 hover:text-blue-800">Home</a>
                <span class="mx-2 text-gray-400">/</span>
                <a href="/#tools" class="text-blue-600 hover:text-blue-800">Tools</a>
                <span class="mx-2 text-gray-400">/</span>
                <span class="text-gray-600">JSON Formatter</span>
            </nav>
            
            <!-- Tool Interface -->
            <div class="bg-white rounded-2xl shadow-xl p-6 md:p-8">
                <div class="grid grid-cols-1 lg:grid-cols-4 gap-6">
                    <!-- Main JSON Formatter Section -->
                    <div class="lg:col-span-3">
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <!-- Input Section -->
                            <div class="space-y-6">
                                <div>
                                    <div class="flex items-center justify-between mb-3">
                                        <label class="block text-lg font-semibold text-gray-700">üìù JSON Input</label>
                                        <button onclick="clearJson()" class="text-xs text-gray-600 hover:text-gray-800 underline">Clear</button>
                                    </div>
                                    <div class="bg-white rounded-lg p-3 border border-gray-200 mb-3">
                                        <label class="block text-xs font-semibold text-gray-600 mb-2">Quick Templates</label>
                                        <div class="grid grid-cols-2 gap-2">
                                            <button onclick="loadJsonTemplate('simple')" class="text-xs bg-gray-100 hover:bg-gray-200 px-3 py-2 rounded-lg transition-all">Simple</button>
                                            <button onclick="loadJsonTemplate('nested')" class="text-xs bg-gray-100 hover:bg-gray-200 px-3 py-2 rounded-lg transition-all">Nested</button>
                                            <button onclick="loadJsonTemplate('array')" class="text-xs bg-gray-100 hover:bg-gray-200 px-3 py-2 rounded-lg transition-all">Array</button>
                                            <button onclick="loadJsonTemplate('complex')" class="text-xs bg-gray-100 hover:bg-gray-200 px-3 py-2 rounded-lg transition-all">Complex</button>
                                        </div>
                                    </div>
                                    <div class="relative">
                                        <div class="absolute left-0 top-0 bottom-0 w-8 bg-gray-100 border border-gray-300 rounded-l-xl flex flex-col items-center text-xs text-gray-500 font-mono overflow-hidden" id="json-input-lines" style="z-index: 1;"></div>
                                        <textarea id="json-input" placeholder="Paste your JSON data here..." class="w-full h-64 pl-10 pr-4 py-4 border-2 border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-mono text-sm resize-none bg-white" style="font-family: 'Courier New', monospace; line-height: 1.5;" oninput="updateJsonInputLineNumbers()" onscroll="syncJsonInputScroll()" onpaste="setTimeout(updateJsonInputLineNumbers, 10)"></textarea>
                                    </div>
                                </div>
                                
                                <div class="grid grid-cols-2 gap-3">
                                    <button onclick="formatJson()" class="bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-bold py-3 px-4 rounded-xl transition-all duration-300 transform hover:scale-105 shadow-lg">
                                        ‚ú® Format JSON
                                    </button>
                                    <button onclick="validateJson()" class="bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-bold py-3 px-4 rounded-xl transition-all duration-300 transform hover:scale-105 shadow-lg">
                                        ‚úì Validate JSON
                                    </button>
                                    <button onclick="minifyJson()" class="bg-gradient-to-r from-orange-500 to-orange-600 hover:from-orange-600 hover:to-orange-700 text-white font-bold py-3 px-4 rounded-xl transition-all duration-300 transform hover:scale-105 shadow-lg">
                                        üì¶ Minify JSON
                                    </button>
                                    <button onclick="clearJson()" class="bg-gradient-to-r from-gray-500 to-gray-600 hover:from-gray-600 hover:to-gray-700 text-white font-bold py-3 px-4 rounded-xl transition-all duration-300 transform hover:scale-105 shadow-lg">
                                        üóëÔ∏è Clear All
                                    </button>
                                </div>
                                
                                <!-- Convert Options -->
                                <div>
                                    <label class="block text-lg font-semibold text-gray-700 mb-3">üîÑ Convert To</label>
                                    <div class="grid grid-cols-2 gap-3">
                                        <button onclick="convertJson('yaml')" class="bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300 shadow-md">
                                            üìù YAML
                                        </button>
                                        <button onclick="convertJson('xml')" class="bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300 shadow-md">
                                            üìÑ XML
                                        </button>
                                        <button onclick="convertJson('csv')" class="bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300 shadow-md">
                                            üìä CSV
                                        </button>
                                        <button onclick="convertJson('php')" class="bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300 shadow-md">
                                            üêò PHP
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Output Section -->
                            <div class="space-y-6">
                                <div>
                                    <label class="block text-lg font-semibold text-gray-700 mb-3">üì§ Output</label>
                                    <div class="relative">
                                        <div class="absolute left-0 top-0 bottom-0 w-8 bg-gray-100 border border-gray-300 rounded-l-xl flex flex-col items-center text-xs text-gray-500 font-mono overflow-hidden" id="json-output-lines" style="z-index: 1;"></div>
                                        <textarea id="json-output" placeholder="Formatted, validated, or converted output will appear here..." class="w-full h-64 pl-10 pr-4 py-4 border-2 border-gray-300 rounded-xl bg-gray-50 font-mono text-sm resize-none" style="font-family: 'Courier New', monospace; line-height: 1.5;" readonly onscroll="syncJsonOutputScroll()"></textarea>
                                    </div>
                                </div>
                                
                                <div class="flex space-x-3">
                                    <button onclick="copyJsonOutput()" class="flex-1 bg-gradient-to-r from-indigo-500 to-indigo-600 hover:from-indigo-600 hover:to-indigo-700 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300 shadow-lg">
                                        üìã Copy Output
                                    </button>
                                    <button onclick="downloadJsonOutput()" class="flex-1 bg-gradient-to-r from-teal-500 to-teal-600 hover:from-teal-600 hover:to-teal-700 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300 shadow-lg">
                                        ‚¨áÔ∏è Download
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Results Section -->
                        <div class="mt-8 space-y-6">
                            <!-- Validation Results -->
                            <div id="validation-results" class="hidden">
                                <div class="bg-green-50 rounded-xl p-6 border border-green-200">
                                    <h4 class="text-lg font-bold mb-4 text-green-800">Validation Results</h4>
                                    <div id="validation-content" class="space-y-3"></div>
                                </div>
                            </div>
                            
                            <!-- Structure Analysis -->
                            <div id="structure-analysis" class="hidden">
                                <div class="bg-blue-50 rounded-xl p-6 border border-blue-200">
                                    <h4 class="text-lg font-bold mb-4 text-blue-800">Structure Analysis</h4>
                                    <div id="structure-content" class="space-y-3"></div>
                                </div>
                            </div>
                            
                            <!-- Error Display -->
                            <div id="error-display" class="hidden">
                                <div class="bg-red-50 rounded-xl p-6 border border-red-200">
                                    <h4 class="text-lg font-bold mb-4 text-red-800">Error Details</h4>
                                    <div id="error-content" class="space-y-3"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Tool Suggestions Widget -->
                    <div class="lg:col-span-1 hidden lg:block">
                        <div class="bg-gradient-to-br from-purple-50 to-blue-50 rounded-xl p-6 border-2 border-purple-200 shadow-lg h-fit sticky top-28">
                            <div class="flex items-center justify-between mb-5">
                                <h4 class="text-xl font-bold text-gray-800">‚ú® Explore Tools</h4>
                                <div class="flex items-center space-x-1">
                                    <div class="w-2.5 h-2.5 bg-purple-500 rounded-full animate-pulse"></div>
                                    <span class="text-xs text-gray-500 font-medium">Live</span>
                                </div>
                            </div>
                            
                            <div id="tool-suggestion-card" class="bg-white rounded-xl p-6 shadow-lg transition-all duration-500 fade-in">
                                <div id="tool-icon" class="text-6xl mb-4 text-center">üßÆ</div>
                                <h5 id="tool-name" class="text-2xl font-bold text-gray-800 mb-3 text-center">Loading...</h5>
                                <p id="tool-description" class="text-base text-gray-600 mb-6 text-center leading-relaxed">Discover amazing tools</p>
                                <button id="tool-checkout-btn" onclick="launchSuggestedTool()" class="w-full bg-gradient-to-r from-purple-500 to-blue-600 text-white font-bold py-3.5 px-6 rounded-xl hover:from-purple-600 hover:to-blue-700 transition-all duration-300 transform hover:scale-105 shadow-lg flex items-center justify-center gap-2 text-lg">
                                    <span>Check it out</span>
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"></path>
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
    
    <!-- Footer Container -->
    <div id="app-footer"></div>
    
    <!-- Toast Notification Container -->
    <div id="toast-container" class="fixed bottom-4 right-4 z-50 space-y-2"></div>
    
    <!-- Scripts -->
    <script src="/js/common-functions.js"></script>
    <script src="/js/widgets.js"></script>
    <script src="/js/components/HeaderLoader.js"></script>
    <script src="/js/components/FooterLoader.js"></script>
    <script src="/js/components/ShareButton.js"></script>
    <script src="/js/widgets-init.js"></script>
    
    <!-- JSON Formatter Dependencies -->
    <script src="/src/js/JsonFormatter.js?v=1&t=1726745000"></script>
    
    <!-- JSON Formatter JavaScript -->
    <script>
        let jsonFormatter = null;

        // Toast Notification System
        function showNotification(message, type = 'info', duration = 5000) {
            const toastContainer = document.getElementById('toast-container');
            if (!toastContainer) return;

            const toast = document.createElement('div');
            const bgColor = type === 'success' ? 'bg-green-500' : 
                          type === 'error' ? 'bg-red-500' : 
                          type === 'warning' ? 'bg-yellow-500' : 'bg-blue-500';
            const icon = type === 'success' ? '‚úÖ' : 
                        type === 'error' ? '‚ùå' : 
                        type === 'warning' ? '‚ö†Ô∏è' : '‚ÑπÔ∏è';

            toast.className = `${bgColor} text-white px-6 py-4 rounded-lg shadow-xl flex items-center gap-3 min-w-[300px] max-w-md animate-slide-in`;
            toast.innerHTML = `
                <span class="text-xl">${icon}</span>
                <span class="flex-1 font-medium">${message}</span>
                <button onclick="this.parentElement.remove()" class="text-white hover:text-gray-200 font-bold text-lg">√ó</button>
            `;

            toastContainer.appendChild(toast);

            if (duration > 0) {
                setTimeout(() => {
                    toast.style.animation = 'slide-out 0.3s ease-out';
                    setTimeout(() => toast.remove(), 300);
                }, duration);
            }
        }

        function initializeJsonFormatter() {
            try {
                if (typeof JsonFormatter !== 'undefined') {
                    jsonFormatter = new JsonFormatter();
                    console.log('‚úÖ JSON Formatter initialized successfully');
                    updateJsonInputLineNumbers();
                    updateJsonOutputLineNumbers();
                } else {
                    console.error('‚ùå JsonFormatter class not found');
                }
            } catch (error) {
                console.error('‚ùå JSON Formatter initialization failed:', error);
            }
        }

        // Quick Templates
        function loadJsonTemplate(template) {
            const templates = {
                'simple': {
                    name: 'Simple Object',
                    json: JSON.stringify({ name: "John Doe", age: 30, city: "New York" }, null, 2)
                },
                'nested': {
                    name: 'Nested Object',
                    json: JSON.stringify({
                        user: {
                            name: "Jane Smith",
                            contact: {
                                email: "jane@example.com",
                                phone: "123-456-7890"
                            }
                        },
                        settings: {
                            theme: "dark",
                            notifications: true
                        }
                    }, null, 2)
                },
                'array': {
                    name: 'Array of Objects',
                    json: JSON.stringify([
                        { id: 1, name: "Item 1", price: 10.99 },
                        { id: 2, name: "Item 2", price: 20.99 },
                        { id: 3, name: "Item 3", price: 30.99 }
                    ], null, 2)
                },
                'complex': {
                    name: 'Complex Structure',
                    json: JSON.stringify({
                        company: "Tech Corp",
                        employees: [
                            { id: 1, name: "Alice", department: "Engineering", skills: ["JavaScript", "Python"] },
                            { id: 2, name: "Bob", department: "Marketing", skills: ["SEO", "Content"] }
                        ],
                        metadata: {
                            created: "2024-01-01",
                            version: "1.0.0"
                        }
                    }, null, 2)
                }
            };

            const preset = templates[template];
            if (preset) {
                document.getElementById('json-input').value = preset.json;
                updateJsonInputLineNumbers();
                showNotification(`Loaded ${preset.name} template`, 'success');
            }
        }

        function formatJson() {
            if (!jsonFormatter) {
                showNotification('JSON Formatter not initialized. Please refresh the page.', 'error');
                return;
            }

            const input = document.getElementById('json-input').value.trim();
            if (!input) {
                showNotification('Please enter JSON data to format.', 'warning');
                document.getElementById('json-input').focus();
                return;
            }

            const formatBtn = document.querySelector('button[onclick="formatJson()"]');
            const originalHTML = formatBtn ? formatBtn.innerHTML : '';
            if (formatBtn) {
                formatBtn.disabled = true;
                formatBtn.innerHTML = '<span class="inline-block animate-spin">‚è≥</span><span> Formatting...</span>';
            }

            setTimeout(() => {
                try {
                    const result = jsonFormatter.formatJson(input);
                    
                    if (result.success) {
                        document.getElementById('json-output').value = result.formatted;
                        updateJsonOutputLineNumbers();
                        hideAllResults();
                        showValidationResults(result);
                        showNotification('JSON formatted successfully!', 'success');
                    } else {
                        document.getElementById('json-output').value = '';
                        updateJsonOutputLineNumbers();
                        hideAllResults();
                        showErrorResults(result);
                        showNotification('JSON formatting failed: ' + result.error, 'error');
                    }
                } catch (error) {
                    console.error('Error in formatJson:', error);
                    showNotification('Error formatting JSON: ' + (error.message || 'Unknown error'), 'error');
                } finally {
                    if (formatBtn) {
                        formatBtn.disabled = false;
                        formatBtn.innerHTML = originalHTML;
                    }
                }
            }, 300);
        }

        function validateJson() {
            if (!jsonFormatter) {
                showNotification('JSON Formatter not initialized. Please refresh the page.', 'error');
                return;
            }

            const input = document.getElementById('json-input').value.trim();
            if (!input) {
                showNotification('Please enter JSON data to validate.', 'warning');
                document.getElementById('json-input').focus();
                return;
            }

            const validateBtn = document.querySelector('button[onclick="validateJson()"]');
            const originalHTML = validateBtn ? validateBtn.innerHTML : '';
            if (validateBtn) {
                validateBtn.disabled = true;
                validateBtn.innerHTML = '<span class="inline-block animate-spin">‚è≥</span><span> Validating...</span>';
            }

            setTimeout(() => {
                try {
                    const result = jsonFormatter.validateJson(input);
                    
                    if (result.success) {
                        document.getElementById('json-output').value = JSON.stringify(result.parsed, null, 2);
                        updateJsonOutputLineNumbers();
                        hideAllResults();
                        showValidationResults(result);
                        if (result.structure) {
                            showStructureAnalysis(result.structure);
                        }
                        showNotification('JSON is valid!', 'success');
                    } else {
                        document.getElementById('json-output').value = '';
                        updateJsonOutputLineNumbers();
                        hideAllResults();
                        showErrorResults(result);
                        showNotification('JSON validation failed: ' + result.error, 'error');
                    }
                } catch (error) {
                    console.error('Error in validateJson:', error);
                    showNotification('Error validating JSON: ' + (error.message || 'Unknown error'), 'error');
                } finally {
                    if (validateBtn) {
                        validateBtn.disabled = false;
                        validateBtn.innerHTML = originalHTML;
                    }
                }
            }, 300);
        }

        function minifyJson() {
            if (!jsonFormatter) {
                showNotification('JSON Formatter not initialized. Please refresh the page.', 'error');
                return;
            }

            const input = document.getElementById('json-input').value.trim();
            if (!input) {
                showNotification('Please enter JSON data to minify.', 'warning');
                document.getElementById('json-input').focus();
                return;
            }

            const minifyBtn = document.querySelector('button[onclick="minifyJson()"]');
            const originalHTML = minifyBtn ? minifyBtn.innerHTML : '';
            if (minifyBtn) {
                minifyBtn.disabled = true;
                minifyBtn.innerHTML = '<span class="inline-block animate-spin">‚è≥</span><span> Minifying...</span>';
            }

            setTimeout(() => {
                try {
                    const result = jsonFormatter.minifyJson(input);
                    
                    if (result.success) {
                        document.getElementById('json-output').value = result.minified;
                        updateJsonOutputLineNumbers();
                        hideAllResults();
                        showMinifyResults(result);
                        showNotification('JSON minified successfully!', 'success');
                    } else {
                        document.getElementById('json-output').value = '';
                        updateJsonOutputLineNumbers();
                        hideAllResults();
                        showErrorResults(result);
                        showNotification('JSON minification failed: ' + result.error, 'error');
                    }
                } catch (error) {
                    console.error('Error in minifyJson:', error);
                    showNotification('Error minifying JSON: ' + (error.message || 'Unknown error'), 'error');
                } finally {
                    if (minifyBtn) {
                        minifyBtn.disabled = false;
                        minifyBtn.innerHTML = originalHTML;
                    }
                }
            }, 300);
        }

        function convertJson(format) {
            if (!jsonFormatter) {
                showNotification('JSON Formatter not initialized. Please refresh the page.', 'error');
                return;
            }

            const input = document.getElementById('json-input').value.trim();
            if (!input) {
                showNotification('Please enter JSON data to convert.', 'warning');
                document.getElementById('json-input').focus();
                return;
            }

            const convertBtns = document.querySelectorAll(`button[onclick="convertJson('${format}')"]`);
            convertBtns.forEach(btn => {
                const originalHTML = btn.innerHTML;
                btn.disabled = true;
                btn.innerHTML = '<span class="inline-block animate-spin">‚è≥</span>';
                
                setTimeout(() => {
                    try {
                        const result = jsonFormatter.convertJson(input, format);
                        
                        if (result.success) {
                            document.getElementById('json-output').value = result.converted;
                            updateJsonOutputLineNumbers();
                            hideAllResults();
                            showConversionResults(result);
                            showNotification(`Converted to ${format.toUpperCase()} successfully!`, 'success');
                        } else {
                            document.getElementById('json-output').value = '';
                            updateJsonOutputLineNumbers();
                            hideAllResults();
                            showErrorResults(result);
                            showNotification(`Conversion to ${format.toUpperCase()} failed: ` + result.error, 'error');
                        }
                    } catch (error) {
                        console.error('Error in convertJson:', error);
                        showNotification('Error converting JSON: ' + (error.message || 'Unknown error'), 'error');
                    } finally {
                        btn.disabled = false;
                        btn.innerHTML = originalHTML;
                    }
                }, 300);
            });
        }

        function clearJson() {
            document.getElementById('json-input').value = '';
            document.getElementById('json-output').value = '';
            document.getElementById('json-input-lines').innerHTML = '<div class="text-center text-xs" style="height: 24px; line-height: 24px; display: flex; align-items: center; justify-content: center;">1</div>';
            document.getElementById('json-output-lines').innerHTML = '<div class="text-center text-xs" style="height: 24px; line-height: 24px; display: flex; align-items: center; justify-content: center;">1</div>';
            hideAllResults();
            showNotification('JSON inputs cleared', 'info');
        }

        function copyJsonOutput() {
            const output = document.getElementById('json-output').value;
            if (!output) {
                showNotification('No output to copy.', 'warning');
                return;
            }

            navigator.clipboard.writeText(output).then(() => {
                showNotification('Output copied to clipboard!', 'success');
            }).catch(() => {
                showNotification('Failed to copy to clipboard.', 'error');
            });
        }

        function downloadJsonOutput() {
            const output = document.getElementById('json-output').value;
            if (!output) {
                showNotification('No output to download.', 'warning');
                return;
            }

            try {
                const blob = new Blob([output], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `json-output-${Date.now()}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                showNotification('JSON file downloaded successfully!', 'success');
            } catch (error) {
                showNotification('Failed to download file: ' + (error.message || 'Unknown error'), 'error');
            }
        }

        function showValidationResults(result) {
            const resultsDiv = document.getElementById('validation-results');
            const contentDiv = document.getElementById('validation-content');
            
            const size = result.size || result.structure?.size || 0;
            
            let html = `
                <div class="space-y-4 animate-fade-in">
                    <div class="bg-white rounded-lg p-5 border-2 border-green-300 shadow-sm">
                        <div class="flex items-center justify-between mb-2">
                            <div class="flex items-center gap-3">
                                <span class="text-3xl">‚úÖ</span>
                                <span class="text-xl font-bold text-green-600">Valid JSON</span>
                            </div>
                        </div>
                        <div class="text-sm text-gray-600 mt-2">
                            <div class="flex items-center gap-2">
                                <span class="font-semibold">Size:</span>
                                <span class="text-blue-600 font-bold">${size.toLocaleString()} characters</span>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            contentDiv.innerHTML = html;
            resultsDiv.classList.remove('hidden');
        }

        function showMinifyResults(result) {
            const resultsDiv = document.getElementById('validation-results');
            const contentDiv = document.getElementById('validation-content');
            
            const compressionPercent = parseFloat(result.size.compression);
            const compressionColor = compressionPercent >= 30 ? 'text-green-600' : compressionPercent >= 15 ? 'text-blue-600' : 'text-yellow-600';
            
            let html = `
                <div class="space-y-4 animate-fade-in">
                    <div class="bg-white rounded-lg p-5 border-2 border-green-300 shadow-sm">
                        <div class="flex items-center justify-between mb-2">
                            <div class="flex items-center gap-3">
                                <span class="text-3xl">üì¶</span>
                                <span class="text-xl font-bold text-green-600">Minified Successfully</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-lg p-4 border-2 border-blue-300 shadow-sm">
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-sm font-semibold text-gray-600">üìä Original Size</span>
                            <span class="text-lg font-bold text-gray-800">${result.size.original.toLocaleString()} characters</span>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-lg p-4 border-2 border-purple-300 shadow-sm">
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-sm font-semibold text-gray-600">üì¶ Minified Size</span>
                            <span class="text-lg font-bold text-purple-600">${result.size.minified.toLocaleString()} characters</span>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-lg p-4 border-2 border-green-300 shadow-sm">
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-sm font-semibold text-gray-600">üíæ Space Saved</span>
                            <span class="text-xl font-bold ${compressionColor}">${result.size.saved.toLocaleString()} characters</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2 mt-2">
                            <div class="bg-green-500 h-2 rounded-full" style="width: ${Math.min(compressionPercent, 100)}%"></div>
                        </div>
                        <div class="text-xs text-gray-500 mt-1">${result.size.compression}% compression</div>
                    </div>
                </div>
            `;
            
            contentDiv.innerHTML = html;
            resultsDiv.classList.remove('hidden');
        }

        function showConversionResults(result) {
            const resultsDiv = document.getElementById('validation-results');
            const contentDiv = document.getElementById('validation-content');
            
            const formatName = result.format ? result.format.toUpperCase() : 'Unknown Format';
            const formatIcon = result.format === 'yaml' ? 'üìù' : result.format === 'xml' ? 'üìÑ' : result.format === 'csv' ? 'üìä' : result.format === 'php' ? 'üêò' : 'üîÑ';
            
            let html = `
                <div class="space-y-4 animate-fade-in">
                    <div class="bg-white rounded-lg p-5 border-2 border-green-300 shadow-sm">
                        <div class="flex items-center justify-between mb-2">
                            <div class="flex items-center gap-3">
                                <span class="text-3xl">${formatIcon}</span>
                                <span class="text-xl font-bold text-green-600">Converted to ${formatName}</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-lg p-4 border-2 border-blue-300 shadow-sm">
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-sm font-semibold text-gray-600">üìè Output Size</span>
                            <span class="text-lg font-bold text-blue-600">${result.converted.length.toLocaleString()} characters</span>
                        </div>
                        <div class="text-xs text-gray-500 mt-1">${formatName} format</div>
                    </div>
                </div>
            `;
            
            contentDiv.innerHTML = html;
            resultsDiv.classList.remove('hidden');
        }

        function showStructureAnalysis(structure) {
            const resultsDiv = document.getElementById('structure-analysis');
            const contentDiv = document.getElementById('structure-content');
            
            let html = `
                <div class="space-y-4 animate-fade-in">
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-white rounded-lg p-4 border-2 border-blue-300 shadow-sm">
                            <div class="text-sm font-semibold text-gray-600 mb-1">üìã Type</div>
                            <div class="text-lg font-bold text-blue-600">${structure.type || 'Unknown'}</div>
                        </div>
                        <div class="bg-white rounded-lg p-4 border-2 border-purple-300 shadow-sm">
                            <div class="text-sm font-semibold text-gray-600 mb-1">üìè Size</div>
                            <div class="text-lg font-bold text-purple-600">${structure.size ? structure.size.toLocaleString() : 'N/A'}</div>
                        </div>
                        <div class="bg-white rounded-lg p-4 border-2 border-green-300 shadow-sm">
                            <div class="text-sm font-semibold text-gray-600 mb-1">üìä Depth</div>
                            <div class="text-lg font-bold text-green-600">${structure.depth || 0} levels</div>
                        </div>
                        <div class="bg-white rounded-lg p-4 border-2 border-orange-300 shadow-sm">
                            <div class="text-sm font-semibold text-gray-600 mb-1">üîó Has Nested</div>
                            <div class="text-lg font-bold ${structure.hasNested ? 'text-green-600' : 'text-gray-600'}">${structure.hasNested ? 'Yes' : 'No'}</div>
                        </div>
                    </div>
            `;
            
            if (structure.keys && structure.keys.length > 0) {
                html += `
                    <div class="bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg p-4 border-2 border-blue-200 shadow-sm">
                        <div class="text-sm font-semibold text-gray-700 mb-3">üîë Keys (${structure.keys.length})</div>
                        <div class="flex flex-wrap gap-2">
                            ${structure.keys.map(key => `<span class="bg-blue-100 text-blue-800 px-3 py-1.5 rounded-lg text-xs font-semibold shadow-sm">${key}</span>`).join('')}
                        </div>
                    </div>
                `;
            }
            
            html += `</div>`;
            
            contentDiv.innerHTML = html;
            resultsDiv.classList.remove('hidden');
        }

        function showErrorResults(result) {
            const resultsDiv = document.getElementById('error-display');
            const contentDiv = document.getElementById('error-content');
            
            let html = `
                <div class="space-y-4 animate-fade-in">
                    <div class="bg-white rounded-lg p-5 border-2 border-red-300 shadow-sm">
                        <div class="flex items-center gap-3 mb-3">
                            <span class="text-3xl">‚ùå</span>
                            <span class="text-xl font-bold text-red-600">JSON Syntax Error</span>
                        </div>
                        <div class="bg-red-50 p-4 rounded-lg border-l-4 border-red-400 font-mono text-sm">
                            ${result.error || 'Unknown error'}
                        </div>
                    </div>
            `;
            
            if (result.line) {
                html += `
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-white rounded-lg p-4 border-2 border-red-300 shadow-sm">
                            <div class="text-sm font-semibold text-gray-600 mb-1">üìç Error Line</div>
                            <div class="text-xl font-bold text-red-600">Line ${result.line}</div>
                        </div>
                        <div class="bg-white rounded-lg p-4 border-2 border-blue-300 shadow-sm">
                            <div class="text-sm font-semibold text-gray-600 mb-1">üìè File Size</div>
                            <div class="text-lg font-bold text-blue-600">${result.size ? result.size.toLocaleString() : 'N/A'} characters</div>
                        </div>
                    </div>
                `;
                
                const input = document.getElementById('json-input').value;
                const lines = input.split('\n');
                if (result.line <= lines.length) {
                    const problemLine = lines[result.line - 1];
                    html += `
                        <div class="bg-white rounded-lg p-4 border-2 border-orange-300 shadow-sm">
                            <div class="text-sm font-semibold text-gray-700 mb-2">‚ö†Ô∏è Problematic Line ${result.line}:</div>
                            <div class="font-mono text-sm bg-red-50 p-3 rounded-lg border-l-4 border-red-400">${problemLine || '(empty line)'}</div>
                        </div>
                    `;
                }
            }
            
            html += `
                    <div class="bg-gradient-to-r from-yellow-50 to-amber-50 rounded-lg p-4 border-2 border-yellow-200 shadow-sm">
                        <div class="text-sm font-semibold text-yellow-800 mb-3">üí° Common JSON Errors:</div>
                        <ul class="text-sm text-yellow-700 space-y-2">
                            <li class="flex items-start gap-2"><span>‚Ä¢</span><span>Missing commas between objects/arrays</span></li>
                            <li class="flex items-start gap-2"><span>‚Ä¢</span><span>Trailing commas (not allowed in JSON)</span></li>
                            <li class="flex items-start gap-2"><span>‚Ä¢</span><span>Unquoted property names</span></li>
                            <li class="flex items-start gap-2"><span>‚Ä¢</span><span>Single quotes instead of double quotes</span></li>
                            <li class="flex items-start gap-2"><span>‚Ä¢</span><span>Missing closing brackets/braces</span></li>
                        </ul>
                    </div>
                </div>
            `;
            
            contentDiv.innerHTML = html;
            resultsDiv.classList.remove('hidden');
        }

        function hideAllResults() {
            document.getElementById('validation-results').classList.add('hidden');
            document.getElementById('structure-analysis').classList.add('hidden');
            document.getElementById('error-display').classList.add('hidden');
        }

        function updateJsonInputLineNumbers() {
            const textarea = document.getElementById('json-input');
            const linesDiv = document.getElementById('json-input-lines');
            
            const content = textarea.value;
            const lines = content.split('\n');
            let lineCount = lines.length;
            
            if (content.trim() === '') {
                lineCount = 1;
            }
            
            let lineNumbers = '';
            for (let i = 1; i <= lineCount; i++) {
                lineNumbers += `<div class="text-center text-xs" style="height: 24px; line-height: 24px; display: flex; align-items: center; justify-content: center;">${i}</div>`;
            }
            
            linesDiv.innerHTML = lineNumbers;
        }

        function updateJsonOutputLineNumbers() {
            const textarea = document.getElementById('json-output');
            const linesDiv = document.getElementById('json-output-lines');
            
            const content = textarea.value;
            const lines = content.split('\n');
            let lineCount = lines.length;
            
            if (content.trim() === '') {
                lineCount = 1;
            }
            
            let lineNumbers = '';
            for (let i = 1; i <= lineCount; i++) {
                lineNumbers += `<div class="text-center text-xs" style="height: 24px; line-height: 24px; display: flex; align-items: center; justify-content: center;">${i}</div>`;
            }
            
            linesDiv.innerHTML = lineNumbers;
        }

        function syncJsonInputScroll() {
            const textarea = document.getElementById('json-input');
            const linesDiv = document.getElementById('json-input-lines');
            linesDiv.scrollTop = textarea.scrollTop;
        }

        function syncJsonOutputScroll() {
            const textarea = document.getElementById('json-output');
            const linesDiv = document.getElementById('json-output-lines');
            linesDiv.scrollTop = textarea.scrollTop;
        }

        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                initializeJsonFormatter();
            }, 500);
        });
    </script>
    
    <!-- Tool Suggestions Widget Script -->
    <script>
        const availableTools = [
            { icon: 'üßÆ', name: 'Smart Calculator', description: 'Advanced calculator with scientific functions', pageUrl: '/tools/calculator.html' },
            { icon: '‚è∞', name: 'Study Timer', description: 'Pomodoro technique with focus sessions', pageUrl: '/tools/study-timer.html' },
            { icon: 'üìù', name: 'Note Taker', description: 'Advanced text summarization & notes', pageUrl: '/tools/note-taker.html' },
            { icon: 'üßÆ', name: 'Math Solver', description: 'Step-by-step math problem solving', pageUrl: '/tools/math-solver.html' },
            { icon: 'üìä', name: 'Grade Calculator', description: 'GPA tracking & academic analysis', pageUrl: '/tools/grade-calculator.html' },
            { icon: 'üìñ', name: 'Citation Generator', description: 'Multiple citation formats & styles', pageUrl: '/tools/citation-generator.html' },
            { icon: 'üéØ', name: 'Study Planner', description: 'Study scheduling & time management', pageUrl: '/tools/study-planner.html' },
            { icon: 'üìö', name: 'Flashcard Generator', description: 'Spaced repetition learning cards', pageUrl: '/tools/flashcard-generator.html' },
            { icon: 'üìà', name: 'Progress Tracker', description: 'Academic progress & analytics', pageUrl: '/tools/progress-tracker.html' },
            { icon: 'üéÇ', name: 'Age Calculator', description: 'Precise age & date calculations', pageUrl: '/tools/age-calculator.html' },
            { icon: '‚öñÔ∏è', name: 'BMI Calculator', description: 'Health analysis & recommendations', pageUrl: '/tools/bmi-calculator.html' },
            { icon: 'üè¶', name: 'Loan Calculator', description: 'Professional loan calculation & analysis', pageUrl: '/tools/loan-calculator.html' },
            { icon: 'üíº', name: 'Investment Calculator', description: 'Investment returns & projections', pageUrl: '/tools/investment-calculator.html' },
            { icon: 'üí∞', name: 'Tax Calculator', description: 'Tax calculation & planning', pageUrl: '/tools/tax-calculator.html' },
            { icon: 'üìä', name: 'Business Metrics', description: 'Business performance analytics', pageUrl: '/tools/business-metrics.html' },
            { icon: 'üí±', name: 'Currency Converter', description: 'Real-time currency conversion', pageUrl: '/tools/currency-converter.html' },
            { icon: 'üè†', name: 'Retirement Planner', description: 'Retirement savings calculator', pageUrl: '/tools/retirement-calculator.html' },
            { icon: 'üè°', name: 'Mortgage Calculator', description: 'Mortgage payment calculations', pageUrl: '/tools/mortgage-calculator.html' },
            { icon: 'üí≥', name: 'Budget Planner', description: 'Personal budget planning tool', pageUrl: '/tools/budget-planner.html' },
            { icon: 'üíµ', name: 'Salary Calculator', description: 'Salary & tax calculations', pageUrl: '/tools/salary-calculator.html' },
            { icon: 'üìÑ', name: 'XML Formatter', description: 'Format & validate XML data', modalId: 'xml-formatter-modal' },
            { icon: 'üîê', name: 'Base64 Encoder', description: 'Encode & decode Base64 data', modalId: 'base64-encoder-modal' },
            { icon: 'üîê', name: 'Hash Generator', description: 'Generate multiple hash types', modalId: 'hash-generator-modal' },
            { icon: 'üåê', name: 'URL Encoder', description: 'Encode & decode URLs', modalId: 'url-encoder-modal' },
            { icon: 'üîç', name: 'Regex Tester', description: 'Test & debug regex patterns', modalId: 'regex-tester-modal' },
            { icon: 'üõ†Ô∏è', name: 'CSS/JS Minifier', description: 'Minify CSS & JavaScript code', modalId: 'css-js-minifier-modal' },
            { icon: 'üé®', name: 'Color Palette', description: 'Generate beautiful color palettes', modalId: 'color-palette-modal' },
            { icon: 'üìù', name: 'Lorem Ipsum', description: 'Generate Lorem Ipsum text', modalId: 'lorem-ipsum-modal' },
            { icon: 'üïê', name: 'Timestamp Converter', description: 'Convert timestamps & dates', modalId: 'timestamp-converter-modal' },
            { icon: 'üîì', name: 'PDF Password Remover', description: 'Remove password from PDFs', modalId: 'pdf-password-remover-modal' },
            { icon: 'üìÑ', name: 'PDF Merger', description: 'Combine multiple PDFs', modalId: 'pdf-merger-modal' },
            { icon: '‚úÇÔ∏è', name: 'PDF Splitter', description: 'Split PDFs into separate pages', modalId: 'pdf-splitter-modal' },
            { icon: 'üîí', name: 'PDF Encryptor', description: 'Add password to PDFs', modalId: 'pdf-encryptor-modal' },
            { icon: 'üñºÔ∏è', name: 'PDF to Images', description: 'Convert PDF pages to images', modalId: 'pdf-to-images-modal' },
            { icon: 'üì∏', name: 'Image to PDF', description: 'Convert images to PDF documents', modalId: 'image-to-pdf-modal' },
            { icon: 'üìè', name: 'Image Compressor', description: 'Reduce image file size', modalId: 'image-compressor-modal' },
            { icon: 'üé®', name: 'Image Converter', description: 'Convert between image formats', modalId: 'image-converter-modal' },
            { icon: 'üìê', name: 'Image Resizer', description: 'Resize images to any dimensions', modalId: 'image-resizer-modal' },
            { icon: '‚úçÔ∏è', name: 'Signature Generator', description: 'Create digital signatures', modalId: 'signature-generator-modal' },
            { icon: 'üìä', name: 'CSV to JSON', description: 'Convert CSV to JSON format', modalId: 'csv-json-converter-modal' }
        ];
        
        let currentToolIndex = -1;
        let refreshInterval = null;
        
        function getRandomTool() {
            let newIndex;
            do {
                newIndex = Math.floor(Math.random() * availableTools.length);
            } while (newIndex === currentToolIndex && availableTools.length > 1);
            currentToolIndex = newIndex;
            return availableTools[newIndex];
        }
        
        function updateToolSuggestion() {
            const tool = getRandomTool();
            const card = document.getElementById('tool-suggestion-card');
            const iconEl = document.getElementById('tool-icon');
            const nameEl = document.getElementById('tool-name');
            const descEl = document.getElementById('tool-description');
            const btnEl = document.getElementById('tool-checkout-btn');
            
            if (!card || !iconEl || !nameEl || !descEl || !btnEl) return;
            
            btnEl.dataset.modalId = tool.modalId || '';
            btnEl.dataset.pageUrl = tool.pageUrl || '';
            card.style.opacity = '0';
            card.style.transform = 'translateY(-10px)';
            
            setTimeout(() => {
                iconEl.textContent = tool.icon;
                nameEl.textContent = tool.name;
                descEl.textContent = tool.description;
                card.style.opacity = '1';
                card.style.transform = 'translateY(0)';
            }, 300);
        }
        
        function launchSuggestedTool() {
            const btnEl = document.getElementById('tool-checkout-btn');
            if (!btnEl) return;
            const modalId = btnEl.dataset.modalId;
            const pageUrl = btnEl.dataset.pageUrl;
            
            if (pageUrl) {
                window.location.href = pageUrl;
            } else if (modalId && typeof openModal === 'function') {
                window.location.href = `/#${modalId}`;
            } else {
                window.location.href = '/#tools';
            }
        }
        
        function initToolSuggestions() {
            updateToolSuggestion();
            refreshInterval = setInterval(() => {
                updateToolSuggestion();
            }, 10000);
        }
        
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(initToolSuggestions, 1000);
        });
        
        window.addEventListener('beforeunload', () => {
            if (refreshInterval) clearInterval(refreshInterval);
        });
    </script>
    
    <style>
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .fade-in { animation: fadeIn 0.5s ease-in-out; }
        #tool-suggestion-card { transition: opacity 0.3s ease, transform 0.3s ease; }
        
        @keyframes slide-in {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        @keyframes slide-out {
            from {
                transform: translateX(0);
                opacity: 1;
            }
            to {
                transform: translateX(100%);
                opacity: 0;
            }
        }
        
        .animate-slide-in {
            animation: slide-in 0.3s ease-out;
        }
        
        @keyframes fade-in {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .animate-fade-in {
            animation: fade-in 0.5s ease-out;
        }
    </style>
</body>
</html>


