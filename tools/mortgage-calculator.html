<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>Mortgage Calculator - FreeToolHub</title>
    <meta name="description" content="Calculate mortgage payments, amortization, and refinancing scenarios. Professional mortgage calculator with affordability analysis.">
    <meta property="og:title" content="Mortgage Calculator - FreeToolHub">
    <meta property="og:description" content="Calculate mortgage payments, amortization, and refinancing scenarios">
    <meta property="og:url" content="https://freetoolhub.in/tools/mortgage-calculator.html">
    <meta property="og:type" content="website">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 text-gray-800">
    <!-- Header Container -->
    <div id="app-header"></div>
    
    <!-- Main Content -->
    <main class="min-h-screen pb-16" style="padding-top: 6rem;">
        <style>
            @media (min-width: 1024px) {
                main {
                    padding-top: 8.5rem !important;
                }
            }
        </style>
        <div class="max-w-7xl mx-auto px-6 py-8">
            <!-- Page Header with Share -->
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-8">
                <div>
                    <h1 class="text-4xl md:text-5xl font-bold text-gray-800 mb-2">üè† Mortgage Calculator</h1>
                    <p class="text-gray-600 text-lg">Calculate mortgage payments, amortization, and refinancing scenarios</p>
                </div>
                <button onclick="shareTool()" class="mt-4 md:mt-0 bg-gradient-to-r from-green-500 to-emerald-600 text-white px-6 py-3 rounded-lg hover:from-green-600 hover:to-emerald-700 transition-all duration-300 flex items-center gap-2 shadow-lg">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.885 12.938 9 12.482 9 12c0-.482-.115-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"></path>
                    </svg>
                    Share Tool
                </button>
            </div>
            
            <!-- Breadcrumbs -->
            <nav class="mb-6 text-sm">
                <a href="/" class="text-blue-600 hover:text-blue-800">Home</a>
                <span class="mx-2 text-gray-400">/</span>
                <a href="/#tools" class="text-blue-600 hover:text-blue-800">Tools</a>
                <span class="mx-2 text-gray-400">/</span>
                <span class="text-gray-600">Mortgage Calculator</span>
            </nav>
            
            <!-- Tool Interface -->
            <div class="bg-white rounded-2xl shadow-xl p-6 md:p-8">
                <!-- Toast Notification Container -->
                <div id="toast-container" class="fixed top-24 right-4 z-50 space-y-2"></div>
                
                <div class="grid grid-cols-1 lg:grid-cols-4 gap-6">
                    <!-- Input Section -->
                    <div class="lg:col-span-2 space-y-6">
                        <!-- Quick Mortgage Templates -->
                        <div class="bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl p-6 border-2 border-green-200">
                            <h4 class="text-lg font-bold mb-4 text-gray-700 flex items-center gap-2">
                                <span>‚ö°</span> Quick Mortgage Templates
                            </h4>
                            <div class="grid grid-cols-1 sm:grid-cols-3 gap-3">
                                <button onclick="loadMortgageTemplate('15year')" class="bg-white hover:bg-green-100 text-gray-800 font-semibold py-3 px-4 rounded-lg border-2 border-green-300 hover:border-green-400 transition-all duration-200 transform hover:scale-105 shadow-sm">
                                    <div class="text-2xl mb-1">üè°</div>
                                    <div class="text-sm">15-Year Fixed</div>
                                    <div class="text-xs text-gray-500">Lower interest</div>
                                </button>
                                <button onclick="loadMortgageTemplate('30year')" class="bg-white hover:bg-green-100 text-gray-800 font-semibold py-3 px-4 rounded-lg border-2 border-green-300 hover:border-green-400 transition-all duration-200 transform hover:scale-105 shadow-sm">
                                    <div class="text-2xl mb-1">üè†</div>
                                    <div class="text-sm">30-Year Fixed</div>
                                    <div class="text-xs text-gray-500">Lower payments</div>
                                </button>
                                <button onclick="loadMortgageTemplate('affordable')" class="bg-white hover:bg-green-100 text-gray-800 font-semibold py-3 px-4 rounded-lg border-2 border-green-300 hover:border-green-400 transition-all duration-200 transform hover:scale-105 shadow-sm">
                                    <div class="text-2xl mb-1">üí∞</div>
                                    <div class="text-sm">Affordable</div>
                                    <div class="text-xs text-gray-500">Budget-friendly</div>
                                </button>
                            </div>
                        </div>
                        
                        <!-- Basic Mortgage Calculator -->
                        <div class="bg-gradient-to-br from-green-50 to-emerald-50 rounded-xl p-6 border-2 border-green-200 shadow-lg">
                            <div class="flex items-center justify-between mb-4">
                                <h4 class="text-xl font-bold text-gray-700 flex items-center gap-2">
                                    <span>üè†</span> Mortgage Payment Calculator
                                </h4>
                                <button onclick="resetMortgageForm()" class="text-sm text-gray-600 hover:text-gray-800 font-medium flex items-center gap-1 px-3 py-1.5 rounded-lg hover:bg-white transition-colors">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                                    </svg>
                                    Reset
                                </button>
                            </div>
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2">
                                        <span>üí±</span> Currency
                                    </label>
                                    <select id="mortgage-currency" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-all" onchange="updateMortgageCurrencyDisplay()">
                                        <option value="USD">üá∫üá∏ US Dollar ($)</option>
                                        <option value="EUR">üá™üá∫ Euro (‚Ç¨)</option>
                                        <option value="GBP">üá¨üáß British Pound (¬£)</option>
                                        <option value="JPY">üáØüáµ Japanese Yen (¬•)</option>
                                        <option value="CAD">üá®üá¶ Canadian Dollar (C$)</option>
                                        <option value="AUD">üá¶üá∫ Australian Dollar (A$)</option>
                                        <option value="CHF">üá®üá≠ Swiss Franc (CHF)</option>
                                        <option value="CNY">üá®üá≥ Chinese Yuan (¬•)</option>
                                        <option value="INR">üáÆüá≥ Indian Rupee (‚Çπ)</option>
                                        <option value="BRL">üáßüá∑ Brazilian Real (R$)</option>
                                        <option value="SGD">üá∏üá¨ Singapore Dollar (S$)</option>
                                        <option value="AED">üá¶üá™ UAE Dirham (ÿØ.ÿ•)</option>
                                        <option value="SAR">üá∏üá¶ Saudi Riyal (Ô∑º)</option>
                                        <option value="ZAR">üáøüá¶ South African Rand (R)</option>
                                        <option value="MXN">üá≤üáΩ Mexican Peso ($)</option>
                                    </select>
                                    <p class="text-xs text-gray-500 mt-1">Currency for display purposes</p>
                                </div>
                                <div class="grid grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2">
                                            <span>üí∞</span> Loan Amount
                                        </label>
                                        <div class="relative">
                                            <span id="loan-currency-prefix" class="absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-500 font-semibold">$</span>
                                            <input type="number" id="loan-amount" min="0" class="w-full pl-10 pr-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-all" placeholder="300000" value="300000" oninput="formatMortgageCurrency()">
                                        </div>
                                        <p class="text-xs text-gray-500 mt-1">Total loan amount</p>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2">
                                            <span>üíµ</span> Down Payment
                                        </label>
                                        <div class="relative">
                                            <span id="down-currency-prefix" class="absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-500 font-semibold">$</span>
                                            <input type="number" id="down-payment" min="0" class="w-full pl-10 pr-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-all" placeholder="60000" value="60000" oninput="formatMortgageCurrency()">
                                        </div>
                                        <p class="text-xs text-gray-500 mt-1">Initial down payment</p>
                                    </div>
                                </div>
                                <div class="grid grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2">
                                            <span>üìä</span> Interest Rate (%)
                                        </label>
                                        <input type="number" id="interest-rate" min="0" max="30" step="0.1" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-all" placeholder="6.5" value="6.5" step="0.1">
                                        <p class="text-xs text-gray-500 mt-1">Annual interest rate</p>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2">
                                            <span>‚è∞</span> Loan Term (Years)
                                        </label>
                                        <input type="number" id="loan-term" min="1" max="50" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-all" placeholder="30" value="30">
                                        <p class="text-xs text-gray-500 mt-1">Loan duration in years</p>
                                    </div>
                                </div>
                                <div class="grid grid-cols-3 gap-4">
                                    <div>
                                        <label class="block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2">
                                            <span>üèõÔ∏è</span> Property Tax (Annual)
                                        </label>
                                        <div class="relative">
                                            <span id="tax-currency-prefix" class="absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-500 font-semibold">$</span>
                                            <input type="number" id="property-tax" min="0" class="w-full pl-10 pr-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-all" placeholder="3600" value="3600" oninput="formatMortgageCurrency()">
                                        </div>
                                        <p class="text-xs text-gray-500 mt-1">Annual property tax</p>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2">
                                            <span>üõ°Ô∏è</span> Insurance (Annual)
                                        </label>
                                        <div class="relative">
                                            <span id="insurance-currency-prefix" class="absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-500 font-semibold">$</span>
                                            <input type="number" id="insurance" min="0" class="w-full pl-10 pr-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-all" placeholder="1200" value="1200" oninput="formatMortgageCurrency()">
                                        </div>
                                        <p class="text-xs text-gray-500 mt-1">Annual insurance</p>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2">
                                            <span>üîí</span> PMI (Annual)
                                        </label>
                                        <div class="relative">
                                            <span id="pmi-currency-prefix" class="absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-500 font-semibold">$</span>
                                            <input type="number" id="pmi" min="0" class="w-full pl-10 pr-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-all" placeholder="0" value="0" oninput="formatMortgageCurrency()">
                                        </div>
                                        <p class="text-xs text-gray-500 mt-1">Private mortgage insurance</p>
                                    </div>
                                </div>
                            </div>
                            <button onclick="calculateMortgage()" id="calculate-mortgage-btn" class="w-full mt-6 bg-gradient-to-r from-green-500 to-emerald-600 text-white font-bold py-4 px-6 rounded-xl hover:from-green-600 hover:to-emerald-700 transition-all duration-300 transform hover:scale-105 shadow-lg flex items-center justify-center gap-2 text-lg">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                                </svg>
                                <span>Calculate Mortgage</span>
                            </button>
                        </div>

                        <!-- Affordability Calculator -->
                        <div class="bg-gradient-to-br from-blue-50 to-cyan-50 rounded-xl p-6 border-2 border-blue-200 shadow-lg">
                            <h4 class="text-xl font-bold mb-4 text-gray-700 flex items-center gap-2">
                                <span>üí∞</span> Affordability Calculator
                            </h4>
                            <div class="space-y-4">
                                <div class="grid grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2">
                                            <span>üíµ</span> Annual Income
                                        </label>
                                        <div class="relative">
                                            <span id="income-currency-prefix" class="absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-500 font-semibold">$</span>
                                            <input type="number" id="annual-income" min="0" class="w-full pl-10 pr-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all" placeholder="75000" value="75000" oninput="formatMortgageCurrency()">
                                        </div>
                                        <p class="text-xs text-gray-500 mt-1">Your annual income</p>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2">
                                            <span>üìã</span> Monthly Debts
                                        </label>
                                        <div class="relative">
                                            <span id="debt-currency-prefix" class="absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-500 font-semibold">$</span>
                                            <input type="number" id="monthly-debts" min="0" class="w-full pl-10 pr-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all" placeholder="500" value="500" oninput="formatMortgageCurrency()">
                                        </div>
                                        <p class="text-xs text-gray-500 mt-1">Existing monthly debts</p>
                                    </div>
                                </div>
                                <div class="grid grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2">
                                            <span>üíº</span> Down Payment Available
                                        </label>
                                        <div class="relative">
                                            <span id="affordability-down-currency-prefix" class="absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-500 font-semibold">$</span>
                                            <input type="number" id="affordability-down" min="0" class="w-full pl-10 pr-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all" placeholder="60000" value="60000" oninput="formatMortgageCurrency()">
                                        </div>
                                        <p class="text-xs text-gray-500 mt-1">Available down payment</p>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2">
                                            <span>üìä</span> Interest Rate (%)
                                        </label>
                                        <input type="number" id="affordability-rate" min="0" max="30" step="0.1" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all" placeholder="6.5" value="6.5" step="0.1">
                                        <p class="text-xs text-gray-500 mt-1">Expected interest rate</p>
                                    </div>
                                </div>
                            </div>
                            <button onclick="calculateAffordability()" id="calculate-affordability-btn" class="w-full mt-4 bg-gradient-to-r from-blue-500 to-blue-600 text-white font-bold py-4 px-6 rounded-xl hover:from-blue-600 hover:to-blue-700 transition-all duration-300 transform hover:scale-105 shadow-lg flex items-center justify-center gap-2 text-lg">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-5m-6 5h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                                </svg>
                                <span>Calculate Affordability</span>
                            </button>
                        </div>
                    </div>
                    
                    <!-- Results Section -->
                    <div class="lg:col-span-1 space-y-6">
                        <!-- Mortgage Results -->
                        <div class="bg-gradient-to-br from-green-50 to-emerald-50 rounded-xl p-6 border-2 border-green-200 shadow-lg">
                            <h4 class="text-xl font-bold mb-4 text-gray-700 flex items-center gap-2">
                                <span>üè†</span> Mortgage Payment
                            </h4>
                            <div id="mortgage-results" class="space-y-3">
                                <div class="text-center text-gray-500 py-8">
                                    <div class="text-4xl mb-2">üí°</div>
                                    <p class="text-sm">Enter loan details and click "Calculate Mortgage"</p>
                                </div>
                            </div>
                        </div>

                        <!-- Affordability Results -->
                        <div class="bg-gradient-to-br from-blue-50 to-cyan-50 rounded-xl p-6 border-2 border-blue-200 shadow-lg">
                            <h4 class="text-xl font-bold mb-4 text-gray-700 flex items-center gap-2">
                                <span>üí∞</span> Affordability Analysis
                            </h4>
                            <div id="affordability-results" class="space-y-3">
                                <div class="text-center text-gray-500 py-8">
                                    <div class="text-4xl mb-2">üìä</div>
                                    <p class="text-sm">Enter income details and click "Calculate Affordability"</p>
                                </div>
                            </div>
                        </div>

                        <!-- Amortization Summary -->
                        <div class="bg-gradient-to-br from-gray-50 to-slate-50 rounded-xl p-6 border-2 border-gray-200 shadow-lg">
                            <h4 class="text-xl font-bold mb-4 text-gray-700 flex items-center gap-2">
                                <span>üìã</span> Loan Summary
                            </h4>
                            <div id="loan-summary" class="space-y-3">
                                <div class="text-center text-gray-500 py-8">
                                    <div class="text-4xl mb-2">üìà</div>
                                    <p class="text-sm">Calculate mortgage to see loan summary</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Tool Suggestions Widget -->
                    <div class="lg:col-span-1 hidden lg:block">
                        <div class="bg-gradient-to-br from-purple-50 to-blue-50 rounded-xl p-6 border-2 border-purple-200 shadow-lg h-fit sticky top-28">
                            <div class="flex items-center justify-between mb-5">
                                <h4 class="text-xl font-bold text-gray-800">‚ú® Explore Tools</h4>
                                <div class="flex items-center space-x-1">
                                    <div class="w-2.5 h-2.5 bg-purple-500 rounded-full animate-pulse"></div>
                                    <span class="text-xs text-gray-500 font-medium">Live</span>
                                </div>
                            </div>
                            
                            <div id="tool-suggestion-card" class="bg-white rounded-xl p-6 shadow-lg transition-all duration-500 fade-in">
                                <div id="tool-icon" class="text-6xl mb-4 text-center">üßÆ</div>
                                <h5 id="tool-name" class="text-2xl font-bold text-gray-800 mb-3 text-center">Loading...</h5>
                                <p id="tool-description" class="text-base text-gray-600 mb-6 text-center leading-relaxed">Discover amazing tools</p>
                                <button id="tool-checkout-btn" onclick="launchSuggestedTool()" class="w-full bg-gradient-to-r from-purple-500 to-blue-600 text-white font-bold py-3.5 px-6 rounded-xl hover:from-purple-600 hover:to-blue-700 transition-all duration-300 transform hover:scale-105 shadow-lg flex items-center justify-center gap-2 text-lg">
                                    <span>Check it out</span>
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"></path>
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
    
    <!-- Footer Container -->
    <div id="app-footer"></div>
    
    <!-- Scripts -->
    <script src="/js/common-functions.js"></script>
    <script src="/js/widgets.js"></script>
    <script src="/js/components/HeaderLoader.js"></script>
    <script src="/js/components/FooterLoader.js"></script>
    <script src="/js/components/ShareButton.js"></script>
    <script src="/js/components/SeasonalEffects.js"></script>
    <script src="/js/widgets-init.js"></script>
    
    <!-- Mortgage Calculator Dependencies -->
    <script src="/src/js/MortgageCalculator.js?v=1&t=1726745000"></script>
    
    <!-- Mortgage Calculator JavaScript -->
    <script>
        let mortgageCalculator = null;

        function initializeMortgageCalculator() {
            try {
                if (typeof MortgageCalculator !== 'undefined') {
                    mortgageCalculator = new MortgageCalculator();
                    console.log('‚úÖ Mortgage Calculator initialized successfully');
                    updateMortgageCurrencyDisplay();
                } else {
                    console.error('‚ùå MortgageCalculator class not found');
                }
            } catch (error) {
                console.error('‚ùå Error initializing Mortgage Calculator:', error);
            }
        }

        // Toast notification function
        function showNotification(message, type = 'info') {
            const container = document.getElementById('toast-container');
            if (!container) return;
            
            const toast = document.createElement('div');
            const bgColor = type === 'success' ? 'bg-green-500' : type === 'error' ? 'bg-red-500' : type === 'warning' ? 'bg-yellow-500' : 'bg-blue-500';
            const icon = type === 'success' ? '‚úÖ' : type === 'error' ? '‚ùå' : type === 'warning' ? '‚ö†Ô∏è' : '‚ÑπÔ∏è';
            
            toast.className = `${bgColor} text-white px-6 py-4 rounded-lg shadow-lg flex items-center gap-3 min-w-[300px] max-w-md animate-slide-in`;
            toast.innerHTML = `
                <span class="text-xl">${icon}</span>
                <span class="flex-1">${message}</span>
                <button onclick="this.parentElement.remove()" class="text-white hover:text-gray-200 font-bold">√ó</button>
            `;
            
            container.appendChild(toast);
            
            setTimeout(() => {
                toast.style.opacity = '0';
                toast.style.transform = 'translateX(100%)';
                setTimeout(() => toast.remove(), 300);
            }, type === 'error' ? 5000 : 3000);
        }

        // Format currency display
        function formatMortgageCurrency() {
            if (!mortgageCalculator) return;
            const currency = mortgageCalculator.currencies[mortgageCalculator.selectedCurrency];
            const symbol = currency ? currency.symbol : '$';
            document.getElementById('loan-currency-prefix').textContent = symbol;
            document.getElementById('down-currency-prefix').textContent = symbol;
            document.getElementById('tax-currency-prefix').textContent = symbol;
            document.getElementById('insurance-currency-prefix').textContent = symbol;
            document.getElementById('pmi-currency-prefix').textContent = symbol;
            document.getElementById('income-currency-prefix').textContent = symbol;
            document.getElementById('debt-currency-prefix').textContent = symbol;
            document.getElementById('affordability-down-currency-prefix').textContent = symbol;
        }

        function updateMortgageCurrencyDisplay() {
            if (!mortgageCalculator) return;
            const currency = document.getElementById('mortgage-currency').value;
            mortgageCalculator.selectedCurrency = currency;
            formatMortgageCurrency();
        }

        // Load quick templates
        function loadMortgageTemplate(type) {
            const templates = {
                '15year': { loanAmount: 300000, downPayment: 60000, interestRate: 5.5, loanTerm: 15, propertyTax: 3600, insurance: 1200, pmi: 0 },
                '30year': { loanAmount: 300000, downPayment: 60000, interestRate: 6.5, loanTerm: 30, propertyTax: 3600, insurance: 1200, pmi: 0 },
                'affordable': { loanAmount: 200000, downPayment: 40000, interestRate: 6.0, loanTerm: 30, propertyTax: 2400, insurance: 800, pmi: 0 }
            };
            
            const template = templates[type];
            if (!template) return;
            
            document.getElementById('loan-amount').value = template.loanAmount;
            document.getElementById('down-payment').value = template.downPayment;
            document.getElementById('interest-rate').value = template.interestRate;
            document.getElementById('loan-term').value = template.loanTerm;
            document.getElementById('property-tax').value = template.propertyTax;
            document.getElementById('insurance').value = template.insurance;
            document.getElementById('pmi').value = template.pmi;
            
            formatMortgageCurrency();
            showNotification(`Loaded ${type.charAt(0).toUpperCase() + type.slice(1)} mortgage template`, 'success');
        }

        // Reset form
        function resetMortgageForm() {
            document.getElementById('loan-amount').value = '';
            document.getElementById('down-payment').value = '';
            document.getElementById('interest-rate').value = '';
            document.getElementById('loan-term').value = '';
            document.getElementById('property-tax').value = '';
            document.getElementById('insurance').value = '';
            document.getElementById('pmi').value = '';
            document.getElementById('annual-income').value = '';
            document.getElementById('monthly-debts').value = '';
            document.getElementById('affordability-down').value = '';
            document.getElementById('affordability-rate').value = '';
            
            document.getElementById('mortgage-results').innerHTML = `
                <div class="text-center text-gray-500 py-8">
                    <div class="text-4xl mb-2">üí°</div>
                    <p class="text-sm">Enter loan details and click "Calculate Mortgage"</p>
                </div>
            `;
            document.getElementById('affordability-results').innerHTML = `
                <div class="text-center text-gray-500 py-8">
                    <div class="text-4xl mb-2">üìä</div>
                    <p class="text-sm">Enter income details and click "Calculate Affordability"</p>
                </div>
            `;
            document.getElementById('loan-summary').innerHTML = `
                <div class="text-center text-gray-500 py-8">
                    <div class="text-4xl mb-2">üìà</div>
                    <p class="text-sm">Calculate mortgage to see loan summary</p>
                </div>
            `;
            showNotification('Form reset successfully', 'info');
        }

        function calculateMortgage() {
            if (!mortgageCalculator) {
                showNotification('Mortgage Calculator not initialized. Please refresh the page.', 'error');
                return;
            }

            const loanAmount = parseFloat(document.getElementById('loan-amount').value);
            const downPayment = parseFloat(document.getElementById('down-payment').value) || 0;
            const interestRate = parseFloat(document.getElementById('interest-rate').value);
            const loanTerm = parseInt(document.getElementById('loan-term').value);
            const propertyTax = parseFloat(document.getElementById('property-tax').value) || 0;
            const insurance = parseFloat(document.getElementById('insurance').value) || 0;
            const pmi = parseFloat(document.getElementById('pmi').value) || 0;

            if (!loanAmount || loanAmount <= 0) {
                showNotification('Please enter a valid loan amount.', 'warning');
                document.getElementById('loan-amount').focus();
                return;
            }

            if (downPayment >= loanAmount) {
                showNotification('Down payment must be less than loan amount.', 'warning');
                document.getElementById('down-payment').focus();
                return;
            }

            if (!interestRate || interestRate < 0 || interestRate > 30) {
                showNotification('Please enter a valid interest rate (0-30%).', 'warning');
                document.getElementById('interest-rate').focus();
                return;
            }

            if (!loanTerm || loanTerm < 1 || loanTerm > 50) {
                showNotification('Please enter a valid loan term (1-50 years).', 'warning');
                document.getElementById('loan-term').focus();
                return;
            }

            const calculateBtn = document.getElementById('calculate-mortgage-btn');
            const originalHTML = calculateBtn.innerHTML;
            calculateBtn.disabled = true;
            calculateBtn.innerHTML = '<span class="inline-block animate-spin">‚è≥</span><span> Calculating...</span>';

            setTimeout(() => {
                const result = mortgageCalculator.calculateMortgagePayment(
                    loanAmount, interestRate, loanTerm, downPayment, propertyTax, insurance, pmi
                );

                if (result.success) {
                    showMortgageResults(result);
                    showLoanSummary(result);
                    showNotification('Mortgage calculated successfully!', 'success');
                } else {
                    showNotification('Error calculating mortgage: ' + result.error, 'error');
                }
                calculateBtn.disabled = false;
                calculateBtn.innerHTML = originalHTML;
            }, 300);
        }

        function showMortgageResults(result) {
            const currency = mortgageCalculator.currencies[mortgageCalculator.selectedCurrency];
            const symbol = currency ? currency.symbol : '$';
            
            // Calculate percentages
            const principalPercent = ((result.principal / result.totalPayment) * 100).toFixed(1);
            const interestPercent = ((result.totalInterest / result.totalPayment) * 100).toFixed(1);
            const extraCosts = result.totalMonthlyPayment - result.monthlyPayment;
            const extraCostsPercent = extraCosts > 0 ? ((extraCosts * result.loanTerm * 12) / result.totalPayment * 100).toFixed(1) : 0;
            
            document.getElementById('mortgage-results').innerHTML = `
                <div class="space-y-4 animate-fade-in">
                    <div class="bg-white rounded-lg p-5 border-2 border-green-300 shadow-sm">
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-sm font-semibold text-gray-600">üí∞ Monthly Payment</span>
                            <span class="text-2xl font-bold text-green-600">${symbol}${result.monthlyPayment.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</span>
                        </div>
                        <div class="text-xs text-gray-500 mt-1">Principal + Interest</div>
                    </div>
                    
                    <div class="bg-white rounded-lg p-5 border-2 border-blue-300 shadow-sm">
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-sm font-semibold text-gray-600">üìä Total Monthly Payment</span>
                            <span class="text-2xl font-bold text-blue-600">${symbol}${result.totalMonthlyPayment.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</span>
                        </div>
                        <div class="text-xs text-gray-500 mt-1">Including taxes, insurance, PMI</div>
                        ${extraCosts > 0 ? `
                            <div class="mt-2 text-xs text-gray-600">
                                + ${symbol}${extraCosts.toFixed(2)}/month for taxes, insurance, PMI
                            </div>
                        ` : ''}
                    </div>
                    
                    <div class="bg-white rounded-lg p-4 border-2 border-red-300 shadow-sm">
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-sm font-semibold text-gray-600">üí∏ Total Interest</span>
                            <span class="text-xl font-bold text-red-600">${symbol}${result.totalInterest.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2 mt-2">
                            <div class="bg-red-500 h-2 rounded-full" style="width: ${interestPercent}%"></div>
                        </div>
                        <div class="text-xs text-gray-500 mt-1">${interestPercent}% of total payment</div>
                    </div>
                    
                    <div class="bg-white rounded-lg p-4 border-2 border-purple-300 shadow-sm">
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-sm font-semibold text-gray-600">üìà Total Payment</span>
                            <span class="text-xl font-bold text-purple-600">${symbol}${result.totalPayment.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</span>
                        </div>
                        <div class="text-xs text-gray-500 mt-1">Principal + Interest over ${result.loanTerm} years</div>
                    </div>
                    
                    <div class="bg-gradient-to-r from-green-100 to-blue-100 rounded-lg p-3 border border-green-200">
                        <div class="text-xs font-semibold text-gray-700 mb-2">üí° Payment Breakdown</div>
                        <div class="flex items-center gap-2">
                            <div class="flex-1 bg-green-500 rounded h-2" style="width: ${principalPercent}%"></div>
                            <span class="text-xs text-gray-600">${principalPercent}% Principal</span>
                        </div>
                        <div class="flex items-center gap-2 mt-1">
                            <div class="flex-1 bg-red-500 rounded h-2" style="width: ${interestPercent}%"></div>
                            <span class="text-xs text-gray-600">${interestPercent}% Interest</span>
                        </div>
                    </div>
                </div>
            `;
        }

        function showLoanSummary(result) {
            const currency = mortgageCalculator.currencies[mortgageCalculator.selectedCurrency];
            const symbol = currency ? currency.symbol : '$';
            
            const downPaymentPercent = ((result.downPayment / result.loanAmount) * 100).toFixed(1);
            
            document.getElementById('loan-summary').innerHTML = `
                <div class="space-y-4 animate-fade-in">
                    <div class="bg-white rounded-lg p-4 border-2 border-gray-300 shadow-sm">
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-sm font-semibold text-gray-600">üí∞ Loan Amount</span>
                            <span class="text-lg font-bold text-gray-800">${symbol}${result.loanAmount.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</span>
                        </div>
                        <div class="text-xs text-gray-500 mt-1">Total loan amount</div>
                    </div>
                    
                    <div class="bg-white rounded-lg p-4 border-2 border-blue-300 shadow-sm">
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-sm font-semibold text-gray-600">üíµ Down Payment</span>
                            <span class="text-lg font-bold text-blue-600">${symbol}${result.downPayment.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</span>
                        </div>
                        <div class="text-xs text-gray-500 mt-1">${downPaymentPercent}% of loan amount</div>
                    </div>
                    
                    <div class="bg-white rounded-lg p-4 border-2 border-green-300 shadow-sm">
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-sm font-semibold text-gray-600">üìä Principal</span>
                            <span class="text-lg font-bold text-green-600">${symbol}${result.principal.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</span>
                        </div>
                        <div class="text-xs text-gray-500 mt-1">Loan amount - down payment</div>
                    </div>
                    
                    <div class="bg-white rounded-lg p-4 border-2 border-orange-300 shadow-sm">
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-sm font-semibold text-gray-600">üìà Interest Rate</span>
                            <span class="text-lg font-bold text-orange-600">${result.interestRate.toFixed(2)}%</span>
                        </div>
                        <div class="text-xs text-gray-500 mt-1">Annual interest rate</div>
                    </div>
                    
                    <div class="bg-white rounded-lg p-4 border-2 border-indigo-300 shadow-sm">
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-sm font-semibold text-gray-600">‚è∞ Loan Term</span>
                            <span class="text-lg font-bold text-indigo-600">${result.loanTerm} years</span>
                        </div>
                        <div class="text-xs text-gray-500 mt-1">${result.loanTerm * 12} monthly payments</div>
                    </div>
                    
                    ${result.propertyTax > 0 || result.insurance > 0 || result.pmi > 0 ? `
                        <div class="bg-gradient-to-r from-gray-100 to-slate-100 rounded-lg p-3 border border-gray-200">
                            <div class="text-xs font-semibold text-gray-700 mb-2">üìã Additional Costs</div>
                            ${result.propertyTax > 0 ? `
                                <div class="text-xs text-gray-600 mb-1">üèõÔ∏è Property Tax: ${symbol}${(result.propertyTax / 12).toFixed(2)}/month</div>
                            ` : ''}
                            ${result.insurance > 0 ? `
                                <div class="text-xs text-gray-600 mb-1">üõ°Ô∏è Insurance: ${symbol}${(result.insurance / 12).toFixed(2)}/month</div>
                            ` : ''}
                            ${result.pmi > 0 ? `
                                <div class="text-xs text-gray-600 mb-1">üîí PMI: ${symbol}${(result.pmi / 12).toFixed(2)}/month</div>
                            ` : ''}
                        </div>
                    ` : ''}
                </div>
            `;
        }

        function calculateAffordability() {
            if (!mortgageCalculator) {
                showNotification('Mortgage Calculator not initialized. Please refresh the page.', 'error');
                return;
            }

            const income = parseFloat(document.getElementById('annual-income').value);
            const monthlyDebts = parseFloat(document.getElementById('monthly-debts').value) || 0;
            const downPayment = parseFloat(document.getElementById('affordability-down').value) || 0;
            const interestRate = parseFloat(document.getElementById('affordability-rate').value);
            const loanTerm = 30;

            if (!income || income <= 0) {
                showNotification('Please enter a valid annual income.', 'warning');
                document.getElementById('annual-income').focus();
                return;
            }

            if (!interestRate || interestRate < 0 || interestRate > 30) {
                showNotification('Please enter a valid interest rate (0-30%).', 'warning');
                document.getElementById('affordability-rate').focus();
                return;
            }

            const affordabilityBtn = document.getElementById('calculate-affordability-btn');
            if (!affordabilityBtn) {
                showNotification('Button element not found.', 'error');
                return;
            }
            
            const originalHTML = affordabilityBtn.innerHTML;
            affordabilityBtn.disabled = true;
            affordabilityBtn.innerHTML = '<span class="inline-block animate-spin">‚è≥</span><span> Calculating...</span>';

            setTimeout(() => {
                try {
                    if (!mortgageCalculator) {
                        throw new Error('Mortgage Calculator not initialized');
                    }
                    
                    let result;
                    if (typeof mortgageCalculator.calculateAffordability === 'function') {
                        result = mortgageCalculator.calculateAffordability(income, monthlyDebts, downPayment, interestRate, loanTerm);
                    } else {
                        // Fallback calculation
                        const monthlyIncome = income / 12;
                        const maxMonthlyPayment = (monthlyIncome * 0.28) - monthlyDebts; // 28% rule
                        
                        if (maxMonthlyPayment <= 0) {
                            result = {
                                success: false,
                                error: 'Monthly debts are too high. Your debts exceed 28% of your income. Please reduce your monthly debts.'
                            };
                        } else {
                            const monthlyRate = interestRate / 100 / 12;
                            const numberOfPayments = loanTerm * 12;
                            
                            let maxLoanAmount = 0;
                            if (monthlyRate > 0) {
                                maxLoanAmount = maxMonthlyPayment * ((Math.pow(1 + monthlyRate, numberOfPayments) - 1) / (monthlyRate * Math.pow(1 + monthlyRate, numberOfPayments)));
                            } else {
                                maxLoanAmount = maxMonthlyPayment * numberOfPayments;
                            }
                            
                            result = {
                                success: true,
                                maxLoanAmount: maxLoanAmount,
                                maxHomePrice: maxLoanAmount + downPayment,
                                maxMonthlyPayment: maxMonthlyPayment,
                                downPayment: downPayment,
                                income: income,
                                monthlyDebts: monthlyDebts,
                                monthlyIncome: monthlyIncome
                            };
                        }
                    }

                    if (result && result.success) {
                        showAffordabilityResults(result);
                        showNotification('Affordability calculated successfully!', 'success');
                    } else {
                        const errorMsg = (result && result.error) ? result.error : 'Unknown error occurred';
                        showNotification('Error calculating affordability: ' + errorMsg, 'error');
                        console.error('Affordability calculation failed:', result);
                    }
                } catch (error) {
                    console.error('Error in calculateAffordability:', error);
                    showNotification('Error calculating affordability: ' + (error.message || 'Unknown error'), 'error');
                } finally {
                    // Always reset button state
                    affordabilityBtn.disabled = false;
                    affordabilityBtn.innerHTML = originalHTML;
                }
            }, 300);
        }

        function showAffordabilityResults(result) {
            if (!result) {
                console.error('No result provided to showAffordabilityResults');
                showNotification('No results to display', 'error');
                return;
            }
            
            const currency = mortgageCalculator.currencies[mortgageCalculator.selectedCurrency];
            const symbol = currency ? currency.symbol : '$';
            
            // Handle both property names (maxPayment from MortgageCalculator, maxMonthlyPayment from fallback)
            const maxMonthlyPayment = result.maxMonthlyPayment || result.maxPayment || 0;
            const maxLoanAmount = result.maxLoanAmount || 0;
            const maxHomePrice = result.maxHomePrice || (maxLoanAmount + (result.downPayment || 0));
            const monthlyIncome = result.monthlyIncome || (result.income ? result.income / 12 : 0);
            const monthlyDebts = result.monthlyDebts || 0;
            const debtToIncome = result.debtToIncomeRatio || (monthlyIncome > 0 ? ((monthlyDebts / monthlyIncome) * 100) : 0);
            const paymentToIncome = monthlyIncome > 0 && maxMonthlyPayment > 0 ? ((maxMonthlyPayment / monthlyIncome) * 100).toFixed(1) : 0;
            
            // Validate required values
            if (!maxLoanAmount || !maxMonthlyPayment) {
                console.error('Missing required values in result:', result);
                showNotification('Invalid calculation result. Please check your inputs.', 'error');
                return;
            }
            
            document.getElementById('affordability-results').innerHTML = `
                <div class="space-y-4 animate-fade-in">
                    <div class="bg-white rounded-lg p-5 border-2 border-blue-300 shadow-sm">
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-sm font-semibold text-gray-600">üí∞ Max Loan Amount</span>
                            <span class="text-2xl font-bold text-blue-600">${symbol}${maxLoanAmount.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</span>
                        </div>
                        <div class="text-xs text-gray-500 mt-1">Maximum loan you qualify for</div>
                    </div>
                    
                    <div class="bg-white rounded-lg p-5 border-2 border-green-300 shadow-sm">
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-sm font-semibold text-gray-600">üè† Max Home Price</span>
                            <span class="text-2xl font-bold text-green-600">${symbol}${maxHomePrice.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</span>
                        </div>
                        <div class="text-xs text-gray-500 mt-1">Loan + Down payment</div>
                    </div>
                    
                    <div class="bg-white rounded-lg p-4 border-2 border-purple-300 shadow-sm">
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-sm font-semibold text-gray-600">üíµ Max Monthly Payment</span>
                            <span class="text-xl font-bold text-purple-600">${symbol}${maxMonthlyPayment.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2 mt-2">
                            <div class="bg-purple-500 h-2 rounded-full" style="width: ${Math.min(paymentToIncome, 100)}%"></div>
                        </div>
                        <div class="text-xs text-gray-500 mt-1">${paymentToIncome}% of monthly income (28% rule)</div>
                    </div>
                    
                    ${result.maxPaymentWithDebt && result.maxPaymentWithDebt > 0 ? `
                        <div class="bg-white rounded-lg p-4 border-2 border-cyan-300 shadow-sm">
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-sm font-semibold text-gray-600">üìä Max with Debt (36% rule)</span>
                                <span class="text-lg font-bold text-cyan-600">${symbol}${result.maxPaymentWithDebt.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</span>
                            </div>
                            <div class="text-xs text-gray-500 mt-1">Including existing debts</div>
                        </div>
                    ` : ''}
                    
                    ${result.maxHomePriceWithDebt && result.maxHomePriceWithDebt > 0 ? `
                        <div class="bg-white rounded-lg p-4 border-2 border-teal-300 shadow-sm">
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-sm font-semibold text-gray-600">üè° Max Home Price (36% rule)</span>
                                <span class="text-lg font-bold text-teal-600">${symbol}${result.maxHomePriceWithDebt.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</span>
                            </div>
                            <div class="text-xs text-gray-500 mt-1">Including existing debts</div>
                        </div>
                    ` : ''}
                    
                    <div class="bg-gradient-to-r from-green-100 to-emerald-100 rounded-lg p-3 border border-green-200">
                        <div class="text-xs font-semibold text-gray-700 mb-2">üí° Affordability Insights</div>
                        <div class="text-xs text-gray-600 space-y-1">
                            <div>üìä Debt-to-Income: ${debtToIncome.toFixed(1)}%</div>
                            <div>üí∞ ${result.downPayment && result.downPayment > 0 ? `Down payment: ${symbol}${result.downPayment.toLocaleString('en-US')}` : 'No down payment included'}</div>
                            ${debtToIncome > 36 ? '<div>‚ö†Ô∏è High debt ratio - consider reducing debts</div>' : debtToIncome > 28 ? '<div>‚ö†Ô∏è Moderate debt ratio</div>' : '<div>‚úÖ Good debt ratio</div>'}
                        </div>
                    </div>
                </div>
            `;
        }

        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                initializeMortgageCalculator();
                formatMortgageCurrency();
            }, 500);
        });
    </script>
    
    <!-- Tool Suggestions Widget Script -->
    <script>
        const availableTools = [
            { icon: 'üßÆ', name: 'Smart Calculator', description: 'Advanced calculator with scientific functions', pageUrl: '/tools/calculator.html' },
            { icon: '‚è∞', name: 'Study Timer', description: 'Pomodoro technique with focus sessions', pageUrl: '/tools/study-timer.html' },
            { icon: 'üìù', name: 'Note Taker', description: 'Advanced text summarization & notes', pageUrl: '/tools/note-taker.html' },
            { icon: 'üßÆ', name: 'Math Solver', description: 'Step-by-step math problem solving', pageUrl: '/tools/math-solver.html' },
            { icon: 'üìä', name: 'Grade Calculator', description: 'GPA tracking & academic analysis', pageUrl: '/tools/grade-calculator.html' },
            { icon: 'üìñ', name: 'Citation Generator', description: 'Multiple citation formats & styles', pageUrl: '/tools/citation-generator.html' },
            { icon: 'üéØ', name: 'Study Planner', description: 'Study scheduling & time management', pageUrl: '/tools/study-planner.html' },
            { icon: 'üìö', name: 'Flashcard Generator', description: 'Spaced repetition learning cards', pageUrl: '/tools/flashcard-generator.html' },
            { icon: 'üìà', name: 'Progress Tracker', description: 'Academic progress & analytics', pageUrl: '/tools/progress-tracker.html' },
            { icon: 'üéÇ', name: 'Age Calculator', description: 'Precise age & date calculations', pageUrl: '/tools/age-calculator.html' },
            { icon: '‚öñÔ∏è', name: 'BMI Calculator', description: 'Health analysis & recommendations', pageUrl: '/tools/bmi-calculator.html' },
            { icon: 'üè¶', name: 'Loan Calculator', description: 'Professional loan calculation & analysis', pageUrl: '/tools/loan-calculator.html' },
            { icon: 'üíº', name: 'Investment Calculator', description: 'Investment returns & projections', pageUrl: '/tools/investment-calculator.html' },
            { icon: 'üí∞', name: 'Tax Calculator', description: 'Tax calculation & planning', pageUrl: '/tools/tax-calculator.html' },
            { icon: 'üìä', name: 'Business Metrics', description: 'Business performance analytics', pageUrl: '/tools/business-metrics.html' },
            { icon: 'üí±', name: 'Currency Converter', description: 'Real-time currency conversion', pageUrl: '/tools/currency-converter.html' },
            { icon: 'üè†', name: 'Retirement Planner', description: 'Retirement savings calculator', pageUrl: '/tools/retirement-calculator.html' },
            { icon: 'üí≥', name: 'Budget Planner', description: 'Personal budget planning tool', modalId: 'budget-planner-modal' },
            { icon: 'üíµ', name: 'Salary Calculator', description: 'Salary & tax calculations', modalId: 'salary-calculator-modal' },
            { icon: 'üîß', name: 'JSON Formatter', description: 'Format & validate JSON data', modalId: 'json-formatter-modal' },
            { icon: 'üìÑ', name: 'XML Formatter', description: 'Format & validate XML data', modalId: 'xml-formatter-modal' },
            { icon: 'üîê', name: 'Base64 Encoder', description: 'Encode & decode Base64 data', modalId: 'base64-encoder-modal' },
            { icon: 'üîê', name: 'Hash Generator', description: 'Generate multiple hash types', modalId: 'hash-generator-modal' },
            { icon: 'üåê', name: 'URL Encoder', description: 'Encode & decode URLs', modalId: 'url-encoder-modal' },
            { icon: 'üîç', name: 'Regex Tester', description: 'Test & debug regex patterns', modalId: 'regex-tester-modal' },
            { icon: 'üõ†Ô∏è', name: 'CSS/JS Minifier', description: 'Minify CSS & JavaScript code', modalId: 'css-js-minifier-modal' },
            { icon: 'üé®', name: 'Color Palette', description: 'Generate beautiful color palettes', modalId: 'color-palette-modal' },
            { icon: 'üìù', name: 'Lorem Ipsum', description: 'Generate Lorem Ipsum text', modalId: 'lorem-ipsum-modal' },
            { icon: 'üïê', name: 'Timestamp Converter', description: 'Convert timestamps & dates', modalId: 'timestamp-converter-modal' },
            { icon: 'üîì', name: 'PDF Password Remover', description: 'Remove password from PDFs', modalId: 'pdf-password-remover-modal' },
            { icon: 'üìÑ', name: 'PDF Merger', description: 'Combine multiple PDFs', modalId: 'pdf-merger-modal' },
            { icon: '‚úÇÔ∏è', name: 'PDF Splitter', description: 'Split PDFs into separate pages', modalId: 'pdf-splitter-modal' },
            { icon: 'üîí', name: 'PDF Encryptor', description: 'Add password to PDFs', modalId: 'pdf-encryptor-modal' },
            { icon: 'üñºÔ∏è', name: 'PDF to Images', description: 'Convert PDF pages to images', modalId: 'pdf-to-images-modal' },
            { icon: 'üì∏', name: 'Image to PDF', description: 'Convert images to PDF documents', modalId: 'image-to-pdf-modal' },
            { icon: 'üìè', name: 'Image Compressor', description: 'Reduce image file size', modalId: 'image-compressor-modal' },
            { icon: 'üé®', name: 'Image Converter', description: 'Convert between image formats', modalId: 'image-converter-modal' },
            { icon: 'üìê', name: 'Image Resizer', description: 'Resize images to any dimensions', modalId: 'image-resizer-modal' },
            { icon: '‚úçÔ∏è', name: 'Signature Generator', description: 'Create digital signatures', modalId: 'signature-generator-modal' },
            { icon: 'üìä', name: 'CSV to JSON', description: 'Convert CSV to JSON format', modalId: 'csv-json-converter-modal' },
            { icon: '‚ö°', name: 'Internet Speed Test', description: 'Test your download, upload speed & ping', modalId: 'internet-speed-test-modal', url: '/tools/internet-speed-test.html' }
        ];
        
        let currentToolIndex = -1;
        let refreshInterval = null;
        
        function getRandomTool() {
            let newIndex;
            do {
                newIndex = Math.floor(Math.random() * availableTools.length);
            } while (newIndex === currentToolIndex && availableTools.length > 1);
            currentToolIndex = newIndex;
            return availableTools[newIndex];
        }
        
        function updateToolSuggestion() {
            const tool = getRandomTool();
            const card = document.getElementById('tool-suggestion-card');
            const iconEl = document.getElementById('tool-icon');
            const nameEl = document.getElementById('tool-name');
            const descEl = document.getElementById('tool-description');
            const btnEl = document.getElementById('tool-checkout-btn');
            
            if (!card || !iconEl || !nameEl || !descEl || !btnEl) return;
            
            btnEl.dataset.modalId = tool.modalId || '';
            btnEl.dataset.pageUrl = tool.pageUrl || '';
            card.style.opacity = '0';
            card.style.transform = 'translateY(-10px)';
            
            setTimeout(() => {
                iconEl.textContent = tool.icon;
                nameEl.textContent = tool.name;
                descEl.textContent = tool.description;
                card.style.opacity = '1';
                card.style.transform = 'translateY(0)';
            }, 300);
        }
        
        function launchSuggestedTool() {
            const btnEl = document.getElementById('tool-checkout-btn');
            if (!btnEl) return;
            const modalId = btnEl.dataset.modalId;
            const pageUrl = btnEl.dataset.pageUrl;
            
            if (pageUrl) {
                window.location.href = pageUrl;
            } else if (modalId && typeof openModal === 'function') {
                window.location.href = `/#${modalId}`;
            } else {
                window.location.href = '/#tools';
            }
        }
        
        function initToolSuggestions() {
            updateToolSuggestion();
            refreshInterval = setInterval(() => {
                updateToolSuggestion();
            }, 10000);
        }
        
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(initToolSuggestions, 1000);
        });
        
        window.addEventListener('beforeunload', () => {
            if (refreshInterval) clearInterval(refreshInterval);
        });
    </script>
    
    <style>
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes slideIn {
            from { 
                opacity: 0; 
                transform: translateX(100%); 
            }
            to { 
                opacity: 1; 
                transform: translateX(0); 
            }
        }
        .fade-in { animation: fadeIn 0.5s ease-in-out; }
        .animate-fade-in { animation: fadeIn 0.5s ease-in-out; }
        .animate-slide-in { animation: slideIn 0.3s ease-out; }
        #tool-suggestion-card { transition: opacity 0.3s ease, transform 0.3s ease; }
        
        /* Input focus effects */
        input:focus, select:focus {
            transform: scale(1.01);
            box-shadow: 0 0 0 3px rgba(34, 197, 94, 0.1);
        }
        
        /* Button hover effects */
        button:not(:disabled):hover {
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.2);
        }
    </style>
</body>
</html>


