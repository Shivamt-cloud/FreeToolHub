<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="FreeToolHub - Access 50+ professional free online tools including calculators, PDF tools, image utilities, converters, and more. 100% free, secure, and client-side processing. No downloads or sign-ups required!">
    <meta name="keywords" content="free tools, online calculator, PDF tools, image tools, converters, utilities, free online tools, 50+ tools">
    <title>FreeToolHub - 50+ Free Online Tools | Calculators, PDF & More</title>
    
    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7327960019798694"
     crossorigin="anonymous"></script>
    
    <!-- Automated Ads -->
    <script>
    (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-7327960019798694",
        enable_page_level_ads: true
    });
    </script>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts for Signature Styles -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;700&family=Great+Vibes&family=Allura&family=Pacifico&family=Sacramento&family=Alex+Brush&display=swap" rel="stylesheet">
    
    <!-- PDF.js for PDF decryption -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    
    <!-- PDF-lib for PDF manipulation -->
    <script src="https://unpkg.com/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
    
    <!-- JSZip for creating ZIP files -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    
    <!-- Pyodide for Python-based PDF encryption -->
    <script src="https://cdn.jsdelivr.net/pyodide/v0.24.1/full/pyodide.js"></script>
    
    <style>
        .animation-delay-2000 {
            animation-delay: 2s;
        }
        .animation-delay-4000 {
            animation-delay: 4s;
        }
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }
        .float-animation {
            animation: float 6s ease-in-out infinite;
        }
        .gradient-text {
            background: linear-gradient(45deg, #fbbf24, #f59e0b, #d97706);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        html {
            scroll-behavior: smooth;
        }
        
        /* Heartbeat Animation */
        @keyframes heartbeat {
            0%, 100% { 
                transform: scale(1);
                opacity: 1;
            }
            50% { 
                transform: scale(1.3);
                opacity: 0.8;
            }
        }
        
        /* Coffee Widget Styles */
        .coffee-widget {
            position: fixed;
            right: 0;
            top: 50%;
            transform: translateY(-50%);
            z-index: 999;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .coffee-widget-content {
            background: linear-gradient(135deg, #d4a574 0%, #8b6f47 100%);
            padding: 20px 15px;
            border-radius: 15px 0 0 15px;
            box-shadow: -4px 4px 15px rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s ease;
            animation: coffeePulse 3s ease-in-out infinite;
        }
        
        .coffee-widget:hover .coffee-widget-content {
            transform: translateX(-10px);
            box-shadow: -8px 8px 25px rgba(0, 0, 0, 0.4);
            animation: none;
        }
        
        /* Weather Widget Styles */
        #weather-widget {
            animation: weatherPulse 2s ease-in-out infinite;
            transition: all 0.3s ease;
        }
        
        #weather-widget:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.3);
        }
        
        @keyframes weatherPulse {
            0%, 100% { 
                box-shadow: 0 4px 15px rgba(59, 130, 246, 0.2);
            }
            50% { 
                box-shadow: 0 6px 20px rgba(59, 130, 246, 0.4);
            }
        }
        
        .weather-loading {
            animation: weatherLoading 1.5s ease-in-out infinite;
        }
        
        @keyframes weatherLoading {
            0%, 100% { opacity: 0.6; }
            50% { opacity: 1; }
        }
        
        /* Location Display Animations */
        #weather-location, #mobile-weather-location {
            transition: all 0.3s ease;
        }
        
        .location-slide-in {
            animation: locationSlideIn 0.5s ease-out;
        }
        
        @keyframes locationSlideIn {
            0% {
                opacity: 0;
                transform: translateY(10px);
            }
            100% {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .location-pulse {
            animation: locationPulse 2s ease-in-out infinite;
        }
        
        @keyframes locationPulse {
            0%, 100% { 
                opacity: 0.8;
            }
            50% { 
                opacity: 1;
            }
        }
        
        .coffee-icon {
            font-size: 32px;
            animation: coffeeFloat 2s ease-in-out infinite;
        }
        
        .coffee-text {
            display: flex;
            flex-direction: column;
            color: white;
        }
        
        .coffee-title {
            font-size: 16px;
            font-weight: bold;
            white-space: nowrap;
        }
        
        .coffee-subtitle {
            font-size: 11px;
            opacity: 0.9;
            white-space: nowrap;
        }
        
        /* Coffee Animations */
        @keyframes coffeePulse {
            0%, 100% { 
                transform: scale(1);
            }
            50% { 
                transform: scale(1.05);
            }
        }
        
        @keyframes coffeeFloat {
            0%, 100% { 
                transform: translateY(0px);
            }
            50% { 
                transform: translateY(-5px);
            }
        }
        
        /* Mobile styles - circular button */
        @media (max-width: 768px) {
            .coffee-widget {
                right: 20px;
                bottom: 20px;
                top: auto;
                transform: none;
            }
            
            .coffee-widget-content {
                border-radius: 50%;
                padding: 18px;
                width: 70px;
                height: 70px;
                flex-direction: column;
                gap: 0;
                justify-content: center;
            }
            
            .coffee-icon {
                font-size: 28px;
            }
            
            .coffee-text {
                display: none;
            }
        }
        
        /* Header Animation Styles */
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0.3; }
        }
        
        @keyframes colorCycle {
            0% { color: #fbbf24; } /* Yellow */
            16.66% { color: #ef4444; } /* Red */
            33.33% { color: #8b5cf6; } /* Purple */
            50% { color: #06b6d4; } /* Cyan */
            66.66% { color: #10b981; } /* Green */
            83.33% { color: #f59e0b; } /* Orange */
            100% { color: #fbbf24; } /* Back to Yellow */
        }
        
        .header-animation {
            animation: blink 2s infinite, colorCycle 30s infinite;
            font-weight: bold;
            text-shadow: 0 0 10px currentColor;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
        }

        /* Calculator Button Styles */
        .calc-btn-number {
            @apply bg-white border-2 border-gray-300 text-gray-800 font-semibold py-3 px-4 rounded-lg hover:bg-gray-50 hover:border-blue-400 transition-all duration-200 text-lg;
        }
        .calc-btn-operator {
            @apply bg-blue-500 text-white font-semibold py-3 px-4 rounded-lg hover:bg-blue-600 transition-all duration-200 text-lg;
        }
        .calc-btn-function {
            @apply bg-purple-500 text-white font-semibold py-3 px-4 rounded-lg hover:bg-purple-600 transition-all duration-200 text-sm;
        }
        .calc-btn-equals {
            @apply bg-green-500 text-white font-bold py-3 px-4 rounded-lg hover:bg-green-600 transition-all duration-200 text-xl;
        }
        .calc-btn-clear {
            @apply bg-red-500 text-white font-semibold py-3 px-4 rounded-lg hover:bg-red-600 transition-all duration-200 text-lg;
        }

        /* Tool Search Styles */
        .tool-hidden {
            display: none !important;
            opacity: 0;
            transform: scale(0.95);
        }

        .tool-card {
            transition: all 0.3s ease-in-out;
        }

        .tool-card.tool-visible {
            animation: fadeInScale 0.3s ease-in-out;
        }

        @keyframes fadeInScale {
            from {
                opacity: 0;
                transform: scale(0.95) translateY(10px);
            }
            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        #tool-search-input:focus {
            transform: scale(1.01);
        }

        .search-highlight {
            background-color: #fef3c7;
            padding: 2px 4px;
            border-radius: 4px;
        }

        /* Unified Search Results */
        .tool-section-hidden {
            display: none !important;
        }

        #unified-search-grid .tool-card {
            animation: fadeInUp 0.4s ease-out;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">
    
    <!-- Navigation -->
    <nav class="fixed w-full z-40 bg-white/90 backdrop-blur-lg border-b border-gray-200">
        <div class="max-w-7xl mx-auto px-6 py-4">
            <div class="flex justify-between items-center">
                <div class="text-2xl font-bold">
                    <span class="header-animation">FreeToolHub</span>
                </div>
                <!-- Weather Widget -->
                <div id="weather-widget" class="hidden lg:flex items-center bg-gradient-to-r from-blue-500 to-purple-600 text-white px-4 py-2 rounded-lg shadow-lg mr-4">
                    <div class="flex items-center space-x-3">
                        <div class="text-center">
                            <div id="current-time" class="text-sm font-bold"></div>
                            <div id="current-date" class="text-xs opacity-90"></div>
                        </div>
                        <div class="w-px h-8 bg-white/30"></div>
                        <div class="flex items-center space-x-2">
                            <div id="weather-icon" class="text-2xl">üå§Ô∏è</div>
                            <div>
                                <div id="weather-temp" class="text-sm font-bold">--¬∞C</div>
                                <div id="weather-desc" class="text-xs opacity-90">Loading...</div>
                                <div id="weather-location" class="text-xs opacity-80 flex items-center mt-1">
                                    <span class="mr-1">üìç</span>
                                    <span id="location-name">Getting location...</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Desktop Navigation -->
                <div class="hidden lg:flex space-x-6">
                    <a href="#home" class="text-gray-700 hover:text-purple-600 transition-colors font-medium">Home</a>
                    <a href="javascript:void(0)" onclick="openModal('calculator-modal')" class="text-gray-700 hover:text-purple-600 transition-colors font-medium cursor-pointer">Calculators</a>
                    <a href="javascript:void(0)" onclick="openModal('loan-calculator-modal')" class="text-gray-700 hover:text-purple-600 transition-colors font-medium cursor-pointer">Loan Calculator</a>
                    <a href="#pdf-tools" class="text-gray-700 hover:text-purple-600 transition-colors font-medium relative">
                        PDF Tools
                        <span class="absolute -top-2 -right-3 bg-gradient-to-r from-purple-500 to-pink-500 text-white text-xs px-2 py-0.5 rounded-full font-bold">NEW</span>
                    </a>
                    <a href="#image-tools" class="text-gray-700 hover:text-purple-600 transition-colors font-medium relative">
                        Image Tools
                        <span class="absolute -top-2 -right-3 bg-gradient-to-r from-purple-500 to-pink-500 text-white text-xs px-2 py-0.5 rounded-full font-bold">NEW</span>
                    </a>
                    <a href="#utilities" class="text-gray-700 hover:text-purple-600 transition-colors font-medium relative">
                        Utilities
                        <span class="absolute -top-2 -right-3 bg-gradient-to-r from-purple-500 to-pink-500 text-white text-xs px-2 py-0.5 rounded-full font-bold">NEW</span>
                    </a>
                    <a href="#about" class="text-gray-700 hover:text-purple-600 transition-colors font-medium">About</a>
                    <a href="#contact" class="text-gray-700 hover:text-purple-600 transition-colors font-medium">Contact</a>
                </div>
                <!-- Mobile Menu Button -->
                <button onclick="toggleMobileMenu()" class="lg:hidden text-gray-700 hover:text-purple-600 focus:outline-none">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                    </svg>
                </button>
            </div>
            <!-- Mobile Navigation Menu -->
            <div id="mobile-menu" class="hidden lg:hidden mt-4 pb-4 space-y-2">
                <!-- Mobile Weather Widget -->
                <div id="mobile-weather-widget" class="bg-gradient-to-r from-blue-500 to-purple-600 text-white p-3 rounded-lg mb-4">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-3">
                            <div class="text-center">
                                <div id="mobile-current-time" class="text-sm font-bold"></div>
                                <div id="mobile-current-date" class="text-xs opacity-90"></div>
                            </div>
                            <div class="w-px h-6 bg-white/30"></div>
                            <div class="flex items-center space-x-2">
                                <div id="mobile-weather-icon" class="text-xl">üå§Ô∏è</div>
                                <div>
                                    <div id="mobile-weather-temp" class="text-sm font-bold">--¬∞C</div>
                                    <div id="mobile-weather-desc" class="text-xs opacity-90">Loading...</div>
                                    <div id="mobile-weather-location" class="text-xs opacity-80 flex items-center mt-1">
                                        <span class="mr-1">üìç</span>
                                        <span id="mobile-location-name">Getting location...</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <a href="#home" onclick="toggleMobileMenu()" class="block text-gray-700 hover:text-purple-600 transition-colors font-medium py-2">Home</a>
                <a href="javascript:void(0)" onclick="openModal('calculator-modal'); toggleMobileMenu();" class="block text-gray-700 hover:text-purple-600 transition-colors font-medium py-2 cursor-pointer">Calculators</a>
                <a href="javascript:void(0)" onclick="openModal('loan-calculator-modal'); toggleMobileMenu();" class="block text-gray-700 hover:text-purple-600 transition-colors font-medium py-2 cursor-pointer">Loan Calculator</a>
                <a href="#pdf-tools" onclick="toggleMobileMenu()" class="block text-gray-700 hover:text-purple-600 transition-colors font-medium py-2">
                    PDF Tools <span class="bg-gradient-to-r from-purple-500 to-pink-500 text-white text-xs px-2 py-0.5 rounded-full font-bold ml-2">NEW</span>
                </a>
                <a href="#image-tools" onclick="toggleMobileMenu()" class="block text-gray-700 hover:text-purple-600 transition-colors font-medium py-2">
                    Image Tools <span class="bg-gradient-to-r from-purple-500 to-pink-500 text-white text-xs px-2 py-0.5 rounded-full font-bold ml-2">NEW</span>
                </a>
                <a href="#utilities" onclick="toggleMobileMenu()" class="block text-gray-700 hover:text-purple-600 transition-colors font-medium py-2">
                    Utilities <span class="bg-gradient-to-r from-purple-500 to-pink-500 text-white text-xs px-2 py-0.5 rounded-full font-bold ml-2">NEW</span>
                </a>
                <a href="#about" onclick="toggleMobileMenu()" class="block text-gray-700 hover:text-purple-600 transition-colors font-medium py-2">About</a>
                <a href="#contact" onclick="toggleMobileMenu()" class="block text-gray-700 hover:text-purple-600 transition-colors font-medium py-2">Contact</a>
            </div>
        </div>
    </nav>

    <!-- Congratulations Popup for New Tools -->
    <div id="congrats-popup" class="hidden fixed inset-0 z-50 flex items-center justify-center p-4" style="background-color: rgba(0, 0, 0, 0.6); backdrop-filter: blur(4px);">
        <div class="bg-white rounded-2xl shadow-2xl max-w-md w-full transform transition-all duration-300 scale-95 opacity-0" id="congrats-popup-content">
            <!-- Close Button -->
            <button onclick="closeCongratsPopup()" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600 transition-colors z-10">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
            </button>

            <!-- Popup Content -->
            <div class="p-8 text-center">
                <!-- Celebration Icon -->
                <div class="mb-4">
                    <div class="inline-flex items-center justify-center w-20 h-20 bg-gradient-to-br from-purple-500 to-pink-500 rounded-full animate-bounce">
                        <span class="text-4xl">üéâ</span>
                    </div>
                </div>

                <!-- Title -->
                <h3 class="text-3xl font-bold text-gray-800 mb-2">
                    Discover Amazing Tools!
                </h3>
                <p class="text-lg text-gray-600 mb-6">
                    Explore our collection of 50+ professional tools
                </p>

                <!-- Featured Tool (Dynamic) -->
                <div id="featured-tool-content" class="bg-gradient-to-br from-blue-50 to-purple-50 rounded-xl p-6 mb-6 border-2 border-purple-200">
                    <!-- Will be populated by JavaScript -->
                </div>

                <!-- CTA Button -->
                <button onclick="openFeaturedTool()" class="bg-gradient-to-r from-purple-600 to-pink-600 text-white font-bold py-3 px-8 rounded-xl hover:from-purple-700 hover:to-pink-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                    Check it out! ‚Üí
                </button>

                <!-- Auto-close indicator -->
                <p class="text-xs text-gray-400 mt-4">
                    Auto-closing in <span id="popup-countdown">7</span>s...
                </p>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <main class="pt-20">
    
    <!-- 50+ Tools Milestone Banner -->
    <div id="milestone-banner" class="fixed top-[73px] left-0 right-0 z-[60] bg-gradient-to-r from-yellow-400 via-pink-500 to-purple-600 text-white py-3 px-4 shadow-lg transform transition-transform duration-500">
        <div class="max-w-7xl mx-auto flex items-center justify-between">
            <div class="flex items-center gap-3 flex-1">
                <span class="text-2xl animate-bounce">üéâ</span>
                <p class="text-sm md:text-base font-semibold">
                    <span class="hidden sm:inline">MILESTONE ACHIEVED! </span>
                    <span class="font-bold">50+ Professional Tools Now Available!</span>
                    <span class="hidden md:inline"> üéä All free, secure, and client-side!</span>
                </p>
                <span class="text-2xl animate-bounce animation-delay-2000">‚ú®</span>
            </div>
            <button onclick="dismissMilestoneBanner()" class="ml-4 text-white hover:text-yellow-200 transition-colors flex-shrink-0">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
            </button>
        </div>
    </div>
    
    <!-- Hero Section -->
        <section id="home" class="min-h-screen flex items-center justify-center bg-gradient-to-br from-purple-600 via-blue-600 to-indigo-700 relative overflow-hidden">
            <!-- Background Animation Elements -->
            <div class="absolute inset-0 overflow-hidden">
                <div class="absolute -top-40 -right-40 w-80 h-80 bg-yellow-300 rounded-full mix-blend-multiply filter blur-xl opacity-20 animate-pulse"></div>
                <div class="absolute -bottom-40 -left-40 w-80 h-80 bg-pink-300 rounded-full mix-blend-multiply filter blur-xl opacity-20 animate-pulse animation-delay-2000"></div>
                <div class="absolute top-40 left-1/2 w-80 h-80 bg-blue-300 rounded-full mix-blend-multiply filter blur-xl opacity-20 animate-pulse animation-delay-4000"></div>
            </div>
            
            <div class="text-center text-white px-6 relative z-10">
                <div class="mb-6">
                    <span class="inline-block bg-gradient-to-r from-yellow-400 to-orange-500 text-white px-6 py-3 rounded-full text-base md:text-lg font-bold mb-4 shadow-lg animate-pulse">
                        üéä 50+ PROFESSIONAL TOOLS üéä
                    </span>
                </div>
                
                <h1 class="text-5xl md:text-7xl font-bold mb-6 leading-tight">
                    Welcome to <span class="header-animation text-6xl md:text-8xl">FreeToolHub</span>
                </h1>
                
                <h2 class="text-2xl md:text-3xl font-semibold mb-8 text-yellow-100">
                    Your Complete Free Tool Hub ‚Äì 50+ Tools & Growing!
                </h2>
                
                <p class="text-lg md:text-xl mb-8 max-w-4xl mx-auto leading-relaxed text-blue-100">
                    Transform your productivity with our powerful suite of free tools. From advanced calculations to essential utilities, we've crafted intuitive solutions that work seamlessly across all devices. <span class="text-yellow-300 font-semibold">No downloads, no sign-ups ‚Äì just pure functionality at your fingertips.</span>
                </p>

                <!-- Stats Counter -->
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 max-w-4xl mx-auto mb-8">
                    <div class="bg-white bg-opacity-20 backdrop-blur-sm rounded-xl p-4 transform hover:scale-105 transition-all duration-300">
                        <div class="text-3xl md:text-4xl font-bold text-yellow-300 mb-1">50+</div>
                        <div class="text-sm md:text-base text-blue-100">Free Tools</div>
                    </div>
                    <div class="bg-white bg-opacity-20 backdrop-blur-sm rounded-xl p-4 transform hover:scale-105 transition-all duration-300">
                        <div class="text-3xl md:text-4xl font-bold text-yellow-300 mb-1">100%</div>
                        <div class="text-sm md:text-base text-blue-100">Free Forever</div>
                    </div>
                    <div class="bg-white bg-opacity-20 backdrop-blur-sm rounded-xl p-4 transform hover:scale-105 transition-all duration-300">
                        <div class="text-3xl md:text-4xl font-bold text-yellow-300 mb-1">üîí</div>
                        <div class="text-sm md:text-base text-blue-100">Client-Side</div>
                    </div>
                    <div class="bg-white bg-opacity-20 backdrop-blur-sm rounded-xl p-4 transform hover:scale-105 transition-all duration-300">
                        <div class="text-3xl md:text-4xl font-bold text-yellow-300 mb-1">‚ö°</div>
                        <div class="text-sm md:text-base text-blue-100">Lightning Fast</div>
                    </div>
                </div>
                
                <div class="flex flex-col sm:flex-row gap-4 justify-center items-center mb-12">
                    <a href="#tools" class="bg-yellow-400 text-purple-900 px-8 py-4 rounded-lg text-lg font-semibold hover:bg-yellow-300 transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl">
                        üöÄ Explore Tools
                    </a>
                    <a href="#about" class="border-2 border-yellow-400 text-yellow-400 px-8 py-4 rounded-lg text-lg font-semibold hover:bg-yellow-400 hover:text-purple-900 transition-all duration-300 transform hover:scale-105">
                        üìñ Learn More
                    </a>
            </div>
        </div>
    </section>

        <!-- Tools Section - Clean Structure with Categories -->
        <section id="tools" class="py-20 bg-gray-50">
            <div class="max-w-7xl mx-auto px-6">
            <div class="text-center mb-16">
                    <h2 class="text-4xl md:text-5xl font-bold mb-4 text-gray-800">üõ†Ô∏è Our <span class="text-purple-600">Smart Tools</span> <span class="text-orange-600 text-3xl md:text-4xl">(50+)</span></h2>
                    <p class="text-xl text-gray-600 max-w-3xl mx-auto">
                        Professional-grade tools organized by category for students, professionals, and developers
                    </p>
                </div>

                <!-- Search Bar -->
                <div class="max-w-2xl mx-auto mb-8">
                    <div class="relative">
                        <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                            <svg class="h-6 w-6 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                            </svg>
                        </div>
                        <input 
                            type="text" 
                            id="tool-search-input" 
                            placeholder="üîç Search from 50+ professional tools... (e.g., calculator, pdf, converter)" 
                            class="w-full pl-12 pr-12 py-4 text-lg border-2 border-gray-300 rounded-xl focus:ring-4 focus:ring-purple-200 focus:border-purple-500 transition-all duration-300 shadow-lg hover:shadow-xl"
                            autocomplete="off"
                        >
                        <button 
                            id="clear-search-btn" 
                            onclick="clearToolSearch()" 
                            class="absolute inset-y-0 right-0 pr-4 flex items-center text-gray-400 hover:text-gray-600 transition-colors hidden"
                        >
                            <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                    
                    <!-- Search Helper Text -->
                    <div id="search-helper-text" class="text-center mt-3 text-sm text-gray-500">
                        üí° Try: "calculator", "pdf", "converter", "image", "age", "json", etc.
                    </div>
                    
                    <!-- Search Results Counter -->
                    <div id="search-results-counter" class="text-center mt-3 text-sm font-semibold text-purple-600 hidden">
                        <!-- Will show: "Showing X of Y tools" -->
                    </div>
                    
                    <!-- No Results Message -->
                    <div id="no-results-message" class="hidden mt-6 text-center">
                        <div class="inline-block bg-yellow-50 border-2 border-yellow-200 rounded-xl p-6 max-w-md">
                            <div class="text-4xl mb-3">üòï</div>
                            <p class="text-lg font-semibold text-gray-800 mb-2">No tools found</p>
                            <p class="text-gray-600 mb-4">Try searching for something else</p>
                            <div class="text-left text-sm text-gray-600">
                                <p class="font-semibold mb-2">üí° Popular searches:</p>
                                <div class="flex flex-wrap gap-2">
                                    <span class="bg-white px-3 py-1 rounded-full border border-gray-300">calculator</span>
                                    <span class="bg-white px-3 py-1 rounded-full border border-gray-300">pdf</span>
                                    <span class="bg-white px-3 py-1 rounded-full border border-gray-300">converter</span>
                                    <span class="bg-white px-3 py-1 rounded-full border border-gray-300">image</span>
                                    <span class="bg-white px-3 py-1 rounded-full border border-gray-300">age</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Filter Buttons -->
                <div class="flex flex-wrap justify-center gap-4 mb-16">
                    <button onclick="filterTools('all', this)" class="filter-btn active bg-gradient-to-r from-gray-600 to-gray-700 text-white px-6 py-3 rounded-full font-semibold hover:from-gray-700 hover:to-gray-800 transition-all duration-300 transform hover:scale-105 shadow-lg">
                        üåü All Tools
                    </button>
                    <button onclick="filterTools('student', this)" class="filter-btn bg-gradient-to-r from-blue-500 to-blue-600 text-white px-6 py-3 rounded-full font-semibold hover:from-blue-600 hover:to-blue-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                        üéì For Students
                    </button>
                    <button onclick="filterTools('professional', this)" class="filter-btn bg-gradient-to-r from-green-500 to-green-600 text-white px-6 py-3 rounded-full font-semibold hover:from-green-600 hover:to-green-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                        üíº For Professionals
                    </button>
                    <button onclick="filterTools('developer', this)" class="filter-btn bg-gradient-to-r from-purple-500 to-purple-600 text-white px-6 py-3 rounded-full font-semibold hover:from-purple-600 hover:to-purple-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                        üë®‚Äçüíª For Developers
                    </button>
                </div>

                <!-- Unified Search Results Section (Hidden by default) -->
                <div id="unified-search-results" class="hidden mb-16">
                    <div class="text-center mb-8">
                        <h3 class="text-3xl font-bold text-purple-600 mb-2">üîç Search Results</h3>
                        <p class="text-gray-600" id="unified-search-subtitle">Found matching tools</p>
                    </div>
                    <div id="unified-search-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 max-w-6xl mx-auto">
                        <!-- Matching tools will appear here dynamically -->
                    </div>
                </div>

                <!-- Student Tools Category -->
                <div class="mb-16 tool-section">
                    <h3 class="text-3xl font-bold text-center mb-8 text-blue-600">üéì For Students</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 max-w-6xl mx-auto" id="student-tools">
                        
                        <!-- Smart Calculator Tool -->
                        <div class="tool-card student bg-white rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 border border-gray-100 overflow-hidden">
                            <div class="bg-gradient-to-r from-blue-500 to-purple-600 p-6 text-white">
                                <div class="text-4xl mb-4">üßÆ</div>
                                <h4 class="text-2xl font-bold mb-2">Smart Calculator</h4>
                                <p class="text-blue-100">Advanced calculator with scientific functions, variables, and expression evaluation</p>
                            </div>
                            <div class="p-6">
                                <div class="space-y-3 mb-6">
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Scientific Functions</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Variables & Memory</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Expression Parser</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>History & Export</span>
                                    </div>
                                </div>
                                <button onclick="openModal('calculator-modal')" class="w-full bg-gradient-to-r from-blue-500 to-purple-600 text-white font-bold py-3 px-6 rounded-xl hover:from-blue-600 hover:to-purple-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                    Launch Calculator
                                </button>
                            </div>
                        </div>

                        <!-- Study Timer & Pomodoro -->
                        <div class="tool-card student bg-white rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 border border-gray-100 overflow-hidden">
                            <div class="bg-gradient-to-r from-orange-500 to-red-600 p-6 text-white">
                                <div class="text-4xl mb-4">‚è∞</div>
                                <h4 class="text-2xl font-bold mb-2">Study Timer & Pomodoro</h4>
                                <p class="text-orange-100">Advanced study timer with Pomodoro technique, focus sessions, and productivity analytics</p>
                            </div>
                            <div class="p-6">
                                <div class="space-y-3 mb-6">
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Pomodoro Technique</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Focus Modes</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Session Tracking</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Productivity Analytics</span>
                                    </div>
                                </div>
                                <button onclick="openModal('study-timer-modal')" class="w-full bg-gradient-to-r from-orange-500 to-red-600 text-white font-bold py-3 px-6 rounded-xl hover:from-orange-600 hover:to-red-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                    Launch Study Timer
                                </button>
                            </div>
                        </div>

                        <!-- Note-Taking & Summarizer -->
                        <div class="tool-card student bg-white rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 border border-gray-100 overflow-hidden">
                            <div class="bg-gradient-to-r from-blue-500 to-indigo-600 p-6 text-white">
                                <div class="text-4xl mb-4">üìù</div>
                                <h4 class="text-2xl font-bold mb-2">Note-Taking & Summarizer</h4>
                                <p class="text-blue-100">Advanced text summarization, key points extraction, and intelligent note organization</p>
                            </div>
                            <div class="p-6">
                                <div class="space-y-3 mb-6">
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Text Summarization</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Key Points Extraction</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Text Analysis</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Structured Notes</span>
                                    </div>
                                </div>
                                <button onclick="openModal('note-taker-modal')" class="w-full bg-gradient-to-r from-blue-500 to-indigo-600 text-white font-bold py-3 px-6 rounded-xl hover:from-blue-600 hover:to-indigo-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                    Launch Note-Taker
                                </button>
                            </div>
                        </div>

                        <!-- Math Problem Solver -->
                        <div class="tool-card student bg-white rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 border border-gray-100 overflow-hidden">
                            <div class="bg-gradient-to-r from-green-500 to-teal-600 p-6 text-white">
                                <div class="text-4xl mb-4">üßÆ</div>
                                <h4 class="text-2xl font-bold mb-2">Math Problem Solver</h4>
                                <p class="text-green-100">Advanced mathematical problem solver with step-by-step solutions and graphing capabilities</p>
                            </div>
                            <div class="p-6">
                                <div class="space-y-3 mb-6">
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Step-by-Step Solutions</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Multiple Math Categories</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Graphing & Visualization</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Problem Recognition</span>
                                    </div>
                                </div>
                                <button onclick="openModal('math-solver-modal')" class="w-full bg-gradient-to-r from-green-500 to-teal-600 text-white font-bold py-3 px-6 rounded-xl hover:from-green-600 hover:to-teal-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                    Launch Math Solver
                                </button>
                            </div>
                        </div>

                        <!-- Grade Calculator -->
                        <div class="tool-card student bg-white rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 border border-gray-100 overflow-hidden">
                            <div class="bg-gradient-to-r from-purple-500 to-pink-600 p-6 text-white">
                                <div class="text-4xl mb-4">üìä</div>
                                <h4 class="text-2xl font-bold mb-2">Grade Calculator</h4>
                                <p class="text-purple-100">Advanced grade calculation, GPA tracking, and academic performance analysis</p>
                            </div>
                            <div class="p-6">
                                <div class="space-y-3 mb-6">
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>GPA Calculation</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Grade Tracking</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Weighted Grades</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Academic Analytics</span>
                                    </div>
                                </div>
                                <button onclick="openModal('grade-calculator-modal')" class="w-full bg-gradient-to-r from-purple-500 to-pink-600 text-white font-bold py-3 px-6 rounded-xl hover:from-purple-600 hover:to-pink-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                    Launch Grade Calculator
                                </button>
                            </div>
                        </div>

                        <!-- Citation Generator -->
                        <div class="tool-card student bg-white rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 border border-gray-100 overflow-hidden">
                            <div class="bg-gradient-to-r from-indigo-500 to-blue-600 p-6 text-white">
                                <div class="text-4xl mb-4">üìñ</div>
                                <h4 class="text-2xl font-bold mb-2">Citation Generator</h4>
                                <p class="text-indigo-100">Advanced citation generation for multiple formats and source types</p>
                            </div>
                            <div class="p-6">
                                <div class="space-y-3 mb-6">
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Multiple Formats</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Source Types</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Auto-Formatting</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Export Options</span>
                                    </div>
                                </div>
                                <button onclick="openModal('citation-generator-modal')" class="w-full bg-gradient-to-r from-indigo-500 to-blue-600 text-white font-bold py-3 px-6 rounded-xl hover:from-indigo-600 hover:to-blue-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                    Launch Citation Generator
                                </button>
                            </div>
                        </div>

                        <!-- Study Planner & Schedule -->
                        <div class="tool-card student bg-white rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 border border-gray-100 overflow-hidden">
                            <div class="bg-gradient-to-r from-emerald-500 to-cyan-600 p-6 text-white">
                                <div class="text-4xl mb-4">üéØ</div>
                                <h4 class="text-2xl font-bold mb-2">Study Planner & Schedule</h4>
                                <p class="text-emerald-100">Advanced study planning, scheduling, and time management for students</p>
                            </div>
                            <div class="p-6">
                                <div class="space-y-3 mb-6">
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Study Scheduling</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Time Management</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Goal Tracking</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Progress Analytics</span>
                                    </div>
                                </div>
                                <button onclick="openModal('study-planner-modal')" class="w-full bg-gradient-to-r from-emerald-500 to-cyan-600 text-white font-bold py-3 px-6 rounded-xl hover:from-emerald-600 hover:to-cyan-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                    Launch Study Planner
                                </button>
                            </div>
                        </div>

                        <!-- Flashcard Generator -->
                        <div class="tool-card student bg-white rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 border border-gray-100 overflow-hidden">
                            <div class="bg-gradient-to-r from-amber-500 to-orange-600 p-6 text-white">
                                <div class="text-4xl mb-4">üìö</div>
                                <h4 class="text-2xl font-bold mb-2">Flashcard Generator</h4>
                                <p class="text-amber-100">Advanced flashcard creation, study modes, and spaced repetition for effective learning</p>
                            </div>
                            <div class="p-6">
                                <div class="space-y-3 mb-6">
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Multiple Card Types</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Spaced Repetition</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Study Modes</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Progress Tracking</span>
                                    </div>
                                </div>
                                <button onclick="openModal('flashcard-generator-modal')" class="w-full bg-gradient-to-r from-amber-500 to-orange-600 text-white font-bold py-3 px-6 rounded-xl hover:from-amber-600 hover:to-orange-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                    Launch Flashcard Generator
                                </button>
                            </div>
                        </div>

                        <!-- Progress Tracker & Analytics -->
                        <div class="tool-card student bg-white rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 border border-gray-100 overflow-hidden">
                            <div class="bg-gradient-to-r from-violet-500 to-purple-600 p-6 text-white">
                                <div class="text-4xl mb-4">üìà</div>
                                <h4 class="text-2xl font-bold mb-2">Progress Tracker & Analytics</h4>
                                <p class="text-violet-100">Comprehensive academic progress tracking, performance analytics, and study insights</p>
                            </div>
                            <div class="p-6">
                                <div class="space-y-3 mb-6">
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Academic Progress</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Performance Analytics</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Study Insights</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Goal Tracking</span>
                                    </div>
                                </div>
                                <button onclick="openModal('progress-tracker-modal')" class="w-full bg-gradient-to-r from-violet-500 to-purple-600 text-white font-bold py-3 px-6 rounded-xl hover:from-violet-600 hover:to-purple-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                    Launch Progress Tracker
                                </button>
                            </div>
                        </div>

                <!-- Age Calculator -->
                <div class="tool-card student bg-white rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 border border-gray-100 overflow-hidden">
                    <div class="bg-gradient-to-r from-pink-500 to-rose-600 p-6 text-white">
                        <div class="text-4xl mb-4">üéÇ</div>
                        <h4 class="text-2xl font-bold mb-2">Age Calculator</h4>
                        <p class="text-pink-100">Advanced age calculation, date analysis, and time-related calculations for students</p>
                    </div>
                    <div class="p-6">
                        <div class="space-y-3 mb-6">
                            <div class="flex items-center text-gray-600">
                                <span class="text-green-500 mr-2">‚úì</span>
                                <span>Precise Age Calculation</span>
                            </div>
                            <div class="flex items-center text-gray-600">
                                <span class="text-green-500 mr-2">‚úì</span>
                                <span>Date Analysis</span>
                            </div>
                            <div class="flex items-center text-gray-600">
                                <span class="text-green-500 mr-2">‚úì</span>
                                <span>Zodiac Signs</span>
                            </div>
                            <div class="flex items-center text-gray-600">
                                <span class="text-green-500 mr-2">‚úì</span>
                                <span>Life Stages</span>
                            </div>
                        </div>
                        <button onclick="openModal('age-calculator-modal')" class="w-full bg-gradient-to-r from-pink-500 to-rose-600 text-white font-bold py-3 px-6 rounded-xl hover:from-pink-600 hover:to-rose-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                            Launch Age Calculator
                        </button>
                    </div>
                </div>

                <!-- BMI Calculator -->
                <div class="tool-card student bg-white rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 border border-gray-100 overflow-hidden">
                    <div class="bg-gradient-to-r from-emerald-500 to-teal-600 p-6 text-white">
                        <div class="text-4xl mb-4">üè•</div>
                        <h4 class="text-2xl font-bold mb-2">BMI Calculator</h4>
                        <p class="text-emerald-100">Comprehensive BMI calculation, health analysis, and personalized recommendations for students</p>
                    </div>
                    <div class="p-6">
                        <div class="space-y-3 mb-6">
                            <div class="flex items-center text-gray-600">
                                <span class="text-green-500 mr-2">‚úì</span>
                                <span>BMI Calculation</span>
                            </div>
                            <div class="flex items-center text-gray-600">
                                <span class="text-green-500 mr-2">‚úì</span>
                                <span>Health Analysis</span>
                            </div>
                            <div class="flex items-center text-gray-600">
                                <span class="text-green-500 mr-2">‚úì</span>
                                <span>Body Fat Estimate</span>
                            </div>
                            <div class="flex items-center text-gray-600">
                                <span class="text-green-500 mr-2">‚úì</span>
                                <span>Personalized Recommendations</span>
                            </div>
                        </div>
                        <button onclick="showBMITemporarilyUnavailable()" class="w-full bg-gradient-to-r from-emerald-500 to-teal-600 text-white font-bold py-3 px-6 rounded-xl hover:from-emerald-600 hover:to-teal-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                            Launch BMI Calculator
                        </button>
                    </div>
                </div>

                    </div>
                </div>

                <!-- Professional Tools Category -->
                <div class="mb-16 tool-section">
                    <h3 class="text-3xl font-bold text-center mb-8 text-green-600">üíº For Professionals</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 max-w-6xl mx-auto" id="professional-tools">
                        
                        <!-- Professional Loan Calculator Tool -->
                        <div class="tool-card professional bg-white rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 border border-gray-100 overflow-hidden">
                            <div class="bg-gradient-to-r from-green-500 to-emerald-600 p-6 text-white">
                                <div class="text-4xl mb-4">üè¶</div>
                                <h4 class="text-2xl font-bold mb-2">Professional Loan Calculator</h4>
                                <p class="text-green-100">Calculate loan payments, amortization schedules, and loan analysis</p>
                            </div>
                            <div class="p-6">
                                <div class="space-y-3 mb-6">
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Monthly Payment Calculator</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Amortization Schedule</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Extra Payment Analysis</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Loan Comparison Tool</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Refinancing Calculator</span>
                                    </div>
                                </div>
                                <button onclick="openModal('loan-calculator-modal')" class="w-full bg-gradient-to-r from-green-500 to-emerald-600 text-white font-bold py-3 px-6 rounded-xl hover:from-green-600 hover:to-emerald-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                    Launch Loan Calculator
                                </button>
                            </div>
                        </div>

                        <!-- Professional Investment Calculator Tool -->
                        <div class="tool-card professional bg-white rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 border border-gray-100 overflow-hidden">
                            <div class="bg-gradient-to-r from-blue-500 to-indigo-600 p-6 text-white">
                                <div class="text-4xl mb-4">üìà</div>
                                <h4 class="text-2xl font-bold mb-2">Investment Calculator</h4>
                                <p class="text-blue-100">Calculate investment returns, compound interest, and retirement planning</p>
                            </div>
                            <div class="p-6">
                                <div class="space-y-3 mb-6">
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Compound Interest Calculator</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Retirement Planning</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Investment Scenarios</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Dollar-Cost Averaging</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Inflation-Adjusted Returns</span>
                                    </div>
                                </div>
                                <button onclick="openModal('investment-calculator-modal')" class="w-full bg-gradient-to-r from-blue-500 to-indigo-600 text-white font-bold py-3 px-6 rounded-xl hover:from-blue-600 hover:to-indigo-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                    Launch Investment Calculator
                                </button>
                            </div>
                        </div>

                        <!-- Professional Tax Calculator Tool -->
                        <div class="tool-card professional bg-white rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 border border-gray-100 overflow-hidden">
                            <div class="bg-gradient-to-r from-purple-500 to-pink-600 p-6 text-white">
                                <div class="text-4xl mb-4">üßæ</div>
                                <h4 class="text-2xl font-bold mb-2">Tax Calculator</h4>
                                <p class="text-purple-100">Calculate income tax for multiple countries with progressive tax brackets</p>
                            </div>
                            <div class="p-6">
                                <div class="space-y-3 mb-6">
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Multi-Country Tax Brackets</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Progressive Tax Calculation</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Tax Scenario Comparison</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Deduction Analysis</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Take-Home Pay Calculator</span>
                                    </div>
                                </div>
                                <button onclick="openModal('tax-calculator-modal')" class="w-full bg-gradient-to-r from-purple-500 to-pink-600 text-white font-bold py-3 px-6 rounded-xl hover:from-purple-600 hover:to-pink-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                    Launch Tax Calculator
                                </button>
                            </div>
                        </div>

                        <!-- Professional Business Metrics Calculator Tool -->
                        <div class="tool-card professional bg-white rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 border border-gray-100 overflow-hidden">
                            <div class="bg-gradient-to-r from-orange-500 to-red-600 p-6 text-white">
                                <div class="text-4xl mb-4">üìä</div>
                                <h4 class="text-2xl font-bold mb-2">Business Metrics Calculator</h4>
                                <p class="text-orange-100">Calculate business performance metrics, profitability, and financial ratios</p>
                            </div>
                            <div class="p-6">
                                <div class="space-y-3 mb-6">
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Profit Margin Analysis</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Break-Even Analysis</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>ROI & ROE Calculations</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Customer Metrics (CLV/CAC)</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Financial Ratios</span>
                                    </div>
                                </div>
                                <button onclick="openModal('business-metrics-modal')" class="w-full bg-gradient-to-r from-orange-500 to-red-600 text-white font-bold py-3 px-6 rounded-xl hover:from-orange-600 hover:to-red-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                    Launch Business Metrics
                                </button>
                            </div>
                        </div>

                        <!-- Professional Currency Converter Tool -->
                        <div class="tool-card professional bg-white rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 border border-gray-100 overflow-hidden">
                            <div class="bg-gradient-to-r from-cyan-500 to-teal-600 p-6 text-white">
                                <div class="text-4xl mb-4">üí±</div>
                                <h4 class="text-2xl font-bold mb-2">Currency Converter</h4>
                                <p class="text-cyan-100">Convert between 20+ currencies with real-time exchange rates</p>
                            </div>
                            <div class="p-6">
                                <div class="space-y-3 mb-6">
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>20+ World Currencies</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Real-time Exchange Rates</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Travel Expense Calculator</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Conversion with Fees</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Historical Conversions</span>
                                    </div>
                                </div>
                                <button onclick="openModal('currency-converter-modal')" class="w-full bg-gradient-to-r from-cyan-500 to-teal-600 text-white font-bold py-3 px-6 rounded-xl hover:from-cyan-600 hover:to-teal-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                    Launch Currency Converter
                                </button>
                            </div>
                        </div>

                        <!-- Professional Retirement Planning Calculator Tool -->
                        <div class="tool-card professional bg-white rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 border border-gray-100 overflow-hidden">
                            <div class="bg-gradient-to-r from-purple-500 to-indigo-600 p-6 text-white">
                                <div class="text-4xl mb-4">üè¶</div>
                                <h4 class="text-2xl font-bold mb-2">Retirement Planning Calculator</h4>
                                <p class="text-purple-100">Plan your retirement with comprehensive savings and income analysis</p>
                            </div>
                            <div class="p-6">
                                <div class="space-y-3 mb-6">
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Retirement Savings Goal</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>401k/IRA Contribution Limits</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Social Security Benefits</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Retirement Readiness Score</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Income Scenarios</span>
                                    </div>
                                </div>
                                <button onclick="openModal('retirement-calculator-modal')" class="w-full bg-gradient-to-r from-purple-500 to-indigo-600 text-white font-bold py-3 px-6 rounded-xl hover:from-purple-600 hover:to-indigo-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                    Launch Retirement Planner
                                </button>
                            </div>
                        </div>

                        <!-- Professional Mortgage Calculator Tool -->
                        <div class="tool-card professional bg-white rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 border border-gray-100 overflow-hidden">
                            <div class="bg-gradient-to-r from-green-500 to-emerald-600 p-6 text-white">
                                <div class="text-4xl mb-4">üè†</div>
                                <h4 class="text-2xl font-bold mb-2">Mortgage Calculator</h4>
                                <p class="text-green-100">Calculate mortgage payments, amortization, and refinancing scenarios</p>
                            </div>
                            <div class="p-6">
                                <div class="space-y-3 mb-6">
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Mortgage Payment Calculator</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Amortization Schedule</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Refinancing Analysis</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Affordability Calculator</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Bi-Weekly Payments</span>
                                    </div>
                                </div>
                                <button onclick="openModal('mortgage-calculator-modal')" class="w-full bg-gradient-to-r from-green-500 to-emerald-600 text-white font-bold py-3 px-6 rounded-xl hover:from-green-600 hover:to-emerald-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                    Launch Mortgage Calculator
                                </button>
                            </div>
                        </div>

                        <!-- Professional Budget Planner Tool -->
                        <div class="tool-card professional bg-white rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 border border-gray-100 overflow-hidden">
                            <div class="bg-gradient-to-r from-pink-500 to-rose-600 p-6 text-white">
                                <div class="text-4xl mb-4">üìä</div>
                                <h4 class="text-2xl font-bold mb-2">Budget Planner</h4>
                                <p class="text-pink-100">Create and manage personal and business budgets with detailed analysis</p>
                            </div>
                            <div class="p-6">
                                <div class="space-y-3 mb-6">
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Personal Budget Planning</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>50/30/20 Budget Rule</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Emergency Fund Calculator</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Debt Payoff Strategies</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Business Budget Analysis</span>
                                    </div>
                                </div>
                                <button onclick="openModal('budget-planner-modal')" class="w-full bg-gradient-to-r from-pink-500 to-rose-600 text-white font-bold py-3 px-6 rounded-xl hover:from-pink-600 hover:to-rose-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                    Launch Budget Planner
                                </button>
                            </div>
                        </div>

                        <!-- Professional Salary Calculator Tool -->
                        <div class="tool-card professional bg-white rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 border border-gray-100 overflow-hidden">
                            <div class="bg-gradient-to-r from-indigo-500 to-purple-600 p-6 text-white">
                                <div class="text-4xl mb-4">üí∞</div>
                                <h4 class="text-2xl font-bold mb-2">Salary Calculator</h4>
                                <p class="text-indigo-100">Calculate take-home pay, benefits, and salary negotiations</p>
                            </div>
                            <div class="p-6">
                                <div class="space-y-3 mb-6">
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Take-Home Pay Calculator</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Salary Comparison Tool</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Hourly to Salary Conversion</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Benefits Value Calculator</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Salary Negotiation Guide</span>
                                    </div>
                                </div>
                                <button onclick="openModal('salary-calculator-modal')" class="w-full bg-gradient-to-r from-indigo-500 to-purple-600 text-white font-bold py-3 px-6 rounded-xl hover:from-indigo-600 hover:to-purple-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                    Launch Salary Calculator
                                </button>
                            </div>
                        </div>

                    </div>
                </div>

                <!-- Developer Tools Category -->
                <div class="mb-16 tool-section">
                    <h3 class="text-3xl font-bold text-center mb-8 text-purple-600">üë®‚Äçüíª For Developers</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 max-w-6xl mx-auto" id="developer-tools">
                        
                        <!-- JSON Formatter & Validator Tool -->
                        <div class="tool-card developer bg-white rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 border border-gray-100 overflow-hidden">
                            <div class="bg-gradient-to-r from-blue-500 to-indigo-600 p-6 text-white">
                                <div class="text-4xl mb-4">üîß</div>
                                <h4 class="text-2xl font-bold mb-2">JSON Formatter & Validator</h4>
                                <p class="text-blue-100">Format, validate, minify, and convert JSON data with advanced features</p>
                            </div>
                            <div class="p-6">
                                <div class="space-y-3 mb-6">
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>JSON Formatting & Validation</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Minify & Compress JSON</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Convert to YAML, XML, CSV</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Error Detection & Fixing</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Structure Analysis</span>
                                    </div>
                                </div>
                                <button onclick="openModal('json-formatter-modal')" class="w-full bg-gradient-to-r from-blue-500 to-indigo-600 text-white font-bold py-3 px-6 rounded-xl hover:from-blue-600 hover:to-indigo-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                    Launch JSON Formatter
                                </button>
                            </div>
                        </div>

                        <!-- XML Formatter & Validator -->
                        <div class="tool-card developer bg-white rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 border border-gray-100 overflow-hidden">
                            <div class="bg-gradient-to-r from-green-500 to-emerald-600 p-6 text-white">
                                <div class="text-4xl mb-4">üìÑ</div>
                                <h4 class="text-2xl font-bold mb-2">XML Formatter & Validator</h4>
                                <p class="text-green-100">Format, validate, minify, and convert XML data with professional features</p>
                            </div>
                            <div class="p-6">
                                <div class="space-y-3 mb-6">
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>XML Formatting & Validation</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Minify & Compress XML</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Convert to JSON, YAML, CSV</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Structure Analysis</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Error Detection & Fixing</span>
                                    </div>
                                </div>
                                <button onclick="openModal('xml-formatter-modal')" class="w-full bg-gradient-to-r from-green-500 to-emerald-600 text-white font-bold py-3 px-6 rounded-xl hover:from-green-600 hover:to-emerald-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                    Launch XML Formatter
                                </button>
                            </div>
                        </div>

                        <!-- Base64 Encoder/Decoder -->
                        <div class="tool-card developer bg-white rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 border border-gray-100 overflow-hidden">
                            <div class="bg-gradient-to-r from-purple-500 to-pink-600 p-6 text-white">
                                <div class="text-4xl mb-4">üîê</div>
                                <h4 class="text-2xl font-bold mb-2">Base64 Encoder/Decoder</h4>
                                <p class="text-purple-100">Encode and decode Base64 data with text, image, and file support</p>
                            </div>
                            <div class="p-6">
                                <div class="space-y-3 mb-6">
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Text Encoding & Decoding</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Image & File Support</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>URL-Safe Base64</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Validation & Analysis</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Batch Processing</span>
                                    </div>
                                </div>
                                <button onclick="openModal('base64-encoder-modal')" class="w-full bg-gradient-to-r from-purple-500 to-pink-600 text-white font-bold py-3 px-6 rounded-xl hover:from-purple-600 hover:to-pink-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                    Launch Base64 Encoder
                                </button>
                            </div>
                        </div>

                        <!-- Hash Generator -->
                        <div class="tool-card developer bg-white rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 border border-gray-100 overflow-hidden">
                            <div class="bg-gradient-to-r from-orange-500 to-red-600 p-6 text-white">
                                <div class="text-4xl mb-4">üîê</div>
                                <h4 class="text-2xl font-bold mb-2">Hash Generator</h4>
                                <p class="text-orange-100">Generate MD5, SHA-1, SHA-256, SHA-512 hashes with advanced options</p>
                            </div>
                            <div class="p-6">
                                <div class="space-y-3 mb-6">
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>MD5, SHA-1, SHA-256, SHA-512</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Text & File Hashing</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Multiple Hash Formats</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Hash Verification</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Batch Processing</span>
                                    </div>
                                </div>
                                <button onclick="openModal('hash-generator-modal')" class="w-full bg-gradient-to-r from-orange-500 to-red-600 text-white font-bold py-3 px-6 rounded-xl hover:from-orange-600 hover:to-red-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                    Launch Hash Generator
                                </button>
                            </div>
                        </div>

                        <!-- URL Encoder/Decoder -->
                        <div class="tool-card developer bg-white rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 border border-gray-100 overflow-hidden">
                            <div class="bg-gradient-to-r from-teal-500 to-cyan-600 p-6 text-white">
                                <div class="text-4xl mb-4">üåê</div>
                                <h4 class="text-2xl font-bold mb-2">URL Encoder/Decoder</h4>
                                <p class="text-teal-100">Encode and decode URLs with query parameter support and validation</p>
                            </div>
                            <div class="p-6">
                                <div class="space-y-3 mb-6">
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>URL Encoding & Decoding</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Query Parameter Support</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>URL Validation</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>URL Beautification</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Component Analysis</span>
                                    </div>
                                </div>
                                <button onclick="openModal('url-encoder-modal')" class="w-full bg-gradient-to-r from-teal-500 to-cyan-600 text-white font-bold py-3 px-6 rounded-xl hover:from-teal-600 hover:to-cyan-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                    Launch URL Encoder
                                </button>
                            </div>
                        </div>

                        <!-- Regular Expression Tester -->
                        <div class="tool-card developer bg-white rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 border border-gray-100 overflow-hidden">
                            <div class="bg-gradient-to-r from-indigo-500 to-purple-600 p-6 text-white">
                                <div class="text-4xl mb-4">üîç</div>
                                <h4 class="text-2xl font-bold mb-2">Regular Expression Tester</h4>
                                <p class="text-indigo-100">Test and debug regex patterns with highlighting and pattern library</p>
                            </div>
                            <div class="p-6">
                                <div class="space-y-3 mb-6">
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Pattern Testing & Validation</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Match Highlighting</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Pattern Library</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Regex Explanation</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Statistics & Analysis</span>
                                    </div>
                                </div>
                                <button onclick="openModal('regex-tester-modal')" class="w-full bg-gradient-to-r from-indigo-500 to-purple-600 text-white font-bold py-3 px-6 rounded-xl hover:from-indigo-600 hover:to-purple-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                    Launch Regex Tester
                                </button>
                            </div>
                        </div>

                        <!-- CSS/JS Minifier -->
                        <div class="tool-card developer bg-white rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 border border-gray-100 overflow-hidden">
                            <div class="bg-gradient-to-r from-orange-500 to-red-600 p-6 text-white">
                                <div class="text-4xl mb-4">üõ†Ô∏è</div>
                                <h4 class="text-2xl font-bold mb-2">CSS/JS Minifier</h4>
                                <p class="text-orange-100">Minify and optimize CSS and JavaScript code with advanced features</p>
                            </div>
                            <div class="p-6">
                                <div class="space-y-3 mb-6">
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>CSS & JS Minification</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Code Beautification</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Syntax Validation</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Optimization Options</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>File Statistics</span>
                                    </div>
                                </div>
                                <button onclick="openModal('css-js-minifier-modal')" class="w-full bg-gradient-to-r from-orange-500 to-red-600 text-white font-bold py-3 px-6 rounded-xl hover:from-orange-600 hover:to-red-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                    Launch CSS/JS Minifier
                                </button>
                            </div>
                        </div>

                        <!-- Color Palette Generator -->
                        <div class="tool-card developer bg-white rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 border border-gray-100 overflow-hidden">
                            <div class="bg-gradient-to-r from-purple-500 to-pink-600 p-6 text-white">
                                <div class="text-4xl mb-4">üé®</div>
                                <h4 class="text-2xl font-bold mb-2">Color Palette Generator</h4>
                                <p class="text-purple-100">Generate beautiful color palettes with accessibility features</p>
                            </div>
                            <div class="p-6">
                                <div class="space-y-3 mb-6">
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Multiple Palette Types</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Accessibility Checking</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Export to CSS/SCSS/Tailwind</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>WCAG Compliance</span>
                                    </div>
                                </div>
                                <button onclick="openModal('color-palette-modal')" class="w-full bg-gradient-to-r from-purple-500 to-pink-600 text-white font-bold py-3 px-6 rounded-xl hover:from-purple-600 hover:to-pink-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                    Launch Color Palette Generator
                                </button>
                            </div>
                        </div>

                        <!-- Lorem Ipsum Generator -->
                        <div class="tool-card developer bg-white rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 border border-gray-100 overflow-hidden">
                            <div class="bg-gradient-to-r from-green-500 to-teal-600 p-6 text-white">
                                <div class="text-4xl mb-4">üìù</div>
                                <h4 class="text-2xl font-bold mb-2">Lorem Ipsum Generator</h4>
                                <p class="text-green-100">Generate Lorem Ipsum text in multiple languages with custom lengths</p>
                            </div>
                            <div class="p-6">
                                <div class="space-y-3 mb-6">
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Multiple Languages</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Custom Lengths</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Words/Sentences/Paragraphs</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Export Formats</span>
                                    </div>
                                </div>
                                <button onclick="openModal('lorem-ipsum-modal')" class="w-full bg-gradient-to-r from-green-500 to-teal-600 text-white font-bold py-3 px-6 rounded-xl hover:from-green-600 hover:to-teal-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                    Launch Lorem Ipsum Generator
                                </button>
                            </div>
                        </div>

                        <!-- Timestamp Converter -->
                        <div class="tool-card developer bg-white rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 border border-gray-100 overflow-hidden">
                            <div class="bg-gradient-to-r from-cyan-500 to-blue-600 p-6 text-white">
                                <div class="text-4xl mb-4">üïê</div>
                                <h4 class="text-2xl font-bold mb-2">Timestamp Converter</h4>
                                <p class="text-cyan-100">Advanced timestamp conversion, timezone handling, and date manipulation for developers</p>
                            </div>
                            <div class="p-6">
                                <div class="space-y-3 mb-6">
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Multiple Formats</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Timezone Support</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Date Calculations</span>
                                    </div>
                                    <div class="flex items-center text-gray-600">
                                        <span class="text-green-500 mr-2">‚úì</span>
                                        <span>Auto-Detection</span>
                                    </div>
                                </div>
                                <button onclick="openModal('timestamp-converter-modal')" class="w-full bg-gradient-to-r from-cyan-500 to-blue-600 text-white font-bold py-3 px-6 rounded-xl hover:from-cyan-600 hover:to-blue-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                    Launch Timestamp Converter
                                </button>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </section>

        <!-- ============================================ -->
        <!-- PDF TOOLS SECTION (NEW) -->
        <!-- ============================================ -->
        <section id="pdf-tools" class="tool-section py-20 bg-gradient-to-br from-red-50 to-orange-50">
            <div class="max-w-7xl mx-auto px-6">
                <div class="text-center mb-16">
                    <div class="inline-block bg-gradient-to-r from-red-500 to-orange-500 text-white text-sm font-bold px-4 py-1 rounded-full mb-4">
                        üÜï NEW TOOLS
                    </div>
                    <h2 class="text-4xl md:text-5xl font-bold mb-4 text-gray-800">üìÑ PDF <span class="text-red-600">Tools</span></h2>
                    <p class="text-xl text-gray-600 max-w-3xl mx-auto">
                        Powerful PDF manipulation tools - all processing happens locally in your browser for maximum privacy
                    </p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 max-w-6xl mx-auto">
                    
                    <!-- PDF Password Remover -->
                    <div class="tool-card pdf-tool bg-white rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 border border-gray-100 overflow-hidden">
                        <div class="bg-gradient-to-r from-red-500 to-pink-600 p-6 text-white">
                            <div class="text-4xl mb-4">üîì</div>
                            <h4 class="text-2xl font-bold mb-2">PDF Password Remover</h4>
                            <p class="text-red-100">Remove password protection from your PDFs instantly</p>
                        </div>
                        <div class="p-6">
                            <div class="space-y-3 mb-6">
                                <div class="flex items-center text-gray-600">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    <span>Client-side processing</span>
                                </div>
                                <div class="flex items-center text-gray-600">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    <span>Complete privacy</span>
                                </div>
                                <div class="flex items-center text-gray-600">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    <span>Fast & secure</span>
                                </div>
                                <div class="flex items-center text-gray-600">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    <span>No file size limits</span>
                                </div>
                            </div>
                            <button onclick="openModal('pdf-password-remover-modal')" class="w-full bg-gradient-to-r from-red-500 to-pink-600 text-white font-bold py-3 px-6 rounded-xl hover:from-red-600 hover:to-pink-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                Remove Password
                            </button>
                        </div>
                    </div>

                    <!-- PDF Merger -->
                    <div class="tool-card pdf-tool bg-white rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 border border-gray-100 overflow-hidden">
                        <div class="bg-gradient-to-r from-blue-500 to-indigo-600 p-6 text-white">
                            <div class="text-4xl mb-4">üìÑ</div>
                            <h4 class="text-2xl font-bold mb-2">PDF Merger</h4>
                            <p class="text-blue-100">Combine multiple PDFs into one document</p>
                        </div>
                        <div class="p-6">
                            <div class="space-y-3 mb-6">
                                <div class="flex items-center text-gray-600">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    <span>Merge unlimited PDFs</span>
                                </div>
                                <div class="flex items-center text-gray-600">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    <span>Drag & drop interface</span>
                                </div>
                                <div class="flex items-center text-gray-600">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    <span>Reorder pages</span>
                                </div>
                                <div class="flex items-center text-gray-600">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    <span>Preview before merge</span>
                                </div>
                            </div>
                            <button onclick="openModal('pdf-merger-modal')" class="w-full bg-gradient-to-r from-blue-500 to-indigo-600 text-white font-bold py-3 px-6 rounded-xl hover:from-blue-600 hover:to-indigo-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                Merge PDFs
                            </button>
                        </div>
                    </div>

                    <!-- PDF Splitter -->
                    <div class="tool-card pdf-tool bg-white rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 border border-gray-100 overflow-hidden">
                        <div class="bg-gradient-to-r from-green-500 to-teal-600 p-6 text-white">
                            <div class="text-4xl mb-4">‚úÇÔ∏è</div>
                            <h4 class="text-2xl font-bold mb-2">PDF Splitter</h4>
                            <p class="text-green-100">Split PDFs into separate pages or ranges</p>
                        </div>
                        <div class="p-6">
                            <div class="space-y-3 mb-6">
                                <div class="flex items-center text-gray-600">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    <span>Extract specific pages</span>
                                </div>
                                <div class="flex items-center text-gray-600">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    <span>Split by page ranges</span>
                                </div>
                                <div class="flex items-center text-gray-600">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    <span>Preview pages</span>
                                </div>
                                <div class="flex items-center text-gray-600">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    <span>Bulk download</span>
                                </div>
                            </div>
                            <button onclick="openModal('pdf-splitter-modal')" class="w-full bg-gradient-to-r from-green-500 to-teal-600 text-white font-bold py-3 px-6 rounded-xl hover:from-green-600 hover:to-teal-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                Split PDF
                            </button>
                        </div>
                    </div>

                    <!-- PDF Encryptor -->
                    <div class="tool-card pdf-tool bg-white rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 border border-gray-100 overflow-hidden">
                        <div class="bg-gradient-to-r from-purple-500 to-pink-600 p-6 text-white">
                            <div class="text-4xl mb-4">üîí</div>
                            <h4 class="text-2xl font-bold mb-2">PDF Encryptor</h4>
                            <p class="text-purple-100">Add password protection to your PDFs</p>
                        </div>
                        <div class="p-6">
                            <div class="space-y-3 mb-6">
                                <div class="flex items-center text-gray-600">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    <span>Strong encryption</span>
                                </div>
                                <div class="flex items-center text-gray-600">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    <span>Custom passwords</span>
                                </div>
                                <div class="flex items-center text-gray-600">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    <span>Secure processing</span>
                                </div>
                                <div class="flex items-center text-gray-600">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    <span>No data upload</span>
                                </div>
                            </div>
                            <button onclick="openModal('pdf-encryptor-modal')" class="w-full bg-gradient-to-r from-purple-500 to-pink-600 text-white font-bold py-3 px-6 rounded-xl hover:from-purple-600 hover:to-pink-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                Encrypt PDF
                            </button>
                        </div>
                    </div>

                    <!-- PDF to Images -->
                    <div class="tool-card pdf-tool bg-white rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 border border-gray-100 overflow-hidden">
                        <div class="bg-gradient-to-r from-orange-500 to-yellow-600 p-6 text-white">
                            <div class="text-4xl mb-4">üñºÔ∏è</div>
                            <h4 class="text-2xl font-bold mb-2">PDF to Images</h4>
                            <p class="text-orange-100">Convert PDF pages to JPG or PNG images</p>
                        </div>
                        <div class="p-6">
                            <div class="space-y-3 mb-6">
                                <div class="flex items-center text-gray-600">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    <span>High-quality output</span>
                                </div>
                                <div class="flex items-center text-gray-600">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    <span>JPG or PNG format</span>
                                </div>
                                <div class="flex items-center text-gray-600">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    <span>Adjustable quality</span>
                                </div>
                                <div class="flex items-center text-gray-600">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    <span>Download as ZIP</span>
                                </div>
                            </div>
                            <button onclick="openModal('pdf-to-images-modal')" class="w-full bg-gradient-to-r from-orange-500 to-yellow-600 text-white font-bold py-3 px-6 rounded-xl hover:from-orange-600 hover:to-yellow-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                Convert to Images
                            </button>
                        </div>
                    </div>

                </div>
            </div>
        </section>

        <!-- ============================================ -->
        <!-- IMAGE TOOLS SECTION (NEW) -->
        <!-- ============================================ -->
        <section id="image-tools" class="tool-section py-20 bg-gradient-to-br from-blue-50 to-purple-50">
            <div class="max-w-7xl mx-auto px-6">
                <div class="text-center mb-16">
                    <div class="inline-block bg-gradient-to-r from-blue-500 to-purple-500 text-white text-sm font-bold px-4 py-1 rounded-full mb-4">
                        üÜï NEW TOOLS
                    </div>
                    <h2 class="text-4xl md:text-5xl font-bold mb-4 text-gray-800">üñºÔ∏è Image <span class="text-blue-600">Tools</span></h2>
                    <p class="text-xl text-gray-600 max-w-3xl mx-auto">
                        Professional image manipulation tools - fast, secure, and completely client-side
                    </p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 max-w-6xl mx-auto">
                    
                    <!-- Image to PDF -->
                    <div class="tool-card image-tool bg-white rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 border border-gray-100 overflow-hidden">
                        <div class="bg-gradient-to-r from-indigo-500 to-purple-600 p-6 text-white">
                            <div class="text-4xl mb-4">üì∏</div>
                            <h4 class="text-2xl font-bold mb-2">Image to PDF</h4>
                            <p class="text-indigo-100">Convert images to PDF documents</p>
                        </div>
                        <div class="p-6">
                            <div class="space-y-3 mb-6">
                                <div class="flex items-center text-gray-600">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    <span>Multiple images support</span>
                                </div>
                                <div class="flex items-center text-gray-600">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    <span>Custom page size</span>
                                </div>
                                <div class="flex items-center text-gray-600">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    <span>Drag & drop</span>
                                </div>
                                <div class="flex items-center text-gray-600">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    <span>Maintain quality</span>
                                </div>
                            </div>
                            <button onclick="openModal('image-to-pdf-modal')" class="w-full bg-gradient-to-r from-indigo-500 to-purple-600 text-white font-bold py-3 px-6 rounded-xl hover:from-indigo-600 hover:to-purple-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                Convert to PDF
                            </button>
                        </div>
                    </div>

                    <!-- Image Compressor -->
                    <div class="tool-card image-tool bg-white rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 border border-gray-100 overflow-hidden">
                        <div class="bg-gradient-to-r from-green-500 to-emerald-600 p-6 text-white">
                            <div class="text-4xl mb-4">üìè</div>
                            <h4 class="text-2xl font-bold mb-2">Image Compressor</h4>
                            <p class="text-green-100">Reduce image file size while maintaining quality</p>
                        </div>
                        <div class="p-6">
                            <div class="space-y-3 mb-6">
                                <div class="flex items-center text-gray-600">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    <span>Smart compression</span>
                                </div>
                                <div class="flex items-center text-gray-600">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    <span>Adjustable quality</span>
                                </div>
                                <div class="flex items-center text-gray-600">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    <span>Batch processing</span>
                                </div>
                                <div class="flex items-center text-gray-600">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    <span>Preview comparison</span>
                                </div>
                            </div>
                            <button onclick="openModal('image-compressor-modal')" class="w-full bg-gradient-to-r from-green-500 to-emerald-600 text-white font-bold py-3 px-6 rounded-xl hover:from-green-600 hover:to-emerald-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                Compress Images
                            </button>
                        </div>
                    </div>

                    <!-- Image Format Converter -->
                    <div class="tool-card image-tool bg-white rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 border border-gray-100 overflow-hidden">
                        <div class="bg-gradient-to-r from-pink-500 to-rose-600 p-6 text-white">
                            <div class="text-4xl mb-4">üé®</div>
                            <h4 class="text-2xl font-bold mb-2">Image Format Converter</h4>
                            <p class="text-pink-100">Convert between JPG, PNG, WebP formats</p>
                        </div>
                        <div class="p-6">
                            <div class="space-y-3 mb-6">
                                <div class="flex items-center text-gray-600">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    <span>Multiple formats</span>
                                </div>
                                <div class="flex items-center text-gray-600">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    <span>Batch conversion</span>
                                </div>
                                <div class="flex items-center text-gray-600">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    <span>Quality control</span>
                                </div>
                                <div class="flex items-center text-gray-600">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    <span>Fast processing</span>
                                </div>
                            </div>
                            <button onclick="openModal('image-converter-modal')" class="w-full bg-gradient-to-r from-pink-500 to-rose-600 text-white font-bold py-3 px-6 rounded-xl hover:from-pink-600 hover:to-rose-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                Convert Format
                            </button>
                        </div>
                    </div>

                    <!-- Image Resizer -->
                    <div class="tool-card image-tool bg-white rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 border border-gray-100 overflow-hidden">
                        <div class="bg-gradient-to-r from-cyan-500 to-blue-600 p-6 text-white">
                            <div class="text-4xl mb-4">üìê</div>
                            <h4 class="text-2xl font-bold mb-2">Image Resizer</h4>
                            <p class="text-cyan-100">Resize images to any dimensions</p>
                        </div>
                        <div class="p-6">
                            <div class="space-y-3 mb-6">
                                <div class="flex items-center text-gray-600">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    <span>Custom dimensions</span>
                                </div>
                                <div class="flex items-center text-gray-600">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    <span>Maintain aspect ratio</span>
                                </div>
                                <div class="flex items-center text-gray-600">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    <span>Percentage or pixels</span>
                                </div>
                                <div class="flex items-center text-gray-600">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    <span>Batch resize</span>
                                </div>
                            </div>
                            <button onclick="openModal('image-resizer-modal')" class="w-full bg-gradient-to-r from-cyan-500 to-blue-600 text-white font-bold py-3 px-6 rounded-xl hover:from-cyan-600 hover:to-blue-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                Resize Images
                            </button>
                        </div>
                    </div>

                </div>
            </div>
        </section>

        <!-- ============================================ -->
        <!-- UTILITIES SECTION (NEW) -->
        <!-- ============================================ -->
        <section id="utilities" class="tool-section py-20 bg-gradient-to-br from-green-50 to-teal-50">
            <div class="max-w-7xl mx-auto px-6">
                <div class="text-center mb-16">
                    <div class="inline-block bg-gradient-to-r from-green-500 to-teal-500 text-white text-sm font-bold px-4 py-1 rounded-full mb-4">
                        üÜï NEW TOOLS
                    </div>
                    <h2 class="text-4xl md:text-5xl font-bold mb-4 text-gray-800">üõ†Ô∏è Utility <span class="text-green-600">Tools</span></h2>
                    <p class="text-xl text-gray-600 max-w-3xl mx-auto">
                        Powerful utility tools for everyday tasks - simple, fast, and efficient
                    </p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 max-w-4xl mx-auto">
                    
                    <!-- Digital Signature Generator -->
                    <div class="tool-card utility-tool bg-white rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 border border-gray-100 overflow-hidden">
                        <div class="bg-gradient-to-r from-purple-500 to-indigo-600 p-6 text-white">
                            <div class="text-4xl mb-4">‚úçÔ∏è</div>
                            <h4 class="text-2xl font-bold mb-2">Digital Signature Generator</h4>
                            <p class="text-purple-100">Create professional digital signatures</p>
                        </div>
                        <div class="p-6">
                            <div class="space-y-3 mb-6">
                                <div class="flex items-center text-gray-600">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    <span>Draw or type signature</span>
                                </div>
                                <div class="flex items-center text-gray-600">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    <span>Multiple styles</span>
                                </div>
                                <div class="flex items-center text-gray-600">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    <span>Transparent PNG</span>
                                </div>
                                <div class="flex items-center text-gray-600">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    <span>Instant download</span>
                                </div>
                            </div>
                            <button onclick="openModal('signature-generator-modal')" class="w-full bg-gradient-to-r from-purple-500 to-indigo-600 text-white font-bold py-3 px-6 rounded-xl hover:from-purple-600 hover:to-indigo-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                Create Signature
                            </button>
                        </div>
                    </div>

                    <!-- CSV to JSON Converter -->
                    <div class="tool-card utility-tool bg-white rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 border border-gray-100 overflow-hidden">
                        <div class="bg-gradient-to-r from-orange-500 to-amber-600 p-6 text-white">
                            <div class="text-4xl mb-4">üìä</div>
                            <h4 class="text-2xl font-bold mb-2">CSV to JSON Converter</h4>
                            <p class="text-orange-100">Convert between CSV and JSON formats</p>
                        </div>
                        <div class="p-6">
                            <div class="space-y-3 mb-6">
                                <div class="flex items-center text-gray-600">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    <span>Bi-directional conversion</span>
                                </div>
                                <div class="flex items-center text-gray-600">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    <span>Data preview</span>
                                </div>
                                <div class="flex items-center text-gray-600">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    <span>Format validation</span>
                                </div>
                                <div class="flex items-center text-gray-600">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    <span>Copy or download</span>
                                </div>
                            </div>
                            <button onclick="openModal('csv-json-converter-modal')" class="w-full bg-gradient-to-r from-orange-500 to-amber-600 text-white font-bold py-3 px-6 rounded-xl hover:from-orange-600 hover:to-amber-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                Convert Data
                            </button>
                        </div>
                    </div>

                </div>
            </div>
        </section>

        <!-- Coming Soon Tools Section - Clean Categories -->
        <section class="py-20 bg-gradient-to-br from-indigo-50 via-purple-50 to-pink-50">
            <div class="max-w-7xl mx-auto px-6">
                <div class="text-center mb-16">
                    <h2 class="text-4xl md:text-5xl font-bold mb-4 text-gray-800">üöÄ Coming Soon Tools</h2>
                    <p class="text-xl text-gray-600 max-w-3xl mx-auto">
                        Exciting new tools are in development. Organized by category for easy discovery.
                    </p>
                </div>

                <!-- Filter Buttons for Coming Soon -->
                <div class="flex flex-wrap justify-center gap-4 mb-16">
                    <button onclick="filterComingSoon('all', this)" class="coming-soon-filter-btn active bg-gradient-to-r from-gray-600 to-gray-700 text-white px-6 py-3 rounded-full font-semibold hover:from-gray-700 hover:to-gray-800 transition-all duration-300 transform hover:scale-105 shadow-lg">
                        üåü All Coming Soon
                    </button>
                    <button onclick="filterComingSoon('student', this)" class="coming-soon-filter-btn bg-gradient-to-r from-blue-500 to-blue-600 text-white px-6 py-3 rounded-full font-semibold hover:from-blue-600 hover:to-blue-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                        üéì Student Tools
                    </button>
                    <button onclick="filterComingSoon('professional', this)" class="coming-soon-filter-btn bg-gradient-to-r from-green-500 to-green-600 text-white px-6 py-3 rounded-full font-semibold hover:from-green-600 hover:to-green-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                        üíº Professional Tools
                    </button>
                    <button onclick="filterComingSoon('developer', this)" class="coming-soon-filter-btn bg-gradient-to-r from-purple-500 to-purple-600 text-white px-6 py-3 rounded-full font-semibold hover:from-purple-600 hover:to-purple-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                        üë®‚Äçüíª Developer Tools
                    </button>
                </div>

                <!-- Student Coming Soon Category -->
                <div class="mb-16">
                    <h3 class="text-3xl font-bold text-center mb-8 text-blue-600">üéì Student Tools Coming Soon</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 max-w-6xl mx-auto" id="coming-soon-student">
                        <!-- Study Group Manager -->
                        <div class="tool-card student coming-soon bg-white rounded-2xl shadow-xl border border-gray-100 overflow-hidden opacity-75">
                            <div class="bg-gradient-to-r from-gray-400 to-gray-500 p-6 text-white relative">
                                <div class="absolute top-2 right-2">
                                    <div class="bg-yellow-500 text-yellow-900 px-2 py-1 rounded-full text-xs font-bold">
                                        üîí COMING SOON
                                    </div>
                                </div>
                                <div class="text-4xl mb-4">üìö</div>
                                <h4 class="text-2xl font-bold mb-2">Study Group Manager</h4>
                                <p class="text-gray-100">Organize study groups, schedule sessions, and track group progress</p>
                            </div>
                            <div class="p-6">
                                <div class="space-y-3 mb-6">
                                    <div class="flex items-center text-gray-500">
                                        <span class="text-gray-400 mr-2">üîí</span>
                                        <span>Group Scheduling</span>
                                    </div>
                                    <div class="flex items-center text-gray-500">
                                        <span class="text-gray-400 mr-2">üîí</span>
                                        <span>Progress Tracking</span>
                                    </div>
                                    <div class="flex items-center text-gray-500">
                                        <span class="text-gray-400 mr-2">üîí</span>
                                        <span>Resource Sharing</span>
                                    </div>
                                    <div class="flex items-center text-gray-500">
                                        <span class="text-gray-400 mr-2">üîí</span>
                                        <span>Collaboration Tools</span>
                                    </div>
                                </div>
                                <button disabled class="w-full bg-gray-400 text-white font-bold py-3 px-6 rounded-xl cursor-not-allowed">
                                    üîí Coming in Next Release
                                </button>
                            </div>
                        </div>

                        <!-- Memory Palace Builder -->
                        <div class="tool-card student coming-soon bg-white rounded-2xl shadow-xl border border-gray-100 overflow-hidden opacity-75">
                            <div class="bg-gradient-to-r from-gray-400 to-gray-500 p-6 text-white relative">
                                <div class="absolute top-2 right-2">
                                    <div class="bg-yellow-500 text-yellow-900 px-2 py-1 rounded-full text-xs font-bold">
                                        üîí COMING SOON
                                    </div>
                                </div>
                                <div class="text-4xl mb-4">üß†</div>
                                <h4 class="text-2xl font-bold mb-2">Memory Palace Builder</h4>
                                <p class="text-gray-100">Create virtual memory palaces for enhanced learning and retention</p>
                            </div>
                            <div class="p-6">
                                <div class="space-y-3 mb-6">
                                    <div class="flex items-center text-gray-500">
                                        <span class="text-gray-400 mr-2">üîí</span>
                                        <span>3D Memory Spaces</span>
                                    </div>
                                    <div class="flex items-center text-gray-500">
                                        <span class="text-gray-400 mr-2">üîí</span>
                                        <span>Visual Associations</span>
                                    </div>
                                    <div class="flex items-center text-gray-500">
                                        <span class="text-gray-400 mr-2">üîí</span>
                                        <span>Memory Techniques</span>
                                    </div>
                                    <div class="flex items-center text-gray-500">
                                        <span class="text-gray-400 mr-2">üîí</span>
                                        <span>Practice Sessions</span>
                                    </div>
                                </div>
                                <button disabled class="w-full bg-gray-400 text-white font-bold py-3 px-6 rounded-xl cursor-not-allowed">
                                    üîí Coming in Next Release
                                </button>
                            </div>
                        </div>

                        <!-- Exam Simulator -->
                        <div class="tool-card student coming-soon bg-white rounded-2xl shadow-xl border border-gray-100 overflow-hidden opacity-75">
                            <div class="bg-gradient-to-r from-gray-400 to-gray-500 p-6 text-white relative">
                                <div class="absolute top-2 right-2">
                                    <div class="bg-yellow-500 text-yellow-900 px-2 py-1 rounded-full text-xs font-bold">
                                        üîí COMING SOON
                                    </div>
                                </div>
                                <div class="text-4xl mb-4">üéØ</div>
                                <h4 class="text-2xl font-bold mb-2">Exam Simulator</h4>
                                <p class="text-gray-100">Practice exams with real-time feedback and performance analytics</p>
                            </div>
                            <div class="p-6">
                                <div class="space-y-3 mb-6">
                                    <div class="flex items-center text-gray-500">
                                        <span class="text-gray-400 mr-2">üîí</span>
                                        <span>Custom Exams</span>
                                    </div>
                                    <div class="flex items-center text-gray-500">
                                        <span class="text-gray-400 mr-2">üîí</span>
                                        <span>Real-time Feedback</span>
                                    </div>
                                    <div class="flex items-center text-gray-500">
                                        <span class="text-gray-400 mr-2">üîí</span>
                                        <span>Performance Analytics</span>
                                    </div>
                                    <div class="flex items-center text-gray-500">
                                        <span class="text-gray-400 mr-2">üîí</span>
                                        <span>Adaptive Testing</span>
                                    </div>
                                </div>
                                <button disabled class="w-full bg-gray-400 text-white font-bold py-3 px-6 rounded-xl cursor-not-allowed">
                                    üîí Coming in Next Release
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Professional Coming Soon Category -->
                <div class="mb-16">
                    <h3 class="text-3xl font-bold text-center mb-8 text-green-600">üíº Professional Tools Coming Soon</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 max-w-6xl mx-auto" id="coming-soon-professional">
                        <!-- Portfolio Optimizer -->
                        <div class="tool-card professional coming-soon bg-white rounded-2xl shadow-xl border border-gray-100 overflow-hidden opacity-75">
                            <div class="bg-gradient-to-r from-gray-400 to-gray-500 p-6 text-white relative">
                                <div class="absolute top-2 right-2">
                                    <div class="bg-yellow-500 text-yellow-900 px-2 py-1 rounded-full text-xs font-bold">
                                        üîí COMING SOON
                                    </div>
                                </div>
                                <div class="text-4xl mb-4">üìä</div>
                                <h4 class="text-2xl font-bold mb-2">Portfolio Optimizer</h4>
                                <p class="text-gray-100">Advanced portfolio analysis, risk assessment, and optimization strategies</p>
                            </div>
                            <div class="p-6">
                                <div class="space-y-3 mb-6">
                                    <div class="flex items-center text-gray-500">
                                        <span class="text-gray-400 mr-2">üîí</span>
                                        <span>Risk Analysis</span>
                                    </div>
                                    <div class="flex items-center text-gray-500">
                                        <span class="text-gray-400 mr-2">üîí</span>
                                        <span>Asset Allocation</span>
                                    </div>
                                    <div class="flex items-center text-gray-500">
                                        <span class="text-gray-400 mr-2">üîí</span>
                                        <span>Performance Tracking</span>
                                    </div>
                                    <div class="flex items-center text-gray-500">
                                        <span class="text-gray-400 mr-2">üîí</span>
                                        <span>Optimization Models</span>
                                    </div>
                                </div>
                                <button disabled class="w-full bg-gray-400 text-white font-bold py-3 px-6 rounded-xl cursor-not-allowed">
                                    üîí Coming in Next Release
                                </button>
                            </div>
                        </div>

                        <!-- Business Valuation -->
                        <div class="tool-card professional coming-soon bg-white rounded-2xl shadow-xl border border-gray-100 overflow-hidden opacity-75">
                            <div class="bg-gradient-to-r from-gray-400 to-gray-500 p-6 text-white relative">
                                <div class="absolute top-2 right-2">
                                    <div class="bg-yellow-500 text-yellow-900 px-2 py-1 rounded-full text-xs font-bold">
                                        üîí COMING SOON
                                    </div>
                                </div>
                                <div class="text-4xl mb-4">üè¢</div>
                                <h4 class="text-2xl font-bold mb-2">Business Valuation</h4>
                                <p class="text-gray-100">Comprehensive business valuation using multiple methodologies</p>
                            </div>
                            <div class="p-6">
                                <div class="space-y-3 mb-6">
                                    <div class="flex items-center text-gray-500">
                                        <span class="text-gray-400 mr-2">üîí</span>
                                        <span>DCF Analysis</span>
                                    </div>
                                    <div class="flex items-center text-gray-500">
                                        <span class="text-gray-400 mr-2">üîí</span>
                                        <span>Market Comparables</span>
                                    </div>
                                    <div class="flex items-center text-gray-500">
                                        <span class="text-gray-400 mr-2">üîí</span>
                                        <span>Asset Valuation</span>
                                    </div>
                                    <div class="flex items-center text-gray-500">
                                        <span class="text-gray-400 mr-2">üîí</span>
                                        <span>Scenario Analysis</span>
                                    </div>
                                </div>
                                <button disabled class="w-full bg-gray-400 text-white font-bold py-3 px-6 rounded-xl cursor-not-allowed">
                                    üîí Coming in Next Release
                                </button>
                            </div>
                        </div>

                        <!-- Financial Forecasting -->
                        <div class="tool-card professional coming-soon bg-white rounded-2xl shadow-xl border border-gray-100 overflow-hidden opacity-75">
                            <div class="bg-gradient-to-r from-gray-400 to-gray-500 p-6 text-white relative">
                                <div class="absolute top-2 right-2">
                                    <div class="bg-yellow-500 text-yellow-900 px-2 py-1 rounded-full text-xs font-bold">
                                        üîí COMING SOON
                                    </div>
                                </div>
                                <div class="text-4xl mb-4">üìà</div>
                                <h4 class="text-2xl font-bold mb-2">Financial Forecasting</h4>
                                <p class="text-gray-100">Advanced financial modeling and forecasting with AI insights</p>
                            </div>
                            <div class="p-6">
                                <div class="space-y-3 mb-6">
                                    <div class="flex items-center text-gray-500">
                                        <span class="text-gray-400 mr-2">üîí</span>
                                        <span>Revenue Forecasting</span>
                                    </div>
                                    <div class="flex items-center text-gray-500">
                                        <span class="text-gray-400 mr-2">üîí</span>
                                        <span>Cash Flow Projections</span>
                                    </div>
                                    <div class="flex items-center text-gray-500">
                                        <span class="text-gray-400 mr-2">üîí</span>
                                        <span>Scenario Planning</span>
                                    </div>
                                    <div class="flex items-center text-gray-500">
                                        <span class="text-gray-400 mr-2">üîí</span>
                                        <span>AI Predictions</span>
                                    </div>
                                </div>
                                <button disabled class="w-full bg-gray-400 text-white font-bold py-3 px-6 rounded-xl cursor-not-allowed">
                                    üîí Coming in Next Release
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Developer Coming Soon Category -->
                <div class="mb-16">
                    <h3 class="text-3xl font-bold text-center mb-8 text-purple-600">üë®‚Äçüíª Developer Tools Coming Soon</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 max-w-6xl mx-auto" id="coming-soon-developer">
                        <!-- API Testing Suite -->
                        <div class="tool-card developer coming-soon bg-white rounded-2xl shadow-xl border border-gray-100 overflow-hidden opacity-75">
                            <div class="bg-gradient-to-r from-gray-400 to-gray-500 p-6 text-white relative">
                                <div class="absolute top-2 right-2">
                                    <div class="bg-yellow-500 text-yellow-900 px-2 py-1 rounded-full text-xs font-bold">
                                        üîí COMING SOON
                                    </div>
                                </div>
                                <div class="text-4xl mb-4">üîê</div>
                                <h4 class="text-2xl font-bold mb-2">API Testing Suite</h4>
                                <p class="text-gray-100">Comprehensive API testing, documentation, and monitoring tools</p>
                            </div>
                            <div class="p-6">
                                <div class="space-y-3 mb-6">
                                    <div class="flex items-center text-gray-500">
                                        <span class="text-gray-400 mr-2">üîí</span>
                                        <span>REST API Testing</span>
                                    </div>
                                    <div class="flex items-center text-gray-500">
                                        <span class="text-gray-400 mr-2">üîí</span>
                                        <span>GraphQL Support</span>
                                    </div>
                                    <div class="flex items-center text-gray-500">
                                        <span class="text-gray-400 mr-2">üîí</span>
                                        <span>Performance Testing</span>
                                    </div>
                                    <div class="flex items-center text-gray-500">
                                        <span class="text-gray-400 mr-2">üîí</span>
                                        <span>Documentation Generator</span>
                                    </div>
                                </div>
                                <button disabled class="w-full bg-gray-400 text-white font-bold py-3 px-6 rounded-xl cursor-not-allowed">
                                    üîí Coming in Next Release
                                </button>
                            </div>
                        </div>

                        <!-- Code Performance Analyzer -->
                        <div class="tool-card developer coming-soon bg-white rounded-2xl shadow-xl border border-gray-100 overflow-hidden opacity-75">
                            <div class="bg-gradient-to-r from-gray-400 to-gray-500 p-6 text-white relative">
                                <div class="absolute top-2 right-2">
                                    <div class="bg-yellow-500 text-yellow-900 px-2 py-1 rounded-full text-xs font-bold">
                                        üîí COMING SOON
                                    </div>
                                </div>
                                <div class="text-4xl mb-4">‚ö°</div>
                                <h4 class="text-2xl font-bold mb-2">Code Performance Analyzer</h4>
                                <p class="text-gray-100">Analyze code performance, identify bottlenecks, and optimization suggestions</p>
                            </div>
                            <div class="p-6">
                                <div class="space-y-3 mb-6">
                                    <div class="flex items-center text-gray-500">
                                        <span class="text-gray-400 mr-2">üîí</span>
                                        <span>Performance Metrics</span>
                                    </div>
                                    <div class="flex items-center text-gray-500">
                                        <span class="text-gray-400 mr-2">üîí</span>
                                        <span>Bottleneck Detection</span>
                                    </div>
                                    <div class="flex items-center text-gray-500">
                                        <span class="text-gray-400 mr-2">üîí</span>
                                        <span>Optimization Tips</span>
                                    </div>
                                    <div class="flex items-center text-gray-500">
                                        <span class="text-gray-400 mr-2">üîí</span>
                                        <span>Memory Analysis</span>
                                    </div>
                                </div>
                                <button disabled class="w-full bg-gray-400 text-white font-bold py-3 px-6 rounded-xl cursor-not-allowed">
                                    üîí Coming in Next Release
                                </button>
                            </div>
                        </div>

                        <!-- AI Code Assistant -->
                        <div class="tool-card developer coming-soon bg-white rounded-2xl shadow-xl border border-gray-100 overflow-hidden opacity-75">
                            <div class="bg-gradient-to-r from-gray-400 to-gray-500 p-6 text-white relative">
                                <div class="absolute top-2 right-2">
                                    <div class="bg-yellow-500 text-yellow-900 px-2 py-1 rounded-full text-xs font-bold">
                                        üîí COMING SOON
                                    </div>
                                </div>
                                <div class="text-4xl mb-4">ü§ñ</div>
                                <h4 class="text-2xl font-bold mb-2">AI Code Assistant</h4>
                                <p class="text-gray-100">AI-powered code generation, debugging, and intelligent suggestions</p>
                            </div>
                            <div class="p-6">
                                <div class="space-y-3 mb-6">
                                    <div class="flex items-center text-gray-500">
                                        <span class="text-gray-400 mr-2">üîí</span>
                                        <span>Code Generation</span>
                                    </div>
                                    <div class="flex items-center text-gray-500">
                                        <span class="text-gray-400 mr-2">üîí</span>
                                        <span>Bug Detection</span>
                                    </div>
                                    <div class="flex items-center text-gray-500">
                                        <span class="text-gray-400 mr-2">üîí</span>
                                        <span>Code Review</span>
                                    </div>
                                    <div class="flex items-center text-gray-500">
                                        <span class="text-gray-400 mr-2">üîí</span>
                                        <span>Smart Refactoring</span>
                                    </div>
                                </div>
                                <button disabled class="w-full bg-gray-400 text-white font-bold py-3 px-6 rounded-xl cursor-not-allowed">
                                    üîí Coming in Next Release
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="text-center mt-12">
                    <div class="flex flex-col sm:flex-row gap-4 justify-center items-center">
                        <a href="#contact" class="bg-blue-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-blue-700 transition-colors">
                            üí° Suggest a Tool
                        </a>
                        <a href="#tools" class="border-2 border-blue-600 text-blue-600 px-6 py-3 rounded-lg font-semibold hover:bg-blue-600 hover:text-white transition-colors">
                            üõ†Ô∏è View Tools Section
                        </a>
                    </div>
                </div>
            </div>
        </section>

        <!-- About Section -->
        <section id="about" class="py-20 bg-white">
            <div class="max-w-7xl mx-auto px-6">
                <div class="text-center mb-16">
                    <h2 class="text-4xl md:text-5xl font-bold mb-4 text-gray-800">About FreeToolHub</h2>
                    <p class="text-xl text-gray-600 max-w-3xl mx-auto">
                        Your one-stop destination for free, powerful online tools
                    </p>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-12 items-center">
                    <div>
                        <h3 class="text-3xl font-bold mb-6 text-gray-800">Why Choose FreeToolHub?</h3>
                        <div class="space-y-6">
                            <div class="flex items-start space-x-4">
                                <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0">
                                    <span class="text-2xl">üöÄ</span>
                                </div>
                                <div>
                                    <h4 class="text-xl font-semibold mb-2 text-gray-800">Lightning Fast</h4>
                                    <p class="text-gray-600">All tools run locally in your browser for instant results with no server delays.</p>
            </div>
        </div>
                            
                            <div class="flex items-start space-x-4">
                                <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center flex-shrink-0">
                                    <span class="text-2xl">üîí</span>
    </div>
                                <div>
                                    <h4 class="text-xl font-semibold mb-2 text-gray-800">Privacy First</h4>
                                    <p class="text-gray-600">Your data never leaves your device. No tracking, no data collection, no accounts required.</p>
            </div>
                </div>

                            <div class="flex items-start space-x-4">
                                <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center flex-shrink-0">
                                    <span class="text-2xl">üíØ</span>
                </div>
                        <div>
                                    <h4 class="text-xl font-semibold mb-2 text-gray-800">Always Free</h4>
                                    <p class="text-gray-600">No hidden costs, no premium tiers, no subscriptions. All features are completely free forever.</p>
                                </div>
                            </div>
                        </div>
                </div>

                    <div class="relative">
                        <div class="bg-gradient-to-br from-purple-100 to-blue-100 rounded-2xl p-8 shadow-xl">
                            <div class="text-center">
                                <div class="w-24 h-24 bg-gradient-to-br from-purple-600 to-blue-600 rounded-full flex items-center justify-center mx-auto mb-6">
                                    <span class="text-4xl">üõ†Ô∏è</span>
                                </div>
                                <h4 class="text-2xl font-bold mb-4 text-gray-800">Professional Grade Tools</h4>
                                <p class="text-gray-600 leading-relaxed">
                                    Each tool is carefully crafted with attention to detail, ensuring accuracy, reliability, and ease of use for both casual users and professionals.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Contact Information -->
                <div class="mt-16 text-center">
                    <div class="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-2xl p-8 max-w-4xl mx-auto">
                        <h3 class="text-3xl font-bold text-gray-800 mb-4">Get in Touch</h3>
                        <p class="text-xl text-gray-600 mb-8">
                            Have questions, suggestions, or want to collaborate? We'd love to hear from you!
                        </p>
                        <div class="flex items-center justify-center space-x-4 mb-4">
                            <div class="text-3xl">üìß</div>
                            <a href="mailto:freetoolhubcommunity@gmail.com" class="text-2xl font-semibold text-blue-600 hover:text-blue-800 transition-colors duration-300">
                                freetoolhubcommunity@gmail.com
                            </a>
                        </div>
                        <p class="text-sm text-gray-500">
                            We typically respond within 24 hours
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Contact Section -->
        <section id="contact" class="py-20 bg-gradient-to-br from-purple-600 via-blue-600 to-indigo-700">
            <div class="max-w-4xl mx-auto px-6">
                <div class="text-center mb-16">
                    <h2 class="text-4xl md:text-5xl font-bold mb-4 text-white">Get In Touch</h2>
                    <p class="text-xl text-blue-100 max-w-2xl mx-auto">
                        Have suggestions for new tools? Found a bug? We'd love to hear from you!
                    </p>
                </div>
                
                <div class="bg-white/10 backdrop-blur-lg rounded-2xl p-8 shadow-2xl">
                    <form id="contact-form" class="space-y-6">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-white font-semibold mb-2">Your Name</label>
                                <input type="text" id="contact-name" class="w-full px-4 py-3 rounded-lg border border-white/20 bg-white/10 text-white placeholder-white/70 focus:outline-none focus:ring-2 focus:ring-yellow-400" placeholder="Enter your name">
                            </div>
                            <div>
                                <label class="block text-white font-semibold mb-2">Your Email</label>
                                <input type="email" id="contact-email" class="w-full px-4 py-3 rounded-lg border border-white/20 bg-white/10 text-white placeholder-white/70 focus:outline-none focus:ring-2 focus:ring-yellow-400" placeholder="Enter your email">
                        </div>
                        </div>
                        
                        <div>
                            <label class="block text-white font-semibold mb-2">Subject</label>
                            <select id="contact-subject" class="w-full px-4 py-3 rounded-lg border border-white/20 bg-white/10 text-white focus:outline-none focus:ring-2 focus:ring-yellow-400">
                                <option value="suggestion">üí° Tool Suggestion</option>
                                <option value="bug">üêõ Bug Report</option>
                                <option value="feedback">üí¨ General Feedback</option>
                                <option value="other">‚ùì Other</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-white font-semibold mb-2">Message</label>
                            <textarea id="contact-message" rows="5" class="w-full px-4 py-3 rounded-lg border border-white/20 bg-white/10 text-white placeholder-white/70 focus:outline-none focus:ring-2 focus:ring-yellow-400 resize-none" placeholder="Tell us about your suggestion, bug report, or feedback..."></textarea>
                        </div>

                        <button type="submit" class="w-full bg-yellow-400 text-purple-900 py-4 rounded-lg text-lg font-bold hover:bg-yellow-300 transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl">
                            üìß Send Message
                        </button>
                    </form>
                    
                    <div id="contact-status" class="mt-6 text-center"></div>
        </div>
    </div>
        </section>
    </main>

    <!-- Professional Footer -->
    <footer class="bg-gradient-to-br from-gray-900 via-purple-900 to-blue-900 text-white">
        <div class="max-w-7xl mx-auto px-6 py-12">
            <!-- Footer Main Content -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 mb-8">
                
                <!-- Column 1: Popular Tools -->
                <div>
                    <h3 class="text-xl font-bold mb-4 text-yellow-400">üõ†Ô∏è Popular Tools</h3>
                    <ul class="space-y-2">
                        <li><a href="#" onclick="openModal('calculator-modal'); return false;" class="text-gray-300 hover:text-yellow-400 transition-colors">Smart Calculator</a></li>
                        <li><a href="#" onclick="openModal('study-timer-modal'); return false;" class="text-gray-300 hover:text-yellow-400 transition-colors">Study Timer</a></li>
                        <li><a href="#" onclick="openModal('loan-calculator-modal'); return false;" class="text-gray-300 hover:text-yellow-400 transition-colors">Loan Calculator</a></li>
                        <li><a href="#" onclick="openModal('json-formatter-modal'); return false;" class="text-gray-300 hover:text-yellow-400 transition-colors">JSON Formatter</a></li>
                        <li><a href="#" onclick="openModal('hash-generator-modal'); return false;" class="text-gray-300 hover:text-yellow-400 transition-colors">Hash Generator</a></li>
                        <li><a href="#tools" class="text-gray-300 hover:text-yellow-400 transition-colors font-semibold">View All Tools ‚Üí</a></li>
                    </ul>
                </div>

                <!-- Column 2: Resources -->
                <div>
                    <h3 class="text-xl font-bold mb-4 text-yellow-400">üìö Resources</h3>
                    <ul class="space-y-2">
                        <li><a href="#about" class="text-gray-300 hover:text-yellow-400 transition-colors">About Us</a></li>
                        <li><a href="#contact" class="text-gray-300 hover:text-yellow-400 transition-colors">Contact</a></li>
                        <li><a href="#" onclick="alert('FAQ Coming Soon!'); return false;" class="text-gray-300 hover:text-yellow-400 transition-colors">FAQ</a></li>
                        <li><a href="#" onclick="alert('Blog Coming Soon!'); return false;" class="text-gray-300 hover:text-yellow-400 transition-colors">Blog</a></li>
                        <li><a href="#" onclick="alert('API Coming Soon!'); return false;" class="text-gray-300 hover:text-yellow-400 transition-colors">Developer API</a></li>
                    </ul>
                </div>

                <!-- Column 3: Legal -->
                <div>
                    <h3 class="text-xl font-bold mb-4 text-yellow-400">‚öñÔ∏è Legal</h3>
                    <ul class="space-y-2">
                        <li><a href="#" onclick="openPrivacyModal(); return false;" class="text-gray-300 hover:text-yellow-400 transition-colors">Privacy Policy</a></li>
                        <li><a href="#" onclick="alert('Terms of Service Coming Soon!'); return false;" class="text-gray-300 hover:text-yellow-400 transition-colors">Terms of Service</a></li>
                        <li><a href="#" onclick="alert('Cookie Policy Coming Soon!'); return false;" class="text-gray-300 hover:text-yellow-400 transition-colors">Cookie Policy</a></li>
                        <li><a href="#" onclick="openSupportModal(); return false;" class="text-gray-300 hover:text-yellow-400 transition-colors">üíõ Support Us</a></li>
                    </ul>
                </div>

                <!-- Column 4: Connect -->
                <div>
                    <h3 class="text-xl font-bold mb-4 text-yellow-400">üîó Connect</h3>
                    <ul class="space-y-2">
                        <li><a href="mailto:freetoolhubcommunity@gmail.com" class="text-gray-300 hover:text-yellow-400 transition-colors flex items-center">
                            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path></svg>
                            Email Us
                        </a></li>
                        <li><a href="https://freetoolhub.in" target="_blank" class="text-gray-300 hover:text-yellow-400 transition-colors flex items-center">
                            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"></path></svg>
                            Visit Website
                        </a></li>
                        <li><a href="#contact" class="text-gray-300 hover:text-yellow-400 transition-colors flex items-center">
                            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path></svg>
                            Send Feedback
                        </a></li>
                    </ul>
                </div>
            </div>

            <!-- Footer Bottom -->
            <div class="border-t border-gray-700 pt-8">
                <div class="flex flex-col md:flex-row justify-between items-center">
                    <div class="mb-4 md:mb-0">
                        <p class="text-gray-400">¬© 2025 <span class="text-yellow-400 font-bold">FreeToolHub</span>. All rights reserved.</p>
                        <p class="text-gray-500 text-sm mt-1">Professional Tools, Forever Free üíõ</p>
                    </div>
                    <div class="flex items-center space-x-4">
                        <span class="text-gray-500 text-sm">Made with</span>
                        <span class="text-red-500" style="animation: heartbeat 1s ease-in-out infinite;">‚ù§Ô∏è</span>
                        <span class="text-gray-500 text-sm">for productivity</span>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- Floating Buy Me a Coffee Widget -->
    <div id="coffee-widget" class="coffee-widget" onclick="openSupportModal()">
        <div class="coffee-widget-content">
            <div class="coffee-icon">‚òï</div>
            <div class="coffee-text">
                <span class="coffee-title">Buy Me a Coffee</span>
                <span class="coffee-subtitle">Support Our Free Tools üíõ</span>
            </div>
        </div>
    </div>

    <!-- ============================================ -->
    <!-- PDF PASSWORD REMOVER MODAL -->
    <!-- ============================================ -->
    <div id="pdf-password-remover-modal" class="modal" style="display: none;">
        <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
            <div class="bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto">
                <!-- Modal Header -->
                <div class="bg-gradient-to-r from-red-500 to-pink-600 text-white p-6 flex justify-between items-center sticky top-0 z-10">
                    <div class="flex items-center gap-3">
                        <div class="text-4xl">üîì</div>
                        <div>
                            <h3 class="text-2xl font-bold">PDF Password Remover</h3>
                            <p class="text-red-100 text-sm">Remove password protection from your PDFs</p>
                        </div>
                    </div>
                    <button onclick="closeModal('pdf-password-remover-modal')" class="text-white hover:text-red-200 transition-colors">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>

                <!-- Modal Content -->
                <div class="p-6">
                    
                    <!-- Privacy Notice -->
                    <div class="bg-green-50 border-l-4 border-green-500 p-4 mb-6 rounded">
                        <div class="flex items-start">
                            <span class="text-2xl mr-3">üîí</span>
                            <div>
                                <p class="font-semibold text-green-800 mb-1">100% Private & Secure</p>
                                <p class="text-sm text-green-700">All processing happens locally in your browser. Your PDF never leaves your device!</p>
                            </div>
                        </div>
                    </div>

                    <!-- Compatibility Notice -->
                    <div class="bg-blue-50 border-l-4 border-blue-500 p-4 mb-6 rounded">
                        <div class="flex items-start">
                            <span class="text-2xl mr-3">‚ÑπÔ∏è</span>
                            <div>
                                <p class="font-semibold text-blue-800 mb-1">How It Works</p>
                                <p class="text-sm text-blue-700">This tool supports most password-protected PDFs including RC4 and AES encryption. Pages are rendered as high-quality images in the new unprotected PDF to ensure compatibility.</p>
                            </div>
                        </div>
                    </div>

                    <!-- Step 1: Upload PDF -->
                    <div class="mb-6">
                        <label class="block text-lg font-semibold text-gray-700 mb-3">
                            <span class="text-red-600">Step 1:</span> Upload Password-Protected PDF
                        </label>
                        
                        <!-- Drop Zone -->
                        <div id="pdf-password-drop-zone" class="border-2 border-dashed border-gray-300 rounded-xl p-8 text-center hover:border-red-500 transition-all cursor-pointer bg-gray-50 hover:bg-red-50">
                            <input type="file" id="pdf-password-file-input" accept=".pdf" class="hidden">
                            <div class="text-5xl mb-3">üìÅ</div>
                            <p class="text-lg font-semibold text-gray-700 mb-2">Drop PDF here or click to browse</p>
                            <p class="text-sm text-gray-500">Supports password-protected PDF files</p>
                        </div>

                        <!-- File Info -->
                        <div id="pdf-password-file-info" class="hidden mt-4 p-4 bg-blue-50 rounded-lg border border-blue-200">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    <span class="text-3xl">üìÑ</span>
                                    <div>
                                        <p id="pdf-password-filename" class="font-semibold text-gray-800"></p>
                                        <p id="pdf-password-filesize" class="text-sm text-gray-600"></p>
                                    </div>
                                </div>
                                <button onclick="clearPdfPasswordFile()" class="text-red-600 hover:text-red-700 font-semibold">
                                    Remove
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Step 2: Enter Password -->
                    <div id="pdf-password-input-section" class="mb-6 hidden">
                        <label class="block text-lg font-semibold text-gray-700 mb-3">
                            <span class="text-red-600">Step 2:</span> Enter PDF Password
                        </label>
                        <div class="relative">
                            <input type="password" id="pdf-password-input" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 text-lg" placeholder="Enter password...">
                            <button onclick="togglePasswordVisibility()" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700">
                                <svg id="password-eye-icon" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                                </svg>
                            </button>
                        </div>
                    </div>

                    <!-- Step 3: Process Button -->
                    <div id="pdf-password-process-section" class="mb-6 hidden">
                        <button onclick="removePdfPassword()" id="pdf-password-remove-btn" class="w-full bg-gradient-to-r from-red-500 to-pink-600 text-white font-bold py-4 px-6 rounded-xl hover:from-red-600 hover:to-pink-700 transition-all duration-300 transform hover:scale-105 shadow-lg text-lg">
                            üîì Remove Password & Process
                        </button>
                    </div>

                    <!-- Progress Indicator -->
                    <div id="pdf-password-progress" class="hidden mb-6">
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                            <div class="flex items-center gap-3 mb-2">
                                <div class="animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"></div>
                                <span class="font-semibold text-blue-800">Processing your PDF...</span>
                            </div>
                            <div class="w-full bg-blue-200 rounded-full h-2">
                                <div class="bg-blue-600 h-2 rounded-full animate-pulse" style="width: 70%"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Success Message -->
                    <div id="pdf-password-success" class="hidden mb-6">
                        <div class="bg-green-50 border-2 border-green-500 rounded-xl p-6 text-center">
                            <div class="text-6xl mb-4">‚úÖ</div>
                            <h4 class="text-2xl font-bold text-green-800 mb-2">Success!</h4>
                            <p class="text-green-700 mb-4">Your PDF has been unlocked successfully</p>
                            <button onclick="downloadUnprotectedPdf()" class="bg-gradient-to-r from-green-500 to-emerald-600 text-white font-bold py-3 px-8 rounded-xl hover:from-green-600 hover:to-emerald-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                üì• Download Unprotected PDF
                            </button>
                        </div>
                    </div>

                    <!-- Error Message -->
                    <div id="pdf-password-error" class="hidden mb-6">
                        <div class="bg-red-50 border-2 border-red-500 rounded-xl p-4">
                            <div class="flex items-start gap-3">
                                <span class="text-3xl">‚ö†Ô∏è</span>
                                <div>
                                    <h4 class="text-lg font-bold text-red-800 mb-1">Error</h4>
                                    <p id="pdf-password-error-message" class="text-red-700"></p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Legal Notice -->
                    <div class="bg-yellow-50 border-l-4 border-yellow-500 p-4 rounded">
                        <p class="text-sm text-yellow-800">
                            <strong>‚öñÔ∏è Legal Notice:</strong> Only remove passwords from PDFs you own or have permission to modify. Unauthorized access to protected documents may be illegal.
                        </p>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <!-- ============================================ -->
    <!-- PDF MERGER MODAL -->
    <!-- ============================================ -->
    <div id="pdf-merger-modal" class="modal" style="display: none;">
        <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
            <div class="bg-white rounded-2xl shadow-2xl w-full max-w-3xl max-h-[90vh] overflow-y-auto">
                <!-- Modal Header -->
                <div class="bg-gradient-to-r from-blue-500 to-indigo-600 text-white p-6 flex justify-between items-center sticky top-0 z-10">
                    <div class="flex items-center gap-3">
                        <div class="text-4xl">üìÑ</div>
                        <div>
                            <h3 class="text-2xl font-bold">PDF Merger</h3>
                            <p class="text-blue-100 text-sm">Combine multiple PDFs into one document</p>
                        </div>
                    </div>
                    <button onclick="closeModal('pdf-merger-modal')" class="text-white hover:text-blue-200 transition-colors">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>

                <!-- Modal Content -->
                <div class="p-6">
                    
                    <!-- Privacy Notice -->
                    <div class="bg-green-50 border-l-4 border-green-500 p-4 mb-6 rounded">
                        <div class="flex items-start">
                            <span class="text-2xl mr-3">üîí</span>
                            <div>
                                <p class="font-semibold text-green-800 mb-1">100% Private & Secure</p>
                                <p class="text-sm text-green-700">All merging happens locally in your browser. Your PDFs never leave your device!</p>
                            </div>
                        </div>
                    </div>

                    <!-- Step 1: Upload PDFs -->
                    <div class="mb-6">
                        <label class="block text-lg font-semibold text-gray-700 mb-3">
                            <span class="text-blue-600">Step 1:</span> Upload PDFs to Merge
                        </label>
                        
                        <!-- Drop Zone -->
                        <div id="pdf-merger-drop-zone" class="border-2 border-dashed border-gray-300 rounded-xl p-8 text-center hover:border-blue-500 transition-all cursor-pointer bg-gray-50 hover:bg-blue-50">
                            <input type="file" id="pdf-merger-file-input" accept=".pdf" multiple class="hidden">
                            <div class="text-5xl mb-3">üìÅ</div>
                            <p class="text-lg font-semibold text-gray-700 mb-2">Drop PDFs here or click to browse</p>
                            <p class="text-sm text-gray-500">You can select multiple PDF files at once</p>
                        </div>
                    </div>

                    <!-- Step 2: File List -->
                    <div id="pdf-merger-files-section" class="mb-6 hidden">
                        <label class="block text-lg font-semibold text-gray-700 mb-3">
                            <span class="text-blue-600">Step 2:</span> Reorder PDFs (Drag to rearrange)
                        </label>
                        
                        <div id="pdf-merger-file-list" class="space-y-2 mb-4">
                            <!-- Files will be listed here -->
                        </div>

                        <div class="flex gap-3">
                            <button onclick="document.getElementById('pdf-merger-file-input').click()" class="flex-1 bg-gray-100 text-gray-700 font-semibold py-3 px-6 rounded-xl hover:bg-gray-200 transition-all">
                                ‚ûï Add More PDFs
                            </button>
                            <button onclick="clearAllPdfMergerFiles()" class="bg-red-100 text-red-700 font-semibold py-3 px-6 rounded-xl hover:bg-red-200 transition-all">
                                üóëÔ∏è Clear All
                            </button>
                        </div>
                    </div>

                    <!-- Step 3: Merge Button -->
                    <div id="pdf-merger-merge-section" class="mb-6 hidden">
                        <button onclick="mergePdfs()" id="pdf-merger-merge-btn" class="w-full bg-gradient-to-r from-blue-500 to-indigo-600 text-white font-bold py-4 px-6 rounded-xl hover:from-blue-600 hover:to-indigo-700 transition-all duration-300 transform hover:scale-105 shadow-lg text-lg">
                            üîó Merge PDFs
                        </button>
                    </div>

                    <!-- Progress Indicator -->
                    <div id="pdf-merger-progress" class="hidden mb-6">
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                            <div class="flex items-center gap-3 mb-2">
                                <div class="animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"></div>
                                <span class="font-semibold text-blue-800">Merging PDFs...</span>
                            </div>
                            <div class="w-full bg-blue-200 rounded-full h-2">
                                <div id="pdf-merger-progress-bar" class="bg-blue-600 h-2 rounded-full transition-all" style="width: 0%"></div>
                            </div>
                            <p id="pdf-merger-progress-text" class="text-sm text-blue-700 mt-2"></p>
                        </div>
                    </div>

                    <!-- Success Message -->
                    <div id="pdf-merger-success" class="hidden mb-6">
                        <div class="bg-green-50 border-2 border-green-500 rounded-xl p-6 text-center">
                            <div class="text-6xl mb-4">‚úÖ</div>
                            <h4 class="text-2xl font-bold text-green-800 mb-2">Success!</h4>
                            <p class="text-green-700 mb-4">Your PDFs have been merged successfully</p>
                            <button onclick="downloadMergedPdf()" class="bg-gradient-to-r from-green-500 to-emerald-600 text-white font-bold py-3 px-8 rounded-xl hover:from-green-600 hover:to-emerald-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                üì• Download Merged PDF
                            </button>
                        </div>
                    </div>

                    <!-- Error Message -->
                    <div id="pdf-merger-error" class="hidden mb-6">
                        <div class="bg-red-50 border-2 border-red-500 rounded-xl p-4">
                            <div class="flex items-start gap-3">
                                <span class="text-3xl">‚ö†Ô∏è</span>
                                <div>
                                    <h4 class="text-lg font-bold text-red-800 mb-1">Error</h4>
                                    <p id="pdf-merger-error-message" class="text-red-700"></p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Info -->
                    <div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded">
                        <p class="text-sm text-blue-800">
                            <strong>üí° Tip:</strong> PDFs will be merged in the order shown above. Drag and drop to reorder them before merging.
                        </p>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <!-- ============================================ -->
    <!-- PDF SPLITTER MODAL -->
    <!-- ============================================ -->
    <div id="pdf-splitter-modal" class="modal" style="display: none;">
        <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
            <div class="bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto">
                <!-- Modal Header -->
                <div class="bg-gradient-to-r from-green-500 to-teal-600 text-white p-6 flex justify-between items-center sticky top-0 z-10">
                    <div class="flex items-center gap-3">
                        <div class="text-4xl">‚úÇÔ∏è</div>
                        <div>
                            <h3 class="text-2xl font-bold">PDF Splitter</h3>
                            <p class="text-green-100 text-sm">Split PDFs into separate pages or ranges</p>
                        </div>
                    </div>
                    <button onclick="closeModal('pdf-splitter-modal')" class="text-white hover:text-green-200 transition-colors">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>

                <!-- Modal Content -->
                <div class="p-6">
                    
                    <!-- Privacy Notice -->
                    <div class="bg-green-50 border-l-4 border-green-500 p-4 mb-6 rounded">
                        <div class="flex items-start">
                            <span class="text-2xl mr-3">üîí</span>
                            <div>
                                <p class="font-semibold text-green-800 mb-1">100% Private & Secure</p>
                                <p class="text-sm text-green-700">All splitting happens locally in your browser. Your PDF never leaves your device!</p>
                            </div>
                        </div>
                    </div>

                    <!-- Step 1: Upload PDF -->
                    <div class="mb-6">
                        <label class="block text-lg font-semibold text-gray-700 mb-3">
                            <span class="text-green-600">Step 1:</span> Upload PDF to Split
                        </label>
                        
                        <!-- Drop Zone -->
                        <div id="pdf-splitter-drop-zone" class="border-2 border-dashed border-gray-300 rounded-xl p-8 text-center hover:border-green-500 transition-all cursor-pointer bg-gray-50 hover:bg-green-50">
                            <input type="file" id="pdf-splitter-file-input" accept=".pdf" class="hidden">
                            <div class="text-5xl mb-3">üìÅ</div>
                            <p class="text-lg font-semibold text-gray-700 mb-2">Drop PDF here or click to browse</p>
                            <p class="text-sm text-gray-500">Upload a PDF file to split</p>
                        </div>

                        <!-- File Info -->
                        <div id="pdf-splitter-file-info" class="hidden mt-4 p-4 bg-blue-50 rounded-lg border border-blue-200">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    <span class="text-3xl">üìÑ</span>
                                    <div>
                                        <p id="pdf-splitter-filename" class="font-semibold text-gray-800"></p>
                                        <p id="pdf-splitter-fileinfo" class="text-sm text-gray-600"></p>
                                    </div>
                                </div>
                                <button onclick="clearPdfSplitterFile()" class="text-red-600 hover:text-red-700 font-semibold">
                                    Remove
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Step 2: Split Options -->
                    <div id="pdf-splitter-options-section" class="mb-6 hidden">
                        <label class="block text-lg font-semibold text-gray-700 mb-3">
                            <span class="text-green-600">Step 2:</span> Choose Split Method
                        </label>

                        <div class="space-y-3">
                            <!-- Option 1: All Pages -->
                            <label class="flex items-start p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-green-500 hover:bg-green-50 transition-all">
                                <input type="radio" name="split-method" value="all" class="mt-1 mr-3" checked onchange="updateSplitMethod()">
                                <div>
                                    <p class="font-semibold text-gray-800">Extract All Pages Separately</p>
                                    <p class="text-sm text-gray-600">Each page becomes a separate PDF file</p>
                                </div>
                            </label>

                            <!-- Option 2: Specific Pages -->
                            <label class="flex items-start p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-green-500 hover:bg-green-50 transition-all">
                                <input type="radio" name="split-method" value="specific" class="mt-1 mr-3" onchange="updateSplitMethod()">
                                <div class="flex-1">
                                    <p class="font-semibold text-gray-800">Extract Specific Pages</p>
                                    <p class="text-sm text-gray-600 mb-2">Enter page numbers separated by commas</p>
                                    <input type="text" id="pdf-splitter-specific-pages" placeholder="e.g., 1, 3, 5, 7" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" disabled>
                                </div>
                            </label>

                            <!-- Option 3: Page Range -->
                            <label class="flex items-start p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-green-500 hover:bg-green-50 transition-all">
                                <input type="radio" name="split-method" value="range" class="mt-1 mr-3" onchange="updateSplitMethod()">
                                <div class="flex-1">
                                    <p class="font-semibold text-gray-800">Extract Page Range</p>
                                    <p class="text-sm text-gray-600 mb-2">Enter start and end page numbers</p>
                                    <div class="flex gap-3">
                                        <input type="number" id="pdf-splitter-range-start" placeholder="From" min="1" class="w-1/2 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" disabled>
                                        <input type="number" id="pdf-splitter-range-end" placeholder="To" min="1" class="w-1/2 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" disabled>
                                    </div>
                                </div>
                            </label>
                        </div>
                    </div>

                    <!-- Step 3: Split Button -->
                    <div id="pdf-splitter-split-section" class="mb-6 hidden">
                        <button onclick="splitPdf()" id="pdf-splitter-split-btn" class="w-full bg-gradient-to-r from-green-500 to-teal-600 text-white font-bold py-4 px-6 rounded-xl hover:from-green-600 hover:to-teal-700 transition-all duration-300 transform hover:scale-105 shadow-lg text-lg">
                            ‚úÇÔ∏è Split PDF
                        </button>
                    </div>

                    <!-- Progress Indicator -->
                    <div id="pdf-splitter-progress" class="hidden mb-6">
                        <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                            <div class="flex items-center gap-3 mb-2">
                                <div class="animate-spin rounded-full h-6 w-6 border-b-2 border-green-600"></div>
                                <span class="font-semibold text-green-800">Splitting PDF...</span>
                            </div>
                            <div class="w-full bg-green-200 rounded-full h-2">
                                <div id="pdf-splitter-progress-bar" class="bg-green-600 h-2 rounded-full transition-all" style="width: 0%"></div>
                            </div>
                            <p id="pdf-splitter-progress-text" class="text-sm text-green-700 mt-2"></p>
                        </div>
                    </div>

                    <!-- Success Message -->
                    <div id="pdf-splitter-success" class="hidden mb-6">
                        <div class="bg-green-50 border-2 border-green-500 rounded-xl p-6 text-center">
                            <div class="text-6xl mb-4">‚úÖ</div>
                            <h4 class="text-2xl font-bold text-green-800 mb-2">Success!</h4>
                            <p id="pdf-splitter-success-text" class="text-green-700 mb-4">Your PDF has been split successfully</p>
                            <button onclick="downloadSplitPdfs()" class="bg-gradient-to-r from-green-500 to-emerald-600 text-white font-bold py-3 px-8 rounded-xl hover:from-green-600 hover:to-emerald-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                üì• Download Pages as ZIP
                            </button>
                        </div>
                    </div>

                    <!-- Error Message -->
                    <div id="pdf-splitter-error" class="hidden mb-6">
                        <div class="bg-red-50 border-2 border-red-500 rounded-xl p-4">
                            <div class="flex items-start gap-3">
                                <span class="text-3xl">‚ö†Ô∏è</span>
                                <div>
                                    <h4 class="text-lg font-bold text-red-800 mb-1">Error</h4>
                                    <p id="pdf-splitter-error-message" class="text-red-700"></p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Info -->
                    <div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded">
                        <p class="text-sm text-blue-800">
                            <strong>üí° Tip:</strong> All extracted pages will be downloaded as a ZIP file. Each page will be saved as a separate PDF.
                        </p>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <!-- ============================================ -->
    <!-- PDF ENCRYPTOR MODAL -->
    <!-- ============================================ -->
    <div id="pdf-encryptor-modal" class="modal" style="display: none;">
        <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
            <div class="bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto">
                <!-- Modal Header -->
                <div class="bg-gradient-to-r from-purple-500 to-pink-600 text-white p-6 flex justify-between items-center sticky top-0 z-10">
                    <div class="flex items-center gap-3">
                        <div class="text-4xl">üîí</div>
                        <div>
                            <h3 class="text-2xl font-bold">PDF Encryptor</h3>
                            <p class="text-purple-100 text-sm">Add password protection to your PDFs</p>
                        </div>
                    </div>
                    <button onclick="closeModal('pdf-encryptor-modal')" class="text-white hover:text-purple-200 transition-colors">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>

                <!-- Modal Content -->
                <div class="p-6">
                    
                    <!-- Privacy Notice -->
                    <div class="bg-green-50 border-l-4 border-green-500 p-4 mb-6 rounded">
                        <div class="flex items-start">
                            <span class="text-2xl mr-3">üîí</span>
                            <div>
                                <p class="font-semibold text-green-800 mb-1">100% Private & Secure</p>
                                <p class="text-sm text-green-700">All encryption happens locally in your browser. Your PDF and password never leave your device!</p>
                            </div>
                        </div>
                    </div>

                    <!-- Step 1: Upload PDF -->
                    <div class="mb-6">
                        <label class="block text-lg font-semibold text-gray-700 mb-3">
                            <span class="text-purple-600">Step 1:</span> Upload PDF to Protect
                        </label>
                        
                        <!-- Drop Zone -->
                        <div id="pdf-encryptor-drop-zone" class="border-2 border-dashed border-gray-300 rounded-xl p-8 text-center hover:border-purple-500 transition-all cursor-pointer bg-gray-50 hover:bg-purple-50">
                            <input type="file" id="pdf-encryptor-file-input" accept=".pdf" class="hidden">
                            <div class="text-5xl mb-3">üìÅ</div>
                            <p class="text-lg font-semibold text-gray-700 mb-2">Drop PDF here or click to browse</p>
                            <p class="text-sm text-gray-500">Upload a PDF file to encrypt</p>
                        </div>

                        <!-- File Info -->
                        <div id="pdf-encryptor-file-info" class="hidden mt-4 p-4 bg-blue-50 rounded-lg border border-blue-200">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    <span class="text-3xl">üìÑ</span>
                                    <div>
                                        <p id="pdf-encryptor-filename" class="font-semibold text-gray-800"></p>
                                        <p id="pdf-encryptor-filesize" class="text-sm text-gray-600"></p>
                                    </div>
                                </div>
                                <button onclick="clearPdfEncryptorFile()" class="text-red-600 hover:text-red-700 font-semibold">
                                    Remove
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Step 2: Set Password -->
                    <div id="pdf-encryptor-password-section" class="mb-6 hidden">
                        <label class="block text-lg font-semibold text-gray-700 mb-3">
                            <span class="text-purple-600">Step 2:</span> Set Password
                        </label>
                        
                        <!-- Password Input -->
                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-600 mb-2">Password</label>
                            <div class="relative">
                                <input type="password" id="pdf-encryptor-password" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="Enter password..." oninput="checkEncryptPasswordStrength()">
                                <button type="button" onclick="toggleEncryptPasswordVisibility('pdf-encryptor-password')" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700">
                                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                                    </svg>
                                </button>
                            </div>
                        </div>

                        <!-- Confirm Password -->
                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-600 mb-2">Confirm Password</label>
                            <div class="relative">
                                <input type="password" id="pdf-encryptor-password-confirm" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="Re-enter password..." oninput="checkPasswordMatch()">
                                <button type="button" onclick="toggleEncryptPasswordVisibility('pdf-encryptor-password-confirm')" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700">
                                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                                    </svg>
                                </button>
                            </div>
                            <p id="pdf-encryptor-password-match" class="text-sm mt-1 hidden"></p>
                        </div>

                        <!-- Password Strength Indicator -->
                        <div id="pdf-encryptor-strength-section" class="hidden mb-4">
                            <label class="block text-sm font-medium text-gray-600 mb-2">Password Strength</label>
                            <div class="flex items-center gap-3">
                                <div class="flex-1 bg-gray-200 rounded-full h-2">
                                    <div id="pdf-encryptor-strength-bar" class="h-2 rounded-full transition-all" style="width: 0%"></div>
                                </div>
                                <span id="pdf-encryptor-strength-text" class="text-sm font-semibold"></span>
                            </div>
                        </div>
                    </div>

                    <!-- Step 3: Encrypt Button -->
                    <div id="pdf-encryptor-encrypt-section" class="mb-6 hidden">
                        <button onclick="encryptPdf()" id="pdf-encryptor-encrypt-btn" class="w-full bg-gradient-to-r from-purple-500 to-pink-600 text-white font-bold py-4 px-6 rounded-xl hover:from-purple-600 hover:to-pink-700 transition-all duration-300 transform hover:scale-105 shadow-lg text-lg">
                            üîí Encrypt PDF
                        </button>
                    </div>

                    <!-- Progress Indicator -->
                    <div id="pdf-encryptor-progress" class="hidden mb-6">
                        <div class="bg-purple-50 border border-purple-200 rounded-lg p-4">
                            <div class="flex items-center gap-3 mb-2">
                                <div class="animate-spin rounded-full h-6 w-6 border-b-2 border-purple-600"></div>
                                <span class="font-semibold text-purple-800">Encrypting your PDF...</span>
                            </div>
                            <div class="w-full bg-purple-200 rounded-full h-2">
                                <div class="bg-purple-600 h-2 rounded-full animate-pulse" style="width: 70%"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Success Message -->
                    <div id="pdf-encryptor-success" class="hidden mb-6">
                        <div class="bg-green-50 border-2 border-green-500 rounded-xl p-6 text-center">
                            <div class="text-6xl mb-4">‚úÖ</div>
                            <h4 class="text-2xl font-bold text-green-800 mb-2">Success!</h4>
                            <p class="text-green-700 mb-4">Your PDF has been encrypted successfully</p>
                            <button onclick="downloadEncryptedPdf()" class="bg-gradient-to-r from-green-500 to-emerald-600 text-white font-bold py-3 px-8 rounded-xl hover:from-green-600 hover:to-emerald-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                üì• Download Protected PDF
                            </button>
                            <p class="text-sm text-gray-600 mt-4">‚ö†Ô∏è Make sure to remember your password!</p>
                        </div>
                    </div>

                    <!-- Error Message -->
                    <div id="pdf-encryptor-error" class="hidden mb-6">
                        <div class="bg-red-50 border-2 border-red-500 rounded-xl p-4">
                            <div class="flex items-start gap-3">
                                <span class="text-3xl">‚ö†Ô∏è</span>
                                <div>
                                    <h4 class="text-lg font-bold text-red-800 mb-1">Error</h4>
                                    <p id="pdf-encryptor-error-message" class="text-red-700"></p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Security Info -->
                    <div class="bg-yellow-50 border-l-4 border-yellow-500 p-4 rounded">
                        <p class="text-sm text-yellow-800">
                            <strong>üîê Security Note:</strong> Uses PyPDF2 (Python library) for industry-standard AES-128 encryption. First use may take 10-20 seconds to load the encryption engine. Make sure to use a strong password and keep it safe!
                        </p>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <!-- ============================================ -->
    <!-- PDF TO IMAGES MODAL -->
    <!-- ============================================ -->
    <div id="pdf-to-images-modal" class="modal" style="display: none;">
        <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
            <div class="bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto">
                <!-- Modal Header -->
                <div class="bg-gradient-to-r from-orange-500 to-yellow-600 text-white p-6 flex justify-between items-center sticky top-0 z-10">
                    <div class="flex items-center gap-3">
                        <div class="text-4xl">üñºÔ∏è</div>
                        <div>
                            <h3 class="text-2xl font-bold">PDF to Images</h3>
                            <p class="text-orange-100 text-sm">Convert PDF pages to JPG or PNG images</p>
                        </div>
                    </div>
                    <button onclick="closeModal('pdf-to-images-modal')" class="text-white hover:text-orange-200 transition-colors">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>

                <!-- Modal Content -->
                <div class="p-6">
                    
                    <!-- Privacy Notice -->
                    <div class="bg-green-50 border-l-4 border-green-500 p-4 mb-6 rounded">
                        <div class="flex items-start">
                            <span class="text-2xl mr-3">üîí</span>
                            <div>
                                <p class="font-semibold text-green-800 mb-1">100% Private & Secure</p>
                                <p class="text-sm text-green-700">All processing happens locally in your browser. Your PDF never leaves your device!</p>
                            </div>
                        </div>
                    </div>

                    <!-- Step 1: Upload PDF -->
                    <div class="mb-6">
                        <label class="block text-lg font-semibold text-gray-700 mb-3">
                            <span class="text-orange-600">Step 1:</span> Upload PDF
                        </label>
                        
                        <!-- Drop Zone -->
                        <div id="pdf-to-images-drop-zone" class="border-2 border-dashed border-gray-300 rounded-xl p-8 text-center hover:border-orange-500 transition-all cursor-pointer bg-gray-50 hover:bg-orange-50">
                            <input type="file" id="pdf-to-images-file-input" accept=".pdf" class="hidden">
                            <div class="text-5xl mb-3">üìÑ</div>
                            <p class="text-lg font-semibold text-gray-700 mb-2">Drop PDF here or click to browse</p>
                            <p class="text-sm text-gray-500">Supports all PDF files</p>
                        </div>

                        <!-- File Info -->
                        <div id="pdf-to-images-file-info" class="hidden mt-4 p-4 bg-blue-50 rounded-lg border border-blue-200">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    <span class="text-3xl">üìÑ</span>
                                    <div>
                                        <p id="pdf-to-images-filename" class="font-semibold text-gray-800"></p>
                                        <p id="pdf-to-images-filesize" class="text-sm text-gray-600"></p>
                                    </div>
                                </div>
                                <button onclick="clearPdfToImagesFile()" class="text-red-600 hover:text-red-700 font-semibold">
                                    Remove
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Step 2: Configure Options -->
                    <div id="pdf-to-images-options-section" class="hidden mb-6">
                        <label class="block text-lg font-semibold text-gray-700 mb-3">
                            <span class="text-orange-600">Step 2:</span> Configure Options
                        </label>

                        <!-- Output Format -->
                        <div class="mb-4">
                            <label class="block text-sm font-semibold text-gray-700 mb-2">Output Format</label>
                            <div class="grid grid-cols-2 gap-3">
                                <label class="border-2 border-orange-300 rounded-lg p-4 cursor-pointer hover:bg-orange-50 transition-all">
                                    <input type="radio" name="pdf-to-images-format" value="jpeg" checked class="mr-2">
                                    <span class="font-semibold">JPG</span>
                                    <p class="text-xs text-gray-600 mt-1">Smaller file size</p>
                                </label>
                                <label class="border-2 border-gray-300 rounded-lg p-4 cursor-pointer hover:bg-orange-50 transition-all">
                                    <input type="radio" name="pdf-to-images-format" value="png" class="mr-2">
                                    <span class="font-semibold">PNG</span>
                                    <p class="text-xs text-gray-600 mt-1">Lossless quality</p>
                                </label>
                            </div>
                        </div>

                        <!-- Image Quality -->
                        <div class="mb-4">
                            <label class="block text-sm font-semibold text-gray-700 mb-2">
                                Image Quality: <span id="pdf-to-images-quality-value" class="text-orange-600">90%</span>
                            </label>
                            <input type="range" id="pdf-to-images-quality" min="50" max="100" value="90" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                            <div class="flex justify-between text-xs text-gray-500 mt-1">
                                <span>50%</span>
                                <span>65%</span>
                                <span>80%</span>
                                <span>95%</span>
                                <span>100%</span>
                            </div>
                        </div>

                        <!-- Resolution Scale -->
                        <div class="mb-4">
                            <label class="block text-sm font-semibold text-gray-700 mb-2">
                                Resolution Scale: <span id="pdf-to-images-scale-value" class="text-orange-600">2x (High Quality)</span>
                            </label>
                            <input type="range" id="pdf-to-images-scale" min="1" max="3" step="0.5" value="2" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                            <div class="flex justify-between text-xs text-gray-500 mt-1">
                                <span>1x</span>
                                <span>1.5x</span>
                                <span>2x</span>
                                <span>2.5x</span>
                                <span>3x</span>
                            </div>
                        </div>

                        <!-- Page Selection -->
                        <div class="mb-4">
                            <label class="block text-sm font-semibold text-gray-700 mb-2">Pages to Convert</label>
                            <div class="space-y-2">
                                <label class="flex items-center">
                                    <input type="radio" name="pdf-to-images-pages" value="all" checked class="mr-2">
                                    <span>All pages (<span id="pdf-to-images-total-pages">0</span> pages)</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="radio" name="pdf-to-images-pages" value="specific" class="mr-2">
                                    <span>Specific pages</span>
                                </label>
                                <input type="text" id="pdf-to-images-page-range" placeholder="e.g., 1,3-5,7" class="w-full px-4 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 disabled:bg-gray-100" disabled>
                                <p class="text-xs text-gray-500">Enter page numbers separated by commas. Use hyphen for ranges.</p>
                            </div>
                        </div>
                    </div>

                    <!-- Step 3: Convert -->
                    <div id="pdf-to-images-convert-section" class="hidden mb-6">
                        <button onclick="convertPdfToImages()" id="pdf-to-images-convert-btn" class="w-full bg-gradient-to-r from-orange-500 to-yellow-600 text-white font-bold py-4 px-6 rounded-xl hover:from-orange-600 hover:to-yellow-700 transition-all duration-300 transform hover:scale-105 shadow-lg text-lg">
                            üñºÔ∏è Convert PDF to Images
                        </button>
                    </div>

                    <!-- Progress Bar -->
                    <div id="pdf-to-images-progress" class="hidden mb-6">
                        <div class="bg-blue-50 border-2 border-blue-500 rounded-xl p-4">
                            <div class="flex items-center gap-3 mb-3">
                                <div class="animate-spin">‚è≥</div>
                                <span class="font-semibold text-blue-800" id="pdf-to-images-progress-text">Processing your PDF...</span>
                            </div>
                            <div class="w-full bg-blue-200 rounded-full h-4 overflow-hidden">
                                <div id="pdf-to-images-progress-bar" class="bg-gradient-to-r from-orange-500 to-yellow-600 h-4 rounded-full transition-all duration-300" style="width: 0%"></div>
                            </div>
                            <p class="text-sm text-blue-700 mt-2" id="pdf-to-images-progress-percent">0%</p>
                        </div>
                    </div>

                    <!-- Success Message -->
                    <div id="pdf-to-images-success" class="hidden mb-6">
                        <div class="bg-green-50 border-2 border-green-500 rounded-xl p-4">
                            <div class="flex items-start gap-3 mb-4">
                                <span class="text-3xl">‚úÖ</span>
                                <div class="flex-1">
                                    <h4 class="text-lg font-bold text-green-800 mb-1">Success!</h4>
                                    <p class="text-green-700 mb-2"><span id="pdf-to-images-success-count">0</span> images ready</p>
                                    
                                    <!-- Preview Thumbnails -->
                                    <div class="mb-3">
                                        <p class="text-sm font-semibold text-gray-700 mb-2">Preview:</p>
                                        <div id="pdf-to-images-preview" class="flex flex-wrap gap-2 max-h-32 overflow-y-auto"></div>
                                    </div>
                                    
                                    <p class="text-sm text-gray-600">Total size: <span id="pdf-to-images-total-size">~0 MB</span></p>
                                </div>
                            </div>
                            <button onclick="downloadImagesAsZip()" class="w-full bg-gradient-to-r from-green-500 to-emerald-600 text-white font-bold py-3 px-8 rounded-xl hover:from-green-600 hover:to-emerald-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                üì• Download All Images as ZIP
                            </button>
                        </div>
                        
                        <p class="text-xs text-gray-500 mt-3 text-center">
                            ‚ÑπÔ∏è Images will be named: <span id="pdf-to-images-naming-example"></span>
                        </p>
                    </div>

                    <!-- Error Message -->
                    <div id="pdf-to-images-error" class="hidden mb-6">
                        <div class="bg-red-50 border-2 border-red-500 rounded-xl p-4">
                            <div class="flex items-start gap-3">
                                <span class="text-3xl">‚ö†Ô∏è</span>
                                <div>
                                    <h4 class="text-lg font-bold text-red-800 mb-1">Error</h4>
                                    <p id="pdf-to-images-error-message" class="text-red-700"></p>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <!-- ============================================ -->
    <!-- IMAGE TO PDF MODAL -->
    <!-- ============================================ -->
    <div id="image-to-pdf-modal" class="modal" style="display: none;">
        <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
            <div class="bg-white rounded-2xl shadow-2xl w-full max-w-3xl max-h-[90vh] overflow-y-auto">
                <!-- Modal Header -->
                <div class="bg-gradient-to-r from-indigo-500 to-purple-600 text-white p-6 flex justify-between items-center sticky top-0 z-10">
                    <div class="flex items-center gap-3">
                        <div class="text-4xl">üì∏</div>
                        <div>
                            <h3 class="text-2xl font-bold">Image to PDF Converter</h3>
                            <p class="text-indigo-100 text-sm">Convert multiple images to a single PDF document</p>
                        </div>
                    </div>
                    <button onclick="closeModal('image-to-pdf-modal')" class="text-white hover:text-indigo-200 transition-colors">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>

                <!-- Modal Content -->
                <div class="p-6">
                    
                    <!-- Privacy Notice -->
                    <div class="bg-green-50 border-l-4 border-green-500 p-4 mb-6 rounded">
                        <div class="flex items-start">
                            <span class="text-2xl mr-3">üîí</span>
                            <div>
                                <p class="font-semibold text-green-800 mb-1">100% Private & Secure</p>
                                <p class="text-sm text-green-700">All processing happens locally in your browser. Your images never leave your device!</p>
                            </div>
                        </div>
                    </div>

                    <!-- Step 1: Upload Images -->
                    <div class="mb-6">
                        <label class="block text-lg font-semibold text-gray-700 mb-3">
                            <span class="text-indigo-600">Step 1:</span> Upload Images
                        </label>
                        
                        <!-- Drop Zone -->
                        <div id="image-to-pdf-drop-zone" class="border-2 border-dashed border-gray-300 rounded-xl p-8 text-center hover:border-indigo-500 transition-all cursor-pointer bg-gray-50 hover:bg-indigo-50">
                            <input type="file" id="image-to-pdf-file-input" accept="image/*" multiple class="hidden">
                            <div class="text-5xl mb-3">üìÅ</div>
                            <p class="text-lg font-semibold text-gray-700 mb-2">Drop images here or click to browse</p>
                            <p class="text-sm text-gray-500">Supports: JPG, PNG, WebP, GIF - Select multiple files</p>
                        </div>

                        <!-- Image Preview Grid -->
                        <div id="image-to-pdf-preview-section" class="hidden mt-4">
                            <div class="flex items-center justify-between mb-3 p-3 bg-blue-50 rounded-lg">
                                <p class="font-semibold text-gray-700">
                                    Uploaded: <span id="image-to-pdf-count" class="text-indigo-600 text-xl">0</span> images
                                </p>
                                <button onclick="clearAllImagesForPdf()" class="text-red-600 hover:text-red-700 text-sm font-semibold px-3 py-1 bg-white rounded-lg hover:bg-red-50 transition-all">
                                    Clear All
                                </button>
                            </div>
                            <div id="image-to-pdf-preview-grid" class="grid grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-3 p-3 bg-gray-50 rounded-lg">
                                <!-- Image previews will be added here -->
                            </div>
                            <p class="text-xs text-gray-500 text-center mt-2">üí° Tip: Images will appear in PDF in the order shown above</p>
                        </div>
                    </div>

                    <!-- Step 2: PDF Settings -->
                    <div id="image-to-pdf-settings-section" class="hidden mb-6">
                        <label class="block text-lg font-semibold text-gray-700 mb-3">
                            <span class="text-indigo-600">Step 2:</span> Configure PDF Settings
                        </label>

                        <div class="space-y-4">
                            <!-- Page Size -->
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">Page Size</label>
                                <div class="grid grid-cols-3 gap-3">
                                    <label class="border-2 border-indigo-300 rounded-lg p-3 cursor-pointer hover:bg-indigo-50 transition-all text-center">
                                        <input type="radio" name="image-to-pdf-page-size" value="a4" checked class="mb-2">
                                        <div class="font-semibold text-sm">A4</div>
                                        <div class="text-xs text-gray-600">210 √ó 297 mm</div>
                                    </label>
                                    <label class="border-2 border-gray-300 rounded-lg p-3 cursor-pointer hover:bg-indigo-50 transition-all text-center">
                                        <input type="radio" name="image-to-pdf-page-size" value="letter" class="mb-2">
                                        <div class="font-semibold text-sm">Letter</div>
                                        <div class="text-xs text-gray-600">8.5 √ó 11 in</div>
                                    </label>
                                    <label class="border-2 border-gray-300 rounded-lg p-3 cursor-pointer hover:bg-indigo-50 transition-all text-center">
                                        <input type="radio" name="image-to-pdf-page-size" value="a5" class="mb-2">
                                        <div class="font-semibold text-sm">A5</div>
                                        <div class="text-xs text-gray-600">148 √ó 210 mm</div>
                                    </label>
                                </div>
                            </div>

                            <!-- Orientation -->
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">Orientation</label>
                                <div class="grid grid-cols-2 gap-3">
                                    <label class="border-2 border-indigo-300 rounded-lg p-3 cursor-pointer hover:bg-indigo-50 transition-all text-center">
                                        <input type="radio" name="image-to-pdf-orientation" value="portrait" checked class="mb-2">
                                        <div class="font-semibold">üìÑ Portrait</div>
                                    </label>
                                    <label class="border-2 border-gray-300 rounded-lg p-3 cursor-pointer hover:bg-indigo-50 transition-all text-center">
                                        <input type="radio" name="image-to-pdf-orientation" value="landscape" class="mb-2">
                                        <div class="font-semibold">üìÑ Landscape</div>
                                    </label>
                                </div>
                            </div>

                            <!-- Image Fit -->
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">Image Fit</label>
                                <div class="grid grid-cols-3 gap-3">
                                    <label class="border-2 border-indigo-300 rounded-lg p-3 cursor-pointer hover:bg-indigo-50 transition-all text-center">
                                        <input type="radio" name="image-to-pdf-fit" value="fit" checked class="mb-2">
                                        <div class="font-semibold text-sm">Fit to Page</div>
                                        <div class="text-xs text-gray-600">Maintain ratio</div>
                                    </label>
                                    <label class="border-2 border-gray-300 rounded-lg p-3 cursor-pointer hover:bg-indigo-50 transition-all text-center">
                                        <input type="radio" name="image-to-pdf-fit" value="stretch" class="mb-2">
                                        <div class="font-semibold text-sm">Stretch</div>
                                        <div class="text-xs text-gray-600">Fill page</div>
                                    </label>
                                    <label class="border-2 border-gray-300 rounded-lg p-3 cursor-pointer hover:bg-indigo-50 transition-all text-center">
                                        <input type="radio" name="image-to-pdf-fit" value="original" class="mb-2">
                                        <div class="font-semibold text-sm">Original</div>
                                        <div class="text-xs text-gray-600">No scaling</div>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 3: Convert -->
                    <div id="image-to-pdf-convert-section" class="hidden mb-6">
                        <button onclick="convertImagesToPdf()" id="image-to-pdf-convert-btn" class="w-full bg-gradient-to-r from-indigo-500 to-purple-600 text-white font-bold py-4 px-6 rounded-xl hover:from-indigo-600 hover:to-purple-700 transition-all duration-300 transform hover:scale-105 shadow-lg text-lg">
                            üìÑ Convert to PDF
                        </button>
                    </div>

                    <!-- Progress Bar -->
                    <div id="image-to-pdf-progress" class="hidden mb-6">
                        <div class="bg-blue-50 border-2 border-blue-500 rounded-xl p-4">
                            <div class="flex items-center gap-3 mb-3">
                                <div class="animate-spin">‚è≥</div>
                                <span class="font-semibold text-blue-800" id="image-to-pdf-progress-text">Converting images to PDF...</span>
                            </div>
                            <div class="w-full bg-blue-200 rounded-full h-4 overflow-hidden">
                                <div id="image-to-pdf-progress-bar" class="bg-gradient-to-r from-indigo-500 to-purple-600 h-4 rounded-full transition-all duration-300" style="width: 0%"></div>
                            </div>
                            <p class="text-sm text-blue-700 mt-2" id="image-to-pdf-progress-percent">0%</p>
                        </div>
                    </div>

                    <!-- Success Message -->
                    <div id="image-to-pdf-success" class="hidden mb-6">
                        <div class="bg-green-50 border-2 border-green-500 rounded-xl p-4">
                            <div class="flex items-center gap-3 mb-4">
                                <span class="text-4xl">‚úÖ</span>
                                <div class="flex-1">
                                    <h4 class="text-lg font-bold text-green-800 mb-1">Success!</h4>
                                    <p class="text-green-700">PDF created successfully</p>
                                    <p class="text-sm text-gray-600 mt-1">
                                        <span id="image-to-pdf-page-count">0</span> pages ‚Ä¢ 
                                        <span id="image-to-pdf-file-size">0 MB</span>
                                    </p>
                                </div>
                            </div>
                            <button onclick="downloadImageToPdf()" class="w-full bg-gradient-to-r from-green-500 to-emerald-600 text-white font-bold py-3 px-8 rounded-xl hover:from-green-600 hover:to-emerald-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                üì• Download PDF
                            </button>
                        </div>
                    </div>

                    <!-- Error Message -->
                    <div id="image-to-pdf-error" class="hidden mb-6">
                        <div class="bg-red-50 border-2 border-red-500 rounded-xl p-4">
                            <div class="flex items-start gap-3">
                                <span class="text-3xl">‚ö†Ô∏è</span>
                                <div>
                                    <h4 class="text-lg font-bold text-red-800 mb-1">Error</h4>
                                    <p id="image-to-pdf-error-message" class="text-red-700"></p>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <!-- ============================================ -->
    <!-- IMAGE COMPRESSOR MODAL -->
    <!-- ============================================ -->
    <div id="image-compressor-modal" class="modal" style="display: none;">
        <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
            <div class="bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto">
                <!-- Modal Header -->
                <div class="bg-gradient-to-r from-green-500 to-emerald-600 text-white p-6 flex justify-between items-center sticky top-0 z-10">
                    <div class="flex items-center gap-3">
                        <div class="text-4xl">üìè</div>
                        <div>
                            <h3 class="text-2xl font-bold">Image Compressor</h3>
                            <p class="text-green-100 text-sm">Reduce image file size while maintaining quality</p>
                        </div>
                    </div>
                    <button onclick="closeModal('image-compressor-modal')" class="text-white hover:text-green-200 transition-colors">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>

                <!-- Modal Content -->
                <div class="p-6">
                    
                    <!-- Privacy Notice -->
                    <div class="bg-green-50 border-l-4 border-green-500 p-4 mb-6 rounded">
                        <div class="flex items-start">
                            <span class="text-2xl mr-3">üîí</span>
                            <div>
                                <p class="font-semibold text-green-800 mb-1">100% Private & Secure</p>
                                <p class="text-sm text-green-700">All processing happens locally in your browser. Your images never leave your device!</p>
                            </div>
                        </div>
                    </div>

                    <!-- Step 1: Upload Images -->
                    <div class="mb-6">
                        <label class="block text-lg font-semibold text-gray-700 mb-3">
                            <span class="text-green-600">Step 1:</span> Upload Images
                        </label>
                        
                        <!-- Drop Zone -->
                        <div id="compressor-drop-zone" class="border-2 border-dashed border-gray-300 rounded-xl p-8 text-center hover:border-green-500 transition-all cursor-pointer bg-gray-50 hover:bg-green-50">
                            <input type="file" id="compressor-file-input" accept="image/*" multiple class="hidden">
                            <div class="text-5xl mb-3">üìÅ</div>
                            <p class="text-lg font-semibold text-gray-700 mb-2">Drop images here or click to browse</p>
                            <p class="text-sm text-gray-500">Supports: JPG, PNG, WebP, GIF - Select multiple files</p>
                        </div>

                        <!-- Image Preview Grid -->
                        <div id="compressor-preview-section" class="hidden mt-4">
                            <div class="flex items-center justify-between mb-3 p-3 bg-green-50 rounded-lg">
                                <p class="font-semibold text-gray-700">
                                    Uploaded: <span id="compressor-count" class="text-green-600 text-xl">0</span> images
                                </p>
                                <button onclick="clearAllCompressorImages()" class="text-red-600 hover:text-red-700 text-sm font-semibold px-3 py-1 bg-white rounded-lg hover:bg-red-50 transition-all">
                                    Clear All
                                </button>
                            </div>
                            <div id="compressor-preview-grid" class="grid grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-3 p-3 bg-gray-50 rounded-lg">
                                <!-- Image previews will be added here -->
                            </div>
                            <p class="text-xs text-gray-500 text-center mt-2">üí° Tip: Images will be compressed individually</p>
                        </div>
                    </div>

                    <!-- Step 2: Compression Settings -->
                    <div id="compressor-settings-section" class="hidden mb-6">
                        <label class="block text-lg font-semibold text-gray-700 mb-3">
                            <span class="text-green-600">Step 2:</span> Compression Settings
                        </label>

                        <div class="space-y-4">
                            <!-- Quality Slider -->
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">Quality Level</label>
                                <div class="flex items-center gap-4">
                                    <span class="text-xs text-gray-600">Low</span>
                                    <input type="range" id="compressor-quality-slider" min="10" max="100" value="80" class="flex-1 h-2 bg-gray-300 rounded-lg appearance-none cursor-pointer slider-green">
                                    <span class="text-xs text-gray-600">High</span>
                                </div>
                                <div class="mt-2 text-center">
                                    <span class="text-lg font-bold text-green-600" id="compressor-quality-value">80%</span>
                                    <span class="text-sm text-gray-600 ml-2">(Recommended)</span>
                                </div>
                            </div>

                            <!-- Output Format -->
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">Output Format</label>
                                <div class="grid grid-cols-3 gap-3">
                                    <label class="border-2 border-green-300 rounded-lg p-3 cursor-pointer hover:bg-green-50 transition-all text-center">
                                        <input type="radio" name="compressor-format" value="jpeg" checked class="mb-2">
                                        <div class="font-semibold text-sm">JPEG</div>
                                        <div class="text-xs text-gray-600">Best compression</div>
                                    </label>
                                    <label class="border-2 border-gray-300 rounded-lg p-3 cursor-pointer hover:bg-green-50 transition-all text-center">
                                        <input type="radio" name="compressor-format" value="png" class="mb-2">
                                        <div class="font-semibold text-sm">PNG</div>
                                        <div class="text-xs text-gray-600">Lossless</div>
                                    </label>
                                    <label class="border-2 border-gray-300 rounded-lg p-3 cursor-pointer hover:bg-green-50 transition-all text-center">
                                        <input type="radio" name="compressor-format" value="webp" class="mb-2">
                                        <div class="font-semibold text-sm">WebP</div>
                                        <div class="text-xs text-gray-600">Modern</div>
                                    </label>
                                </div>
                            </div>

                            <!-- Resize Options -->
                            <div>
                                <label class="flex items-center text-sm font-semibold text-gray-700 mb-2">
                                    <input type="checkbox" id="compressor-resize-checkbox" class="mr-2">
                                    Resize Images (Optional)
                                </label>
                                <div id="compressor-resize-options" class="grid grid-cols-2 gap-3 hidden">
                                    <div>
                                        <label class="block text-xs text-gray-600 mb-1">Max Width (px)</label>
                                        <input type="number" id="compressor-max-width" value="1920" min="100" max="10000" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                    </div>
                                    <div>
                                        <label class="block text-xs text-gray-600 mb-1">Max Height (px)</label>
                                        <input type="number" id="compressor-max-height" value="1080" min="100" max="10000" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 3: Compress Button -->
                    <div id="compressor-compress-section" class="hidden mb-6">
                        <button onclick="compressAllImages()" id="compressor-compress-btn" class="w-full bg-gradient-to-r from-green-500 to-emerald-600 text-white font-bold py-4 px-6 rounded-xl hover:from-green-600 hover:to-emerald-700 transition-all duration-300 transform hover:scale-105 shadow-lg text-lg">
                            üóúÔ∏è Compress Images
                        </button>
                    </div>

                    <!-- Progress Bar -->
                    <div id="compressor-progress" class="hidden mb-6">
                        <div class="bg-green-50 border-2 border-green-500 rounded-xl p-4">
                            <div class="flex items-center gap-3 mb-3">
                                <div class="animate-spin">‚è≥</div>
                                <span class="font-semibold text-green-800" id="compressor-progress-text">Compressing images...</span>
                            </div>
                            <div class="w-full bg-green-200 rounded-full h-4 overflow-hidden">
                                <div id="compressor-progress-bar" class="bg-gradient-to-r from-green-500 to-emerald-600 h-4 rounded-full transition-all duration-300" style="width: 0%"></div>
                            </div>
                            <p class="text-sm text-green-700 mt-2" id="compressor-progress-percent">0%</p>
                        </div>
                    </div>

                    <!-- Success Message with Results -->
                    <div id="compressor-success" class="hidden mb-6">
                        <div class="bg-green-50 border-2 border-green-500 rounded-xl p-4 mb-4">
                            <div class="flex items-center gap-3 mb-2">
                                <span class="text-4xl">‚úÖ</span>
                                <div class="flex-1">
                                    <h4 class="text-lg font-bold text-green-800 mb-1">Success!</h4>
                                    <p class="text-green-700">All images compressed successfully</p>
                                    <p class="text-sm text-gray-600 mt-1">
                                        üìä Total savings: <span id="compressor-total-before">0 MB</span> ‚Üí 
                                        <span id="compressor-total-after">0 MB</span> 
                                        (<span id="compressor-total-savings" class="font-bold text-green-600">0%</span> reduction)
                                    </p>
                                </div>
                            </div>
                        </div>

                        <!-- Results Grid -->
                        <div id="compressor-results-grid" class="space-y-3 mb-4 max-h-96 overflow-y-auto">
                            <!-- Results will be added here -->
                        </div>

                        <!-- Download All Button -->
                        <button onclick="downloadAllCompressedAsZip()" class="w-full bg-gradient-to-r from-green-500 to-emerald-600 text-white font-bold py-3 px-8 rounded-xl hover:from-green-600 hover:to-emerald-700 transition-all duration-300 transform hover:scale-105 shadow-lg mb-3">
                            üì• Download All as ZIP
                        </button>

                        <!-- Compress More Button -->
                        <button onclick="resetCompressor()" class="w-full bg-white border-2 border-gray-300 text-gray-700 font-bold py-3 px-8 rounded-xl hover:bg-gray-50 transition-all duration-300">
                            üîÑ Compress More Images
                        </button>
                    </div>

                    <!-- Error Message -->
                    <div id="compressor-error" class="hidden mb-6">
                        <div class="bg-red-50 border-2 border-red-500 rounded-xl p-4">
                            <div class="flex items-start gap-3">
                                <span class="text-3xl">‚ö†Ô∏è</span>
                                <div>
                                    <h4 class="text-lg font-bold text-red-800 mb-1">Error</h4>
                                    <p id="compressor-error-message" class="text-red-700"></p>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <!-- ============================================ -->
    <!-- IMAGE FORMAT CONVERTER MODAL -->
    <!-- ============================================ -->
    <div id="image-converter-modal" class="modal" style="display: none;">
        <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
            <div class="bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto">
                <!-- Modal Header -->
                <div class="bg-gradient-to-r from-pink-500 to-rose-600 text-white p-6 flex justify-between items-center sticky top-0 z-10">
                    <div class="flex items-center gap-3">
                        <div class="text-4xl">üé®</div>
                        <div>
                            <h3 class="text-2xl font-bold">Image Format Converter</h3>
                            <p class="text-pink-100 text-sm">Convert between JPG, PNG, WebP formats</p>
                        </div>
                    </div>
                    <button onclick="closeModal('image-converter-modal')" class="text-white hover:text-pink-200 transition-colors">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>

                <!-- Modal Content -->
                <div class="p-6">
                    
                    <!-- Privacy Notice -->
                    <div class="bg-pink-50 border-l-4 border-pink-500 p-4 mb-6 rounded">
                        <div class="flex items-start">
                            <span class="text-2xl mr-3">üîí</span>
                            <div>
                                <p class="font-semibold text-pink-800 mb-1">100% Private & Secure</p>
                                <p class="text-sm text-pink-700">All processing happens locally in your browser. Your images never leave your device!</p>
                            </div>
                        </div>
                    </div>

                    <!-- Step 1: Upload Images -->
                    <div class="mb-6">
                        <label class="block text-lg font-semibold text-gray-700 mb-3">
                            <span class="text-pink-600">Step 1:</span> Upload Images
                        </label>
                        
                        <!-- Drop Zone -->
                        <div id="converter-drop-zone" class="border-2 border-dashed border-gray-300 rounded-xl p-8 text-center hover:border-pink-500 transition-all cursor-pointer bg-gray-50 hover:bg-pink-50">
                            <input type="file" id="converter-file-input" accept="image/*" multiple class="hidden">
                            <div class="text-5xl mb-3">üñºÔ∏è</div>
                            <p class="text-lg font-semibold text-gray-700 mb-2">Drop images here or click to browse</p>
                            <p class="text-sm text-gray-500">Supports: JPG, PNG, WebP, GIF - Select multiple files</p>
                        </div>

                        <!-- Image Preview Grid -->
                        <div id="converter-preview-section" class="hidden mt-4">
                            <div class="flex items-center justify-between mb-3 p-3 bg-pink-50 rounded-lg">
                                <p class="font-semibold text-gray-700">
                                    Uploaded: <span id="converter-count" class="text-pink-600 text-xl">0</span> images
                                </p>
                                <button onclick="clearAllConverterImages()" class="text-red-600 hover:text-red-700 text-sm font-semibold px-3 py-1 bg-white rounded-lg hover:bg-red-50 transition-all">
                                    Clear All
                                </button>
                            </div>
                            <div id="converter-preview-grid" class="grid grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-3 p-3 bg-gray-50 rounded-lg">
                                <!-- Image previews will be added here -->
                            </div>
                            <p class="text-xs text-gray-500 text-center mt-2">üí° Tip: Each image will be converted to your selected format</p>
                        </div>
                    </div>

                    <!-- Step 2: Select Output Format -->
                    <div id="converter-settings-section" class="hidden mb-6">
                        <label class="block text-lg font-semibold text-gray-700 mb-3">
                            <span class="text-pink-600">Step 2:</span> Select Output Format
                        </label>

                        <div class="space-y-4">
                            <!-- Format Selection -->
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">Choose Target Format</label>
                                <div class="grid grid-cols-3 gap-3">
                                    <label class="border-2 border-pink-300 rounded-lg p-4 cursor-pointer hover:bg-pink-50 transition-all text-center bg-pink-50">
                                        <input type="radio" name="converter-format" value="jpeg" checked class="mb-2">
                                        <div class="text-2xl mb-1">üì∏</div>
                                        <div class="font-semibold text-sm">JPG</div>
                                        <div class="text-xs text-gray-600 mt-1">Small size</div>
                                        <div class="text-xs text-gray-600">Universal</div>
                                    </label>
                                    <label class="border-2 border-gray-300 rounded-lg p-4 cursor-pointer hover:bg-pink-50 transition-all text-center">
                                        <input type="radio" name="converter-format" value="png" class="mb-2">
                                        <div class="text-2xl mb-1">üñºÔ∏è</div>
                                        <div class="font-semibold text-sm">PNG</div>
                                        <div class="text-xs text-gray-600 mt-1">Lossless</div>
                                        <div class="text-xs text-gray-600">Transparency</div>
                                    </label>
                                    <label class="border-2 border-gray-300 rounded-lg p-4 cursor-pointer hover:bg-pink-50 transition-all text-center">
                                        <input type="radio" name="converter-format" value="webp" class="mb-2">
                                        <div class="text-2xl mb-1">üöÄ</div>
                                        <div class="font-semibold text-sm">WebP</div>
                                        <div class="text-xs text-gray-600 mt-1">Modern</div>
                                        <div class="text-xs text-gray-600">Best quality</div>
                                    </label>
                                </div>
                            </div>

                            <!-- Quality Slider (for JPG/WebP) -->
                            <div id="converter-quality-section">
                                <label class="block text-sm font-semibold text-gray-700 mb-2">Quality Settings</label>
                                <div class="flex items-center gap-4">
                                    <span class="text-xs text-gray-600">Low</span>
                                    <input type="range" id="converter-quality-slider" min="10" max="100" value="90" class="flex-1 h-2 bg-gray-300 rounded-lg appearance-none cursor-pointer slider-pink">
                                    <span class="text-xs text-gray-600">High</span>
                                </div>
                                <div class="mt-2 text-center">
                                    <span class="text-lg font-bold text-pink-600" id="converter-quality-value">90%</span>
                                    <span class="text-sm text-gray-600 ml-2">(Recommended for photos)</span>
                                </div>
                            </div>

                            <!-- Transparency Background (for PNG to JPG) -->
                            <div id="converter-background-section" class="hidden">
                                <div class="bg-yellow-50 border-l-4 border-yellow-500 p-4 rounded mb-3">
                                    <div class="flex items-start">
                                        <span class="text-xl mr-2">‚ö†Ô∏è</span>
                                        <div>
                                            <p class="font-semibold text-yellow-800 text-sm mb-1">Transparency Notice</p>
                                            <p class="text-xs text-yellow-700">Converting PNG with transparency to JPG will replace transparent areas with a solid background color.</p>
                                        </div>
                                    </div>
                                </div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">Background Color</label>
                                <div class="flex gap-3">
                                    <label class="flex-1 border-2 border-pink-300 rounded-lg p-3 cursor-pointer hover:bg-pink-50 transition-all text-center">
                                        <input type="radio" name="converter-bg-color" value="white" checked class="mb-2">
                                        <div class="w-8 h-8 bg-white border-2 border-gray-300 rounded mx-auto mb-1"></div>
                                        <div class="text-xs font-semibold">White</div>
                                    </label>
                                    <label class="flex-1 border-2 border-gray-300 rounded-lg p-3 cursor-pointer hover:bg-pink-50 transition-all text-center">
                                        <input type="radio" name="converter-bg-color" value="black" class="mb-2">
                                        <div class="w-8 h-8 bg-black border-2 border-gray-300 rounded mx-auto mb-1"></div>
                                        <div class="text-xs font-semibold">Black</div>
                                    </label>
                                    <label class="flex-1 border-2 border-gray-300 rounded-lg p-3 cursor-pointer hover:bg-pink-50 transition-all text-center">
                                        <input type="radio" name="converter-bg-color" value="custom" class="mb-2">
                                        <input type="color" id="converter-custom-color" value="#ffffff" class="w-8 h-8 rounded mx-auto mb-1 cursor-pointer">
                                        <div class="text-xs font-semibold">Custom</div>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 3: Convert Button -->
                    <div id="converter-convert-section" class="hidden mb-6">
                        <button onclick="convertAllFormats()" id="converter-convert-btn" class="w-full bg-gradient-to-r from-pink-500 to-rose-600 text-white font-bold py-4 px-6 rounded-xl hover:from-pink-600 hover:to-rose-700 transition-all duration-300 transform hover:scale-105 shadow-lg text-lg">
                            üîÑ Convert All Images
                        </button>
                    </div>

                    <!-- Progress Bar -->
                    <div id="converter-progress" class="hidden mb-6">
                        <div class="bg-pink-50 border-2 border-pink-500 rounded-xl p-4">
                            <div class="flex items-center gap-3 mb-3">
                                <div class="animate-spin">‚è≥</div>
                                <span class="font-semibold text-pink-800" id="converter-progress-text">Converting images...</span>
                            </div>
                            <div class="w-full bg-pink-200 rounded-full h-4 overflow-hidden">
                                <div id="converter-progress-bar" class="bg-gradient-to-r from-pink-500 to-rose-600 h-4 rounded-full transition-all duration-300" style="width: 0%"></div>
                            </div>
                            <p class="text-sm text-pink-700 mt-2" id="converter-progress-percent">0%</p>
                        </div>
                    </div>

                    <!-- Success Message with Results -->
                    <div id="converter-success" class="hidden mb-6">
                        <div class="bg-pink-50 border-2 border-pink-500 rounded-xl p-4 mb-4">
                            <div class="flex items-center gap-3 mb-2">
                                <span class="text-4xl">‚úÖ</span>
                                <div class="flex-1">
                                    <h4 class="text-lg font-bold text-pink-800 mb-1">Success!</h4>
                                    <p class="text-pink-700">All images converted successfully</p>
                                    <p class="text-sm text-gray-600 mt-1">
                                        üìä Converted <span id="converter-total-count">0</span> images to 
                                        <span id="converter-target-format" class="font-bold text-pink-600">JPG</span> format
                                    </p>
                                </div>
                            </div>
                        </div>

                        <!-- Results Grid -->
                        <div id="converter-results-grid" class="space-y-3 mb-4 max-h-96 overflow-y-auto">
                            <!-- Results will be added here -->
                        </div>

                        <!-- Download All Button -->
                        <button onclick="downloadAllConvertedAsZip()" class="w-full bg-gradient-to-r from-pink-500 to-rose-600 text-white font-bold py-3 px-8 rounded-xl hover:from-pink-600 hover:to-rose-700 transition-all duration-300 transform hover:scale-105 shadow-lg mb-3">
                            üì• Download All as ZIP
                        </button>

                        <!-- Convert More Button -->
                        <button onclick="resetConverter()" class="w-full bg-white border-2 border-gray-300 text-gray-700 font-bold py-3 px-8 rounded-xl hover:bg-gray-50 transition-all duration-300">
                            üîÑ Convert More Images
                        </button>
                    </div>

                    <!-- Error Message -->
                    <div id="converter-error" class="hidden mb-6">
                        <div class="bg-red-50 border-2 border-red-500 rounded-xl p-4">
                            <div class="flex items-start gap-3">
                                <span class="text-3xl">‚ö†Ô∏è</span>
                                <div>
                                    <h4 class="text-lg font-bold text-red-800 mb-1">Error</h4>
                                    <p id="converter-error-message" class="text-red-700"></p>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <!-- ============================================ -->
    <!-- IMAGE RESIZER MODAL -->
    <!-- ============================================ -->
    <div id="image-resizer-modal" class="modal" style="display: none;">
        <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
            <div class="bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto">
                <!-- Modal Header -->
                <div class="bg-gradient-to-r from-cyan-500 to-blue-600 text-white p-6 flex justify-between items-center sticky top-0 z-10">
                    <div class="flex items-center gap-3">
                        <div class="text-4xl">üìê</div>
                        <div>
                            <h3 class="text-2xl font-bold">Image Resizer</h3>
                            <p class="text-cyan-100 text-sm">Resize images to any dimensions</p>
                        </div>
                    </div>
                    <button onclick="closeModal('image-resizer-modal')" class="text-white hover:text-cyan-200 transition-colors">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>

                <!-- Modal Content -->
                <div class="p-6">
                    
                    <!-- Privacy Notice -->
                    <div class="bg-cyan-50 border-l-4 border-cyan-500 p-4 mb-6 rounded">
                        <div class="flex items-start">
                            <span class="text-2xl mr-3">üîí</span>
                            <div>
                                <p class="font-semibold text-cyan-800 mb-1">100% Private & Secure</p>
                                <p class="text-sm text-cyan-700">All processing happens locally in your browser. Your images never leave your device!</p>
                            </div>
                        </div>
                    </div>

                    <!-- Step 1: Upload Images -->
                    <div class="mb-6">
                        <label class="block text-lg font-semibold text-gray-700 mb-3">
                            <span class="text-cyan-600">Step 1:</span> Upload Images
                        </label>
                        
                        <!-- Drop Zone -->
                        <div id="resizer-drop-zone" class="border-2 border-dashed border-gray-300 rounded-xl p-8 text-center hover:border-cyan-500 transition-all cursor-pointer bg-gray-50 hover:bg-cyan-50">
                            <input type="file" id="resizer-file-input" accept="image/*" multiple class="hidden">
                            <div class="text-5xl mb-3">üìè</div>
                            <p class="text-lg font-semibold text-gray-700 mb-2">Drop images here or click to browse</p>
                            <p class="text-sm text-gray-500">Supports: JPG, PNG, WebP, GIF - Select multiple files</p>
                        </div>

                        <!-- Image Preview Grid -->
                        <div id="resizer-preview-section" class="hidden mt-4">
                            <div class="flex items-center justify-between mb-3 p-3 bg-cyan-50 rounded-lg">
                                <p class="font-semibold text-gray-700">
                                    Uploaded: <span id="resizer-count" class="text-cyan-600 text-xl">0</span> images
                                </p>
                                <button onclick="clearAllResizerImages()" class="text-red-600 hover:text-red-700 text-sm font-semibold px-3 py-1 bg-white rounded-lg hover:bg-red-50 transition-all">
                                    Clear All
                                </button>
                            </div>
                            <div id="resizer-preview-grid" class="grid grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-3 p-3 bg-gray-50 rounded-lg">
                                <!-- Image previews will be added here -->
                            </div>
                            <p class="text-xs text-gray-500 text-center mt-2">üí° Tip: All images will be resized to the same dimensions</p>
                        </div>
                    </div>

                    <!-- Step 2: Resize Settings -->
                    <div id="resizer-settings-section" class="hidden mb-6">
                        <label class="block text-lg font-semibold text-gray-700 mb-3">
                            <span class="text-cyan-600">Step 2:</span> Resize Settings
                        </label>

                        <div class="space-y-4">
                            <!-- Resize Method -->
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">Resize Method</label>
                                <div class="grid grid-cols-3 gap-3">
                                    <label class="border-2 border-cyan-300 rounded-lg p-3 cursor-pointer hover:bg-cyan-50 transition-all text-center bg-cyan-50">
                                        <input type="radio" name="resizer-method" value="custom" checked class="mb-2">
                                        <div class="font-semibold text-sm">Custom</div>
                                        <div class="text-xs text-gray-600">Exact pixels</div>
                                    </label>
                                    <label class="border-2 border-gray-300 rounded-lg p-3 cursor-pointer hover:bg-cyan-50 transition-all text-center">
                                        <input type="radio" name="resizer-method" value="percentage" class="mb-2">
                                        <div class="font-semibold text-sm">Percentage</div>
                                        <div class="text-xs text-gray-600">Scale by %</div>
                                    </label>
                                    <label class="border-2 border-gray-300 rounded-lg p-3 cursor-pointer hover:bg-cyan-50 transition-all text-center">
                                        <input type="radio" name="resizer-method" value="preset" class="mb-2">
                                        <div class="font-semibold text-sm">Preset</div>
                                        <div class="text-xs text-gray-600">Common sizes</div>
                                    </label>
                                </div>
                            </div>

                            <!-- Custom Dimensions -->
                            <div id="resizer-custom-section">
                                <label class="block text-sm font-semibold text-gray-700 mb-2">Custom Dimensions</label>
                                <div class="flex items-center gap-3">
                                    <div class="flex-1">
                                        <label class="block text-xs text-gray-600 mb-1">Width (px)</label>
                                        <input type="number" id="resizer-width" value="1920" min="1" max="10000" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-cyan-500 focus:border-transparent">
                                    </div>
                                    <div class="flex items-end pb-2">
                                        <button onclick="toggleAspectRatioLock()" id="resizer-lock-btn" class="p-2 bg-cyan-500 hover:bg-cyan-600 text-white rounded-lg transition-all">
                                            <span id="resizer-lock-icon">üîí</span>
                                        </button>
                                    </div>
                                    <div class="flex-1">
                                        <label class="block text-xs text-gray-600 mb-1">Height (px)</label>
                                        <input type="number" id="resizer-height" value="1080" min="1" max="10000" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-cyan-500 focus:border-transparent">
                                    </div>
                                </div>
                                <p class="text-xs text-gray-500 mt-2 text-center">
                                    <span id="resizer-lock-status">üîí Aspect ratio locked</span>
                                </p>
                            </div>

                            <!-- Percentage Section -->
                            <div id="resizer-percentage-section" class="hidden">
                                <label class="block text-sm font-semibold text-gray-700 mb-2">Scale Percentage</label>
                                <div class="flex items-center gap-4 mb-3">
                                    <span class="text-xs text-gray-600">10%</span>
                                    <input type="range" id="resizer-percentage-slider" min="10" max="500" value="100" class="flex-1 h-2 bg-gray-300 rounded-lg appearance-none cursor-pointer">
                                    <span class="text-xs text-gray-600">500%</span>
                                </div>
                                <div class="text-center mb-3">
                                    <span class="text-2xl font-bold text-cyan-600" id="resizer-percentage-value">100%</span>
                                </div>
                                <div class="grid grid-cols-4 gap-2">
                                    <button onclick="setResizePercentage(50)" class="border border-cyan-300 rounded-lg p-2 text-sm hover:bg-cyan-50">50%</button>
                                    <button onclick="setResizePercentage(75)" class="border border-cyan-300 rounded-lg p-2 text-sm hover:bg-cyan-50">75%</button>
                                    <button onclick="setResizePercentage(150)" class="border border-cyan-300 rounded-lg p-2 text-sm hover:bg-cyan-50">150%</button>
                                    <button onclick="setResizePercentage(200)" class="border border-cyan-300 rounded-lg p-2 text-sm hover:bg-cyan-50">200%</button>
                                </div>
                            </div>

                            <!-- Preset Sizes -->
                            <div id="resizer-preset-section" class="hidden">
                                <label class="block text-sm font-semibold text-gray-700 mb-2">Choose Preset Size</label>
                                <div class="grid grid-cols-2 md:grid-cols-3 gap-3">
                                    <button onclick="applyPresetSize(150, 150)" class="border border-gray-300 rounded-lg p-3 text-left hover:bg-cyan-50 hover:border-cyan-300 transition-all">
                                        <div class="font-semibold text-sm">Thumbnail</div>
                                        <div class="text-xs text-gray-600">150 √ó 150</div>
                                    </button>
                                    <button onclick="applyPresetSize(320, 240)" class="border border-gray-300 rounded-lg p-3 text-left hover:bg-cyan-50 hover:border-cyan-300 transition-all">
                                        <div class="font-semibold text-sm">Small</div>
                                        <div class="text-xs text-gray-600">320 √ó 240</div>
                                    </button>
                                    <button onclick="applyPresetSize(640, 480)" class="border border-gray-300 rounded-lg p-3 text-left hover:bg-cyan-50 hover:border-cyan-300 transition-all">
                                        <div class="font-semibold text-sm">Medium</div>
                                        <div class="text-xs text-gray-600">640 √ó 480</div>
                                    </button>
                                    <button onclick="applyPresetSize(1024, 768)" class="border border-gray-300 rounded-lg p-3 text-left hover:bg-cyan-50 hover:border-cyan-300 transition-all">
                                        <div class="font-semibold text-sm">Large</div>
                                        <div class="text-xs text-gray-600">1024 √ó 768</div>
                                    </button>
                                    <button onclick="applyPresetSize(1920, 1080)" class="border border-gray-300 rounded-lg p-3 text-left hover:bg-cyan-50 hover:border-cyan-300 transition-all">
                                        <div class="font-semibold text-sm">HD</div>
                                        <div class="text-xs text-gray-600">1920 √ó 1080</div>
                                    </button>
                                    <button onclick="applyPresetSize(3840, 2160)" class="border border-gray-300 rounded-lg p-3 text-left hover:bg-cyan-50 hover:border-cyan-300 transition-all">
                                        <div class="font-semibold text-sm">4K</div>
                                        <div class="text-xs text-gray-600">3840 √ó 2160</div>
                                    </button>
                                </div>
                            </div>

                            <!-- Output Quality -->
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">Output Quality</label>
                                <div class="flex items-center gap-4">
                                    <span class="text-xs text-gray-600">Low</span>
                                    <input type="range" id="resizer-quality-slider" min="10" max="100" value="90" class="flex-1 h-2 bg-gray-300 rounded-lg appearance-none cursor-pointer">
                                    <span class="text-xs text-gray-600">High</span>
                                </div>
                                <div class="mt-2 text-center">
                                    <span class="text-lg font-bold text-cyan-600" id="resizer-quality-value">90%</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 3: Resize Button -->
                    <div id="resizer-resize-section" class="hidden mb-6">
                        <button onclick="resizeAllImages()" id="resizer-resize-btn" class="w-full bg-gradient-to-r from-cyan-500 to-blue-600 text-white font-bold py-4 px-6 rounded-xl hover:from-cyan-600 hover:to-blue-700 transition-all duration-300 transform hover:scale-105 shadow-lg text-lg">
                            üìê Resize Images
                        </button>
                    </div>

                    <!-- Progress Bar -->
                    <div id="resizer-progress" class="hidden mb-6">
                        <div class="bg-cyan-50 border-2 border-cyan-500 rounded-xl p-4">
                            <div class="flex items-center gap-3 mb-3">
                                <div class="animate-spin">‚è≥</div>
                                <span class="font-semibold text-cyan-800" id="resizer-progress-text">Resizing images...</span>
                            </div>
                            <div class="w-full bg-cyan-200 rounded-full h-4 overflow-hidden">
                                <div id="resizer-progress-bar" class="bg-gradient-to-r from-cyan-500 to-blue-600 h-4 rounded-full transition-all duration-300" style="width: 0%"></div>
                            </div>
                            <p class="text-sm text-cyan-700 mt-2" id="resizer-progress-percent">0%</p>
                        </div>
                    </div>

                    <!-- Success Message with Results -->
                    <div id="resizer-success" class="hidden mb-6">
                        <div class="bg-cyan-50 border-2 border-cyan-500 rounded-xl p-4 mb-4">
                            <div class="flex items-center gap-3 mb-2">
                                <span class="text-4xl">‚úÖ</span>
                                <div class="flex-1">
                                    <h4 class="text-lg font-bold text-cyan-800 mb-1">Success!</h4>
                                    <p class="text-cyan-700">All images resized successfully</p>
                                    <p class="text-sm text-gray-600 mt-1">
                                        üìä Resized <span id="resizer-total-count">0</span> images
                                    </p>
                                </div>
                            </div>
                        </div>

                        <!-- Results Grid -->
                        <div id="resizer-results-grid" class="space-y-3 mb-4 max-h-96 overflow-y-auto">
                            <!-- Results will be added here -->
                        </div>

                        <!-- Download All Button -->
                        <button onclick="downloadAllResizedAsZip()" class="w-full bg-gradient-to-r from-cyan-500 to-blue-600 text-white font-bold py-3 px-8 rounded-xl hover:from-cyan-600 hover:to-blue-700 transition-all duration-300 transform hover:scale-105 shadow-lg mb-3">
                            üì• Download All as ZIP
                        </button>

                        <!-- Resize More Button -->
                        <button onclick="resetResizer()" class="w-full bg-white border-2 border-gray-300 text-gray-700 font-bold py-3 px-8 rounded-xl hover:bg-gray-50 transition-all duration-300">
                            üîÑ Resize More Images
                        </button>
                    </div>

                    <!-- Error Message -->
                    <div id="resizer-error" class="hidden mb-6">
                        <div class="bg-red-50 border-2 border-red-500 rounded-xl p-4">
                            <div class="flex items-start gap-3">
                                <span class="text-3xl">‚ö†Ô∏è</span>
                                <div>
                                    <h4 class="text-lg font-bold text-red-800 mb-1">Error</h4>
                                    <p id="resizer-error-message" class="text-red-700"></p>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <!-- ============================================ -->
    <!-- DIGITAL SIGNATURE GENERATOR MODAL -->
    <!-- ============================================ -->
    <div id="signature-generator-modal" class="modal" style="display: none;">
        <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
            <div class="bg-white rounded-2xl shadow-2xl w-full max-w-5xl max-h-[90vh] overflow-y-auto">
                <!-- Modal Header -->
                <div class="bg-gradient-to-r from-purple-500 to-indigo-600 text-white p-6 flex justify-between items-center sticky top-0 z-10">
                    <div class="flex items-center gap-3">
                        <div class="text-4xl">‚úçÔ∏è</div>
                        <div>
                            <h3 class="text-2xl font-bold">Digital Signature Generator</h3>
                            <p class="text-purple-100 text-sm">Create professional digital signatures</p>
                        </div>
                    </div>
                    <button onclick="closeModal('signature-generator-modal')" class="text-white hover:text-purple-200 transition-colors">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>

                <!-- Modal Content -->
                <div class="p-6">
                    
                    <!-- Privacy Notice -->
                    <div class="bg-purple-50 border-l-4 border-purple-500 p-4 mb-6 rounded">
                        <div class="flex items-start">
                            <span class="text-2xl mr-3">üîí</span>
                            <div>
                                <p class="font-semibold text-purple-800 mb-1">100% Private & Secure</p>
                                <p class="text-sm text-purple-700">All processing happens locally in your browser. Your signature never leaves your device!</p>
                            </div>
                        </div>
                    </div>

                    <!-- Signature Type Selector -->
                    <div class="mb-6">
                        <label class="block text-lg font-semibold text-gray-700 mb-3">
                            <span class="text-purple-600">Step 1:</span> Choose Signature Type
                        </label>
                        <div class="grid grid-cols-2 gap-4">
                            <label class="border-2 border-purple-300 rounded-xl p-4 cursor-pointer hover:bg-purple-50 transition-all text-center bg-purple-50" id="draw-signature-selector">
                                <input type="radio" name="signature-type" value="draw" checked class="mb-2" onchange="switchSignatureType('draw')">
                                <div class="text-3xl mb-2">‚úèÔ∏è</div>
                                <div class="font-semibold">Draw Signature</div>
                                <div class="text-xs text-gray-600 mt-1">Draw your signature using mouse or touchscreen</div>
                            </label>
                            <label class="border-2 border-gray-300 rounded-xl p-4 cursor-pointer hover:bg-purple-50 transition-all text-center" id="text-signature-selector">
                                <input type="radio" name="signature-type" value="text" class="mb-2" onchange="switchSignatureType('text')">
                                <div class="text-3xl mb-2">üìù</div>
                                <div class="font-semibold">Type Signature</div>
                                <div class="text-xs text-gray-600 mt-1">Type your name and choose a style</div>
                            </label>
                        </div>
                    </div>

                    <!-- Draw Signature Section -->
                    <div id="draw-signature-section" class="mb-6">
                        <label class="block text-lg font-semibold text-gray-700 mb-3">
                            <span class="text-purple-600">Step 2:</span> Draw Your Signature
                        </label>
                        
                        <!-- Canvas Container -->
                        <div class="border-2 border-gray-300 rounded-xl overflow-hidden bg-white mb-4">
                            <canvas id="signature-canvas" 
                                    width="800" 
                                    height="300" 
                                    class="w-full cursor-crosshair touch-none"
                                    style="max-height: 300px;">
                            </canvas>
                        </div>
                        
                        <!-- Drawing Controls -->
                        <div class="grid grid-cols-4 gap-3 mb-4">
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">Pen Color</label>
                                <div class="flex gap-2">
                                    <input type="color" id="pen-color" value="#000000" class="w-12 h-10 border border-gray-300 rounded cursor-pointer">
                                    <select id="pen-color-preset" onchange="setPenColorPreset()" class="flex-1 border border-gray-300 rounded-lg px-2 py-2 text-sm focus:ring-2 focus:ring-purple-500">
                                        <option value="#000000">Black</option>
                                        <option value="#0000FF">Blue</option>
                                        <option value="#000080">Navy</option>
                                        <option value="#1a1a1a">Dark Gray</option>
                                    </select>
                                </div>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">Pen Size</label>
                                <input type="range" id="pen-size" min="1" max="10" value="2" class="w-full h-10">
                                <div class="text-xs text-gray-500 text-center mt-1"><span id="pen-size-value">2</span>px</div>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">Background</label>
                                <select id="canvas-background" onchange="setCanvasBackground()" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-purple-500">
                                    <option value="transparent">Transparent</option>
                                    <option value="#FFFFFF">White</option>
                                    <option value="#F3F4F6">Light Gray</option>
                                </select>
                            </div>
                            <div class="flex items-end">
                                <button onclick="clearSignatureCanvas()" class="w-full bg-red-500 hover:bg-red-600 text-white py-2 px-4 rounded-lg font-semibold transition-all">
                                    üóëÔ∏è Clear
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Type Signature Section -->
                    <div id="text-signature-section" class="hidden mb-6">
                        <label class="block text-lg font-semibold text-gray-700 mb-3">
                            <span class="text-purple-600">Step 2:</span> Type Your Name
                        </label>
                        
                        <!-- Text Input -->
                        <input type="text" 
                               id="signature-text-input" 
                               placeholder="Enter your name..." 
                               class="w-full border-2 border-gray-300 rounded-xl px-4 py-3 text-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent mb-4"
                               oninput="updateTextSignaturePreview()"
                               maxlength="50">
                        
                        <!-- Font Style Selection -->
                        <label class="block text-lg font-semibold text-gray-700 mb-3">
                            <span class="text-purple-600">Step 3:</span> Choose Font Style
                        </label>
                        <div class="grid grid-cols-2 md:grid-cols-3 gap-4 mb-4">
                            <label class="border-2 border-purple-300 rounded-xl p-4 cursor-pointer hover:bg-purple-50 transition-all text-center bg-purple-50" id="font-style-1">
                                <input type="radio" name="signature-font" value="Dancing Script" checked class="mb-2" onchange="updateTextSignaturePreview()">
                                <div class="text-2xl mb-2" style="font-family: 'Dancing Script', cursive;">Signature</div>
                                <div class="text-xs text-gray-600">Dancing Script</div>
                            </label>
                            <label class="border-2 border-gray-300 rounded-xl p-4 cursor-pointer hover:bg-purple-50 transition-all text-center" id="font-style-2">
                                <input type="radio" name="signature-font" value="Great Vibes" class="mb-2" onchange="updateTextSignaturePreview()">
                                <div class="text-2xl mb-2" style="font-family: 'Great Vibes', cursive;">Signature</div>
                                <div class="text-xs text-gray-600">Great Vibes</div>
                            </label>
                            <label class="border-2 border-gray-300 rounded-xl p-4 cursor-pointer hover:bg-purple-50 transition-all text-center" id="font-style-3">
                                <input type="radio" name="signature-font" value="Allura" class="mb-2" onchange="updateTextSignaturePreview()">
                                <div class="text-2xl mb-2" style="font-family: 'Allura', cursive;">Signature</div>
                                <div class="text-xs text-gray-600">Allura</div>
                            </label>
                            <label class="border-2 border-gray-300 rounded-xl p-4 cursor-pointer hover:bg-purple-50 transition-all text-center" id="font-style-4">
                                <input type="radio" name="signature-font" value="Pacifico" class="mb-2" onchange="updateTextSignaturePreview()">
                                <div class="text-2xl mb-2" style="font-family: 'Pacifico', cursive;">Signature</div>
                                <div class="text-xs text-gray-600">Pacifico</div>
                            </label>
                            <label class="border-2 border-gray-300 rounded-xl p-4 cursor-pointer hover:bg-purple-50 transition-all text-center" id="font-style-5">
                                <input type="radio" name="signature-font" value="Sacramento" class="mb-2" onchange="updateTextSignaturePreview()">
                                <div class="text-2xl mb-2" style="font-family: 'Sacramento', cursive;">Signature</div>
                                <div class="text-xs text-gray-600">Sacramento</div>
                            </label>
                            <label class="border-2 border-gray-300 rounded-xl p-4 cursor-pointer hover:bg-purple-50 transition-all text-center" id="font-style-6">
                                <input type="radio" name="signature-font" value="Alex Brush" class="mb-2" onchange="updateTextSignaturePreview()">
                                <div class="text-2xl mb-2" style="font-family: 'Alex Brush', cursive;">Signature</div>
                                <div class="text-xs text-gray-600">Alex Brush</div>
                            </label>
                        </div>

                        <!-- Text Signature Controls -->
                        <div class="grid grid-cols-3 gap-4 mb-4">
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">Text Color</label>
                                <div class="flex gap-2">
                                    <input type="color" id="text-signature-color" value="#000000" class="w-12 h-10 border border-gray-300 rounded cursor-pointer" onchange="updateTextSignaturePreview()">
                                    <select id="text-color-preset" onchange="setTextColorPreset()" class="flex-1 border border-gray-300 rounded-lg px-2 py-2 text-sm focus:ring-2 focus:ring-purple-500">
                                        <option value="#000000">Black</option>
                                        <option value="#0000FF">Blue</option>
                                        <option value="#000080">Navy</option>
                                        <option value="#1a1a1a">Dark Gray</option>
                                    </select>
                                </div>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">Font Size</label>
                                <input type="range" id="text-signature-size" min="40" max="120" value="72" class="w-full h-10" oninput="updateTextSignaturePreview()">
                                <div class="text-xs text-gray-500 text-center mt-1"><span id="text-size-value">72</span>px</div>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">Background</label>
                                <select id="text-canvas-background" onchange="updateTextSignaturePreview()" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-purple-500">
                                    <option value="transparent">Transparent</option>
                                    <option value="#FFFFFF">White</option>
                                    <option value="#F3F4F6">Light Gray</option>
                                </select>
                            </div>
                        </div>

                        <!-- Text Signature Preview -->
                        <label class="block text-lg font-semibold text-gray-700 mb-3">Preview</label>
                        <div class="border-2 border-gray-300 rounded-xl overflow-hidden bg-white mb-4">
                            <canvas id="text-signature-canvas" 
                                    width="800" 
                                    height="300" 
                                    class="w-full"
                                    style="max-height: 300px;">
                            </canvas>
                        </div>
                    </div>

                    <!-- Download Section -->
                    <div class="mb-6">
                        <label class="block text-lg font-semibold text-gray-700 mb-3">
                            <span class="text-purple-600">Step <span id="download-step-number">3</span>:</span> Download Your Signature
                        </label>
                        
                        <!-- Download Options -->
                        <div class="grid grid-cols-3 gap-4 mb-4">
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">File Format</label>
                                <select id="signature-format" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-purple-500">
                                    <option value="png">PNG (Recommended)</option>
                                    <option value="jpg">JPG</option>
                                    <option value="svg">SVG (Draw only)</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">Image Quality</label>
                                <select id="signature-quality" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-purple-500">
                                    <option value="1">Standard</option>
                                    <option value="2" selected>High (2x)</option>
                                    <option value="3">Ultra (3x)</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">Trim Whitespace</label>
                                <label class="flex items-center h-10 mt-1">
                                    <input type="checkbox" id="signature-trim" checked class="mr-2 w-5 h-5">
                                    <span class="text-sm">Auto-trim edges</span>
                                </label>
                            </div>
                        </div>

                        <!-- Download Button -->
                        <button onclick="downloadSignature()" class="w-full bg-gradient-to-r from-purple-500 to-indigo-600 text-white font-bold py-4 px-6 rounded-xl hover:from-purple-600 hover:to-indigo-700 transition-all duration-300 transform hover:scale-105 shadow-lg text-lg">
                            üì• Download Signature
                        </button>
                    </div>

                    <!-- Success Message -->
                    <div id="signature-success" class="hidden mb-6">
                        <div class="bg-green-50 border-2 border-green-500 rounded-xl p-4">
                            <div class="flex items-center gap-3">
                                <span class="text-3xl">‚úì</span>
                                <div>
                                    <h4 class="text-lg font-bold text-green-800 mb-1">Success!</h4>
                                    <p class="text-green-700">Your signature has been downloaded successfully.</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Error Message -->
                    <div id="signature-error" class="hidden mb-6">
                        <div class="bg-red-50 border-2 border-red-500 rounded-xl p-4">
                            <div class="flex items-start gap-3">
                                <span class="text-3xl">‚ö†Ô∏è</span>
                                <div>
                                    <h4 class="text-lg font-bold text-red-800 mb-1">Error</h4>
                                    <p id="signature-error-message" class="text-red-700"></p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Tips Section -->
                    <div class="bg-gradient-to-r from-purple-50 to-indigo-50 rounded-xl p-6 border border-purple-200">
                        <h4 class="text-lg font-bold text-purple-900 mb-3 flex items-center gap-2">
                            <span>üí°</span>
                            <span>Tips for Creating Great Signatures</span>
                        </h4>
                        <ul class="space-y-2 text-sm text-gray-700">
                            <li class="flex items-start gap-2">
                                <span class="text-purple-600 mt-1">‚Ä¢</span>
                                <span><strong>Draw Mode:</strong> Use smooth, flowing strokes. Practice a few times before downloading.</span>
                            </li>
                            <li class="flex items-start gap-2">
                                <span class="text-purple-600 mt-1">‚Ä¢</span>
                                <span><strong>Text Mode:</strong> Choose a font that matches your style. Script fonts work best for signatures.</span>
                            </li>
                            <li class="flex items-start gap-2">
                                <span class="text-purple-600 mt-1">‚Ä¢</span>
                                <span><strong>Transparent Background:</strong> Use PNG with transparent background for documents and PDFs.</span>
                            </li>
                            <li class="flex items-start gap-2">
                                <span class="text-purple-600 mt-1">‚Ä¢</span>
                                <span><strong>High Quality:</strong> Select "High (2x)" or "Ultra (3x)" for crisp, professional results.</span>
                            </li>
                        </ul>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <!-- ============================================ -->
    <!-- CSV TO JSON CONVERTER MODAL -->
    <!-- ============================================ -->
    <div id="csv-json-converter-modal" class="modal" style="display: none;">
        <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
            <div class="bg-white rounded-2xl shadow-2xl w-full max-w-5xl max-h-[90vh] overflow-y-auto">
                <!-- Modal Header -->
                <div class="bg-gradient-to-r from-orange-500 to-amber-600 text-white p-6 flex justify-between items-center sticky top-0 z-10">
                    <div class="flex items-center gap-3">
                        <div class="text-4xl">üìä</div>
                        <div>
                            <h3 class="text-2xl font-bold">CSV to JSON Converter</h3>
                            <p class="text-orange-100 text-sm">Convert between CSV and JSON formats</p>
                        </div>
                    </div>
                    <button onclick="closeModal('csv-json-converter-modal')" class="text-white hover:text-orange-200 transition-colors">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>

                <!-- Modal Content -->
                <div class="p-6">
                    
                    <!-- Privacy Notice -->
                    <div class="bg-orange-50 border-l-4 border-orange-500 p-4 mb-6 rounded">
                        <div class="flex items-start">
                            <span class="text-2xl mr-3">üîí</span>
                            <div>
                                <p class="font-semibold text-orange-800 mb-1">100% Private & Secure</p>
                                <p class="text-sm text-orange-700">All processing happens locally in your browser. Your data never leaves your device!</p>
                            </div>
                        </div>
                    </div>

                    <!-- Conversion Direction Selector -->
                    <div class="mb-6">
                        <label class="block text-lg font-semibold text-gray-700 mb-3">Select Conversion Direction</label>
                        <div class="grid grid-cols-2 gap-4">
                            <label class="border-2 border-orange-300 rounded-xl p-4 cursor-pointer hover:bg-orange-50 transition-all text-center bg-orange-50">
                                <input type="radio" name="csv-json-direction" value="csv-to-json" checked class="mb-2">
                                <div class="text-3xl mb-2">üìÑ ‚Üí üìã</div>
                                <div class="font-semibold">CSV to JSON</div>
                                <div class="text-xs text-gray-600 mt-1">Convert CSV data to JSON format</div>
                            </label>
                            <label class="border-2 border-gray-300 rounded-xl p-4 cursor-pointer hover:bg-orange-50 transition-all text-center">
                                <input type="radio" name="csv-json-direction" value="json-to-csv" class="mb-2">
                                <div class="text-3xl mb-2">üìã ‚Üí üìÑ</div>
                                <div class="font-semibold">JSON to CSV</div>
                                <div class="text-xs text-gray-600 mt-1">Convert JSON data to CSV format</div>
                            </label>
                        </div>
                    </div>

                    <!-- Input Section -->
                    <div class="mb-6">
                        <div class="flex items-center justify-between mb-3">
                            <label class="block text-lg font-semibold text-gray-700">
                                <span class="text-orange-600">Step 1:</span> <span id="csv-json-input-label">Input CSV Data</span>
                            </label>
                            <div class="flex gap-2">
                                <label class="bg-orange-500 hover:bg-orange-600 text-white px-4 py-2 rounded-lg cursor-pointer text-sm font-semibold transition-all">
                                    üìÅ Upload File
                                    <input type="file" id="csv-json-file-input" accept=".csv,.json,.txt" class="hidden">
                                </label>
                                <button onclick="clearCsvJsonInput()" class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg text-sm font-semibold transition-all">
                                    üóëÔ∏è Clear
                                </button>
                            </div>
                        </div>
                        <textarea id="csv-json-input" rows="10" placeholder="Paste your CSV data here...&#10;&#10;Example:&#10;Name,Age,City&#10;John,30,New York&#10;Jane,25,Los Angeles" class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-orange-500 focus:border-transparent font-mono text-sm"></textarea>
                        <div class="flex items-center justify-between mt-2">
                            <p class="text-xs text-gray-500">
                                <span id="csv-json-input-chars">0</span> characters
                            </p>
                            <button onclick="pasteSampleData()" class="text-orange-600 hover:text-orange-700 text-xs font-semibold">
                                üìã Use Sample Data
                            </button>
                        </div>
                    </div>

                    <!-- Settings Section (for CSV to JSON) -->
                    <div id="csv-json-settings-csv" class="mb-6">
                        <label class="block text-lg font-semibold text-gray-700 mb-3">
                            <span class="text-orange-600">Step 2:</span> CSV Settings
                        </label>
                        <div class="grid grid-cols-3 gap-4">
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">Delimiter</label>
                                <select id="csv-delimiter" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-orange-500">
                                    <option value="auto">Auto-detect</option>
                                    <option value=",">Comma (,)</option>
                                    <option value=";">Semicolon (;)</option>
                                    <option value="\t">Tab</option>
                                    <option value="|">Pipe (|)</option>
                                </select>
                            </div>
                            <div>
                                <label class="flex items-center text-sm font-semibold text-gray-700 mb-2">
                                    <input type="checkbox" id="csv-has-header" checked class="mr-2">
                                    First row is header
                                </label>
                                <p class="text-xs text-gray-500">Check if first row contains column names</p>
                            </div>
                            <div>
                                <label class="flex items-center text-sm font-semibold text-gray-700 mb-2">
                                    <input type="checkbox" id="json-pretty-print" checked class="mr-2">
                                    Pretty print JSON
                                </label>
                                <p class="text-xs text-gray-500">Format JSON with indentation</p>
                            </div>
                        </div>
                    </div>

                    <!-- Settings Section (for JSON to CSV) -->
                    <div id="csv-json-settings-json" class="hidden mb-6">
                        <label class="block text-lg font-semibold text-gray-700 mb-3">
                            <span class="text-orange-600">Step 2:</span> CSV Output Settings
                        </label>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">CSV Delimiter</label>
                                <select id="csv-output-delimiter" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-orange-500">
                                    <option value=",">Comma (,)</option>
                                    <option value=";">Semicolon (;)</option>
                                    <option value="\t">Tab</option>
                                    <option value="|">Pipe (|)</option>
                                </select>
                            </div>
                            <div>
                                <label class="flex items-center text-sm font-semibold text-gray-700 mb-2">
                                    <input type="checkbox" id="csv-include-header" checked class="mr-2">
                                    Include header row
                                </label>
                                <p class="text-xs text-gray-500">Add column names as first row</p>
                            </div>
                        </div>
                    </div>

                    <!-- Convert Button -->
                    <div class="mb-6">
                        <button onclick="convertCsvJson()" class="w-full bg-gradient-to-r from-orange-500 to-amber-600 text-white font-bold py-4 px-6 rounded-xl hover:from-orange-600 hover:to-amber-700 transition-all duration-300 transform hover:scale-105 shadow-lg text-lg">
                            üîÑ <span id="csv-json-convert-btn-text">Convert to JSON</span>
                        </button>
                    </div>

                    <!-- Output Section -->
                    <div id="csv-json-output-section" class="hidden mb-6">
                        <div class="flex items-center justify-between mb-3">
                            <label class="block text-lg font-semibold text-gray-700">
                                <span class="text-orange-600">Step 3:</span> <span id="csv-json-output-label">Output JSON</span>
                            </label>
                            <div class="flex gap-2">
                                <button onclick="copyToClipboardCsvJson()" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg text-sm font-semibold transition-all">
                                    üìã Copy to Clipboard
                                </button>
                                <button onclick="downloadCsvJsonOutput()" class="bg-orange-500 hover:bg-orange-600 text-white px-4 py-2 rounded-lg text-sm font-semibold transition-all">
                                    üì• Download
                                </button>
                            </div>
                        </div>
                        <textarea id="csv-json-output" rows="12" readonly class="w-full border border-gray-300 rounded-lg px-4 py-3 bg-gray-50 font-mono text-sm"></textarea>
                        <div class="flex items-center justify-between mt-2">
                            <p class="text-xs text-gray-500">
                                <span id="csv-json-output-chars">0</span> characters ‚Ä¢ 
                                <span id="csv-json-output-lines">0</span> lines
                            </p>
                            <p class="text-xs text-green-600 font-semibold" id="csv-json-success-msg"></p>
                        </div>
                    </div>

                    <!-- Preview Table (for validation) -->
                    <div id="csv-json-preview-section" class="hidden mb-6">
                        <label class="block text-lg font-semibold text-gray-700 mb-3">Data Preview</label>
                        <div class="overflow-x-auto max-h-64 border border-gray-300 rounded-lg">
                            <table id="csv-json-preview-table" class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50 sticky top-0">
                                    <tr id="csv-json-preview-header"></tr>
                                </thead>
                                <tbody id="csv-json-preview-body" class="bg-white divide-y divide-gray-200"></tbody>
                            </table>
                        </div>
                        <p class="text-xs text-gray-500 mt-2 text-center">
                            Showing first 10 rows
                        </p>
                    </div>

                    <!-- Error Message -->
                    <div id="csv-json-error" class="hidden mb-6">
                        <div class="bg-red-50 border-2 border-red-500 rounded-xl p-4">
                            <div class="flex items-start gap-3">
                                <span class="text-3xl">‚ö†Ô∏è</span>
                                <div>
                                    <h4 class="text-lg font-bold text-red-800 mb-1">Error</h4>
                                    <p id="csv-json-error-message" class="text-red-700"></p>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <!-- Privacy Policy Modal -->
    <div id="privacy-modal" class="modal" style="display: none;">
        <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
            <div class="bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden">
                <!-- Modal Header -->
                <div class="bg-gradient-to-r from-purple-600 to-blue-600 text-white p-6 flex justify-between items-center">
                    <div>
                        <h3 class="text-2xl font-bold">üîí Privacy Policy</h3>
                        <p class="text-blue-100 mt-1">Last Updated: October 8, 2025</p>
                    </div>
                    <button onclick="closePrivacyModal()" class="text-white hover:text-gray-200 text-3xl font-bold">&times;</button>
                </div>
                
                <!-- Modal Content -->
                <div class="p-6 md:p-8 max-h-[calc(90vh-120px)] overflow-y-auto">
                    
                    <!-- Privacy Summary (Always Visible) -->
                    <div id="privacy-summary" class="space-y-6">
                        <!-- Introduction -->
                        <div>
                            <p class="text-gray-700 leading-relaxed text-lg">
                                Welcome to FreeToolHub. We respect your privacy and are committed to protecting your personal information. This policy outlines how we handle your data when you use our free online tools.
                            </p>
                        </div>

                        <!-- Key Points Grid -->
                        <div class="grid md:grid-cols-2 gap-4 my-8">
                            <div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded">
                                <h4 class="font-bold text-gray-800 mb-2 flex items-center">
                                    <span class="mr-2">üîí</span> Local Processing
                                </h4>
                                <p class="text-gray-600 text-sm">
                                    Most tools process data locally in your browser. We don't store your calculator inputs or converter data.
                                </p>
                            </div>

                            <div class="bg-yellow-50 border-l-4 border-yellow-500 p-4 rounded">
                                <h4 class="font-bold text-gray-800 mb-2 flex items-center">
                                    <span class="mr-2">üí∞</span> Google AdSense
                                </h4>
                                <p class="text-gray-600 text-sm">
                                    We use Google AdSense for ads. Google may use cookies to serve personalized advertisements based on your browsing.
                                </p>
                            </div>

                            <div class="bg-green-50 border-l-4 border-green-500 p-4 rounded">
                                <h4 class="font-bold text-gray-800 mb-2 flex items-center">
                                    <span class="mr-2">üç™</span> Cookies
                                </h4>
                                <p class="text-gray-600 text-sm">
                                    We use cookies for essential functionality, analytics, and advertising. You can control cookie preferences in your browser.
                                </p>
                            </div>

                            <div class="bg-purple-50 border-l-4 border-purple-500 p-4 rounded">
                                <h4 class="font-bold text-gray-800 mb-2 flex items-center">
                                    <span class="mr-2">üá™üá∫</span> GDPR Compliant
                                </h4>
                                <p class="text-gray-600 text-sm">
                                    EU users can manage consent via our consent banner. You have rights to access, delete, and control your data.
                                </p>
                            </div>
                        </div>

                        <!-- Quick Summary -->
                        <div class="bg-gradient-to-r from-purple-50 to-blue-50 p-6 rounded-lg border border-purple-200">
                            <h4 class="font-bold text-gray-800 mb-3">üìù In Short:</h4>
                            <ul class="space-y-2 text-gray-700">
                                <li class="flex items-start">
                                    <span class="text-purple-600 mr-2 mt-1">‚úì</span>
                                    <span>We collect minimal personal information</span>
                                </li>
                                <li class="flex items-start">
                                    <span class="text-purple-600 mr-2 mt-1">‚úì</span>
                                    <span>Most data is processed locally in your browser</span>
                                </li>
                                <li class="flex items-start">
                                    <span class="text-purple-600 mr-2 mt-1">‚úì</span>
                                    <span>Google AdSense displays ads using cookies</span>
                                </li>
                                <li class="flex items-start">
                                    <span class="text-purple-600 mr-2 mt-1">‚úì</span>
                                    <span>You can opt-out of personalized ads anytime</span>
                                </li>
                                <li class="flex items-start">
                                    <span class="text-purple-600 mr-2 mt-1">‚úì</span>
                                    <span>We comply with GDPR and privacy regulations</span>
                                </li>
                            </ul>
                        </div>

                        <!-- Toggle Button -->
                        <div class="text-center pt-4">
                            <button onclick="togglePrivacyDetails()" id="privacy-toggle-btn" class="bg-gradient-to-r from-purple-600 to-blue-600 text-white px-8 py-4 rounded-lg text-lg font-semibold hover:from-purple-700 hover:to-blue-700 transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl">
                                üìñ Read Full Privacy Policy
                            </button>
                        </div>
                    </div>

                    <!-- Full Privacy Details (Hidden by Default) -->
                    <div id="privacy-details" class="space-y-8 mt-8" style="display: none;">

                    <!-- Information We Collect -->
                    <div>
                        <h3 class="text-2xl font-bold text-gray-800 mb-4">üìä Information We Collect</h3>
                        <div class="space-y-4">
                            <div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded">
                                <h4 class="font-semibold text-gray-800 mb-2">1. Information You Provide</h4>
                                <p class="text-gray-600">
                                    When you use our tools or contact forms, you may provide information such as names, email addresses, or data you input into our calculators and tools. This information is processed locally in your browser and is not stored on our servers unless explicitly stated.
                                </p>
                            </div>
                            
                            <div class="bg-green-50 border-l-4 border-green-500 p-4 rounded">
                                <h4 class="font-semibold text-gray-800 mb-2">2. Automatically Collected Information</h4>
                                <p class="text-gray-600 mb-2">
                                    We automatically collect certain information when you visit our website, including:
                                </p>
                                <ul class="list-disc list-inside text-gray-600 space-y-1 ml-4">
                                    <li>IP address and browser type</li>
                                    <li>Device information and operating system</li>
                                    <li>Pages visited and time spent on pages</li>
                                    <li>Referring website addresses</li>
                                    <li>Clickstream data</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Google AdSense -->
                    <div>
                        <h3 class="text-2xl font-bold text-gray-800 mb-4">üí∞ Google AdSense and Advertising</h3>
                        <div class="bg-yellow-50 border-l-4 border-yellow-500 p-4 rounded space-y-3">
                            <p class="text-gray-600">
                                We use Google AdSense to display advertisements on our website. Google AdSense uses cookies and web beacons to serve ads based on your prior visits to our website or other websites on the Internet.
                            </p>
                            <p class="text-gray-600">
                                <strong>Third-Party Advertising:</strong> Google and other third-party vendors use cookies to serve ads based on your previous visits to this website and other websites. Google's use of advertising cookies enables it and its partners to serve ads to you based on your visit to our site and/or other sites on the Internet.
                            </p>
                            <p class="text-gray-600">
                                <strong>Opt-Out Options:</strong> You may opt out of personalized advertising by visiting <a href="https://www.google.com/settings/ads" target="_blank" class="text-purple-600 hover:underline">Google Ads Settings</a> or by visiting <a href="http://www.aboutads.info/choices/" target="_blank" class="text-purple-600 hover:underline">aboutads.info</a>.
                            </p>
                        </div>
                    </div>

                    <!-- Cookies -->
                    <div>
                        <h3 class="text-2xl font-bold text-gray-800 mb-4">üç™ Cookies and Tracking Technologies</h3>
                        <div class="space-y-3">
                            <p class="text-gray-600">
                                We use cookies and similar tracking technologies to track activity on our website and store certain information. Cookies are files with a small amount of data that are sent to your browser from a website and stored on your device.
                            </p>
                            <div class="bg-purple-50 p-4 rounded">
                                <h4 class="font-semibold text-gray-800 mb-2">Types of Cookies We Use:</h4>
                                <ul class="list-disc list-inside text-gray-600 space-y-1 ml-4">
                                    <li><strong>Essential Cookies:</strong> Required for website functionality</li>
                                    <li><strong>Analytics Cookies:</strong> Help us understand how visitors use our site</li>
                                    <li><strong>Advertising Cookies:</strong> Used by Google AdSense to deliver relevant ads</li>
                                    <li><strong>Preference Cookies:</strong> Remember your settings and preferences</li>
                                </ul>
                            </div>
                            <p class="text-gray-600">
                                You can instruct your browser to refuse all cookies or to indicate when a cookie is being sent. However, if you do not accept cookies, you may not be able to use some portions of our website.
                            </p>
                        </div>
                    </div>

                    <!-- How We Use Your Information -->
                    <div>
                        <h3 class="text-2xl font-bold text-gray-800 mb-4">‚öôÔ∏è How We Use Your Information</h3>
                        <div class="bg-indigo-50 p-4 rounded">
                            <ul class="space-y-2 text-gray-600">
                                <li class="flex items-start">
                                    <span class="text-indigo-600 mr-2">‚úì</span>
                                    <span>To provide and maintain our tools and services</span>
                                </li>
                                <li class="flex items-start">
                                    <span class="text-indigo-600 mr-2">‚úì</span>
                                    <span>To improve and personalize user experience</span>
                                </li>
                                <li class="flex items-start">
                                    <span class="text-indigo-600 mr-2">‚úì</span>
                                    <span>To analyze website usage and trends</span>
                                </li>
                                <li class="flex items-start">
                                    <span class="text-indigo-600 mr-2">‚úì</span>
                                    <span>To display relevant advertisements through Google AdSense</span>
                                </li>
                                <li class="flex items-start">
                                    <span class="text-indigo-600 mr-2">‚úì</span>
                                    <span>To respond to user inquiries and support requests</span>
                                </li>
                                <li class="flex items-start">
                                    <span class="text-indigo-600 mr-2">‚úì</span>
                                    <span>To detect, prevent, and address technical issues</span>
                                </li>
                            </ul>
                        </div>
                    </div>

                    <!-- Data Storage and Security -->
                    <div>
                        <h3 class="text-2xl font-bold text-gray-800 mb-4">üîê Data Storage and Security</h3>
                        <p class="text-gray-600 mb-3">
                            Most of our tools process data locally in your browser. We do not store the data you input into calculators, converters, or other tools on our servers. However, we cannot guarantee absolute security of data transmitted over the Internet.
                        </p>
                        <div class="bg-red-50 border-l-4 border-red-500 p-4 rounded">
                            <p class="text-gray-600">
                                <strong>Important:</strong> While we strive to use commercially acceptable means to protect your information, no method of transmission over the Internet or electronic storage is 100% secure. We cannot guarantee absolute security.
                            </p>
                        </div>
                    </div>

                    <!-- GDPR Compliance -->
                    <div>
                        <h3 class="text-2xl font-bold text-gray-800 mb-4">üá™üá∫ GDPR Compliance (European Users)</h3>
                        <p class="text-gray-600 mb-3">
                            If you are located in the European Economic Area (EEA), United Kingdom, or Switzerland, you have certain data protection rights under GDPR:
                        </p>
                        <div class="bg-blue-50 p-4 rounded space-y-2">
                            <p class="text-gray-600"><strong>‚Ä¢ Right to Access:</strong> Request copies of your personal data</p>
                            <p class="text-gray-600"><strong>‚Ä¢ Right to Rectification:</strong> Request correction of inaccurate data</p>
                            <p class="text-gray-600"><strong>‚Ä¢ Right to Erasure:</strong> Request deletion of your data</p>
                            <p class="text-gray-600"><strong>‚Ä¢ Right to Restrict Processing:</strong> Request limitation of data processing</p>
                            <p class="text-gray-600"><strong>‚Ä¢ Right to Data Portability:</strong> Request transfer of your data</p>
                            <p class="text-gray-600"><strong>‚Ä¢ Right to Object:</strong> Object to data processing</p>
                        </div>
                        <p class="text-gray-600 mt-3">
                            We use Google's Consent Management Platform (CMP) to collect and manage consent from users in these regions for advertising cookies and personalized ads.
                        </p>
                    </div>

                    <!-- Third-Party Services -->
                    <div>
                        <h3 class="text-2xl font-bold text-gray-800 mb-4">üîó Third-Party Services</h3>
                        <p class="text-gray-600 mb-3">
                            Our website may contain links to third-party websites and uses the following third-party services:
                        </p>
                        <div class="space-y-2">
                            <div class="bg-gray-50 p-3 rounded">
                                <p class="text-gray-600"><strong>Google AdSense:</strong> For displaying advertisements. <a href="https://policies.google.com/privacy" target="_blank" class="text-purple-600 hover:underline">Privacy Policy</a></p>
                            </div>
                            <div class="bg-gray-50 p-3 rounded">
                                <p class="text-gray-600"><strong>Netlify:</strong> For website hosting. <a href="https://www.netlify.com/privacy/" target="_blank" class="text-purple-600 hover:underline">Privacy Policy</a></p>
                            </div>
                        </div>
                        <p class="text-gray-600 mt-3">
                            We are not responsible for the privacy practices of these third-party services. We encourage you to review their privacy policies.
                        </p>
                    </div>

                    <!-- Children's Privacy -->
                    <div>
                        <h3 class="text-2xl font-bold text-gray-800 mb-4">üë∂ Children's Privacy</h3>
                        <div class="bg-orange-50 border-l-4 border-orange-500 p-4 rounded">
                            <p class="text-gray-600">
                                Our website is not intended for children under 13 years of age. We do not knowingly collect personal information from children under 13. If you are a parent or guardian and believe your child has provided us with personal information, please contact us so we can delete such information.
                            </p>
                        </div>
                    </div>

                    <!-- Changes to Privacy Policy -->
                    <div>
                        <h3 class="text-2xl font-bold text-gray-800 mb-4">üìù Changes to This Privacy Policy</h3>
                        <p class="text-gray-600">
                            We may update our Privacy Policy from time to time. We will notify you of any changes by posting the new Privacy Policy on this page and updating the "Last Updated" date at the top. You are advised to review this Privacy Policy periodically for any changes. Changes to this Privacy Policy are effective when they are posted on this page.
                        </p>
                    </div>

                    <!-- Contact Information -->
                    <div>
                        <h3 class="text-2xl font-bold text-gray-800 mb-4">üìß Contact Us</h3>
                        <div class="bg-gradient-to-r from-purple-50 to-blue-50 p-6 rounded-lg">
                            <p class="text-gray-600 mb-3">
                                If you have any questions about this Privacy Policy or our privacy practices, please contact us:
                            </p>
                            <div class="space-y-2 text-gray-700">
                                <p><strong>Website:</strong> <a href="https://freetoolhub.in" class="text-purple-600 hover:underline">freetoolhub.in</a></p>
                                <p><strong>Contact Form:</strong> <a href="#contact" class="text-purple-600 hover:underline">Use our contact form</a></p>
                            </div>
                        </div>
                    </div>

                    <!-- Consent Notice -->
                    <div class="border-t-2 border-gray-200 pt-6">
                        <div class="bg-green-50 border border-green-200 p-6 rounded-lg">
                            <h4 class="font-bold text-gray-800 mb-3 flex items-center">
                                <span class="text-2xl mr-2">‚úÖ</span>
                                Your Consent
                            </h4>
                            <p class="text-gray-600">
                                By using our website, you consent to our Privacy Policy and agree to its terms. For users in the EEA, UK, and Switzerland, you will be presented with a consent banner to manage your cookie preferences and advertising consent.
                            </p>
                        </div>
                    </div>
                    
                    <!-- Collapse Button -->
                    <div class="text-center pt-6 border-t-2 border-gray-200">
                        <button onclick="togglePrivacyDetails()" class="text-purple-600 hover:text-purple-700 font-semibold text-lg">
                            ‚Üë Show Less
                        </button>
                    </div>
                    
                    </div>
                    <!-- End of Full Privacy Details -->
                    </div>
                    
                </div>
            </div>
        </div>
    </div>

    <!-- Support Us Modal -->
    <div id="support-modal" class="modal" style="display: none;">
        <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
            <div class="bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden">
                <!-- Modal Header -->
                <div class="bg-gradient-to-r from-yellow-500 via-orange-500 to-red-500 text-white p-6 flex justify-between items-center">
                    <div>
                        <h3 class="text-2xl font-bold flex items-center gap-2">
                            ‚òï Support FreeToolHub
                        </h3>
                        <p class="text-yellow-100 mt-1">Help us keep tools free forever!</p>
                    </div>
                    <button onclick="closeSupportModal()" class="text-white hover:text-gray-200 text-3xl font-bold">&times;</button>
                </div>
                
                <!-- Modal Content -->
                <div class="p-8 max-h-[calc(90vh-120px)] overflow-y-auto">
                    
                    <!-- Main Message -->
                    <div class="text-center mb-8">
                        <div class="text-6xl mb-4">üíõ</div>
                        <h4 class="text-2xl font-bold text-gray-800 mb-3">Love Our Free Tools?</h4>
                        <p class="text-gray-600 text-lg">
                            Your support helps us maintain and improve FreeToolHub for everyone!
                        </p>
                    </div>

                    <!-- Why Support Section -->
                    <div class="bg-gradient-to-r from-purple-50 to-blue-50 p-6 rounded-xl mb-6">
                        <h5 class="font-bold text-gray-800 mb-4 text-lg">üöÄ Why Your Support Matters:</h5>
                        <div class="grid md:grid-cols-2 gap-3">
                            <div class="flex items-start gap-2">
                                <span class="text-green-500 text-xl">‚úì</span>
                                <span class="text-gray-700">Keep all tools completely free</span>
                            </div>
                            <div class="flex items-start gap-2">
                                <span class="text-green-500 text-xl">‚úì</span>
                                <span class="text-gray-700">Add new powerful features</span>
                            </div>
                            <div class="flex items-start gap-2">
                                <span class="text-green-500 text-xl">‚úì</span>
                                <span class="text-gray-700">Improve performance</span>
                            </div>
                            <div class="flex items-start gap-2">
                                <span class="text-green-500 text-xl">‚úì</span>
                                <span class="text-gray-700">Cover hosting costs</span>
                            </div>
                        </div>
                    </div>

                    <!-- Support Options -->
                    <div class="space-y-4 mb-6">
                        <h5 class="font-bold text-gray-800 text-lg mb-4">‚òï Support Options:</h5>
                        
                        <!-- Buy Me a Coffee - Main CTA -->
                        <a href="https://buymeacoffee.com/freetoolhubcommunity" target="_blank" class="block bg-gradient-to-r from-yellow-400 to-orange-500 hover:from-yellow-500 hover:to-orange-600 text-white p-6 rounded-xl shadow-lg hover:shadow-xl transition-all transform hover:scale-105">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-4">
                                    <div class="text-4xl">‚òï</div>
                                    <div>
                                        <div class="font-bold text-xl">Buy Me a Coffee</div>
                                        <div class="text-sm opacity-90">One-time or monthly support</div>
                                    </div>
                                </div>
                                <div class="text-2xl">‚Üí</div>
                            </div>
                        </a>

                        <!-- Alternative Options -->
                        <div class="flex justify-center">
                            <div class="bg-gray-50 p-4 rounded-lg border-2 border-gray-200 hover:border-purple-400 transition-all w-full max-w-md">
                                <div class="text-2xl mb-2">üí¨</div>
                                <div class="font-semibold text-gray-800">Spread the Word</div>
                                <div class="text-sm text-gray-600 mt-1">Share with friends!</div>
                                <button onclick="shareWebsite()" class="text-purple-600 text-sm hover:underline mt-2 font-semibold">‚Üí Share Website</button>
                            </div>
                        </div>
                    </div>

                    <!-- Thank You Message -->
                    <div class="bg-green-50 border-l-4 border-green-500 p-4 rounded">
                        <p class="text-gray-700 text-center">
                            <strong>üôè Thank you for considering!</strong><br>
                            <span class="text-sm">Every contribution, big or small, makes a huge difference!</span>
                        </p>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <!-- Calculator Modal -->
    <div id="calculator-modal" class="modal">
        <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
            <div class="bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden">
                <!-- Modal Header -->
                <div class="bg-gradient-to-r from-blue-500 to-purple-600 text-white p-6 flex justify-between items-center">
                    <div>
                        <h3 class="text-2xl font-bold">üßÆ Smart Calculator</h3>
                        <p class="text-blue-100 mt-1">Advanced calculator with scientific functions</p>
                    </div>
                    <button onclick="closeModal('calculator-modal')" class="text-white hover:text-gray-200 text-3xl font-bold">&times;</button>
                </div>
                
                <!-- Calculator Content -->
                <div class="p-6 max-h-[calc(90vh-120px)] overflow-y-auto">
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        <!-- Calculator Display -->
                        <div class="lg:col-span-2">
                            <div class="bg-gray-900 rounded-xl p-4 mb-4">
                                <div class="text-gray-400 text-sm mb-2">Expression:</div>
                                <input type="text" id="calc-expression" class="w-full bg-transparent text-white text-xl font-mono border-none outline-none" placeholder="Enter expression..." readonly>
                                <div class="text-gray-400 text-sm mt-2 mb-1">Result:</div>
                                <div id="calc-result" class="text-green-400 text-3xl font-mono font-bold min-h-[40px]">0</div>
                            </div>
                            
                            <!-- Calculator Buttons -->
                            <div class="grid grid-cols-5 gap-2">
                                <!-- Row 1: Functions -->
                                <button onclick="calcFunction('sin')" class="calc-btn-function">sin</button>
                                <button onclick="calcFunction('cos')" class="calc-btn-function">cos</button>
                                <button onclick="calcFunction('tan')" class="calc-btn-function">tan</button>
                                <button onclick="calcFunction('log')" class="calc-btn-function">log</button>
                                <button onclick="calcFunction('ln')" class="calc-btn-function">ln</button>
                                
                                <!-- Row 2: More Functions -->
                                <button onclick="calcInput('(')" class="calc-btn-operator">(</button>
                                <button onclick="calcInput(')')" class="calc-btn-operator">)</button>
                                <button onclick="calcInput('^')" class="calc-btn-operator">x^y</button>
                                <button onclick="calcFunction('sqrt')" class="calc-btn-function">‚àö</button>
                                <button onclick="calcClear()" class="calc-btn-clear">C</button>
                                
                                <!-- Row 3: Numbers -->
                                <button onclick="calcInput('7')" class="calc-btn-number">7</button>
                                <button onclick="calcInput('8')" class="calc-btn-number">8</button>
                                <button onclick="calcInput('9')" class="calc-btn-number">9</button>
                                <button onclick="calcInput('/')" class="calc-btn-operator">√∑</button>
                                <button onclick="calcDelete()" class="calc-btn-clear">‚å´</button>
                                
                                <!-- Row 4: Numbers -->
                                <button onclick="calcInput('4')" class="calc-btn-number">4</button>
                                <button onclick="calcInput('5')" class="calc-btn-number">5</button>
                                <button onclick="calcInput('6')" class="calc-btn-number">6</button>
                                <button onclick="calcInput('*')" class="calc-btn-operator">√ó</button>
                                <button onclick="calcInput('pi')" class="calc-btn-function">œÄ</button>
                                
                                <!-- Row 5: Numbers -->
                                <button onclick="calcInput('1')" class="calc-btn-number">1</button>
                                <button onclick="calcInput('2')" class="calc-btn-number">2</button>
                                <button onclick="calcInput('3')" class="calc-btn-number">3</button>
                                <button onclick="calcInput('-')" class="calc-btn-operator">-</button>
                                <button onclick="calcInput('e')" class="calc-btn-function">e</button>
                                
                                <!-- Row 6: Numbers -->
                                <button onclick="calcInput('0')" class="calc-btn-number">0</button>
                                <button onclick="calcInput('.')" class="calc-btn-number">.</button>
                                <button onclick="calcCalculate()" class="calc-btn-equals">=</button>
                                <button onclick="calcInput('+')" class="calc-btn-operator">+</button>
                                <button onclick="switchMode()" class="calc-btn-function" id="mode-btn">RAD</button>
                            </div>
                        </div>
                        
                        <!-- History Panel -->
                        <div class="lg:col-span-1">
                            <h4 class="text-lg font-bold mb-3 text-gray-700">History</h4>
                            <div id="calc-history" class="bg-gray-50 rounded-xl p-4 h-96 overflow-y-auto">
                                <div class="text-gray-500 text-center">No calculations yet</div>
                            </div>
                            <div class="mt-4 space-y-2">
                                <button onclick="clearHistory()" class="w-full bg-red-500 text-white py-2 px-4 rounded-lg hover:bg-red-600 transition-colors">
                                    Clear History
                                </button>
                                <button onclick="exportHistory()" class="w-full bg-blue-500 text-white py-2 px-4 rounded-lg hover:bg-blue-600 transition-colors">
                                    Export History
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Loan Calculator Modal -->
    <div id="loan-calculator-modal" class="modal">
        <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
            <div class="bg-white rounded-2xl shadow-2xl w-full max-w-6xl max-h-[90vh] overflow-hidden">
                <!-- Modal Header -->
                <div class="bg-gradient-to-r from-green-500 to-emerald-600 text-white p-6 flex justify-between items-center">
                    <div>
                        <h3 class="text-2xl font-bold">üè¶ Professional Loan Calculator</h3>
                        <p class="text-green-100 mt-1">Calculate loan payments, amortization, and analysis</p>
                    </div>
                    <button onclick="closeModal('loan-calculator-modal')" class="text-white hover:text-gray-200 text-3xl font-bold">&times;</button>
                </div>
                
                <!-- Loan Calculator Content -->
                <div class="p-6 max-h-[calc(90vh-120px)] overflow-y-auto">
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- Input Section -->
                        <div class="space-y-6">
                            <div class="bg-gray-50 rounded-xl p-6">
                                <h4 class="text-lg font-bold mb-4 text-gray-700">Loan Details</h4>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-600 mb-2">Currency</label>
                                        <select id="loan-currency" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" onchange="updateCurrencyDisplay()">
                                            <option value="USD">üá∫üá∏ US Dollar ($)</option>
                                            <option value="EUR">üá™üá∫ Euro (‚Ç¨)</option>
                                            <option value="GBP">üá¨üáß British Pound (¬£)</option>
                                            <option value="JPY">üáØüáµ Japanese Yen (¬•)</option>
                                            <option value="CAD">üá®üá¶ Canadian Dollar (C$)</option>
                                            <option value="AUD">üá¶üá∫ Australian Dollar (A$)</option>
                                            <option value="CHF">üá®üá≠ Swiss Franc (CHF)</option>
                                            <option value="CNY">üá®üá≥ Chinese Yuan (¬•)</option>
                                            <option value="INR">üáÆüá≥ Indian Rupee (‚Çπ)</option>
                                            <option value="BRL">üáßüá∑ Brazilian Real (R$)</option>
                                            <option value="SGD">üá∏üá¨ Singapore Dollar (S$)</option>
                                            <option value="AED">üá¶üá™ UAE Dirham (ÿØ.ÿ•)</option>
                                            <option value="SAR">üá∏üá¶ Saudi Riyal (Ô∑º)</option>
                                            <option value="ZAR">üáøüá¶ South African Rand (R)</option>
                                            <option value="MXN">üá≤üáΩ Mexican Peso ($)</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-600 mb-2">Loan Amount</label>
                                        <input type="number" id="loan-amount" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="250000" value="250000">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-600 mb-2">Annual Interest Rate (%)</label>
                                        <input type="number" id="interest-rate" step="0.01" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="3.5" value="3.5">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-600 mb-2">Loan Term (Years)</label>
                                        <input type="number" id="loan-term" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="30" value="30">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-600 mb-2">Payment Frequency</label>
                                        <select id="payment-frequency" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500">
                                            <option value="12">Monthly (12/year)</option>
                                            <option value="26">Bi-weekly (26/year)</option>
                                            <option value="52">Weekly (52/year)</option>
                                        </select>
                                    </div>
                                </div>
                                <button onclick="calculateLoan()" class="w-full mt-6 bg-gradient-to-r from-green-500 to-emerald-600 text-white font-bold py-3 px-6 rounded-xl hover:from-green-600 hover:to-emerald-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                    Calculate Loan
                                </button>
                            </div>

                            <!-- Extra Payment Section -->
                            <div class="bg-blue-50 rounded-xl p-6">
                                <h4 class="text-lg font-bold mb-4 text-gray-700">Extra Payment Analysis</h4>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-600 mb-2">Extra Monthly Payment</label>
                                        <input type="number" id="extra-payment" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="200" value="200">
                                    </div>
                                    <button onclick="calculateExtraPayment()" class="w-full bg-gradient-to-r from-blue-500 to-blue-600 text-white font-bold py-3 px-6 rounded-xl hover:from-blue-600 hover:to-blue-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                        Analyze Extra Payments
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Results Section -->
                        <div class="space-y-6">
                            <!-- Basic Results -->
                            <div class="bg-green-50 rounded-xl p-6">
                                <h4 class="text-lg font-bold mb-4 text-gray-700">Loan Summary</h4>
                                <div id="loan-results" class="space-y-3">
                                    <div class="text-center text-gray-500">Enter loan details and click "Calculate Loan"</div>
                                </div>
                            </div>

                            <!-- Extra Payment Results -->
                            <div class="bg-blue-50 rounded-xl p-6">
                                <h4 class="text-lg font-bold mb-4 text-gray-700">Extra Payment Analysis</h4>
                                <div id="extra-payment-results" class="space-y-3">
                                    <div class="text-center text-gray-500">Enter extra payment amount and click "Analyze Extra Payments"</div>
                                </div>
                            </div>

                            <!-- Amortization Schedule -->
                            <div class="bg-gray-50 rounded-xl p-6">
                                <h4 class="text-lg font-bold mb-4 text-gray-700">Amortization Schedule</h4>
                                <div id="amortization-schedule" class="max-h-64 overflow-y-auto">
                                    <div class="text-center text-gray-500">Calculate loan to see amortization schedule</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Investment Calculator Modal -->
    <div id="investment-calculator-modal" class="modal">
        <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
            <div class="bg-white rounded-2xl shadow-2xl w-full max-w-6xl max-h-[90vh] overflow-hidden">
                <!-- Modal Header -->
                <div class="bg-gradient-to-r from-blue-500 to-indigo-600 text-white p-6 flex justify-between items-center">
                    <div>
                        <h3 class="text-2xl font-bold">üìà Investment Calculator</h3>
                        <p class="text-blue-100 mt-1">Calculate investment returns, compound interest, and retirement planning</p>
                    </div>
                    <button onclick="closeModal('investment-calculator-modal')" class="text-white hover:text-gray-200 text-3xl font-bold">&times;</button>
                </div>
                
                <!-- Investment Calculator Content -->
                <div class="p-6 max-h-[calc(90vh-120px)] overflow-y-auto">
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- Input Section -->
                        <div class="space-y-6">
                            <!-- Basic Investment Calculator -->
                            <div class="bg-gray-50 rounded-xl p-6">
                                <h4 class="text-lg font-bold mb-4 text-gray-700">Investment Calculator</h4>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-600 mb-2">Currency</label>
                                        <select id="investment-currency" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" onchange="updateInvestmentCurrencyDisplay()">
                                            <option value="USD">üá∫üá∏ US Dollar ($)</option>
                                            <option value="EUR">üá™üá∫ Euro (‚Ç¨)</option>
                                            <option value="GBP">üá¨üáß British Pound (¬£)</option>
                                            <option value="JPY">üáØüáµ Japanese Yen (¬•)</option>
                                            <option value="CAD">üá®üá¶ Canadian Dollar (C$)</option>
                                            <option value="AUD">üá¶üá∫ Australian Dollar (A$)</option>
                                            <option value="CHF">üá®üá≠ Swiss Franc (CHF)</option>
                                            <option value="CNY">üá®üá≥ Chinese Yuan (¬•)</option>
                                            <option value="INR">üáÆüá≥ Indian Rupee (‚Çπ)</option>
                                            <option value="BRL">üáßüá∑ Brazilian Real (R$)</option>
                                            <option value="SGD">üá∏üá¨ Singapore Dollar (S$)</option>
                                            <option value="AED">üá¶üá™ UAE Dirham (ÿØ.ÿ•)</option>
                                            <option value="SAR">üá∏üá¶ Saudi Riyal (Ô∑º)</option>
                                            <option value="ZAR">üáøüá¶ South African Rand (R)</option>
                                            <option value="MXN">üá≤üáΩ Mexican Peso ($)</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-600 mb-2">Initial Investment</label>
                                        <input type="number" id="initial-investment" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="10000" value="10000">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-600 mb-2">Monthly Contribution</label>
                                        <input type="number" id="monthly-contribution" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="500" value="500">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-600 mb-2">Annual Return Rate (%)</label>
                                        <input type="number" id="annual-return" step="0.01" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="7" value="7">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-600 mb-2">Investment Period (Years)</label>
                                        <input type="number" id="investment-years" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="30" value="30">
                                    </div>
                                </div>
                                <button onclick="calculateInvestment()" class="w-full mt-6 bg-gradient-to-r from-blue-500 to-indigo-600 text-white font-bold py-3 px-6 rounded-xl hover:from-blue-600 hover:to-indigo-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                    Calculate Investment
                                </button>
                            </div>

                            <!-- Retirement Planning -->
                            <div class="bg-green-50 rounded-xl p-6">
                                <h4 class="text-lg font-bold mb-4 text-gray-700">Retirement Planning</h4>
                                <div class="space-y-4">
                                    <div class="grid grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-600 mb-2">Current Age</label>
                                            <input type="number" id="current-age" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="30" value="30">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-600 mb-2">Retirement Age</label>
                                            <input type="number" id="retirement-age" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="65" value="65">
                                        </div>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-600 mb-2">Current Savings</label>
                                        <input type="number" id="current-savings" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="50000" value="50000">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-600 mb-2">Desired Annual Income</label>
                                        <input type="number" id="desired-income" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="80000" value="80000">
                                    </div>
                                </div>
                                <button onclick="calculateRetirement()" class="w-full mt-4 bg-gradient-to-r from-green-500 to-green-600 text-white font-bold py-3 px-6 rounded-xl hover:from-green-600 hover:to-green-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                    Plan Retirement
                                </button>
                            </div>
                        </div>
                        
                        <!-- Results Section -->
                        <div class="space-y-6">
                            <!-- Investment Results -->
                            <div class="bg-blue-50 rounded-xl p-6">
                                <h4 class="text-lg font-bold mb-4 text-gray-700">Investment Results</h4>
                                <div id="investment-results" class="space-y-3">
                                    <div class="text-center text-gray-500">Enter investment details and click "Calculate Investment"</div>
                                </div>
                            </div>

                            <!-- Retirement Results -->
                            <div class="bg-green-50 rounded-xl p-6">
                                <h4 class="text-lg font-bold mb-4 text-gray-700">Retirement Analysis</h4>
                                <div id="retirement-results" class="space-y-3">
                                    <div class="text-center text-gray-500">Enter retirement details and click "Plan Retirement"</div>
                                </div>
                            </div>

                            <!-- Growth Projection Chart -->
                            <div class="bg-gray-50 rounded-xl p-6">
                                <h4 class="text-lg font-bold mb-4 text-gray-700">Growth Projection</h4>
                                <div id="growth-projection" class="max-h-64 overflow-y-auto">
                                    <div class="text-center text-gray-500">Calculate investment to see growth projection</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Tax Calculator Modal -->
    <div id="tax-calculator-modal" class="modal">
        <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
            <div class="bg-white rounded-2xl shadow-2xl w-full max-w-6xl max-h-[90vh] overflow-hidden">
                <!-- Modal Header -->
                <div class="bg-gradient-to-r from-purple-500 to-pink-600 text-white p-6 flex justify-between items-center">
                    <div>
                        <h3 class="text-2xl font-bold">üßæ Tax Calculator</h3>
                        <p class="text-purple-100 mt-1">Calculate income tax for multiple countries with progressive tax brackets</p>
                    </div>
                    <button onclick="closeModal('tax-calculator-modal')" class="text-white hover:text-gray-200 text-3xl font-bold">&times;</button>
                </div>
                
                <!-- Tax Calculator Content -->
                <div class="p-6 max-h-[calc(90vh-120px)] overflow-y-auto">
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- Input Section -->
                        <div class="space-y-6">
                            <!-- Basic Tax Calculator -->
                            <div class="bg-gray-50 rounded-xl p-6">
                                <h4 class="text-lg font-bold mb-4 text-gray-700">Tax Calculation</h4>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-600 mb-2">Country</label>
                                        <select id="tax-country" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500">
                                            <option value="US">üá∫üá∏ United States</option>
                                            <option value="UK">üá¨üáß United Kingdom</option>
                                            <option value="CA">üá®üá¶ Canada</option>
                                            <option value="AU">üá¶üá∫ Australia</option>
                                            <option value="IN">üáÆüá≥ India</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-600 mb-2">Currency</label>
                                        <select id="tax-currency" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" onchange="updateTaxCurrencyDisplay()">
                                            <option value="USD">üá∫üá∏ US Dollar ($)</option>
                                            <option value="EUR">üá™üá∫ Euro (‚Ç¨)</option>
                                            <option value="GBP">üá¨üáß British Pound (¬£)</option>
                                            <option value="JPY">üáØüáµ Japanese Yen (¬•)</option>
                                            <option value="CAD">üá®üá¶ Canadian Dollar (C$)</option>
                                            <option value="AUD">üá¶üá∫ Australian Dollar (A$)</option>
                                            <option value="CHF">üá®üá≠ Swiss Franc (CHF)</option>
                                            <option value="CNY">üá®üá≥ Chinese Yuan (¬•)</option>
                                            <option value="INR">üáÆüá≥ Indian Rupee (‚Çπ)</option>
                                            <option value="BRL">üáßüá∑ Brazilian Real (R$)</option>
                                            <option value="SGD">üá∏üá¨ Singapore Dollar (S$)</option>
                                            <option value="AED">üá¶üá™ UAE Dirham (ÿØ.ÿ•)</option>
                                            <option value="SAR">üá∏üá¶ Saudi Riyal (Ô∑º)</option>
                                            <option value="ZAR">üáøüá¶ South African Rand (R)</option>
                                            <option value="MXN">üá≤üáΩ Mexican Peso ($)</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-600 mb-2">Filing Status</label>
                                        <select id="filing-status" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500">
                                            <option value="single">Single</option>
                                            <option value="married">Married Filing Jointly</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-600 mb-2">Gross Income</label>
                                        <input type="number" id="gross-income" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="75000" value="75000">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-600 mb-2">Deductions</label>
                                        <input type="number" id="deductions" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="12500" value="12500">
                                    </div>
                                </div>
                                <button onclick="calculateTax()" class="w-full mt-6 bg-gradient-to-r from-purple-500 to-pink-600 text-white font-bold py-3 px-6 rounded-xl hover:from-purple-600 hover:to-pink-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                    Calculate Tax
                                </button>
                            </div>

                            <!-- Take-Home Pay Calculator -->
                            <div class="bg-blue-50 rounded-xl p-6">
                                <h4 class="text-lg font-bold mb-4 text-gray-700">Take-Home Pay Calculator</h4>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-600 mb-2">Other Deductions (401k, Insurance, etc.)</label>
                                        <input type="number" id="other-deductions" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="5000" value="5000">
                                    </div>
                                    <button onclick="calculateTakeHomePay()" class="w-full bg-gradient-to-r from-blue-500 to-blue-600 text-white font-bold py-3 px-6 rounded-xl hover:from-blue-600 hover:to-blue-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                        Calculate Take-Home Pay
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Results Section -->
                        <div class="space-y-6">
                            <!-- Tax Results -->
                            <div class="bg-purple-50 rounded-xl p-6">
                                <h4 class="text-lg font-bold mb-4 text-gray-700">Tax Results</h4>
                                <div id="tax-results" class="space-y-3">
                                    <div class="text-center text-gray-500">Enter tax details and click "Calculate Tax"</div>
                                </div>
                            </div>

                            <!-- Take-Home Pay Results -->
                            <div class="bg-blue-50 rounded-xl p-6">
                                <h4 class="text-lg font-bold mb-4 text-gray-700">Take-Home Pay Analysis</h4>
                                <div id="take-home-results" class="space-y-3">
                                    <div class="text-center text-gray-500">Enter details and click "Calculate Take-Home Pay"</div>
                                </div>
                            </div>

                            <!-- Tax Bracket Breakdown -->
                            <div class="bg-gray-50 rounded-xl p-6">
                                <h4 class="text-lg font-bold mb-4 text-gray-700">Tax Bracket Breakdown</h4>
                                <div id="tax-breakdown" class="max-h-64 overflow-y-auto">
                                    <div class="text-center text-gray-500">Calculate tax to see bracket breakdown</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Business Metrics Calculator Modal -->
    <div id="business-metrics-modal" class="modal">
        <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
            <div class="bg-white rounded-2xl shadow-2xl w-full max-w-7xl max-h-[90vh] overflow-hidden">
                <!-- Modal Header -->
                <div class="bg-gradient-to-r from-orange-500 to-red-600 text-white p-6 flex justify-between items-center">
                    <div>
                        <h3 class="text-2xl font-bold">üìä Business Metrics Calculator</h3>
                        <p class="text-orange-100 mt-1">Calculate business performance metrics, profitability, and financial ratios</p>
                    </div>
                    <button onclick="closeModal('business-metrics-modal')" class="text-white hover:text-gray-200 text-3xl font-bold">&times;</button>
                </div>
                
                <!-- Business Metrics Calculator Content -->
                <div class="p-6 max-h-[calc(90vh-120px)] overflow-y-auto">
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- Input Section -->
                        <div class="space-y-6">
                            <!-- Basic Business Metrics -->
                            <div class="bg-gray-50 rounded-xl p-6">
                                <h4 class="text-lg font-bold mb-4 text-gray-700">Business Performance Metrics</h4>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-600 mb-2">Currency</label>
                                        <select id="business-currency" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500" onchange="updateBusinessCurrencyDisplay()">
                                            <option value="USD">üá∫üá∏ US Dollar ($)</option>
                                            <option value="EUR">üá™üá∫ Euro (‚Ç¨)</option>
                                            <option value="GBP">üá¨üáß British Pound (¬£)</option>
                                            <option value="JPY">üáØüáµ Japanese Yen (¬•)</option>
                                            <option value="CAD">üá®üá¶ Canadian Dollar (C$)</option>
                                            <option value="AUD">üá¶üá∫ Australian Dollar (A$)</option>
                                            <option value="CHF">üá®üá≠ Swiss Franc (CHF)</option>
                                            <option value="CNY">üá®üá≥ Chinese Yuan (¬•)</option>
                                            <option value="INR">üáÆüá≥ Indian Rupee (‚Çπ)</option>
                                            <option value="BRL">üáßüá∑ Brazilian Real (R$)</option>
                                            <option value="SGD">üá∏üá¨ Singapore Dollar (S$)</option>
                                            <option value="AED">üá¶üá™ UAE Dirham (ÿØ.ÿ•)</option>
                                            <option value="SAR">üá∏üá¶ Saudi Riyal (Ô∑º)</option>
                                            <option value="ZAR">üáøüá¶ South African Rand (R)</option>
                                            <option value="MXN">üá≤üáΩ Mexican Peso ($)</option>
                                        </select>
                                    </div>
                                    <div class="grid grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-600 mb-2">Revenue</label>
                                            <input type="number" id="revenue" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500" placeholder="100000" value="100000">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-600 mb-2">Cost of Goods Sold</label>
                                            <input type="number" id="costs" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500" placeholder="60000" value="60000">
                                        </div>
                                    </div>
                                    <div class="grid grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-600 mb-2">Operating Expenses</label>
                                            <input type="number" id="expenses" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500" placeholder="25000" value="25000">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-600 mb-2">Total Assets</label>
                                            <input type="number" id="assets" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500" placeholder="200000" value="200000">
                                        </div>
                                    </div>
                                    <div class="grid grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-600 mb-2">Total Liabilities</label>
                                            <input type="number" id="liabilities" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500" placeholder="80000" value="80000">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-600 mb-2">Total Equity</label>
                                            <input type="number" id="equity" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500" placeholder="120000" value="120000">
                                        </div>
                                    </div>
                                </div>
                                <button onclick="calculateBusinessMetrics()" class="w-full mt-6 bg-gradient-to-r from-orange-500 to-red-600 text-white font-bold py-3 px-6 rounded-xl hover:from-orange-600 hover:to-red-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                    Calculate Business Metrics
                                </button>
                            </div>

                            <!-- Break-Even Analysis -->
                            <div class="bg-blue-50 rounded-xl p-6">
                                <h4 class="text-lg font-bold mb-4 text-gray-700">Break-Even Analysis</h4>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-600 mb-2">Fixed Costs</label>
                                        <input type="number" id="fixed-costs" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="15000" value="15000">
                                    </div>
                                    <div class="grid grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-600 mb-2">Variable Cost per Unit</label>
                                            <input type="number" id="variable-cost" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="20" value="20">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-600 mb-2">Selling Price per Unit</label>
                                            <input type="number" id="selling-price" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="50" value="50">
                                        </div>
                                    </div>
                                </div>
                                <button onclick="calculateBreakEven()" class="w-full mt-4 bg-gradient-to-r from-blue-500 to-blue-600 text-white font-bold py-3 px-6 rounded-xl hover:from-blue-600 hover:to-blue-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                    Calculate Break-Even
                                </button>
                            </div>
                        </div>
                        
                        <!-- Results Section -->
                        <div class="space-y-6">
                            <!-- Business Metrics Results -->
                            <div class="bg-orange-50 rounded-xl p-6">
                                <h4 class="text-lg font-bold mb-4 text-gray-700">Business Performance</h4>
                                <div id="business-results" class="space-y-3">
                                    <div class="text-center text-gray-500">Enter business details and click "Calculate Business Metrics"</div>
                                </div>
                            </div>

                            <!-- Break-Even Results -->
                            <div class="bg-blue-50 rounded-xl p-6">
                                <h4 class="text-lg font-bold mb-4 text-gray-700">Break-Even Analysis</h4>
                                <div id="break-even-results" class="space-y-3">
                                    <div class="text-center text-gray-500">Enter break-even details and click "Calculate Break-Even"</div>
                                </div>
                            </div>

                            <!-- Financial Ratios -->
                            <div class="bg-gray-50 rounded-xl p-6">
                                <h4 class="text-lg font-bold mb-4 text-gray-700">Financial Ratios</h4>
                                <div id="financial-ratios" class="space-y-3">
                                    <div class="text-center text-gray-500">Calculate business metrics to see financial ratios</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Currency Converter Modal -->
    <div id="currency-converter-modal" class="modal">
        <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
            <div class="bg-white rounded-2xl shadow-2xl w-full max-w-6xl max-h-[90vh] overflow-hidden">
                <!-- Modal Header -->
                <div class="bg-gradient-to-r from-cyan-500 to-teal-600 text-white p-6 flex justify-between items-center">
                    <div>
                        <h3 class="text-2xl font-bold">üí± Currency Converter</h3>
                        <p class="text-cyan-100 mt-1">Convert between 20+ currencies with real-time exchange rates</p>
                    </div>
                    <button onclick="closeModal('currency-converter-modal')" class="text-white hover:text-gray-200 text-3xl font-bold">&times;</button>
                </div>
                
                <!-- Currency Converter Content -->
                <div class="p-6 max-h-[calc(90vh-120px)] overflow-y-auto">
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- Input Section -->
                        <div class="space-y-6">
                            <!-- Basic Currency Converter -->
                            <div class="bg-gray-50 rounded-xl p-6">
                                <h4 class="text-lg font-bold mb-4 text-gray-700">Currency Converter</h4>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-600 mb-2">Amount</label>
                                        <input type="number" id="convert-amount" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500" placeholder="100" value="100">
                                    </div>
                                    <div class="grid grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-600 mb-2">From Currency</label>
                                            <select id="from-currency" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500">
                                                <option value="USD">üá∫üá∏ US Dollar ($)</option>
                                                <option value="EUR">üá™üá∫ Euro (‚Ç¨)</option>
                                                <option value="GBP">üá¨üáß British Pound (¬£)</option>
                                                <option value="JPY">üáØüáµ Japanese Yen (¬•)</option>
                                                <option value="CAD">üá®üá¶ Canadian Dollar (C$)</option>
                                                <option value="AUD">üá¶üá∫ Australian Dollar (A$)</option>
                                                <option value="CHF">üá®üá≠ Swiss Franc (CHF)</option>
                                                <option value="CNY">üá®üá≥ Chinese Yuan (¬•)</option>
                                                <option value="INR">üáÆüá≥ Indian Rupee (‚Çπ)</option>
                                                <option value="BRL">üáßüá∑ Brazilian Real (R$)</option>
                                                <option value="SGD">üá∏üá¨ Singapore Dollar (S$)</option>
                                                <option value="AED">üá¶üá™ UAE Dirham (ÿØ.ÿ•)</option>
                                                <option value="SAR">üá∏üá¶ Saudi Riyal (Ô∑º)</option>
                                                <option value="ZAR">üáøüá¶ South African Rand (R)</option>
                                                <option value="MXN">üá≤üáΩ Mexican Peso ($)</option>
                                                <option value="KRW">üá∞üá∑ South Korean Won (‚Ç©)</option>
                                                <option value="THB">üáπüá≠ Thai Baht (‡∏ø)</option>
                                                <option value="NZD">üá≥üáø New Zealand Dollar (NZ$)</option>
                                                <option value="NOK">üá≥üá¥ Norwegian Krone (kr)</option>
                                                <option value="SEK">üá∏üá™ Swedish Krona (kr)</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-600 mb-2">To Currency</label>
                                            <select id="to-currency" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500">
                                                <option value="EUR">üá™üá∫ Euro (‚Ç¨)</option>
                                                <option value="USD">üá∫üá∏ US Dollar ($)</option>
                                                <option value="GBP">üá¨üáß British Pound (¬£)</option>
                                                <option value="JPY">üáØüáµ Japanese Yen (¬•)</option>
                                                <option value="CAD">üá®üá¶ Canadian Dollar (C$)</option>
                                                <option value="AUD">üá¶üá∫ Australian Dollar (A$)</option>
                                                <option value="CHF">üá®üá≠ Swiss Franc (CHF)</option>
                                                <option value="CNY">üá®üá≥ Chinese Yuan (¬•)</option>
                                                <option value="INR">üáÆüá≥ Indian Rupee (‚Çπ)</option>
                                                <option value="BRL">üáßüá∑ Brazilian Real (R$)</option>
                                                <option value="SGD">üá∏üá¨ Singapore Dollar (S$)</option>
                                                <option value="AED">üá¶üá™ UAE Dirham (ÿØ.ÿ•)</option>
                                                <option value="SAR">üá∏üá¶ Saudi Riyal (Ô∑º)</option>
                                                <option value="ZAR">üáøüá¶ South African Rand (R)</option>
                                                <option value="MXN">üá≤üáΩ Mexican Peso ($)</option>
                                                <option value="KRW">üá∞üá∑ South Korean Won (‚Ç©)</option>
                                                <option value="THB">üáπüá≠ Thai Baht (‡∏ø)</option>
                                                <option value="NZD">üá≥üáø New Zealand Dollar (NZ$)</option>
                                                <option value="NOK">üá≥üá¥ Norwegian Krone (kr)</option>
                                                <option value="SEK">üá∏üá™ Swedish Krona (kr)</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <button onclick="convertCurrency()" class="w-full mt-6 bg-gradient-to-r from-cyan-500 to-teal-600 text-white font-bold py-3 px-6 rounded-xl hover:from-cyan-600 hover:to-teal-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                    Convert Currency
                                </button>
                            </div>

                            <!-- Travel Expense Calculator -->
                            <div class="bg-blue-50 rounded-xl p-6">
                                <h4 class="text-lg font-bold mb-4 text-gray-700">Travel Expense Calculator</h4>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-600 mb-2">Hotel Cost</label>
                                        <input type="number" id="hotel-cost" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="200" value="200">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-600 mb-2">Food Cost</label>
                                        <input type="number" id="food-cost" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="100" value="100">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-600 mb-2">Transportation Cost</label>
                                        <input type="number" id="transport-cost" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="50" value="50">
                                    </div>
                                </div>
                                <button onclick="calculateTravelExpenses()" class="w-full mt-4 bg-gradient-to-r from-blue-500 to-blue-600 text-white font-bold py-3 px-6 rounded-xl hover:from-blue-600 hover:to-blue-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                    Calculate Travel Expenses
                                </button>
                            </div>
                        </div>
                        
                        <!-- Results Section -->
                        <div class="space-y-6">
                            <!-- Conversion Results -->
                            <div class="bg-cyan-50 rounded-xl p-6">
                                <h4 class="text-lg font-bold mb-4 text-gray-700">Conversion Results</h4>
                                <div id="conversion-results" class="space-y-3">
                                    <div class="text-center text-gray-500">Enter amount and currencies to convert</div>
                                </div>
                            </div>

                            <!-- Travel Expense Results -->
                            <div class="bg-blue-50 rounded-xl p-6">
                                <h4 class="text-lg font-bold mb-4 text-gray-700">Travel Expense Summary</h4>
                                <div id="travel-results" class="space-y-3">
                                    <div class="text-center text-gray-500">Enter travel expenses to calculate</div>
                                </div>
                            </div>

                            <!-- Exchange Rate Table -->
                            <div class="bg-gray-50 rounded-xl p-6">
                                <div class="flex justify-between items-center mb-4">
                                    <h4 class="text-lg font-bold text-gray-700">Exchange Rates</h4>
                                    <div class="flex items-center space-x-2">
                                        <button onclick="refreshExchangeRates()" class="px-3 py-1 bg-cyan-500 text-white text-sm rounded-lg hover:bg-cyan-600 transition-colors">
                                            üîÑ Refresh
                                        </button>
                                        <div id="rate-status" class="text-xs text-gray-500">
                                            <span class="inline-block w-2 h-2 bg-gray-400 rounded-full mr-1"></span>
                                            Loading...
                                        </div>
                                    </div>
                                </div>
                                <div id="exchange-rates" class="max-h-64 overflow-y-auto">
                                    <div class="text-center text-gray-500">Select currencies to see exchange rates</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Retirement Planning Calculator Modal -->
    <div id="retirement-calculator-modal" class="modal">
        <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
            <div class="bg-white rounded-2xl shadow-2xl w-full max-w-7xl max-h-[90vh] overflow-hidden">
                <!-- Modal Header -->
                <div class="bg-gradient-to-r from-purple-500 to-indigo-600 text-white p-6 flex justify-between items-center">
                    <div>
                        <h3 class="text-2xl font-bold">üè¶ Retirement Planning Calculator</h3>
                        <p class="text-purple-100 mt-1">Plan your retirement with comprehensive savings and income analysis</p>
                    </div>
                    <button onclick="closeModal('retirement-calculator-modal')" class="text-white hover:text-gray-200 text-3xl font-bold">&times;</button>
                </div>
                
                <!-- Retirement Calculator Content -->
                <div class="p-6 max-h-[calc(90vh-120px)] overflow-y-auto">
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- Input Section -->
                        <div class="space-y-6">
                            <!-- Basic Retirement Planning -->
                            <div class="bg-gray-50 rounded-xl p-6">
                                <h4 class="text-lg font-bold mb-4 text-gray-700">Retirement Planning</h4>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-600 mb-2">Currency</label>
                                        <select id="retirement-currency" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" onchange="updateRetirementCurrencyDisplay()">
                                            <option value="USD">üá∫üá∏ US Dollar ($)</option>
                                            <option value="EUR">üá™üá∫ Euro (‚Ç¨)</option>
                                            <option value="GBP">üá¨üáß British Pound (¬£)</option>
                                            <option value="JPY">üáØüáµ Japanese Yen (¬•)</option>
                                            <option value="CAD">üá®üá¶ Canadian Dollar (C$)</option>
                                            <option value="AUD">üá¶üá∫ Australian Dollar (A$)</option>
                                            <option value="CHF">üá®üá≠ Swiss Franc (CHF)</option>
                                            <option value="CNY">üá®üá≥ Chinese Yuan (¬•)</option>
                                            <option value="INR">üáÆüá≥ Indian Rupee (‚Çπ)</option>
                                            <option value="BRL">üáßüá∑ Brazilian Real (R$)</option>
                                            <option value="SGD">üá∏üá¨ Singapore Dollar (S$)</option>
                                            <option value="AED">üá¶üá™ UAE Dirham (ÿØ.ÿ•)</option>
                                            <option value="SAR">üá∏üá¶ Saudi Riyal (Ô∑º)</option>
                                            <option value="ZAR">üáøüá¶ South African Rand (R)</option>
                                            <option value="MXN">üá≤üáΩ Mexican Peso ($)</option>
                                        </select>
                                    </div>
                                    <div class="grid grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-600 mb-2">Current Age</label>
                                            <input type="number" id="current-age" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="30" value="30">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-600 mb-2">Retirement Age</label>
                                            <input type="number" id="retirement-age" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="65" value="65">
                                        </div>
                                    </div>
                                    <div class="grid grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-600 mb-2">Current Salary</label>
                                            <input type="number" id="current-salary" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="75000" value="75000">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-600 mb-2">Current Savings</label>
                                            <input type="number" id="current-savings" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="50000" value="50000">
                                        </div>
                                    </div>
                                    <div class="grid grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-600 mb-2">Monthly Contribution</label>
                                            <input type="number" id="monthly-contribution" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="1000" value="1000">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-600 mb-2">Annual Return (%)</label>
                                            <input type="number" id="annual-return" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="7" value="7" step="0.1">
                                        </div>
                                    </div>
                                </div>
                                <button onclick="calculateRetirementPlan()" class="w-full mt-6 bg-gradient-to-r from-purple-500 to-indigo-600 text-white font-bold py-3 px-6 rounded-xl hover:from-purple-600 hover:to-indigo-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                    Calculate Retirement Plan
                                </button>
                            </div>

                            <!-- 401k/IRA Calculator -->
                            <div class="bg-blue-50 rounded-xl p-6">
                                <h4 class="text-lg font-bold mb-4 text-gray-700">401k/IRA Contribution Limits</h4>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-600 mb-2">Account Type</label>
                                        <select id="account-type" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                            <option value="401k">401(k)</option>
                                            <option value="IRA">IRA</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-600 mb-2">Current Age</label>
                                        <input type="number" id="contribution-age" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="30" value="30">
                                    </div>
                                </div>
                                <button onclick="calculateContributionLimits()" class="w-full mt-4 bg-gradient-to-r from-blue-500 to-blue-600 text-white font-bold py-3 px-6 rounded-xl hover:from-blue-600 hover:to-blue-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                    Calculate Limits
                                </button>
                            </div>
                        </div>
                        
                        <!-- Results Section -->
                        <div class="space-y-6">
                            <!-- Retirement Plan Results -->
                            <div class="bg-purple-50 rounded-xl p-6">
                                <h4 class="text-lg font-bold mb-4 text-gray-700">Retirement Plan</h4>
                                <div id="retirement-results" class="space-y-3">
                                    <div class="text-center text-gray-500">Enter details and click "Calculate Retirement Plan"</div>
                                </div>
                            </div>

                            <!-- Readiness Score -->
                            <div class="bg-green-50 rounded-xl p-6">
                                <h4 class="text-lg font-bold mb-4 text-gray-700">Retirement Readiness</h4>
                                <div id="readiness-results" class="space-y-3">
                                    <div class="text-center text-gray-500">Calculate retirement plan to see readiness score</div>
                                </div>
                            </div>

                            <!-- Contribution Limits -->
                            <div class="bg-blue-50 rounded-xl p-6">
                                <h4 class="text-lg font-bold mb-4 text-gray-700">Contribution Limits</h4>
                                <div id="contribution-results" class="space-y-3">
                                    <div class="text-center text-gray-500">Enter age and account type to see limits</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mortgage Calculator Modal -->
    <div id="mortgage-calculator-modal" class="modal">
        <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
            <div class="bg-white rounded-2xl shadow-2xl w-full max-w-7xl max-h-[90vh] overflow-hidden">
                <!-- Modal Header -->
                <div class="bg-gradient-to-r from-green-500 to-emerald-600 text-white p-6 flex justify-between items-center">
                    <div>
                        <h3 class="text-2xl font-bold">üè† Mortgage Calculator</h3>
                        <p class="text-green-100 mt-1">Calculate mortgage payments, amortization, and refinancing scenarios</p>
                    </div>
                    <button onclick="closeModal('mortgage-calculator-modal')" class="text-white hover:text-gray-200 text-3xl font-bold">&times;</button>
                </div>
                
                <!-- Mortgage Calculator Content -->
                <div class="p-6 max-h-[calc(90vh-120px)] overflow-y-auto">
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- Input Section -->
                        <div class="space-y-6">
                            <!-- Basic Mortgage Calculator -->
                            <div class="bg-gray-50 rounded-xl p-6">
                                <h4 class="text-lg font-bold mb-4 text-gray-700">Mortgage Payment Calculator</h4>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-600 mb-2">Currency</label>
                                        <select id="mortgage-currency" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" onchange="updateMortgageCurrencyDisplay()">
                                            <option value="USD">üá∫üá∏ US Dollar ($)</option>
                                            <option value="EUR">üá™üá∫ Euro (‚Ç¨)</option>
                                            <option value="GBP">üá¨üáß British Pound (¬£)</option>
                                            <option value="JPY">üáØüáµ Japanese Yen (¬•)</option>
                                            <option value="CAD">üá®üá¶ Canadian Dollar (C$)</option>
                                            <option value="AUD">üá¶üá∫ Australian Dollar (A$)</option>
                                            <option value="CHF">üá®üá≠ Swiss Franc (CHF)</option>
                                            <option value="CNY">üá®üá≥ Chinese Yuan (¬•)</option>
                                            <option value="INR">üáÆüá≥ Indian Rupee (‚Çπ)</option>
                                            <option value="BRL">üáßüá∑ Brazilian Real (R$)</option>
                                            <option value="SGD">üá∏üá¨ Singapore Dollar (S$)</option>
                                            <option value="AED">üá¶üá™ UAE Dirham (ÿØ.ÿ•)</option>
                                            <option value="SAR">üá∏üá¶ Saudi Riyal (Ô∑º)</option>
                                            <option value="ZAR">üáøüá¶ South African Rand (R)</option>
                                            <option value="MXN">üá≤üáΩ Mexican Peso ($)</option>
                                        </select>
                                    </div>
                                    <div class="grid grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-600 mb-2">Loan Amount</label>
                                            <input type="number" id="loan-amount" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="300000" value="300000">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-600 mb-2">Down Payment</label>
                                            <input type="number" id="down-payment" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="60000" value="60000">
                                        </div>
                                    </div>
                                    <div class="grid grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-600 mb-2">Interest Rate (%)</label>
                                            <input type="number" id="interest-rate" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="6.5" value="6.5" step="0.1">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-600 mb-2">Loan Term (Years)</label>
                                            <input type="number" id="loan-term" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="30" value="30">
                                        </div>
                                    </div>
                                    <div class="grid grid-cols-3 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-600 mb-2">Property Tax (Annual)</label>
                                            <input type="number" id="property-tax" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="3600" value="3600">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-600 mb-2">Insurance (Annual)</label>
                                            <input type="number" id="insurance" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="1200" value="1200">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-600 mb-2">PMI (Annual)</label>
                                            <input type="number" id="pmi" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="0" value="0">
                                        </div>
                                    </div>
                                </div>
                                <button onclick="calculateMortgage()" class="w-full mt-6 bg-gradient-to-r from-green-500 to-emerald-600 text-white font-bold py-3 px-6 rounded-xl hover:from-green-600 hover:to-emerald-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                    Calculate Mortgage
                                </button>
                            </div>

                            <!-- Affordability Calculator -->
                            <div class="bg-blue-50 rounded-xl p-6">
                                <h4 class="text-lg font-bold mb-4 text-gray-700">Affordability Calculator</h4>
                                <div class="space-y-4">
                                    <div class="grid grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-600 mb-2">Annual Income</label>
                                            <input type="number" id="annual-income" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="75000" value="75000">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-600 mb-2">Monthly Debts</label>
                                            <input type="number" id="monthly-debts" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="500" value="500">
                                        </div>
                                    </div>
                                    <div class="grid grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-600 mb-2">Down Payment Available</label>
                                            <input type="number" id="affordability-down" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="60000" value="60000">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-600 mb-2">Interest Rate (%)</label>
                                            <input type="number" id="affordability-rate" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="6.5" value="6.5" step="0.1">
                                        </div>
                                    </div>
                                </div>
                                <button onclick="calculateAffordability()" class="w-full mt-4 bg-gradient-to-r from-blue-500 to-blue-600 text-white font-bold py-3 px-6 rounded-xl hover:from-blue-600 hover:to-blue-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                    Calculate Affordability
                                </button>
                            </div>
                        </div>
                        
                        <!-- Results Section -->
                        <div class="space-y-6">
                            <!-- Mortgage Results -->
                            <div class="bg-green-50 rounded-xl p-6">
                                <h4 class="text-lg font-bold mb-4 text-gray-700">Mortgage Payment</h4>
                                <div id="mortgage-results" class="space-y-3">
                                    <div class="text-center text-gray-500">Enter loan details and click "Calculate Mortgage"</div>
                                </div>
                            </div>

                            <!-- Affordability Results -->
                            <div class="bg-blue-50 rounded-xl p-6">
                                <h4 class="text-lg font-bold mb-4 text-gray-700">Affordability Analysis</h4>
                                <div id="affordability-results" class="space-y-3">
                                    <div class="text-center text-gray-500">Enter income details and click "Calculate Affordability"</div>
                                </div>
                            </div>

                            <!-- Amortization Summary -->
                            <div class="bg-gray-50 rounded-xl p-6">
                                <h4 class="text-lg font-bold mb-4 text-gray-700">Loan Summary</h4>
                                <div id="loan-summary" class="space-y-3">
                                    <div class="text-center text-gray-500">Calculate mortgage to see loan summary</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Budget Planner Modal -->
    <div id="budget-planner-modal" class="modal">
        <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
            <div class="bg-white rounded-2xl shadow-2xl w-full max-w-7xl max-h-[90vh] overflow-hidden">
                <!-- Modal Header -->
                <div class="bg-gradient-to-r from-pink-500 to-rose-600 text-white p-6 flex justify-between items-center">
                    <div>
                        <h3 class="text-2xl font-bold">üìä Budget Planner</h3>
                        <p class="text-pink-100 mt-1">Create and manage personal and business budgets with detailed analysis</p>
                    </div>
                    <button onclick="closeModal('budget-planner-modal')" class="text-white hover:text-gray-200 text-3xl font-bold">&times;</button>
                </div>
                
                <!-- Budget Planner Content -->
                <div class="p-6 max-h-[calc(90vh-120px)] overflow-y-auto">
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- Input Section -->
                        <div class="space-y-6">
                            <!-- Personal Budget Calculator -->
                            <div class="bg-gray-50 rounded-xl p-6">
                                <h4 class="text-lg font-bold mb-4 text-gray-700">Personal Budget Calculator</h4>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-600 mb-2">Currency</label>
                                        <select id="budget-currency" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-pink-500" onchange="updateBudgetCurrencyDisplay()">
                                            <option value="USD">üá∫üá∏ US Dollar ($)</option>
                                            <option value="EUR">üá™üá∫ Euro (‚Ç¨)</option>
                                            <option value="GBP">üá¨üáß British Pound (¬£)</option>
                                            <option value="JPY">üáØüáµ Japanese Yen (¬•)</option>
                                            <option value="CAD">üá®üá¶ Canadian Dollar (C$)</option>
                                            <option value="AUD">üá¶üá∫ Australian Dollar (A$)</option>
                                            <option value="CHF">üá®üá≠ Swiss Franc (CHF)</option>
                                            <option value="CNY">üá®üá≥ Chinese Yuan (¬•)</option>
                                            <option value="INR">üáÆüá≥ Indian Rupee (‚Çπ)</option>
                                            <option value="BRL">üáßüá∑ Brazilian Real (R$)</option>
                                            <option value="SGD">üá∏üá¨ Singapore Dollar (S$)</option>
                                            <option value="AED">üá¶üá™ UAE Dirham (ÿØ.ÿ•)</option>
                                            <option value="SAR">üá∏üá¶ Saudi Riyal (Ô∑º)</option>
                                            <option value="ZAR">üáøüá¶ South African Rand (R)</option>
                                            <option value="MXN">üá≤üáΩ Mexican Peso ($)</option>
                                        </select>
                                    </div>
                                    <div class="grid grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-600 mb-2">Monthly Income</label>
                                            <input type="number" id="monthly-income" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-pink-500" placeholder="5000" value="5000">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-600 mb-2">Monthly Expenses</label>
                                            <input type="number" id="monthly-expenses" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-pink-500" placeholder="3500" value="3500">
                                        </div>
                                    </div>
                                    <div class="grid grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-600 mb-2">Monthly Savings</label>
                                            <input type="number" id="monthly-savings" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-pink-500" placeholder="1000" value="1000">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-600 mb-2">Monthly Debt</label>
                                            <input type="number" id="monthly-debt" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-pink-500" placeholder="500" value="500">
                                        </div>
                                    </div>
                                </div>
                                <button onclick="calculatePersonalBudget()" class="w-full mt-6 bg-gradient-to-r from-pink-500 to-rose-600 text-white font-bold py-3 px-6 rounded-xl hover:from-pink-600 hover:to-rose-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                    Calculate Personal Budget
                                </button>
                            </div>

                            <!-- 50/30/20 Budget Rule -->
                            <div class="bg-blue-50 rounded-xl p-6">
                                <h4 class="text-lg font-bold mb-4 text-gray-700">50/30/20 Budget Rule</h4>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-600 mb-2">Monthly Income</label>
                                        <input type="number" id="rule-income" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="5000" value="5000">
                                    </div>
                                </div>
                                <button onclick="calculate502030Budget()" class="w-full mt-4 bg-gradient-to-r from-blue-500 to-blue-600 text-white font-bold py-3 px-6 rounded-xl hover:from-blue-600 hover:to-blue-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                    Calculate 50/30/20 Budget
                                </button>
                            </div>

                            <!-- Emergency Fund Calculator -->
                            <div class="bg-green-50 rounded-xl p-6">
                                <h4 class="text-lg font-bold mb-4 text-gray-700">Emergency Fund Calculator</h4>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-600 mb-2">Monthly Expenses</label>
                                        <input type="number" id="emergency-expenses" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="3500" value="3500">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-600 mb-2">Months to Cover</label>
                                        <select id="emergency-months" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500">
                                            <option value="3">3 months</option>
                                            <option value="6" selected>6 months</option>
                                            <option value="9">9 months</option>
                                            <option value="12">12 months</option>
                                        </select>
                                    </div>
                                </div>
                                <button onclick="calculateEmergencyFund()" class="w-full mt-4 bg-gradient-to-r from-green-500 to-green-600 text-white font-bold py-3 px-6 rounded-xl hover:from-green-600 hover:to-green-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                    Calculate Emergency Fund
                                </button>
                            </div>
                        </div>
                        
                        <!-- Results Section -->
                        <div class="space-y-6">
                            <!-- Budget Analysis -->
                            <div class="bg-pink-50 rounded-xl p-6">
                                <h4 class="text-lg font-bold mb-4 text-gray-700">Budget Analysis</h4>
                                <div id="budget-results" class="space-y-3">
                                    <div class="text-center text-gray-500">Enter budget details and click "Calculate Personal Budget"</div>
                                </div>
                            </div>

                            <!-- 50/30/20 Results -->
                            <div class="bg-blue-50 rounded-xl p-6">
                                <h4 class="text-lg font-bold mb-4 text-gray-700">50/30/20 Budget</h4>
                                <div id="rule-results" class="space-y-3">
                                    <div class="text-center text-gray-500">Enter income and click "Calculate 50/30/20 Budget"</div>
                                </div>
                            </div>

                            <!-- Emergency Fund Results -->
                            <div class="bg-green-50 rounded-xl p-6">
                                <h4 class="text-lg font-bold mb-4 text-gray-700">Emergency Fund</h4>
                                <div id="emergency-results" class="space-y-3">
                                    <div class="text-center text-gray-500">Enter expenses and click "Calculate Emergency Fund"</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Salary Calculator Modal -->
    <div id="salary-calculator-modal" class="modal">
        <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
            <div class="bg-white rounded-2xl shadow-2xl w-full max-w-7xl max-h-[90vh] overflow-hidden">
                <!-- Modal Header -->
                <div class="bg-gradient-to-r from-indigo-500 to-purple-600 text-white p-6 flex justify-between items-center">
                    <div>
                        <h3 class="text-2xl font-bold">üí∞ Salary Calculator</h3>
                        <p class="text-indigo-100 mt-1">Calculate take-home pay, benefits, and salary negotiations</p>
                    </div>
                    <button onclick="closeModal('salary-calculator-modal')" class="text-white hover:text-gray-200 text-3xl font-bold">&times;</button>
                </div>
                
                <!-- Salary Calculator Content -->
                <div class="p-6 max-h-[calc(90vh-120px)] overflow-y-auto">
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- Input Section -->
                        <div class="space-y-6">
                            <!-- Take-Home Pay Calculator -->
                            <div class="bg-gray-50 rounded-xl p-6">
                                <h4 class="text-lg font-bold mb-4 text-gray-700">Take-Home Pay Calculator</h4>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-600 mb-2">Currency</label>
                                        <select id="salary-currency" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" onchange="updateSalaryCurrencyDisplay()">
                                            <option value="USD">üá∫üá∏ US Dollar ($)</option>
                                            <option value="EUR">üá™üá∫ Euro (‚Ç¨)</option>
                                            <option value="GBP">üá¨üáß British Pound (¬£)</option>
                                            <option value="JPY">üáØüáµ Japanese Yen (¬•)</option>
                                            <option value="CAD">üá®üá¶ Canadian Dollar (C$)</option>
                                            <option value="AUD">üá¶üá∫ Australian Dollar (A$)</option>
                                            <option value="CHF">üá®üá≠ Swiss Franc (CHF)</option>
                                            <option value="CNY">üá®üá≥ Chinese Yuan (¬•)</option>
                                            <option value="INR">üáÆüá≥ Indian Rupee (‚Çπ)</option>
                                            <option value="BRL">üáßüá∑ Brazilian Real (R$)</option>
                                            <option value="SGD">üá∏üá¨ Singapore Dollar (S$)</option>
                                            <option value="AED">üá¶üá™ UAE Dirham (ÿØ.ÿ•)</option>
                                            <option value="SAR">üá∏üá¶ Saudi Riyal (Ô∑º)</option>
                                            <option value="ZAR">üáøüá¶ South African Rand (R)</option>
                                            <option value="MXN">üá≤üáΩ Mexican Peso ($)</option>
                                        </select>
                                    </div>
                                    <div class="grid grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-600 mb-2">Gross Salary</label>
                                            <input type="number" id="gross-salary" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" placeholder="75000" value="75000">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-600 mb-2">Filing Status</label>
                                            <select id="filing-status" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                                                <option value="single">Single</option>
                                                <option value="married">Married Filing Jointly</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="grid grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-600 mb-2">State</label>
                                            <select id="state" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                                                <option value="CA">California</option>
                                                <option value="NY">New York</option>
                                                <option value="TX">Texas</option>
                                                <option value="FL">Florida</option>
                                                <option value="WA">Washington</option>
                                                <option value="NV">Nevada</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-600 mb-2">Pre-tax Deductions</label>
                                            <input type="number" id="pre-tax-deductions" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" placeholder="5000" value="5000">
                                        </div>
                                    </div>
                                </div>
                                <button onclick="calculateSalaryTakeHomePay()" class="w-full mt-6 bg-gradient-to-r from-indigo-500 to-purple-600 text-white font-bold py-3 px-6 rounded-xl hover:from-indigo-600 hover:to-purple-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                    Calculate Take-Home Pay
                                </button>
                            </div>

                            <!-- Salary Comparison -->
                            <div class="bg-blue-50 rounded-xl p-6">
                                <h4 class="text-lg font-bold mb-4 text-gray-700">Salary Comparison</h4>
                                <div class="space-y-4">
                                    <div class="grid grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-600 mb-2">Current Salary</label>
                                            <input type="number" id="current-salary" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="70000" value="70000">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-600 mb-2">New Salary</label>
                                            <input type="number" id="new-salary" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="85000" value="85000">
                                        </div>
                                    </div>
                                    <div class="grid grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-600 mb-2">Current Benefits</label>
                                            <input type="number" id="current-benefits" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="5000" value="5000">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-600 mb-2">New Benefits</label>
                                            <input type="number" id="new-benefits" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="8000" value="8000">
                                        </div>
                                    </div>
                                </div>
                                <button onclick="calculateSalaryComparison()" class="w-full mt-4 bg-gradient-to-r from-blue-500 to-blue-600 text-white font-bold py-3 px-6 rounded-xl hover:from-blue-600 hover:to-blue-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                    Compare Salaries
                                </button>
                            </div>

                            <!-- Hourly to Salary -->
                            <div class="bg-green-50 rounded-xl p-6">
                                <h4 class="text-lg font-bold mb-4 text-gray-700">Hourly to Salary Conversion</h4>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-600 mb-2">Hourly Rate</label>
                                        <input type="number" id="hourly-rate" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="25" value="25" step="0.01">
                                    </div>
                                    <div class="grid grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-600 mb-2">Hours per Week</label>
                                            <input type="number" id="hours-per-week" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="40" value="40">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-600 mb-2">Weeks per Year</label>
                                            <input type="number" id="weeks-per-year" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="52" value="52">
                                        </div>
                                    </div>
                                </div>
                                <button onclick="calculateSalaryHourlyToSalary()" class="w-full mt-4 bg-gradient-to-r from-green-500 to-green-600 text-white font-bold py-3 px-6 rounded-xl hover:from-green-600 hover:to-green-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                    Convert to Salary
                                </button>
                            </div>
                        </div>
                        
                        <!-- Results Section -->
                        <div class="space-y-6">
                            <!-- Take-Home Pay Results -->
                            <div class="bg-indigo-50 rounded-xl p-6">
                                <h4 class="text-lg font-bold mb-4 text-gray-700">Take-Home Pay</h4>
                                <div id="salary-take-home-results" class="space-y-3">
                                    <div class="text-center text-gray-500">Enter salary details and click "Calculate Take-Home Pay"</div>
                                </div>
                            </div>

                            <!-- Salary Comparison Results -->
                            <div class="bg-blue-50 rounded-xl p-6">
                                <h4 class="text-lg font-bold mb-4 text-gray-700">Salary Comparison</h4>
                                <div id="comparison-results" class="space-y-3">
                                    <div class="text-center text-gray-500">Enter salary details and click "Compare Salaries"</div>
                                </div>
                            </div>

                            <!-- Hourly Conversion Results -->
                            <div class="bg-green-50 rounded-xl p-6">
                                <h4 class="text-lg font-bold mb-4 text-gray-700">Salary Conversion</h4>
                                <div id="salary-conversion-results" class="space-y-3">
                                    <div class="text-center text-gray-500">Enter hourly rate and click "Convert to Salary"</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- JSON Formatter & Validator Modal -->
    <div id="json-formatter-modal" class="modal fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="modal-content bg-white rounded-2xl shadow-2xl max-w-6xl w-full mx-4 my-8 max-h-[90vh] overflow-y-auto">
            <div class="bg-gradient-to-r from-blue-500 to-indigo-600 p-6 text-white rounded-t-2xl">
                <div class="flex justify-between items-center">
                    <div>
                        <h3 class="text-3xl font-bold mb-2">JSON Formatter & Validator</h3>
                        <p class="text-blue-100">Format, validate, minify, and convert JSON data with advanced features</p>
                    </div>
                    <button onclick="closeModal('json-formatter-modal')" class="text-white hover:text-gray-200 text-3xl font-bold">&times;</button>
                </div>
            </div>
            
            <div class="p-6">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Input Section -->
                    <div class="space-y-6">
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">JSON Input</label>
                            <div class="relative">
                                <div class="absolute left-0 top-0 bottom-0 w-8 bg-gray-100 border border-gray-300 rounded-l-xl flex flex-col items-center text-xs text-gray-500 font-mono overflow-hidden" id="json-input-lines" style="z-index: 1;"></div>
                                <textarea id="json-input" placeholder="Paste your JSON data here..." class="w-full h-64 pl-10 pr-4 py-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent font-mono text-sm resize-none" style="font-family: 'Courier New', monospace; line-height: 1.5;" oninput="updateJsonInputLineNumbers()" onscroll="syncJsonInputScroll()" onpaste="setTimeout(updateJsonInputLineNumbers, 10)"></textarea>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-2 gap-3">
                            <button onclick="formatJson()" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-4 rounded-xl transition-all duration-300 transform hover:scale-105">
                                Format JSON
                            </button>
                            <button onclick="validateJson()" class="bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-4 rounded-xl transition-all duration-300 transform hover:scale-105">
                                Validate JSON
                            </button>
                            <button onclick="minifyJson()" class="bg-orange-500 hover:bg-orange-600 text-white font-bold py-3 px-4 rounded-xl transition-all duration-300 transform hover:scale-105">
                                Minify JSON
                            </button>
                            <button onclick="clearJson()" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-3 px-4 rounded-xl transition-all duration-300 transform hover:scale-105">
                                Clear All
                            </button>
                        </div>
                        
                        <!-- Convert Options -->
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Convert To</label>
                            <div class="grid grid-cols-2 gap-3">
                                <button onclick="convertJson('yaml')" class="bg-purple-500 hover:bg-purple-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    YAML
                                </button>
                                <button onclick="convertJson('xml')" class="bg-purple-500 hover:bg-purple-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    XML
                                </button>
                                <button onclick="convertJson('csv')" class="bg-purple-500 hover:bg-purple-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    CSV
                                </button>
                                <button onclick="convertJson('php')" class="bg-purple-500 hover:bg-purple-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    PHP
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Output Section -->
                    <div class="space-y-6">
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Output</label>
                            <div class="relative">
                                <div class="absolute left-0 top-0 bottom-0 w-8 bg-gray-100 border border-gray-300 rounded-l-xl flex flex-col items-center text-xs text-gray-500 font-mono overflow-hidden" id="json-output-lines" style="z-index: 1;"></div>
                                <textarea id="json-output" placeholder="Formatted, validated, or converted output will appear here..." class="w-full h-64 pl-10 pr-4 py-4 border border-gray-300 rounded-xl bg-gray-50 font-mono text-sm resize-none" style="font-family: 'Courier New', monospace; line-height: 1.5;" readonly onscroll="syncJsonOutputScroll()"></textarea>
                            </div>
                        </div>
                        
                        <div class="flex space-x-3">
                            <button onclick="copyJsonOutput()" class="bg-indigo-500 hover:bg-indigo-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                Copy Output
                            </button>
                            <button onclick="downloadJsonOutput()" class="bg-teal-500 hover:bg-teal-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                Download
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Results Section -->
                <div class="mt-8 space-y-6">
                    <!-- Validation Results -->
                    <div id="validation-results" class="hidden">
                        <div class="bg-green-50 rounded-xl p-6">
                            <h4 class="text-lg font-bold mb-4 text-green-800">Validation Results</h4>
                            <div id="validation-content" class="space-y-3"></div>
                        </div>
                    </div>
                    
                    <!-- Structure Analysis -->
                    <div id="structure-analysis" class="hidden">
                        <div class="bg-blue-50 rounded-xl p-6">
                            <h4 class="text-lg font-bold mb-4 text-blue-800">Structure Analysis</h4>
                            <div id="structure-content" class="space-y-3"></div>
                        </div>
                    </div>
                    
                    <!-- Error Display -->
                    <div id="error-display" class="hidden">
                        <div class="bg-red-50 rounded-xl p-6">
                            <h4 class="text-lg font-bold mb-4 text-red-800">Error Details</h4>
                            <div id="error-content" class="space-y-3"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- XML Formatter & Validator Modal -->
    <div id="xml-formatter-modal" class="modal fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="modal-content bg-white rounded-2xl shadow-2xl max-w-6xl w-full mx-4 my-8 max-h-[90vh] overflow-y-auto">
            <div class="bg-gradient-to-r from-green-500 to-emerald-600 p-6 text-white rounded-t-2xl">
                <div class="flex justify-between items-center">
                    <div>
                        <h3 class="text-3xl font-bold mb-2">XML Formatter & Validator</h3>
                        <p class="text-green-100">Format, validate, minify, and convert XML data with professional features</p>
                    </div>
                    <button onclick="closeModal('xml-formatter-modal')" class="text-white hover:text-gray-200 text-3xl font-bold">&times;</button>
                </div>
            </div>
            
            <div class="p-6">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Input Section -->
                    <div class="space-y-6">
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">XML Input</label>
                            <div class="relative">
                                <div class="absolute left-0 top-0 bottom-0 w-8 bg-gray-100 border border-gray-300 rounded-l-xl flex flex-col items-center text-xs text-gray-500 font-mono overflow-hidden" id="xml-input-lines" style="z-index: 1;"></div>
                                <textarea id="xml-input" placeholder="Paste your XML data here..." class="w-full h-64 pl-10 pr-4 py-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent font-mono text-sm resize-none" style="font-family: 'Courier New', monospace; line-height: 1.5;" oninput="updateXmlInputLineNumbers()" onscroll="syncXmlInputScroll()" onpaste="setTimeout(updateXmlInputLineNumbers, 10)"></textarea>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-2 gap-3">
                            <button onclick="formatXml()" class="bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-4 rounded-xl transition-all duration-300 transform hover:scale-105">
                                Format XML
                            </button>
                            <button onclick="validateXml()" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-4 rounded-xl transition-all duration-300 transform hover:scale-105">
                                Validate XML
                            </button>
                            <button onclick="minifyXml()" class="bg-orange-500 hover:bg-orange-600 text-white font-bold py-3 px-4 rounded-xl transition-all duration-300 transform hover:scale-105">
                                Minify XML
                            </button>
                            <button onclick="clearXml()" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-3 px-4 rounded-xl transition-all duration-300 transform hover:scale-105">
                                Clear All
                            </button>
                        </div>
                        
                        <!-- Convert Options -->
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Convert To</label>
                            <div class="grid grid-cols-2 gap-3">
                                <button onclick="convertXml('json')" class="bg-purple-500 hover:bg-purple-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    JSON
                                </button>
                                <button onclick="convertXml('yaml')" class="bg-purple-500 hover:bg-purple-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    YAML
                                </button>
                                <button onclick="convertXml('csv')" class="bg-purple-500 hover:bg-purple-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    CSV
                                </button>
                                <button onclick="convertXml('html')" class="bg-purple-500 hover:bg-purple-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    HTML
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Output Section -->
                    <div class="space-y-6">
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Output</label>
                            <div class="relative">
                                <div class="absolute left-0 top-0 bottom-0 w-8 bg-gray-100 border border-gray-300 rounded-l-xl flex flex-col items-center text-xs text-gray-500 font-mono overflow-hidden" id="xml-output-lines" style="z-index: 1;"></div>
                                <textarea id="xml-output" placeholder="Formatted, validated, or converted output will appear here..." class="w-full h-64 pl-10 pr-4 py-4 border border-gray-300 rounded-xl bg-gray-50 font-mono text-sm resize-none" style="font-family: 'Courier New', monospace; line-height: 1.5;" readonly onscroll="syncXmlOutputScroll()"></textarea>
                            </div>
                        </div>
                        
                        <div class="flex space-x-3">
                            <button onclick="copyXmlOutput()" class="bg-emerald-500 hover:bg-emerald-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                Copy Output
                            </button>
                            <button onclick="downloadXmlOutput()" class="bg-teal-500 hover:bg-teal-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                Download
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Results Section -->
                <div class="mt-8 space-y-6">
                    <!-- Validation Results -->
                    <div id="xml-validation-results" class="hidden">
                        <div class="bg-green-50 rounded-xl p-6">
                            <h4 class="text-lg font-bold mb-4 text-green-800">Validation Results</h4>
                            <div id="xml-validation-content" class="space-y-3"></div>
                        </div>
                    </div>
                    
                    <!-- Structure Analysis -->
                    <div id="xml-structure-analysis" class="hidden">
                        <div class="bg-blue-50 rounded-xl p-6">
                            <h4 class="text-lg font-bold mb-4 text-blue-800">Structure Analysis</h4>
                            <div id="xml-structure-content" class="space-y-3"></div>
                        </div>
                    </div>
                    
                    <!-- Error Display -->
                    <div id="xml-error-display" class="hidden">
                        <div class="bg-red-50 rounded-xl p-6">
                            <h4 class="text-lg font-bold mb-4 text-red-800">Error Details</h4>
                            <div id="xml-error-content" class="space-y-3"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Base64 Encoder/Decoder Modal -->
    <div id="base64-encoder-modal" class="modal fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="modal-content bg-white rounded-2xl shadow-2xl max-w-6xl w-full mx-4 my-8 max-h-[90vh] overflow-y-auto">
            <div class="bg-gradient-to-r from-purple-500 to-pink-600 p-6 text-white rounded-t-2xl">
                <div class="flex justify-between items-center">
                    <div>
                        <h3 class="text-3xl font-bold mb-2">Base64 Encoder/Decoder</h3>
                        <p class="text-purple-100">Encode and decode Base64 data with text, image, and file support</p>
                    </div>
                    <button onclick="closeModal('base64-encoder-modal')" class="text-white hover:text-gray-200 text-3xl font-bold">&times;</button>
                </div>
            </div>
            
            <div class="p-6">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Input Section -->
                    <div class="space-y-6">
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Input</label>
                            <div class="relative">
                                <div class="absolute left-0 top-0 bottom-0 w-8 bg-gray-100 border border-gray-300 rounded-l-xl flex flex-col items-center text-xs text-gray-500 font-mono overflow-hidden" id="base64-input-lines" style="z-index: 1;"></div>
                                <textarea id="base64-input" placeholder="Enter text to encode or Base64 to decode..." class="w-full h-64 pl-10 pr-4 py-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent font-mono text-sm resize-none" style="font-family: 'Courier New', monospace; line-height: 1.5;" oninput="updateBase64InputLineNumbers()" onscroll="syncBase64InputScroll()" onpaste="setTimeout(updateBase64InputLineNumbers, 10)"></textarea>
                            </div>
                        </div>
                        
                        <!-- File Upload -->
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">File Upload</label>
                            <div class="border-2 border-dashed border-gray-300 rounded-xl p-6 text-center hover:border-purple-400 transition-colors">
                                <input type="file" id="base64-file-input" class="hidden" onchange="handleFileUpload()" accept="*/*">
                                <div class="text-gray-500 mb-2">
                                    <span class="text-4xl">üìÅ</span>
                                </div>
                                <p class="text-gray-600 mb-2">Click to upload a file</p>
                                <button onclick="document.getElementById('base64-file-input').click()" class="bg-purple-500 hover:bg-purple-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    Choose File
                                </button>
                                <p class="text-sm text-gray-400 mt-2">Supports any file type</p>
                            </div>
                        </div>
                        
                        <!-- Options -->
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Options</label>
                            <div class="space-y-3">
                                <div class="flex items-center">
                                    <input type="checkbox" id="url-safe" class="mr-2">
                                    <label for="url-safe" class="text-gray-700">URL-Safe Base64</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="checkbox" id="line-breaks" class="mr-2">
                                    <label for="line-breaks" class="text-gray-700">Add Line Breaks</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="checkbox" id="no-padding" class="mr-2">
                                    <label for="no-padding" class="text-gray-700">Remove Padding</label>
                                </div>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-2 gap-3">
                            <button onclick="encodeBase64()" class="bg-purple-500 hover:bg-purple-600 text-white font-bold py-3 px-4 rounded-xl transition-all duration-300 transform hover:scale-105">
                                Encode
                            </button>
                            <button onclick="decodeBase64()" class="bg-pink-500 hover:bg-pink-600 text-white font-bold py-3 px-4 rounded-xl transition-all duration-300 transform hover:scale-105">
                                Decode
                            </button>
                            <button onclick="validateBase64()" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-4 rounded-xl transition-all duration-300 transform hover:scale-105">
                                Validate
                            </button>
                            <button onclick="clearBase64()" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-3 px-4 rounded-xl transition-all duration-300 transform hover:scale-105">
                                Clear All
                            </button>
                        </div>
                    </div>
                    
                    <!-- Output Section -->
                    <div class="space-y-6">
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Output</label>
                            <div class="relative">
                                <div class="absolute left-0 top-0 bottom-0 w-8 bg-gray-100 border border-gray-300 rounded-l-xl flex flex-col items-center text-xs text-gray-500 font-mono overflow-hidden" id="base64-output-lines" style="z-index: 1;"></div>
                                <textarea id="base64-output" placeholder="Encoded or decoded output will appear here..." class="w-full h-64 pl-10 pr-4 py-4 border border-gray-300 rounded-xl bg-gray-50 font-mono text-sm resize-none" style="font-family: 'Courier New', monospace; line-height: 1.5;" readonly onscroll="syncBase64OutputScroll()"></textarea>
                            </div>
                        </div>
                        
                        <div class="flex space-x-3">
                            <button onclick="copyBase64Output()" class="bg-purple-500 hover:bg-purple-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                Copy Output
                            </button>
                            <button onclick="downloadBase64Output()" class="bg-pink-500 hover:bg-pink-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                Download
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Results Section -->
                <div class="mt-8 space-y-6">
                    <!-- Analysis Results -->
                    <div id="base64-analysis-results" class="hidden">
                        <div class="bg-blue-50 rounded-xl p-6">
                            <h4 class="text-lg font-bold mb-4 text-blue-800">Base64 Analysis</h4>
                            <div id="base64-analysis-content" class="space-y-3"></div>
                        </div>
                    </div>
                    
                    <!-- Validation Results -->
                    <div id="base64-validation-results" class="hidden">
                        <div class="bg-green-50 rounded-xl p-6">
                            <h4 class="text-lg font-bold mb-4 text-green-800">Validation Results</h4>
                            <div id="base64-validation-content" class="space-y-3"></div>
                        </div>
                    </div>
                    
                    <!-- Error Display -->
                    <div id="base64-error-display" class="hidden">
                        <div class="bg-red-50 rounded-xl p-6">
                            <h4 class="text-lg font-bold mb-4 text-red-800">Error Details</h4>
                            <div id="base64-error-content" class="space-y-3"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Hash Generator Modal -->
    <div id="hash-generator-modal" class="modal fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="modal-content bg-white rounded-2xl shadow-2xl max-w-6xl w-full mx-4 my-8 max-h-[90vh] overflow-y-auto">
            <div class="bg-gradient-to-r from-orange-500 to-red-600 p-6 text-white rounded-t-2xl">
                <div class="flex justify-between items-center">
                    <div>
                        <h3 class="text-3xl font-bold mb-2">Hash Generator</h3>
                        <p class="text-orange-100">Generate MD5, SHA-1, SHA-256, SHA-512 hashes with advanced options</p>
                    </div>
                    <button onclick="closeModal('hash-generator-modal')" class="text-white hover:text-gray-200 text-3xl font-bold">&times;</button>
                </div>
            </div>
            
            <div class="p-6">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Input Section -->
                    <div class="space-y-6">
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Input</label>
                            <div class="relative">
                                <div class="absolute left-0 top-0 bottom-0 w-8 bg-gray-100 border border-gray-300 rounded-l-xl flex flex-col items-center text-xs text-gray-500 font-mono overflow-hidden" id="hash-input-lines" style="z-index: 1;"></div>
                                <textarea id="hash-input" placeholder="Enter text to hash..." class="w-full h-64 pl-10 pr-4 py-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-orange-500 focus:border-transparent font-mono text-sm resize-none" style="font-family: 'Courier New', monospace; line-height: 1.5;" oninput="updateHashInputLineNumbers()" onscroll="syncHashInputScroll()" onpaste="setTimeout(updateHashInputLineNumbers, 10)"></textarea>
                            </div>
                        </div>
                        
                        <!-- File Upload -->
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">File Upload</label>
                            <div class="border-2 border-dashed border-gray-300 rounded-xl p-6 text-center hover:border-orange-400 transition-colors">
                                <input type="file" id="hash-file-input" class="hidden" onchange="handleHashFileUpload()" accept="*/*">
                                <div class="text-gray-500 mb-2">
                                    <span class="text-4xl">üìÅ</span>
                                </div>
                                <p class="text-gray-600 mb-2">Click to upload a file</p>
                                <button onclick="document.getElementById('hash-file-input').click()" class="bg-orange-500 hover:bg-orange-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    Choose File
                                </button>
                                <p class="text-sm text-gray-400 mt-2">Supports any file type</p>
                            </div>
                        </div>
                        
                        <!-- Algorithm Selection -->
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Hash Algorithm</label>
                            <select id="hash-algorithm" class="w-full p-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-orange-500 focus:border-transparent">
                                <option value="SHA-256">SHA-256 (Recommended)</option>
                                <option value="SHA-512">SHA-512 (Strongest)</option>
                                <option value="SHA-384">SHA-384</option>
                                <option value="SHA-224">SHA-224</option>
                                <option value="SHA-1">SHA-1 (Deprecated)</option>
                                <option value="MD5">MD5 (Deprecated)</option>
                            </select>
                        </div>
                        
                        <!-- Options -->
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Options</label>
                            <div class="space-y-3">
                                <div class="flex items-center">
                                    <input type="checkbox" id="hash-uppercase" class="mr-2">
                                    <label for="hash-uppercase" class="text-gray-700">Uppercase Hash</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="checkbox" id="hash-base64" class="mr-2">
                                    <label for="hash-base64" class="text-gray-700">Base64 Output</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="checkbox" id="hash-binary" class="mr-2">
                                    <label for="hash-binary" class="text-gray-700">Binary Output</label>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Advanced Options -->
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Advanced Options</label>
                            <div class="space-y-3">
                                <div>
                                    <label class="block text-sm text-gray-600 mb-1">Salt (Optional)</label>
                                    <input type="text" id="hash-salt" placeholder="Enter salt..." class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent">
                                </div>
                                <div>
                                    <label class="block text-sm text-gray-600 mb-1">Iterations</label>
                                    <input type="number" id="hash-iterations" value="1" min="1" max="1000" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent">
                                </div>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-2 gap-3">
                            <button onclick="generateHash()" class="bg-orange-500 hover:bg-orange-600 text-white font-bold py-3 px-4 rounded-xl transition-all duration-300 transform hover:scale-105">
                                Generate Hash
                            </button>
                            <button onclick="generateMultipleHashes()" class="bg-red-500 hover:bg-red-600 text-white font-bold py-3 px-4 rounded-xl transition-all duration-300 transform hover:scale-105">
                                All Algorithms
                            </button>
                            <button onclick="verifyHash()" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-4 rounded-xl transition-all duration-300 transform hover:scale-105">
                                Verify Hash
                            </button>
                            <button onclick="clearHash()" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-3 px-4 rounded-xl transition-all duration-300 transform hover:scale-105">
                                Clear All
                            </button>
                        </div>
                    </div>
                    
                    <!-- Output Section -->
                    <div class="space-y-6">
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Output</label>
                            <div class="relative">
                                <div class="absolute left-0 top-0 bottom-0 w-8 bg-gray-100 border border-gray-300 rounded-l-xl flex flex-col items-center text-xs text-gray-500 font-mono overflow-hidden" id="hash-output-lines" style="z-index: 1;"></div>
                                <textarea id="hash-output" placeholder="Generated hash will appear here..." class="w-full h-64 pl-10 pr-4 py-4 border border-gray-300 rounded-xl bg-gray-50 font-mono text-sm resize-none" style="font-family: 'Courier New', monospace; line-height: 1.5;" readonly onscroll="syncHashOutputScroll()"></textarea>
                            </div>
                        </div>
                        
                        <div class="flex space-x-3">
                            <button onclick="copyHashOutput()" class="bg-orange-500 hover:bg-orange-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                Copy Hash
                            </button>
                            <button onclick="downloadHashOutput()" class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                Download
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Results Section -->
                <div class="mt-8 space-y-6">
                    <!-- Hash Analysis -->
                    <div id="hash-analysis-results" class="hidden">
                        <div class="bg-blue-50 rounded-xl p-6">
                            <h4 class="text-lg font-bold mb-4 text-blue-800">Hash Analysis</h4>
                            <div id="hash-analysis-content" class="space-y-3"></div>
                        </div>
                    </div>
                    
                    <!-- Multiple Hashes Results -->
                    <div id="hash-multiple-results" class="hidden">
                        <div class="bg-green-50 rounded-xl p-6">
                            <h4 class="text-lg font-bold mb-4 text-green-800">Multiple Hash Results</h4>
                            <div id="hash-multiple-content" class="space-y-3"></div>
                        </div>
                    </div>
                    
                    <!-- Verification Results -->
                    <div id="hash-verification-results" class="hidden">
                        <div class="bg-purple-50 rounded-xl p-6">
                            <h4 class="text-lg font-bold mb-4 text-purple-800">Hash Verification</h4>
                            <div id="hash-verification-content" class="space-y-3"></div>
                        </div>
                    </div>
                    
                    <!-- Error Display -->
                    <div id="hash-error-display" class="hidden">
                        <div class="bg-red-50 rounded-xl p-6">
                            <h4 class="text-lg font-bold mb-4 text-red-800">Error Details</h4>
                            <div id="hash-error-content" class="space-y-3"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- URL Encoder/Decoder Modal -->
    <div id="url-encoder-modal" class="modal fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="modal-content bg-white rounded-2xl shadow-2xl max-w-6xl w-full mx-4 my-8 max-h-[90vh] overflow-y-auto">
            <div class="bg-gradient-to-r from-teal-500 to-cyan-600 p-6 text-white rounded-t-2xl">
                <div class="flex justify-between items-center">
                    <div>
                        <h3 class="text-3xl font-bold mb-2">URL Encoder/Decoder</h3>
                        <p class="text-teal-100">Encode and decode URLs with query parameter support and validation</p>
                    </div>
                    <button onclick="closeModal('url-encoder-modal')" class="text-white hover:text-gray-200 text-3xl font-bold">&times;</button>
                </div>
            </div>
            
            <div class="p-6">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Input Section -->
                    <div class="space-y-6">
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Input</label>
                            <div class="relative">
                                <div class="absolute left-0 top-0 bottom-0 w-8 bg-gray-100 border border-gray-300 rounded-l-xl flex flex-col items-center text-xs text-gray-500 font-mono overflow-hidden" id="url-input-lines" style="z-index: 1;"></div>
                                <textarea id="url-input" placeholder="Enter URL to encode or decode..." class="w-full h-64 pl-10 pr-4 py-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-teal-500 focus:border-transparent font-mono text-sm resize-none" style="font-family: 'Courier New', monospace; line-height: 1.5;" oninput="updateUrlInputLineNumbers()" onscroll="syncUrlInputScroll()" onpaste="setTimeout(updateUrlInputLineNumbers, 10)"></textarea>
                            </div>
                        </div>
                        
                        <!-- Query Parameters -->
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Query Parameters</label>
                            <div class="space-y-3">
                                <div class="flex space-x-2">
                                    <input type="text" id="query-key" placeholder="Parameter name" class="flex-1 p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent">
                                    <input type="text" id="query-value" placeholder="Parameter value" class="flex-1 p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent">
                                    <button onclick="addQueryParam()" class="bg-teal-500 hover:bg-teal-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                        Add
                                    </button>
                                </div>
                                <div id="query-params-list" class="space-y-2 max-h-32 overflow-y-auto"></div>
                            </div>
                        </div>
                        
                        <!-- Options -->
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Options</label>
                            <div class="space-y-3">
                                <div class="flex items-center">
                                    <input type="checkbox" id="url-encode-reserved" class="mr-2">
                                    <label for="url-encode-reserved" class="text-gray-700">Encode Reserved Characters</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="checkbox" id="url-encode-spaces" class="mr-2" checked>
                                    <label for="url-encode-spaces" class="text-gray-700">Encode Spaces</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="checkbox" id="url-preserve-protocol" class="mr-2" checked>
                                    <label for="url-preserve-protocol" class="text-gray-700">Preserve Protocol</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="checkbox" id="url-strict-decode" class="mr-2">
                                    <label for="url-strict-decode" class="text-gray-700">Strict Decoding</label>
                                </div>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-2 gap-3">
                            <button onclick="encodeUrl()" class="bg-teal-500 hover:bg-teal-600 text-white font-bold py-3 px-4 rounded-xl transition-all duration-300 transform hover:scale-105">
                                Encode URL
                            </button>
                            <button onclick="decodeUrl()" class="bg-cyan-500 hover:bg-cyan-600 text-white font-bold py-3 px-4 rounded-xl transition-all duration-300 transform hover:scale-105">
                                Decode URL
                            </button>
                            <button onclick="validateUrl()" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-4 rounded-xl transition-all duration-300 transform hover:scale-105">
                                Validate URL
                            </button>
                            <button onclick="beautifyUrl()" class="bg-purple-500 hover:bg-purple-600 text-white font-bold py-3 px-4 rounded-xl transition-all duration-300 transform hover:scale-105">
                                Beautify URL
                            </button>
                            <button onclick="clearUrl()" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-3 px-4 rounded-xl transition-all duration-300 transform hover:scale-105">
                                Clear All
                            </button>
                        </div>
                    </div>
                    
                    <!-- Output Section -->
                    <div class="space-y-6">
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Output</label>
                            <div class="relative">
                                <div class="absolute left-0 top-0 bottom-0 w-8 bg-gray-100 border border-gray-300 rounded-l-xl flex flex-col items-center text-xs text-gray-500 font-mono overflow-hidden" id="url-output-lines" style="z-index: 1;"></div>
                                <textarea id="url-output" placeholder="Encoded or decoded URL will appear here..." class="w-full h-64 pl-10 pr-4 py-4 border border-gray-300 rounded-xl bg-gray-50 font-mono text-sm resize-none" style="font-family: 'Courier New', monospace; line-height: 1.5;" readonly onscroll="syncUrlOutputScroll()"></textarea>
                            </div>
                        </div>
                        
                        <div class="flex space-x-3">
                            <button onclick="copyUrlOutput()" class="bg-teal-500 hover:bg-teal-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                Copy URL
                            </button>
                            <button onclick="downloadUrlOutput()" class="bg-cyan-500 hover:bg-cyan-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                Download
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Results Section -->
                <div class="mt-8 space-y-6">
                    <!-- URL Analysis -->
                    <div id="url-analysis-results" class="hidden">
                        <div class="bg-blue-50 rounded-xl p-6">
                            <h4 class="text-lg font-bold mb-4 text-blue-800">URL Analysis</h4>
                            <div id="url-analysis-content" class="space-y-3"></div>
                        </div>
                    </div>
                    
                    <!-- Validation Results -->
                    <div id="url-validation-results" class="hidden">
                        <div class="bg-green-50 rounded-xl p-6">
                            <h4 class="text-lg font-bold mb-4 text-green-800">URL Validation</h4>
                            <div id="url-validation-content" class="space-y-3"></div>
                        </div>
                    </div>
                    
                    <!-- Beautification Results -->
                    <div id="url-beautification-results" class="hidden">
                        <div class="bg-purple-50 rounded-xl p-6">
                            <h4 class="text-lg font-bold mb-4 text-purple-800">URL Beautification</h4>
                            <div id="url-beautification-content" class="space-y-3"></div>
                        </div>
                    </div>
                    
                    <!-- Error Display -->
                    <div id="url-error-display" class="hidden">
                        <div class="bg-red-50 rounded-xl p-6">
                            <h4 class="text-lg font-bold mb-4 text-red-800">Error Details</h4>
                            <div id="url-error-content" class="space-y-3"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Regular Expression Tester Modal -->
    <div id="regex-tester-modal" class="modal fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="modal-content bg-white rounded-2xl shadow-2xl max-w-7xl w-full mx-4 my-8 max-h-[90vh] overflow-y-auto">
            <div class="bg-gradient-to-r from-indigo-500 to-purple-600 p-6 text-white rounded-t-2xl">
                <div class="flex justify-between items-center">
                    <div>
                        <h3 class="text-3xl font-bold mb-2">Regular Expression Tester</h3>
                        <p class="text-indigo-100">Test and debug regex patterns with highlighting and pattern library</p>
                    </div>
                    <button onclick="closeModal('regex-tester-modal')" class="text-white hover:text-gray-200 text-3xl font-bold">&times;</button>
                </div>
            </div>
            
            <div class="p-6">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Input Section -->
                    <div class="space-y-6">
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Pattern</label>
                            <div class="relative">
                                <div class="absolute left-0 top-0 bottom-0 w-8 bg-gray-100 border border-gray-300 rounded-l-xl flex flex-col items-center text-xs text-gray-500 font-mono overflow-hidden" id="regex-pattern-lines" style="z-index: 1;"></div>
                                <textarea id="regex-pattern" placeholder="Enter your regex pattern..." class="w-full h-32 pl-10 pr-4 py-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent font-mono text-sm resize-none" style="font-family: 'Courier New', monospace; line-height: 1.5;" oninput="updateRegexPatternLineNumbers()" onscroll="syncRegexPatternScroll()" onpaste="setTimeout(updateRegexPatternLineNumbers, 10)"></textarea>
                            </div>
                        </div>
                        
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Test Text <span class="text-sm text-gray-500">(Optional - only needed for testing, highlighting, and statistics)</span></label>
                            <div class="relative">
                                <div class="absolute left-0 top-0 bottom-0 w-8 bg-gray-100 border border-gray-300 rounded-l-xl flex flex-col items-center text-xs text-gray-500 font-mono overflow-hidden" id="regex-text-lines" style="z-index: 1;"></div>
                                <textarea id="regex-text" placeholder="Enter text to test against the pattern (optional for validation and explanation)..." class="w-full h-64 pl-10 pr-4 py-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent font-mono text-sm resize-none" style="font-family: 'Courier New', monospace; line-height: 1.5;" oninput="updateRegexTextLineNumbers()" onscroll="syncRegexTextScroll()" onpaste="setTimeout(updateRegexTextLineNumbers, 10)"></textarea>
                            </div>
                        </div>
                        
                        <!-- Flags -->
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Flags</label>
                            <div class="grid grid-cols-3 gap-2">
                                <div class="flex items-center">
                                    <input type="checkbox" id="flag-g" class="mr-2">
                                    <label for="flag-g" class="text-gray-700 text-sm">Global (g)</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="checkbox" id="flag-i" class="mr-2">
                                    <label for="flag-i" class="text-gray-700 text-sm">Case Insensitive (i)</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="checkbox" id="flag-m" class="mr-2">
                                    <label for="flag-m" class="text-gray-700 text-sm">Multiline (m)</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="checkbox" id="flag-s" class="mr-2">
                                    <label for="flag-s" class="text-gray-700 text-sm">Dot All (s)</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="checkbox" id="flag-u" class="mr-2">
                                    <label for="flag-u" class="text-gray-700 text-sm">Unicode (u)</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="checkbox" id="flag-y" class="mr-2">
                                    <label for="flag-y" class="text-gray-700 text-sm">Sticky (y)</label>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Pattern Library -->
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Pattern Library</label>
                            <select id="pattern-library" class="w-full p-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent" onchange="loadPatternFromLibrary()">
                                <option value="">Select a pattern from library...</option>
                            </select>
                        </div>
                        
                        <div class="grid grid-cols-2 gap-3">
                            <button onclick="testRegex()" class="bg-indigo-500 hover:bg-indigo-600 text-white font-bold py-3 px-4 rounded-xl transition-all duration-300 transform hover:scale-105">
                                Test Pattern <span class="text-xs">(needs text)</span>
                            </button>
                            <button onclick="validateRegex()" class="bg-purple-500 hover:bg-purple-600 text-white font-bold py-3 px-4 rounded-xl transition-all duration-300 transform hover:scale-105">
                                Validate Pattern
                            </button>
                            <button onclick="explainRegex()" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-4 rounded-xl transition-all duration-300 transform hover:scale-105">
                                Explain Pattern
                            </button>
                            <button onclick="getStats()" class="bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-4 rounded-xl transition-all duration-300 transform hover:scale-105">
                                Get Statistics <span class="text-xs">(needs text)</span>
                            </button>
                            <button onclick="highlightMatches()" class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-3 px-4 rounded-xl transition-all duration-300 transform hover:scale-105">
                                Highlight Matches <span class="text-xs">(needs text)</span>
                            </button>
                            <button onclick="clearRegex()" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-3 px-4 rounded-xl transition-all duration-300 transform hover:scale-105">
                                Clear All
                            </button>
                        </div>
                    </div>
                    
                    <!-- Output Section -->
                    <div class="space-y-6">
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Results</label>
                            <div class="relative">
                                <div class="absolute left-0 top-0 bottom-0 w-8 bg-gray-100 border border-gray-300 rounded-l-xl flex flex-col items-center text-xs text-gray-500 font-mono overflow-hidden" id="regex-results-lines" style="z-index: 1;"></div>
                                <div id="regex-results" class="w-full h-64 pl-10 pr-4 py-4 border border-gray-300 rounded-xl bg-gray-50 font-mono text-sm overflow-y-auto" style="font-family: 'Courier New', monospace; line-height: 1.5;"></div>
                            </div>
                        </div>
                        
                        <div class="flex space-x-3">
                            <button onclick="copyRegexResults()" class="bg-indigo-500 hover:bg-indigo-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                Copy Results
                            </button>
                            <button onclick="downloadRegexResults()" class="bg-purple-500 hover:bg-purple-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                Download
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Results Section -->
                <div class="mt-8 space-y-6">
                    <!-- Test Results -->
                    <div id="regex-test-results" class="hidden">
                        <div class="bg-blue-50 rounded-xl p-6">
                            <h4 class="text-lg font-bold mb-4 text-blue-800">Test Results</h4>
                            <div id="regex-test-content" class="space-y-3"></div>
                        </div>
                    </div>
                    
                    <!-- Validation Results -->
                    <div id="regex-validation-results" class="hidden">
                        <div class="bg-green-50 rounded-xl p-6">
                            <h4 class="text-lg font-bold mb-4 text-green-800">Validation Results</h4>
                            <div id="regex-validation-content" class="space-y-3"></div>
                        </div>
                    </div>
                    
                    <!-- Explanation Results -->
                    <div id="regex-explanation-results" class="hidden">
                        <div class="bg-purple-50 rounded-xl p-6">
                            <h4 class="text-lg font-bold mb-4 text-purple-800">Pattern Explanation</h4>
                            <div id="regex-explanation-content" class="space-y-3"></div>
                        </div>
                    </div>
                    
                    <!-- Statistics Results -->
                    <div id="regex-stats-results" class="hidden">
                        <div class="bg-yellow-50 rounded-xl p-6">
                            <h4 class="text-lg font-bold mb-4 text-yellow-800">Statistics</h4>
                            <div id="regex-stats-content" class="space-y-3"></div>
                        </div>
                    </div>
                    
                    <!-- Error Display -->
                    <div id="regex-error-display" class="hidden">
                        <div class="bg-red-50 rounded-xl p-6">
                            <h4 class="text-lg font-bold mb-4 text-red-800">Error Details</h4>
                            <div id="regex-error-content" class="space-y-3"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- CSS/JS Minifier Modal -->
    <div id="css-js-minifier-modal" class="modal fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="modal-content bg-white rounded-2xl shadow-2xl max-w-7xl w-full mx-4 my-8 max-h-[90vh] overflow-y-auto">
            <div class="bg-gradient-to-r from-orange-500 to-red-600 p-6 text-white rounded-t-2xl">
                <div class="flex justify-between items-center">
                    <div>
                        <h3 class="text-3xl font-bold mb-2">CSS/JS Minifier</h3>
                        <p class="text-orange-100">Minify and optimize CSS and JavaScript code with advanced features</p>
                    </div>
                    <button onclick="closeModal('css-js-minifier-modal')" class="text-white hover:text-gray-200 text-3xl font-bold">&times;</button>
                </div>
            </div>
            
            <div class="p-6">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Input Section -->
                    <div class="space-y-6">
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Code Type</label>
                            <select id="code-type" class="w-full p-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-orange-500 focus:border-transparent" onchange="updateCodeType()">
                                <option value="css">CSS</option>
                                <option value="js">JavaScript</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Input Code</label>
                            <div class="relative">
                                <div class="absolute left-0 top-0 bottom-0 w-8 bg-gray-100 border border-gray-300 rounded-l-xl flex flex-col items-center text-xs text-gray-500 font-mono overflow-hidden" id="minifier-input-lines" style="z-index: 1;"></div>
                                <textarea id="minifier-input" placeholder="Enter your CSS or JavaScript code..." class="w-full h-64 pl-10 pr-4 py-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-orange-500 focus:border-transparent font-mono text-sm resize-none" style="font-family: 'Courier New', monospace; line-height: 1.5;" oninput="updateMinifierInputLineNumbers()" onscroll="syncMinifierInputScroll()" onpaste="setTimeout(updateMinifierInputLineNumbers, 10)"></textarea>
                            </div>
                        </div>
                        
                        <!-- Optimization Options -->
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Optimization Options</label>
                            <div id="css-options" class="space-y-3">
                                <div class="flex items-center">
                                    <input type="checkbox" id="remove-comments" class="mr-2" checked>
                                    <label for="remove-comments" class="text-gray-700">Remove Comments</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="checkbox" id="remove-whitespace" class="mr-2" checked>
                                    <label for="remove-whitespace" class="text-gray-700">Remove Whitespace</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="checkbox" id="remove-empty-rules" class="mr-2" checked>
                                    <label for="remove-empty-rules" class="text-gray-700">Remove Empty Rules</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="checkbox" id="optimize-colors" class="mr-2" checked>
                                    <label for="optimize-colors" class="text-gray-700">Optimize Colors</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="checkbox" id="optimize-shorthand" class="mr-2" checked>
                                    <label for="optimize-shorthand" class="text-gray-700">Optimize Shorthand</label>
                                </div>
                            </div>
                            <div id="js-options" class="space-y-3 hidden">
                                <div class="flex items-center">
                                    <input type="checkbox" id="remove-js-comments" class="mr-2" checked>
                                    <label for="remove-js-comments" class="text-gray-700">Remove Comments</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="checkbox" id="remove-js-whitespace" class="mr-2" checked>
                                    <label for="remove-js-whitespace" class="text-gray-700">Remove Whitespace</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="checkbox" id="remove-console-logs" class="mr-2" checked>
                                    <label for="remove-console-logs" class="text-gray-700">Remove Console Logs</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="checkbox" id="optimize-expressions" class="mr-2" checked>
                                    <label for="optimize-expressions" class="text-gray-700">Optimize Expressions</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="checkbox" id="minify-identifiers" class="mr-2">
                                    <label for="minify-identifiers" class="text-gray-700">Minify Identifiers</label>
                                </div>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-2 gap-3">
                            <button onclick="minifyCode()" class="bg-orange-500 hover:bg-orange-600 text-white font-bold py-3 px-4 rounded-xl transition-all duration-300 transform hover:scale-105">
                                Minify Code
                            </button>
                            <button onclick="beautifyCode()" class="bg-red-500 hover:bg-red-600 text-white font-bold py-3 px-4 rounded-xl transition-all duration-300 transform hover:scale-105">
                                Beautify Code
                            </button>
                            <button onclick="validateCode()" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-4 rounded-xl transition-all duration-300 transform hover:scale-105">
                                Validate Code
                            </button>
                            <button onclick="getFileStats()" class="bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-4 rounded-xl transition-all duration-300 transform hover:scale-105">
                                Get Statistics
                            </button>
                            <button onclick="clearMinifier()" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-3 px-4 rounded-xl transition-all duration-300 transform hover:scale-105">
                                Clear All
                            </button>
                        </div>
                    </div>
                    
                    <!-- Output Section -->
                    <div class="space-y-6">
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Output</label>
                            <div class="relative">
                                <div class="absolute left-0 top-0 bottom-0 w-8 bg-gray-100 border border-gray-300 rounded-l-xl flex flex-col items-center text-xs text-gray-500 font-mono overflow-hidden" id="minifier-output-lines" style="z-index: 1;"></div>
                                <textarea id="minifier-output" placeholder="Minified or beautified code will appear here..." class="w-full h-64 pl-10 pr-4 py-4 border border-gray-300 rounded-xl bg-gray-50 font-mono text-sm resize-none" style="font-family: 'Courier New', monospace; line-height: 1.5;" readonly onscroll="syncMinifierOutputScroll()"></textarea>
                            </div>
                        </div>
                        
                        <div class="flex space-x-3">
                            <button onclick="copyMinifierOutput()" class="bg-orange-500 hover:bg-orange-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                Copy Output
                            </button>
                            <button onclick="downloadMinifierOutput()" class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                Download
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Results Section -->
                <div class="mt-8 space-y-6">
                    <!-- Minification Results -->
                    <div id="minification-results" class="hidden">
                        <div class="bg-orange-50 rounded-xl p-6">
                            <h4 class="text-lg font-bold mb-4 text-orange-800">Minification Results</h4>
                            <div id="minification-content" class="space-y-3"></div>
                        </div>
                    </div>
                    
                    <!-- Beautification Results -->
                    <div id="beautification-results" class="hidden">
                        <div class="bg-red-50 rounded-xl p-6">
                            <h4 class="text-lg font-bold mb-4 text-red-800">Beautification Results</h4>
                            <div id="beautification-content" class="space-y-3"></div>
                        </div>
                    </div>
                    
                    <!-- Validation Results -->
                    <div id="minifier-validation-results" class="hidden">
                        <div class="bg-blue-50 rounded-xl p-6">
                            <h4 class="text-lg font-bold mb-4 text-blue-800">Validation Results</h4>
                            <div id="minifier-validation-content" class="space-y-3"></div>
                        </div>
                    </div>
                    
                    <!-- Statistics Results -->
                    <div id="statistics-results" class="hidden">
                        <div class="bg-green-50 rounded-xl p-6">
                            <h4 class="text-lg font-bold mb-4 text-green-800">File Statistics</h4>
                            <div id="statistics-content" class="space-y-3"></div>
                        </div>
                    </div>
                    
                    <!-- Error Display -->
                    <div id="minifier-error-display" class="hidden">
                        <div class="bg-red-50 rounded-xl p-6">
                            <h4 class="text-lg font-bold mb-4 text-red-800">Error Details</h4>
                            <div id="minifier-error-content" class="space-y-3"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Color Palette Generator Modal -->
    <div id="color-palette-modal" class="modal fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="modal-content bg-white rounded-2xl shadow-2xl max-w-7xl w-full mx-4 my-8 max-h-[90vh] overflow-y-auto">
            <div class="bg-gradient-to-r from-purple-500 to-pink-600 p-6 text-white rounded-t-2xl">
                <div class="flex justify-between items-center">
                    <div>
                        <h3 class="text-3xl font-bold mb-2">Color Palette Generator</h3>
                        <p class="text-purple-100">Generate beautiful color palettes with accessibility features</p>
                    </div>
                    <button onclick="closeModal('color-palette-modal')" class="text-white hover:text-gray-200 text-3xl font-bold">&times;</button>
                </div>
            </div>
            
            <div class="p-6">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Input Section -->
                    <div class="space-y-6">
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Base Color</label>
                            <div class="flex items-center space-x-4">
                                <input type="color" id="base-color" value="#3B82F6" class="w-16 h-12 border border-gray-300 rounded-lg cursor-pointer">
                                <input type="text" id="base-color-hex" value="#3B82F6" placeholder="#3B82F6" class="flex-1 p-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent font-mono">
                            </div>
                        </div>
                        
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Palette Type</label>
                            <select id="palette-type" class="w-full p-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                                <option value="complementary">Complementary</option>
                                <option value="analogous">Analogous</option>
                                <option value="triadic">Triadic</option>
                                <option value="tetradic">Tetradic</option>
                                <option value="monochromatic">Monochromatic</option>
                                <option value="split-complementary">Split Complementary</option>
                                <option value="random">Random</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Number of Colors</label>
                            <input type="range" id="color-count" min="3" max="10" value="5" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider">
                            <div class="flex justify-between text-sm text-gray-600 mt-1">
                                <span>3</span>
                                <span id="color-count-value">5</span>
                                <span>10</span>
                            </div>
                        </div>
                        
                        <div class="flex space-x-4">
                            <button onclick="generatePalette()" class="flex-1 bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white font-bold py-3 px-6 rounded-xl transition-all duration-300 transform hover:scale-105">
                                Generate Palette
                            </button>
                            <button onclick="randomColor()" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-3 px-6 rounded-xl transition-all duration-300 transform hover:scale-105">
                                Random Color
                            </button>
                        </div>
                    </div>
                    
                    <!-- Output Section -->
                    <div class="space-y-6">
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Generated Palette</label>
                            <div id="palette-preview" class="grid grid-cols-5 gap-2 mb-4">
                                <!-- Palette colors will be generated here -->
                            </div>
                        </div>
                        
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Export Options</label>
                            <div class="space-y-3">
                                <button onclick="exportCSS()" class="w-full bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    Export CSS Variables
                                </button>
                                <button onclick="exportSCSS()" class="w-full bg-pink-500 hover:bg-pink-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    Export SCSS Variables
                                </button>
                                <button onclick="exportTailwind()" class="w-full bg-cyan-500 hover:bg-cyan-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    Export Tailwind Config
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Results Section -->
                <div class="mt-8 space-y-6">
                    <!-- Accessibility Results -->
                    <div id="accessibility-results" class="hidden">
                        <div class="bg-green-50 rounded-xl p-6">
                            <h4 class="text-lg font-bold mb-4 text-green-800">Accessibility Analysis</h4>
                            <div id="accessibility-content" class="space-y-3"></div>
                        </div>
                    </div>
                    
                    <!-- Export Results -->
                    <div id="export-results" class="hidden">
                        <div class="bg-blue-50 rounded-xl p-6">
                            <h4 class="text-lg font-bold mb-4 text-blue-800">Export Code</h4>
                            <div class="relative">
                                <div class="absolute left-0 top-0 bottom-0 w-8 bg-gray-100 border border-gray-300 rounded-l-xl flex flex-col items-center text-xs text-gray-500 font-mono overflow-hidden" id="export-lines" style="z-index: 1;"></div>
                                <textarea id="export-output" readonly class="w-full h-48 pl-10 pr-4 py-4 border border-gray-300 rounded-xl font-mono text-sm resize-none" style="font-family: 'Courier New', monospace; line-height: 1.5;" placeholder="Generated code will appear here..."></textarea>
                            </div>
                            <div class="flex space-x-4 mt-4">
                                <button onclick="copyExport()" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    Copy Code
                                </button>
                                <button onclick="downloadExport()" class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    Download
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Lorem Ipsum Generator Modal -->
    <div id="lorem-ipsum-modal" class="modal fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="modal-content bg-white rounded-2xl shadow-2xl max-w-7xl w-full mx-4 my-8 max-h-[90vh] overflow-y-auto">
            <div class="bg-gradient-to-r from-green-500 to-teal-600 p-6 text-white rounded-t-2xl">
                <div class="flex justify-between items-center">
                    <div>
                        <h3 class="text-3xl font-bold mb-2">Lorem Ipsum Generator</h3>
                        <p class="text-green-100">Generate Lorem Ipsum text in multiple languages with custom lengths</p>
                    </div>
                    <button onclick="closeModal('lorem-ipsum-modal')" class="text-white hover:text-gray-200 text-3xl font-bold">&times;</button>
                </div>
            </div>
            
            <div class="p-6">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Input Section -->
                    <div class="space-y-6">
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Language</label>
                            <select id="lorem-language" class="w-full p-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                <option value="latin">Latin (Classic Lorem Ipsum)</option>
                                <option value="english">English (Pangrams)</option>
                                <option value="spanish">Spanish (Pangrams)</option>
                                <option value="french">French (Pangrams)</option>
                                <option value="german">German (Pangrams)</option>
                                <option value="japanese">Japanese (Iroha)</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Type</label>
                            <select id="lorem-type" class="w-full p-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                <option value="words">Words</option>
                                <option value="sentences">Sentences</option>
                                <option value="paragraphs">Paragraphs</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Count</label>
                            <input type="number" id="lorem-count" min="1" max="1000" value="50" class="w-full p-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent">
                            <div class="text-sm text-gray-600 mt-1">
                                <span id="count-description">50 words</span>
                            </div>
                        </div>
                        
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Format</label>
                            <select id="lorem-format" class="w-full p-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                <option value="plain">Plain Text</option>
                                <option value="html">HTML</option>
                                <option value="markdown">Markdown</option>
                            </select>
                        </div>
                        
                        <div class="flex items-center">
                            <input type="checkbox" id="start-with-lorem" class="mr-2" checked>
                            <label for="start-with-lorem" class="text-gray-700">Start with "Lorem ipsum"</label>
                        </div>
                        
                        <div class="flex space-x-4">
                            <button onclick="generateLoremIpsum()" class="flex-1 bg-gradient-to-r from-green-500 to-teal-500 hover:from-green-600 hover:to-teal-600 text-white font-bold py-3 px-6 rounded-xl transition-all duration-300 transform hover:scale-105">
                                Generate Text
                            </button>
                            <button onclick="generateRandomLorem()" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-3 px-6 rounded-xl transition-all duration-300 transform hover:scale-105">
                                Random
                            </button>
                        </div>
                    </div>
                    
                    <!-- Output Section -->
                    <div class="space-y-6">
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Generated Text</label>
                            <div class="relative">
                                <div class="absolute left-0 top-0 bottom-0 w-8 bg-gray-100 border border-gray-300 rounded-l-xl flex flex-col items-center text-xs text-gray-500 font-mono overflow-hidden" id="lorem-output-lines" style="z-index: 1;"></div>
                                <textarea id="lorem-output" readonly class="w-full h-64 pl-10 pr-4 py-4 border border-gray-300 rounded-xl font-mono text-sm resize-none" style="font-family: 'Courier New', monospace; line-height: 1.5;" placeholder="Generated Lorem Ipsum text will appear here..."></textarea>
                            </div>
                        </div>
                        
                        <div class="flex space-x-4">
                            <button onclick="copyLoremOutput()" class="flex-1 bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                Copy Text
                            </button>
                            <button onclick="downloadLoremOutput()" class="flex-1 bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                Download
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Results Section -->
                <div class="mt-8 space-y-6">
                    <!-- Statistics Results -->
                    <div id="lorem-stats-results" class="hidden">
                        <div class="bg-blue-50 rounded-xl p-6">
                            <h4 class="text-lg font-bold mb-4 text-blue-800">Text Statistics</h4>
                            <div id="lorem-stats-content" class="space-y-3"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Note-Taking & Summarizer Modal -->
    <div id="note-taker-modal" class="modal fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="modal-content bg-white rounded-2xl shadow-2xl max-w-7xl w-full mx-4 my-8 max-h-[90vh] overflow-y-auto">
            <div class="bg-gradient-to-r from-blue-500 to-indigo-600 p-6 text-white rounded-t-2xl">
                <div class="flex justify-between items-center">
                    <div>
                        <h3 class="text-3xl font-bold mb-2">Note-Taking & Summarizer</h3>
                        <p class="text-blue-100">Advanced text summarization, key points extraction, and intelligent note organization</p>
                    </div>
                    <button onclick="closeModal('note-taker-modal')" class="text-white hover:text-gray-200 text-3xl font-bold">&times;</button>
                </div>
            </div>
            
            <div class="p-6">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Input Section -->
                    <div class="space-y-6">
                        <!-- Text Input -->
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Text to Analyze</label>
                            <textarea id="note-text" rows="12" class="w-full p-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none" placeholder="Paste your text here for summarization, key points extraction, and analysis..."></textarea>
                        </div>
                        
                        <!-- Options -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">Summarization Mode</label>
                                <select id="summary-mode" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                                    <option value="brief">Brief Summary (10%)</option>
                                    <option value="standard" selected>Standard Summary (20%)</option>
                                    <option value="detailed">Detailed Summary (30%)</option>
                                    <option value="comprehensive">Comprehensive Summary (40%)</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">Key Points Count</label>
                                <select id="key-points-count" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                                    <option value="3">3 Key Points</option>
                                    <option value="5" selected>5 Key Points</option>
                                    <option value="8">8 Key Points</option>
                                    <option value="10">10 Key Points</option>
                                </select>
                            </div>
                        </div>
                        
                        <!-- Action Buttons -->
                        <div class="grid grid-cols-2 gap-4">
                            <button onclick="summarizeText()" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-6 rounded-xl transition-all duration-300 transform hover:scale-105">
                                üìù Summarize
                            </button>
                            <button onclick="extractKeyPoints()" class="bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-6 rounded-xl transition-all duration-300 transform hover:scale-105">
                                üéØ Key Points
                            </button>
                            <button onclick="analyzeText()" class="bg-purple-500 hover:bg-purple-600 text-white font-bold py-3 px-6 rounded-xl transition-all duration-300 transform hover:scale-105">
                                üìä Analyze
                            </button>
                            <button onclick="createStructuredNotes()" class="bg-indigo-500 hover:bg-indigo-600 text-white font-bold py-3 px-6 rounded-xl transition-all duration-300 transform hover:scale-105">
                                üìö Create Notes
                            </button>
                        </div>
                        
                        <!-- Quick Actions -->
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">Quick Actions</label>
                            <div class="flex space-x-2">
                                <button onclick="clearNoteText()" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    Clear
                                </button>
                                <button onclick="loadSampleText()" class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    Load Sample
                                </button>
                                <button onclick="copyNoteText()" class="bg-teal-500 hover:bg-teal-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    Copy Text
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Results Section -->
                    <div class="space-y-6">
                        <!-- Summary Results -->
                        <div id="summary-results" class="hidden">
                            <h4 class="text-lg font-bold text-gray-800 mb-3">üìù Summary</h4>
                            <div class="bg-blue-50 p-4 rounded-lg">
                                <div id="summary-content" class="text-gray-700 mb-3"></div>
                                <div id="summary-stats" class="text-sm text-gray-600"></div>
                                <div class="flex space-x-2 mt-3">
                                    <button onclick="copySummary()" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                        Copy Summary
                                    </button>
                                    <button onclick="downloadSummary()" class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                        Download
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Key Points Results -->
                        <div id="key-points-results" class="hidden">
                            <h4 class="text-lg font-bold text-gray-800 mb-3">üéØ Key Points</h4>
                            <div class="bg-green-50 p-4 rounded-lg">
                                <div id="key-points-content" class="space-y-2 mb-3"></div>
                                <div id="key-points-stats" class="text-sm text-gray-600"></div>
                                <div class="flex space-x-2 mt-3">
                                    <button onclick="copyKeyPoints()" class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                        Copy Points
                                    </button>
                                    <button onclick="downloadKeyPoints()" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                        Download
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Analysis Results -->
                        <div id="analysis-results" class="hidden">
                            <h4 class="text-lg font-bold text-gray-800 mb-3">üìä Text Analysis</h4>
                            <div class="bg-purple-50 p-4 rounded-lg">
                                <div id="analysis-content" class="grid grid-cols-2 gap-4 mb-3"></div>
                                <div id="analysis-stats" class="text-sm text-gray-600"></div>
                            </div>
                        </div>
                        
                        <!-- Structured Notes Results -->
                        <div id="notes-results" class="hidden">
                            <h4 class="text-lg font-bold text-gray-800 mb-3">üìö Structured Notes</h4>
                            <div class="bg-indigo-50 p-4 rounded-lg">
                                <div id="notes-content" class="space-y-4 mb-3"></div>
                                <div class="flex space-x-2 mt-3">
                                    <button onclick="saveNotes()" class="bg-indigo-500 hover:bg-indigo-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                        Save Notes
                                    </button>
                                    <button onclick="downloadNotes()" class="bg-purple-500 hover:bg-purple-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                        Download
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Notes Library -->
                        <div>
                            <h4 class="text-lg font-bold text-gray-800 mb-3">üìö Notes Library</h4>
                            <div id="notes-library" class="space-y-2 max-h-48 overflow-y-auto">
                                <div class="text-gray-500 text-center py-4">No saved notes yet</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Flashcard Generator Modal -->
    <div id="flashcard-generator-modal" class="modal fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="modal-content bg-white rounded-2xl shadow-2xl max-w-7xl w-full mx-4 my-8 max-h-[90vh] overflow-y-auto">
            <div class="bg-gradient-to-r from-amber-500 to-orange-600 p-6 text-white rounded-t-2xl">
                <div class="flex justify-between items-center">
                    <div>
                        <h3 class="text-3xl font-bold mb-2">Flashcard Generator</h3>
                        <p class="text-amber-100">Advanced flashcard creation, study modes, and spaced repetition for effective learning</p>
                    </div>
                    <button onclick="closeModal('flashcard-generator-modal')" class="text-white hover:text-gray-200 text-3xl font-bold">&times;</button>
                </div>
            </div>
            
            <div class="p-6">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Input Section -->
                    <div class="space-y-6">
                        <!-- Create Deck -->
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Create New Deck</label>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Deck Name</label>
                                    <input type="text" id="deck-name" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500" placeholder="e.g., Spanish Vocabulary">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Subject</label>
                                    <input type="text" id="deck-subject" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500" placeholder="e.g., Spanish">
                                </div>
                                <div class="col-span-2">
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Description</label>
                                    <textarea id="deck-description" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500" placeholder="Brief description of the deck" rows="2"></textarea>
                                </div>
                            </div>
                            <button onclick="createDeck()" class="w-full mt-4 bg-amber-500 hover:bg-amber-600 text-white font-bold py-3 px-6 rounded-xl transition-all duration-300 transform hover:scale-105">
                                üìö Create Deck
                            </button>
                        </div>
                        
                        <!-- Add Flashcard -->
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Add Flashcard</label>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Deck</label>
                                    <select id="flashcard-deck" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500">
                                        <option value="">Select a deck</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Card Type</label>
                                    <select id="card-type" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500" onchange="updateCardFields()">
                                        <option value="basic">Basic Card</option>
                                        <option value="cloze">Cloze Deletion</option>
                                        <option value="multiple_choice">Multiple Choice</option>
                                        <option value="image">Image Card</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Front/Question</label>
                                    <input type="text" id="card-front" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500" placeholder="e.g., What is the capital of France?">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Back/Answer</label>
                                    <input type="text" id="card-back" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500" placeholder="e.g., Paris">
                                </div>
                                <div id="card-options" class="col-span-2 hidden">
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Options (one per line)</label>
                                    <textarea id="card-options-text" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500" placeholder="Option 1&#10;Option 2&#10;Option 3" rows="3"></textarea>
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Difficulty</label>
                                    <select id="card-difficulty" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500">
                                        <option value="easy">Easy</option>
                                        <option value="medium">Medium</option>
                                        <option value="hard">Hard</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Tags</label>
                                    <input type="text" id="card-tags" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500" placeholder="e.g., vocabulary, grammar">
                                </div>
                            </div>
                            <button onclick="addFlashcard()" class="w-full mt-4 bg-orange-500 hover:bg-orange-600 text-white font-bold py-3 px-6 rounded-xl transition-all duration-300 transform hover:scale-105">
                                ‚ûï Add Flashcard
                            </button>
                        </div>
                        
                        <!-- Study Session -->
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Start Study Session</label>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Deck</label>
                                    <select id="study-deck" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500">
                                        <option value="">Select a deck</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Study Mode</label>
                                    <select id="study-mode" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500">
                                        <option value="review">Review Mode</option>
                                        <option value="learn">Learn Mode</option>
                                        <option value="test">Test Mode</option>
                                        <option value="cram">Cram Mode</option>
                                    </select>
                                </div>
                            </div>
                            <button onclick="startStudySession()" class="w-full mt-4 bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-6 rounded-xl transition-all duration-300 transform hover:scale-105">
                                üéØ Start Studying
                            </button>
                        </div>
                        
                        <!-- Quick Actions -->
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">Quick Actions</label>
                            <div class="grid grid-cols-2 gap-2">
                                <button onclick="getStudyStats()" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    üìä Study Stats
                                </button>
                                <button onclick="exportDeck()" class="bg-purple-500 hover:bg-purple-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    üì§ Export Deck
                                </button>
                                <button onclick="searchCards()" class="bg-indigo-500 hover:bg-indigo-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    üîç Search Cards
                                </button>
                                <button onclick="clearAllData()" class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    üóëÔ∏è Clear All
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Results Section -->
                    <div class="space-y-6">
                        <!-- Study Session -->
                        <div id="study-session" class="hidden">
                            <h4 class="text-lg font-bold text-gray-800 mb-3">üìö Study Session</h4>
                            <div class="bg-amber-50 p-4 rounded-lg">
                                <div id="study-progress" class="text-sm text-gray-600 mb-3"></div>
                                <div id="study-card" class="bg-white p-4 rounded-lg border-2 border-amber-200 mb-4">
                                    <div id="card-question" class="text-lg font-semibold text-gray-800 mb-3"></div>
                                    <div id="card-answer" class="hidden text-gray-600 mb-3"></div>
                                    <div id="study-actions" class="flex space-x-2">
                                        <button onclick="showAnswer()" class="bg-amber-500 hover:bg-amber-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                            Show Answer
                                        </button>
                                        <button onclick="answerCard('correct')" class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                            Correct
                                        </button>
                                        <button onclick="answerCard('incorrect')" class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                            Incorrect
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Study Statistics -->
                        <div id="study-stats-results" class="hidden">
                            <h4 class="text-lg font-bold text-gray-800 mb-3">üìä Study Statistics</h4>
                            <div class="bg-blue-50 p-4 rounded-lg">
                                <div id="study-stats-content" class="text-sm text-gray-600"></div>
                            </div>
                        </div>
                        
                        <!-- Decks List -->
                        <div>
                            <h4 class="text-lg font-bold text-gray-800 mb-3">üìö Your Decks</h4>
                            <div id="decks-list" class="space-y-2 max-h-48 overflow-y-auto">
                                <div class="text-gray-500 text-center py-4">No decks created yet</div>
                            </div>
                        </div>
                        
                        <!-- Cards List -->
                        <div>
                            <h4 class="text-lg font-bold text-gray-800 mb-3">üÉè Recent Cards</h4>
                            <div id="cards-list" class="space-y-2 max-h-48 overflow-y-auto">
                                <div class="text-gray-500 text-center py-4">No cards added yet</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Progress Tracker & Analytics Modal -->
    <div id="progress-tracker-modal" class="modal fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="modal-content bg-white rounded-2xl shadow-2xl max-w-7xl w-full mx-4 my-8 max-h-[90vh] overflow-y-auto">
            <div class="bg-gradient-to-r from-violet-500 to-purple-600 p-6 text-white rounded-t-2xl">
                <div class="flex justify-between items-center">
                    <div>
                        <h3 class="text-3xl font-bold mb-2">Progress Tracker & Analytics</h3>
                        <p class="text-violet-100">Comprehensive academic progress tracking, performance analytics, and study insights</p>
                    </div>
                    <button onclick="closeModal('progress-tracker-modal')" class="text-white hover:text-gray-200 text-3xl font-bold">&times;</button>
                </div>
            </div>
            
            <div class="p-6">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Input Section -->
                    <div class="space-y-6">
                        <!-- Add Subject -->
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Add Subject</label>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Subject Name</label>
                                    <input type="text" id="subject-name" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-violet-500" placeholder="e.g., Mathematics">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Subject Code</label>
                                    <input type="text" id="subject-code" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-violet-500" placeholder="e.g., MATH101">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Credits</label>
                                    <input type="number" id="subject-credits" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-violet-500" placeholder="3" min="1" max="6">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Instructor</label>
                                    <input type="text" id="subject-instructor" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-violet-500" placeholder="e.g., Dr. Smith">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Semester</label>
                                    <input type="text" id="subject-semester" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-violet-500" placeholder="e.g., Fall 2024">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Year</label>
                                    <input type="number" id="subject-year" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-violet-500" placeholder="2024" min="2020" max="2030">
                                </div>
                            </div>
                            <button onclick="addSubject()" class="w-full mt-4 bg-violet-500 hover:bg-violet-600 text-white font-bold py-3 px-6 rounded-xl transition-all duration-300 transform hover:scale-105">
                                üìö Add Subject
                            </button>
                        </div>
                        
                        <!-- Add Assignment -->
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Add Assignment</label>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Subject</label>
                                    <select id="assignment-subject" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-violet-500">
                                        <option value="">Select a subject</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Type</label>
                                    <select id="assignment-type" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-violet-500">
                                        <option value="homework">Homework</option>
                                        <option value="project">Project</option>
                                        <option value="essay">Essay</option>
                                        <option value="lab">Lab Report</option>
                                        <option value="presentation">Presentation</option>
                                    </select>
                                </div>
                                <div class="col-span-2">
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Title</label>
                                    <input type="text" id="assignment-title" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-violet-500" placeholder="e.g., Calculus Problem Set 1">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Due Date</label>
                                    <input type="date" id="assignment-due-date" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-violet-500">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Points</label>
                                    <input type="number" id="assignment-points" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-violet-500" placeholder="100" min="1">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Grade (%)</label>
                                    <input type="number" id="assignment-grade" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-violet-500" placeholder="85" min="0" max="100">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Priority</label>
                                    <select id="assignment-priority" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-violet-500">
                                        <option value="low">Low</option>
                                        <option value="medium">Medium</option>
                                        <option value="high">High</option>
                                    </select>
                                </div>
                            </div>
                            <button onclick="addAssignment()" class="w-full mt-4 bg-purple-500 hover:bg-purple-600 text-white font-bold py-3 px-6 rounded-xl transition-all duration-300 transform hover:scale-105">
                                üìù Add Assignment
                            </button>
                        </div>
                        
                        <!-- Add Exam -->
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Add Exam</label>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Subject</label>
                                    <select id="exam-subject" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-violet-500">
                                        <option value="">Select a subject</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Type</label>
                                    <select id="exam-type" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-violet-500">
                                        <option value="midterm">Midterm</option>
                                        <option value="final">Final</option>
                                        <option value="quiz">Quiz</option>
                                        <option value="test">Test</option>
                                    </select>
                                </div>
                                <div class="col-span-2">
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Title</label>
                                    <input type="text" id="exam-title" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-violet-500" placeholder="e.g., Midterm Exam 1">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Date</label>
                                    <input type="date" id="exam-date" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-violet-500">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Duration (min)</label>
                                    <input type="number" id="exam-duration" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-violet-500" placeholder="120" min="30">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Total Marks</label>
                                    <input type="number" id="exam-total-marks" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-violet-500" placeholder="100" min="1">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Grade (%)</label>
                                    <input type="number" id="exam-grade" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-violet-500" placeholder="88" min="0" max="100">
                                </div>
                            </div>
                            <button onclick="addExam()" class="w-full mt-4 bg-indigo-500 hover:bg-indigo-600 text-white font-bold py-3 px-6 rounded-xl transition-all duration-300 transform hover:scale-105">
                                üìä Add Exam
                            </button>
                        </div>
                        
                        <!-- Quick Actions -->
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">Quick Actions</label>
                            <div class="grid grid-cols-2 gap-2">
                                <button onclick="getOverallAnalytics()" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    üìä Analytics
                                </button>
                                <button onclick="getStudyInsights()" class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    üîç Insights
                                </button>
                                <button onclick="exportProgressData()" class="bg-purple-500 hover:bg-purple-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    üì§ Export Data
                                </button>
                                <button onclick="clearAllProgressData()" class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    üóëÔ∏è Clear All
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Results Section -->
                    <div class="space-y-6">
                        <!-- Overall Analytics -->
                        <div id="overall-analytics" class="hidden">
                            <h4 class="text-lg font-bold text-gray-800 mb-3">üìä Overall Analytics</h4>
                            <div class="bg-blue-50 p-4 rounded-lg">
                                <div id="analytics-content" class="text-sm text-gray-600"></div>
                            </div>
                        </div>
                        
                        <!-- Study Insights -->
                        <div id="study-insights" class="hidden">
                            <h4 class="text-lg font-bold text-gray-800 mb-3">üîç Study Insights</h4>
                            <div class="bg-green-50 p-4 rounded-lg">
                                <div id="insights-content" class="text-sm text-gray-600"></div>
                            </div>
                        </div>
                        
                        <!-- Subjects List -->
                        <div>
                            <h4 class="text-lg font-bold text-gray-800 mb-3">üìö Your Subjects</h4>
                            <div id="subjects-list" class="space-y-2 max-h-48 overflow-y-auto">
                                <div class="text-gray-500 text-center py-4">No subjects added yet</div>
                            </div>
                        </div>
                        
                        <!-- Recent Assignments -->
                        <div>
                            <h4 class="text-lg font-bold text-gray-800 mb-3">üìù Recent Assignments</h4>
                            <div id="assignments-list" class="space-y-2 max-h-48 overflow-y-auto">
                                <div class="text-gray-500 text-center py-4">No assignments added yet</div>
                            </div>
                        </div>
                        
                        <!-- Recent Exams -->
                        <div>
                            <h4 class="text-lg font-bold text-gray-800 mb-3">üìä Recent Exams</h4>
                            <div id="exams-list" class="space-y-2 max-h-48 overflow-y-auto">
                                <div class="text-gray-500 text-center py-4">No exams added yet</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Study Planner & Schedule Modal -->
    <div id="study-planner-modal" class="modal fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="modal-content bg-white rounded-2xl shadow-2xl max-w-7xl w-full mx-4 my-8 max-h-[90vh] overflow-y-auto">
            <div class="bg-gradient-to-r from-emerald-500 to-cyan-600 p-6 text-white rounded-t-2xl">
                <div class="flex justify-between items-center">
                    <div>
                        <h3 class="text-3xl font-bold mb-2">Study Planner & Schedule</h3>
                        <p class="text-emerald-100">Advanced study planning, scheduling, and time management for students</p>
                    </div>
                    <button onclick="closeModal('study-planner-modal')" class="text-white hover:text-gray-200 text-3xl font-bold">&times;</button>
                </div>
            </div>
            
            <div class="p-6">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Input Section -->
                    <div class="space-y-6">
                        <!-- Study Session -->
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Add Study Session</label>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Session Title</label>
                                    <input type="text" id="session-title" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500" placeholder="e.g., Math Review">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Subject</label>
                                    <input type="text" id="session-subject" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500" placeholder="e.g., Mathematics">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Session Type</label>
                                    <select id="session-type" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500">
                                        <option value="focused">Focused Study</option>
                                        <option value="review">Review Session</option>
                                        <option value="practice">Practice Problems</option>
                                        <option value="reading">Reading Session</option>
                                        <option value="group">Group Study</option>
                                        <option value="exam_prep">Exam Preparation</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Duration (minutes)</label>
                                    <input type="number" id="session-duration" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500" placeholder="45" min="15" max="240">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Date</label>
                                    <input type="date" id="session-date" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Start Time</label>
                                    <input type="time" id="session-start-time" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Priority</label>
                                    <select id="session-priority" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500">
                                        <option value="high">High Priority</option>
                                        <option value="medium">Medium Priority</option>
                                        <option value="low">Low Priority</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Location</label>
                                    <input type="text" id="session-location" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500" placeholder="e.g., Library, Home">
                                </div>
                            </div>
                            <button onclick="addStudySession()" class="w-full mt-4 bg-emerald-500 hover:bg-emerald-600 text-white font-bold py-3 px-6 rounded-xl transition-all duration-300 transform hover:scale-105">
                                ‚ûï Add Study Session
                            </button>
                        </div>
                        
                        <!-- Study Goal -->
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Add Study Goal</label>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Goal Title</label>
                                    <input type="text" id="goal-title" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500" placeholder="e.g., Complete Math Chapter 5">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Subject</label>
                                    <input type="text" id="goal-subject" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500" placeholder="e.g., Mathematics">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Goal Type</label>
                                    <select id="goal-type" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500">
                                        <option value="daily">Daily Goal</option>
                                        <option value="weekly">Weekly Goal</option>
                                        <option value="monthly">Monthly Goal</option>
                                        <option value="semester">Semester Goal</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Target</label>
                                    <input type="number" id="goal-target" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500" placeholder="1" min="1">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Unit</label>
                                    <select id="goal-unit" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500">
                                        <option value="hours">Hours</option>
                                        <option value="sessions">Sessions</option>
                                        <option value="chapters">Chapters</option>
                                        <option value="pages">Pages</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Deadline</label>
                                    <input type="date" id="goal-deadline" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500">
                                </div>
                            </div>
                            <button onclick="addStudyGoal()" class="w-full mt-4 bg-cyan-500 hover:bg-cyan-600 text-white font-bold py-3 px-6 rounded-xl transition-all duration-300 transform hover:scale-105">
                                üéØ Add Study Goal
                            </button>
                        </div>
                        
                        <!-- Quick Actions -->
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">Quick Actions</label>
                            <div class="grid grid-cols-2 gap-2">
                                <button onclick="generateSchedule()" class="bg-emerald-500 hover:bg-emerald-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    üìÖ Generate Schedule
                                </button>
                                <button onclick="getStudyStats()" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    üìä Study Stats
                                </button>
                                <button onclick="getRecommendations()" class="bg-purple-500 hover:bg-purple-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    üí° Recommendations
                                </button>
                                <button onclick="exportStudyData()" class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    üì§ Export Data
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Results Section -->
                    <div class="space-y-6">
                        <!-- Study Statistics -->
                        <div id="study-stats-results" class="hidden">
                            <h4 class="text-lg font-bold text-gray-800 mb-3">üìä Study Statistics</h4>
                            <div class="bg-emerald-50 p-4 rounded-lg">
                                <div id="study-stats-content" class="text-sm text-gray-600"></div>
                            </div>
                        </div>
                        
                        <!-- Study Recommendations -->
                        <div id="study-recommendations-results" class="hidden">
                            <h4 class="text-lg font-bold text-gray-800 mb-3">üí° Study Recommendations</h4>
                            <div class="bg-purple-50 p-4 rounded-lg">
                                <div id="study-recommendations-content" class="text-sm text-gray-600"></div>
                            </div>
                        </div>
                        
                        <!-- Upcoming Sessions -->
                        <div>
                            <h4 class="text-lg font-bold text-gray-800 mb-3">üìÖ Upcoming Sessions</h4>
                            <div id="upcoming-sessions" class="space-y-2 max-h-48 overflow-y-auto">
                                <div class="text-gray-500 text-center py-4">No upcoming sessions</div>
                            </div>
                        </div>
                        
                        <!-- Study Goals -->
                        <div>
                            <h4 class="text-lg font-bold text-gray-800 mb-3">üéØ Study Goals</h4>
                            <div id="study-goals" class="space-y-2 max-h-48 overflow-y-auto">
                                <div class="text-gray-500 text-center py-4">No study goals set</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Citation Generator Modal -->
    <div id="citation-generator-modal" class="modal fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="modal-content bg-white rounded-2xl shadow-2xl max-w-7xl w-full mx-4 my-8 max-h-[90vh] overflow-y-auto">
            <div class="bg-gradient-to-r from-indigo-500 to-blue-600 p-6 text-white rounded-t-2xl">
                <div class="flex justify-between items-center">
                    <div>
                        <h3 class="text-3xl font-bold mb-2">Citation Generator</h3>
                        <p class="text-indigo-100">Advanced citation generation for multiple formats and source types</p>
                    </div>
                    <button onclick="closeModal('citation-generator-modal')" class="text-white hover:text-gray-200 text-3xl font-bold">&times;</button>
                </div>
            </div>
            
            <div class="p-6">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Input Section -->
                    <div class="space-y-6">
                        <!-- Citation Format Selection -->
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Citation Format</label>
                            <select id="citation-format" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500" onchange="updateFormatInfo()">
                                <option value="apa">APA (American Psychological Association)</option>
                                <option value="mla">MLA (Modern Language Association)</option>
                                <option value="chicago">Chicago Manual of Style</option>
                                <option value="harvard">Harvard Referencing</option>
                                <option value="ieee">IEEE (Engineering)</option>
                                <option value="vancouver">Vancouver Style</option>
                            </select>
                            <div id="format-info" class="mt-2 text-sm text-gray-600"></div>
                        </div>
                        
                        <!-- Source Type Selection -->
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Source Type</label>
                            <select id="source-type" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500" onchange="updateSourceFields()">
                                <option value="book">Book</option>
                                <option value="journal">Journal Article</option>
                                <option value="website">Website</option>
                                <option value="newspaper">Newspaper Article</option>
                                <option value="conference">Conference Paper</option>
                                <option value="thesis">Thesis/Dissertation</option>
                                <option value="video">Video/YouTube</option>
                                <option value="podcast">Podcast</option>
                            </select>
                        </div>
                        
                        <!-- Source Information Fields -->
                        <div id="source-fields" class="space-y-4">
                            <!-- Dynamic fields will be populated here -->
                        </div>
                        
                        <!-- Action Buttons -->
                        <div class="grid grid-cols-2 gap-3">
                            <button onclick="generateCitation()" class="bg-indigo-500 hover:bg-indigo-600 text-white font-bold py-3 px-6 rounded-xl transition-all duration-300 transform hover:scale-105">
                                üìù Generate Citation
                            </button>
                            <button onclick="clearCitationForm()" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-3 px-6 rounded-xl transition-all duration-300 transform hover:scale-105">
                                üóëÔ∏è Clear Form
                            </button>
                            <button onclick="loadSampleData()" class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-3 px-6 rounded-xl transition-all duration-300 transform hover:scale-105">
                                üìã Load Sample
                            </button>
                            <button onclick="exportCitations()" class="bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-6 rounded-xl transition-all duration-300 transform hover:scale-105">
                                üì§ Export
                            </button>
                        </div>
                    </div>
                    
                    <!-- Results Section -->
                    <div class="space-y-6">
                        <!-- Generated Citation -->
                        <div id="citation-results" class="hidden">
                            <h4 class="text-lg font-bold text-gray-800 mb-3">üìù Generated Citation</h4>
                            <div class="bg-indigo-50 p-4 rounded-lg">
                                <div id="citation-display" class="text-sm text-gray-800 mb-3"></div>
                                <div class="flex space-x-2">
                                    <button onclick="copyCitation()" class="bg-indigo-500 hover:bg-indigo-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                        üìã Copy
                                    </button>
                                    <button onclick="downloadCitation()" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                        üíæ Download
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Citation History -->
                        <div>
                            <h4 class="text-lg font-bold text-gray-800 mb-3">üìö Citation History</h4>
                            <div id="citation-history" class="space-y-2 max-h-64 overflow-y-auto">
                                <div class="text-gray-500 text-center py-4">No citations generated yet</div>
                            </div>
                        </div>
                        
                        <!-- Format Information -->
                        <div id="format-details" class="hidden">
                            <h4 class="text-lg font-bold text-gray-800 mb-3">‚ÑπÔ∏è Format Information</h4>
                            <div class="bg-gray-50 p-4 rounded-lg">
                                <div id="format-details-content" class="text-sm text-gray-600"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Grade Calculator Modal -->
    <div id="grade-calculator-modal" class="modal fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="modal-content bg-white rounded-2xl shadow-2xl max-w-7xl w-full mx-4 my-8 max-h-[90vh] overflow-y-auto">
            <div class="bg-gradient-to-r from-purple-500 to-pink-600 p-6 text-white rounded-t-2xl">
                <div class="flex justify-between items-center">
                    <div>
                        <h3 class="text-3xl font-bold mb-2">Grade Calculator</h3>
                        <p class="text-purple-100">Advanced grade calculation, GPA tracking, and academic performance analysis</p>
                    </div>
                    <button onclick="closeModal('grade-calculator-modal')" class="text-white hover:text-gray-200 text-3xl font-bold">&times;</button>
                </div>
            </div>
            
            <div class="p-6">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Input Section -->
                    <div class="space-y-6">
                        <!-- Course Input -->
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Add Course</label>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Course Name</label>
                                    <input type="text" id="course-name" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500" placeholder="e.g., Mathematics 101">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Course Code</label>
                                    <input type="text" id="course-code" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500" placeholder="e.g., MATH101">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Credits</label>
                                    <input type="number" id="course-credits" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500" placeholder="3" min="1" max="6">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Grade</label>
                                    <input type="text" id="course-grade" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500" placeholder="A, 85, 3.5">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Semester</label>
                                    <input type="text" id="course-semester" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500" placeholder="Fall 2024">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Grade Scale</label>
                                    <select id="grade-scale" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500">
                                        <option value="4.0">4.0 Scale</option>
                                        <option value="100">100 Point Scale</option>
                                        <option value="percentage">Percentage Scale</option>
                                    </select>
                                </div>
                            </div>
                            <button onclick="addCourse()" class="w-full mt-4 bg-purple-500 hover:bg-purple-600 text-white font-bold py-3 px-6 rounded-xl transition-all duration-300 transform hover:scale-105">
                                ‚ûï Add Course
                            </button>
                        </div>
                        
                        <!-- Weighted Grade Calculator -->
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Weighted Grade Calculator</label>
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Current Grade (%)</label>
                                    <input type="number" id="current-grade" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500" placeholder="85" min="0" max="100">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Target Grade (%)</label>
                                    <input type="number" id="target-grade" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500" placeholder="90" min="0" max="100">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Remaining Weight (%)</label>
                                    <input type="number" id="remaining-weight" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500" placeholder="30" min="0" max="100">
                                </div>
                                <button onclick="calculateGradeNeeded()" class="w-full bg-pink-500 hover:bg-pink-600 text-white font-bold py-3 px-6 rounded-xl transition-all duration-300 transform hover:scale-105">
                                    üéØ Calculate Grade Needed
                                </button>
                            </div>
                        </div>
                        
                        <!-- Quick Actions -->
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">Quick Actions</label>
                            <div class="grid grid-cols-2 gap-2">
                                <button onclick="calculateGPA()" class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    üìä Calculate GPA
                                </button>
                                <button onclick="clearCourses()" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    üóëÔ∏è Clear All
                                </button>
                                <button onclick="exportData()" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    üì§ Export Data
                                </button>
                                <button onclick="loadSampleData()" class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    üìã Load Sample
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Results Section -->
                    <div class="space-y-6">
                        <!-- GPA Results -->
                        <div id="gpa-results" class="hidden">
                            <h4 class="text-lg font-bold text-gray-800 mb-3">üìä GPA Results</h4>
                            <div class="bg-purple-50 p-4 rounded-lg">
                                <div id="gpa-display" class="text-3xl font-bold text-purple-600 mb-2"></div>
                                <div id="gpa-details" class="text-sm text-gray-600 mb-3"></div>
                                <div id="academic-standing" class="text-sm font-semibold text-gray-700"></div>
                            </div>
                        </div>
                        
                        <!-- Grade Needed Results -->
                        <div id="grade-needed-results" class="hidden">
                            <h4 class="text-lg font-bold text-gray-800 mb-3">üéØ Grade Needed</h4>
                            <div class="bg-pink-50 p-4 rounded-lg">
                                <div id="grade-needed-display" class="text-2xl font-bold text-pink-600 mb-2"></div>
                                <div id="grade-needed-details" class="text-sm text-gray-600"></div>
                            </div>
                        </div>
                        
                        <!-- Course List -->
                        <div>
                            <h4 class="text-lg font-bold text-gray-800 mb-3">üìö Courses</h4>
                            <div id="courses-list" class="space-y-2 max-h-48 overflow-y-auto">
                                <div class="text-gray-500 text-center py-4">No courses added yet</div>
                            </div>
                        </div>
                        
                        <!-- Statistics -->
                        <div id="statistics-results" class="hidden">
                            <h4 class="text-lg font-bold text-gray-800 mb-3">üìà Statistics</h4>
                            <div class="bg-gray-50 p-4 rounded-lg">
                                <div id="statistics-content" class="grid grid-cols-2 gap-4"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Math Problem Solver Modal -->
    <div id="math-solver-modal" class="modal fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="modal-content bg-white rounded-2xl shadow-2xl max-w-7xl w-full mx-4 my-8 max-h-[90vh] overflow-y-auto">
            <div class="bg-gradient-to-r from-green-500 to-teal-600 p-6 text-white rounded-t-2xl">
                <div class="flex justify-between items-center">
                    <div>
                        <h3 class="text-3xl font-bold mb-2">Math Problem Solver</h3>
                        <p class="text-green-100">Advanced mathematical problem solver with step-by-step solutions and graphing capabilities</p>
                    </div>
                    <button onclick="closeModal('math-solver-modal')" class="text-white hover:text-gray-200 text-3xl font-bold">&times;</button>
                </div>
            </div>
            
            <div class="p-6">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Input Section -->
                    <div class="space-y-6">
                        <!-- Problem Input -->
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Math Problem</label>
                            <textarea id="math-problem" rows="4" class="w-full p-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent resize-none" placeholder="Enter your math problem here (e.g., 2x + 5 = 13, x¬≤ + 3x - 4 = 0, 25% of 80)"></textarea>
                        </div>
                        
                        <!-- Math Category -->
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Math Category</label>
                            <select id="math-category" class="w-full p-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                <option value="algebra">Algebra</option>
                                <option value="calculus">Calculus</option>
                                <option value="geometry">Geometry</option>
                                <option value="statistics">Statistics</option>
                                <option value="trigonometry">Trigonometry</option>
                            </select>
                        </div>
                        
                        <!-- Quick Problem Templates -->
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Quick Templates</label>
                            <div class="grid grid-cols-2 gap-2">
                                <button onclick="loadTemplate('linear')" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    Linear Equation
                                </button>
                                <button onclick="loadTemplate('quadratic')" class="bg-purple-500 hover:bg-purple-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    Quadratic
                                </button>
                                <button onclick="loadTemplate('percentage')" class="bg-orange-500 hover:bg-orange-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    Percentage
                                </button>
                                <button onclick="loadTemplate('fraction')" class="bg-pink-500 hover:bg-pink-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    Fractions
                                </button>
                            </div>
                        </div>
                        
                        <!-- Action Buttons -->
                        <div class="grid grid-cols-2 gap-4">
                            <button onclick="solveMathProblem()" class="bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-6 rounded-xl transition-all duration-300 transform hover:scale-105">
                                üßÆ Solve Problem
                            </button>
                            <button onclick="clearMathProblem()" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-3 px-6 rounded-xl transition-all duration-300 transform hover:scale-105">
                                üóëÔ∏è Clear
                            </button>
                        </div>
                        
                        <!-- Quick Actions -->
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">Quick Actions</label>
                            <div class="flex space-x-2">
                                <button onclick="copyMathProblem()" class="bg-teal-500 hover:bg-teal-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    Copy Problem
                                </button>
                                <button onclick="loadSampleProblem()" class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    Load Sample
                                </button>
                                <button onclick="showMathHelp()" class="bg-indigo-500 hover:bg-indigo-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    Help
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Results Section -->
                    <div class="space-y-6">
                        <!-- Solution Results -->
                        <div id="solution-results" class="hidden">
                            <h4 class="text-lg font-bold text-gray-800 mb-3">üìä Solution</h4>
                            <div class="bg-green-50 p-4 rounded-lg">
                                <div id="solution-answer" class="text-2xl font-bold text-green-600 mb-3"></div>
                                <div id="solution-explanation" class="text-gray-700 mb-4"></div>
                                <div id="solution-steps" class="space-y-2 mb-4"></div>
                                <div class="flex space-x-2">
                                    <button onclick="copySolution()" class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                        Copy Solution
                                    </button>
                                    <button onclick="downloadSolution()" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                        Download
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Graph Results -->
                        <div id="graph-results" class="hidden">
                            <h4 class="text-lg font-bold text-gray-800 mb-3">üìà Graph</h4>
                            <div class="bg-blue-50 p-4 rounded-lg">
                                <div id="graph-container" class="bg-white p-4 rounded-lg border">
                                    <div class="text-center text-gray-500">Graph will be displayed here</div>
                                </div>
                                <div id="graph-equation" class="text-sm text-gray-600 mt-2"></div>
                            </div>
                        </div>
                        
                        <!-- Problem Analysis -->
                        <div id="analysis-results" class="hidden">
                            <h4 class="text-lg font-bold text-gray-800 mb-3">üîç Problem Analysis</h4>
                            <div class="bg-purple-50 p-4 rounded-lg">
                                <div id="problem-type" class="text-sm text-gray-600 mb-2"></div>
                                <div id="problem-difficulty" class="text-sm text-gray-600 mb-2"></div>
                                <div id="problem-category" class="text-sm text-gray-600"></div>
                            </div>
                        </div>
                        
                        <!-- Solution History -->
                        <div>
                            <h4 class="text-lg font-bold text-gray-800 mb-3">üìö Solution History</h4>
                            <div id="solution-history" class="space-y-2 max-h-48 overflow-y-auto">
                                <div class="text-gray-500 text-center py-4">No solutions yet</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Age Calculator Modal -->
    <div id="age-calculator-modal" class="modal fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="modal-content bg-white rounded-2xl shadow-2xl max-w-7xl w-full mx-4 my-8 max-h-[90vh] overflow-y-auto">
            <div class="bg-gradient-to-r from-pink-500 to-rose-600 p-6 text-white rounded-t-2xl">
                <div class="flex justify-between items-center">
                    <div>
                        <h3 class="text-3xl font-bold mb-2">Age Calculator</h3>
                        <p class="text-pink-100">Advanced age calculation, date analysis, and time-related calculations for students</p>
                    </div>
                    <button onclick="closeModal('age-calculator-modal')" class="text-white hover:text-gray-200 text-3xl font-bold">&times;</button>
                </div>
            </div>
            
            <div class="p-6">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Input Section -->
                    <div class="space-y-6">
                        <!-- Calculate Age -->
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Calculate Age</label>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Birth Date</label>
                                    <input type="date" id="birth-date" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Current Date (Optional)</label>
                                    <input type="date" id="current-date" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Calculation Method</label>
                                    <select id="calculation-method" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500">
                                        <option value="precise">Precise Age</option>
                                        <option value="simple">Simple Age</option>
                                        <option value="academic">Academic Age</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Date Format</label>
                                    <select id="date-format" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500">
                                        <option value="yyyy-mm-dd">YYYY-MM-DD</option>
                                        <option value="mm/dd/yyyy">MM/DD/YYYY</option>
                                        <option value="dd/mm/yyyy">DD/MM/YYYY</option>
                                        <option value="dd-mm-yyyy">DD-MM-YYYY</option>
                                        <option value="month-day-year">Month Day, Year</option>
                                    </select>
                                </div>
                            </div>
                            <button onclick="calculateAge()" class="w-full mt-4 bg-pink-500 hover:bg-pink-600 text-white font-bold py-3 px-6 rounded-xl transition-all duration-300 transform hover:scale-105">
                                üéÇ Calculate Age
                            </button>
                        </div>
                        
                        <!-- Age Difference -->
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Calculate Age Difference</label>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Person 1 Birth Date</label>
                                    <input type="date" id="person1-birth" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Person 2 Birth Date</label>
                                    <input type="date" id="person2-birth" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500">
                                </div>
                            </div>
                            <button onclick="calculateAgeDifference()" class="w-full mt-4 bg-purple-500 hover:bg-purple-600 text-white font-bold py-3 px-6 rounded-xl transition-all duration-300 transform hover:scale-105">
                                üë• Calculate Age Difference
                            </button>
                        </div>
                        
                        <!-- Date Analysis -->
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Date Analysis</label>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Birth Date</label>
                                    <input type="date" id="analysis-date" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Analysis Type</label>
                                    <select id="analysis-type" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500">
                                        <option value="zodiac">Zodiac Sign</option>
                                        <option value="chinese">Chinese Zodiac</option>
                                        <option value="life-stage">Life Stage</option>
                                        <option value="milestones">Age Milestones</option>
                                        <option value="next-birthday">Next Birthday</option>
                                    </select>
                                </div>
                            </div>
                            <button onclick="analyzeDate()" class="w-full mt-4 bg-indigo-500 hover:bg-indigo-600 text-white font-bold py-3 px-6 rounded-xl transition-all duration-300 transform hover:scale-105">
                                üîç Analyze Date
                            </button>
                        </div>
                        
                        <!-- Quick Actions -->
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">Quick Actions</label>
                            <div class="grid grid-cols-2 gap-2">
                                <button onclick="getCurrentAge()" class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    üïê Current Age
                                </button>
                                <button onclick="getAgeStatistics()" class="bg-orange-500 hover:bg-orange-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    üìä Age Stats
                                </button>
                                <button onclick="clearAgeForm()" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    üóëÔ∏è Clear
                                </button>
                                <button onclick="copyAgeResult()" class="bg-teal-500 hover:bg-teal-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    üìã Copy
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Results Section -->
                    <div class="space-y-6">
                        <!-- Age Results -->
                        <div id="age-results" class="hidden">
                            <h4 class="text-lg font-bold text-gray-800 mb-3">üéÇ Age Calculation Results</h4>
                            <div class="bg-pink-50 p-4 rounded-lg">
                                <div id="age-content" class="text-sm text-gray-600"></div>
                            </div>
                        </div>
                        
                        <!-- Age Difference Results -->
                        <div id="age-difference-results" class="hidden">
                            <h4 class="text-lg font-bold text-gray-800 mb-3">üë• Age Difference Results</h4>
                            <div class="bg-purple-50 p-4 rounded-lg">
                                <div id="age-difference-content" class="text-sm text-gray-600"></div>
                            </div>
                        </div>
                        
                        <!-- Date Analysis Results -->
                        <div id="date-analysis-results" class="hidden">
                            <h4 class="text-lg font-bold text-gray-800 mb-3">üîç Date Analysis Results</h4>
                            <div class="bg-indigo-50 p-4 rounded-lg">
                                <div id="date-analysis-content" class="text-sm text-gray-600"></div>
                            </div>
                        </div>
                        
                        <!-- Current Age Results -->
                        <div id="current-age-results" class="hidden">
                            <h4 class="text-lg font-bold text-gray-800 mb-3">üïê Current Age</h4>
                            <div class="bg-green-50 p-4 rounded-lg">
                                <div id="current-age-content" class="text-sm text-gray-600"></div>
                            </div>
                        </div>
                        
                        <!-- Age Statistics Results -->
                        <div id="age-statistics-results" class="hidden">
                            <h4 class="text-lg font-bold text-gray-800 mb-3">üìä Age Statistics</h4>
                            <div class="bg-orange-50 p-4 rounded-lg">
                                <div id="age-statistics-content" class="text-sm text-gray-600"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- BMI Calculator Modal -->
    <div id="bmi-calculator-modal" class="modal fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="modal-content bg-white rounded-2xl shadow-2xl max-w-7xl w-full mx-4 my-8 max-h-[90vh] overflow-y-auto">
            <div class="bg-gradient-to-r from-emerald-500 to-teal-600 p-6 text-white rounded-t-2xl">
                <div class="flex justify-between items-center">
                    <div>
                        <h3 class="text-3xl font-bold mb-2">BMI Calculator</h3>
                        <p class="text-emerald-100">Comprehensive BMI calculation, health analysis, and personalized recommendations for students</p>
                    </div>
                    <button onclick="closeModal('bmi-calculator-modal')" class="text-white hover:text-gray-200 text-3xl font-bold">&times;</button>
                </div>
            </div>
            
            <div class="p-6">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Input Section -->
                    <div class="space-y-6">
                        <!-- BMI Calculation -->
                        <div class="bg-gray-50 p-6 rounded-xl">
                            <h4 class="text-lg font-bold text-gray-800 mb-4">üìä Calculate BMI</h4>
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Unit System</label>
                                    <select id="bmi-unit" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500">
                                        <option value="metric">Metric (kg, cm)</option>
                                        <option value="imperial">Imperial (lbs, inches)</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Weight</label>
                                    <input type="number" id="bmi-weight" step="0.1" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500" placeholder="Enter weight">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Height</label>
                                    <input type="number" id="bmi-height" step="0.1" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500" placeholder="Enter height">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Age (Optional)</label>
                                    <input type="number" id="bmi-age" min="1" max="120" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500" placeholder="Enter age">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Gender (Optional)</label>
                                    <select id="bmi-gender" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500">
                                        <option value="male">Male</option>
                                        <option value="female">Female</option>
                                    </select>
                                </div>
                                <button onclick="calculateBMI()" class="w-full bg-emerald-500 hover:bg-emerald-600 text-white font-bold py-3 px-6 rounded-xl transition-all duration-300">
                                    üè• Calculate BMI
                                </button>
                            </div>
                        </div>

                        <!-- Weight Goal Calculator -->
                        <div class="bg-gray-50 p-6 rounded-xl">
                            <h4 class="text-lg font-bold text-gray-800 mb-4">üéØ Weight Goal Calculator</h4>
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Current Weight</label>
                                    <input type="number" id="goal-current-weight" step="0.1" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500" placeholder="Current weight">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Height</label>
                                    <input type="number" id="goal-height" step="0.1" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500" placeholder="Height">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Target BMI</label>
                                    <input type="number" id="target-bmi" step="0.1" value="22" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500" placeholder="Target BMI">
                                </div>
                                <button onclick="calculateWeightGoal()" class="w-full bg-emerald-500 hover:bg-emerald-600 text-white font-bold py-3 px-6 rounded-xl transition-all duration-300">
                                    üéØ Calculate Goal
                                </button>
                            </div>
                        </div>

                        <!-- Quick Actions -->
                        <div class="bg-gray-50 p-6 rounded-xl">
                            <h4 class="text-lg font-bold text-gray-800 mb-4">‚ö° Quick Actions</h4>
                            <div class="grid grid-cols-2 gap-3">
                                <button onclick="getBMIStatistics()" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    üìä Statistics
                                </button>
                                <button onclick="clearBMIForm()" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    üóëÔ∏è Clear All
                                </button>
                                <button onclick="copyBMIResult()" class="bg-purple-500 hover:bg-purple-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    üìã Copy Result
                                </button>
                                <button onclick="exportBMIData()" class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    üíæ Export Data
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Results Section -->
                    <div class="space-y-6">
                        <!-- BMI Results -->
                        <div id="bmi-results" class="hidden">
                            <h4 class="text-lg font-bold text-gray-800 mb-3">üìä BMI Results</h4>
                            <div class="bg-emerald-50 p-4 rounded-lg">
                                <div id="bmi-content" class="text-sm text-gray-600"></div>
                            </div>
                        </div>

                        <!-- Health Analysis Results -->
                        <div id="health-analysis-results" class="hidden">
                            <h4 class="text-lg font-bold text-gray-800 mb-3">üè• Health Analysis</h4>
                            <div class="bg-blue-50 p-4 rounded-lg">
                                <div id="health-analysis-content" class="text-sm text-gray-600"></div>
                            </div>
                        </div>

                        <!-- Body Fat Results -->
                        <div id="body-fat-results" class="hidden">
                            <h4 class="text-lg font-bold text-gray-800 mb-3">üí™ Body Fat Analysis</h4>
                            <div class="bg-purple-50 p-4 rounded-lg">
                                <div id="body-fat-content" class="text-sm text-gray-600"></div>
                            </div>
                        </div>

                        <!-- Recommendations Results -->
                        <div id="recommendations-results" class="hidden">
                            <h4 class="text-lg font-bold text-gray-800 mb-3">üí° Recommendations</h4>
                            <div class="bg-yellow-50 p-4 rounded-lg">
                                <div id="recommendations-content" class="text-sm text-gray-600"></div>
                            </div>
                        </div>

                        <!-- Weight Goal Results -->
                        <div id="weight-goal-results" class="hidden">
                            <h4 class="text-lg font-bold text-gray-800 mb-3">üéØ Weight Goal Results</h4>
                            <div class="bg-orange-50 p-4 rounded-lg">
                                <div id="weight-goal-content" class="text-sm text-gray-600"></div>
                            </div>
                        </div>

                        <!-- BMI Statistics Results -->
                        <div id="bmi-statistics-results" class="hidden">
                            <h4 class="text-lg font-bold text-gray-800 mb-3">üìä BMI Statistics</h4>
                            <div class="bg-green-50 p-4 rounded-lg">
                                <div id="bmi-statistics-content" class="text-sm text-gray-600"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Timestamp Converter Modal -->
    <div id="timestamp-converter-modal" class="modal fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="modal-content bg-white rounded-2xl shadow-2xl max-w-7xl w-full mx-4 my-8 max-h-[90vh] overflow-y-auto">
            <div class="bg-gradient-to-r from-cyan-500 to-blue-600 p-6 text-white rounded-t-2xl">
                <div class="flex justify-between items-center">
                    <div>
                        <h3 class="text-3xl font-bold mb-2">Timestamp Converter</h3>
                        <p class="text-cyan-100">Advanced timestamp conversion, timezone handling, and date manipulation for developers</p>
                    </div>
                    <button onclick="closeModal('timestamp-converter-modal')" class="text-white hover:text-gray-200 text-3xl font-bold">&times;</button>
                </div>
            </div>
            
            <div class="p-6">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Input Section -->
                    <div class="space-y-6">
                        <!-- Convert Timestamp -->
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Convert Timestamp</label>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">From Format</label>
                                    <select id="from-format" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500">
                                        <option value="auto">Auto Detect</option>
                                        <option value="unix">Unix Timestamp</option>
                                        <option value="unix_ms">Unix Timestamp (ms)</option>
                                        <option value="iso8601">ISO 8601</option>
                                        <option value="rfc2822">RFC 2822</option>
                                        <option value="mysql">MySQL</option>
                                        <option value="human">Human Readable</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">To Format</label>
                                    <select id="to-format" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500">
                                        <option value="unix">Unix Timestamp</option>
                                        <option value="unix_ms">Unix Timestamp (ms)</option>
                                        <option value="iso8601">ISO 8601</option>
                                        <option value="rfc2822">RFC 2822</option>
                                        <option value="mysql">MySQL</option>
                                        <option value="human">Human Readable</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Timezone</label>
                                    <select id="timezone" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500">
                                        <option value="UTC">UTC</option>
                                        <option value="EST">EST (UTC-5)</option>
                                        <option value="PST">PST (UTC-8)</option>
                                        <option value="CET">CET (UTC+1)</option>
                                        <option value="JST">JST (UTC+9)</option>
                                        <option value="IST">IST (UTC+5:30)</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Input Timestamp</label>
                                    <input type="text" id="input-timestamp" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500" placeholder="e.g., 1640995200 or 2024-01-01T00:00:00Z">
                                </div>
                            </div>
                            <button onclick="convertTimestamp()" class="w-full mt-4 bg-cyan-500 hover:bg-cyan-600 text-white font-bold py-3 px-6 rounded-xl transition-all duration-300 transform hover:scale-105">
                                üîÑ Convert Timestamp
                            </button>
                        </div>
                        
                        <!-- Current Time -->
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Current Time</label>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Format</label>
                                    <select id="current-format" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500">
                                        <option value="unix">Unix Timestamp</option>
                                        <option value="iso8601">ISO 8601</option>
                                        <option value="human">Human Readable</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Timezone</label>
                                    <select id="current-timezone" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500">
                                        <option value="UTC">UTC</option>
                                        <option value="EST">EST (UTC-5)</option>
                                        <option value="PST">PST (UTC-8)</option>
                                        <option value="CET">CET (UTC+1)</option>
                                        <option value="JST">JST (UTC+9)</option>
                                        <option value="IST">IST (UTC+5:30)</option>
                                    </select>
                                </div>
                            </div>
                            <button onclick="getCurrentTime()" class="w-full mt-4 bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-6 rounded-xl transition-all duration-300 transform hover:scale-105">
                                üïê Get Current Time
                            </button>
                        </div>
                        
                        <!-- Time Difference -->
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Calculate Time Difference</label>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Timestamp 1</label>
                                    <input type="text" id="diff-timestamp1" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500" placeholder="e.g., 1640995200">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Timestamp 2</label>
                                    <input type="text" id="diff-timestamp2" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500" placeholder="e.g., 1641081600">
                                </div>
                            </div>
                            <button onclick="calculateTimeDifference()" class="w-full mt-4 bg-purple-500 hover:bg-purple-600 text-white font-bold py-3 px-6 rounded-xl transition-all duration-300 transform hover:scale-105">
                                ‚è±Ô∏è Calculate Difference
                            </button>
                        </div>
                        
                        <!-- Add/Subtract Time -->
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Add/Subtract Time</label>
                            <div class="grid grid-cols-3 gap-4">
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Timestamp</label>
                                    <input type="text" id="add-timestamp" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500" placeholder="e.g., 1640995200">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Amount</label>
                                    <input type="number" id="add-amount" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500" placeholder="e.g., 7">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Unit</label>
                                    <select id="add-unit" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500">
                                        <option value="days">Days</option>
                                        <option value="hours">Hours</option>
                                        <option value="minutes">Minutes</option>
                                        <option value="seconds">Seconds</option>
                                        <option value="weeks">Weeks</option>
                                        <option value="months">Months</option>
                                        <option value="years">Years</option>
                                    </select>
                                </div>
                            </div>
                            <button onclick="addTime()" class="w-full mt-4 bg-indigo-500 hover:bg-indigo-600 text-white font-bold py-3 px-6 rounded-xl transition-all duration-300 transform hover:scale-105">
                                ‚ûï Add Time
                            </button>
                        </div>
                        
                        <!-- Quick Actions -->
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">Quick Actions</label>
                            <div class="grid grid-cols-2 gap-2">
                                <button onclick="getTimestampInfo()" class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    ‚ÑπÔ∏è Get Info
                                </button>
                                <button onclick="validateTimestamp()" class="bg-orange-500 hover:bg-orange-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    ‚úÖ Validate
                                </button>
                                <button onclick="clearTimestampForm()" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    üóëÔ∏è Clear
                                </button>
                                <button onclick="copyTimestampResult()" class="bg-teal-500 hover:bg-teal-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    üìã Copy
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Results Section -->
                    <div class="space-y-6">
                        <!-- Conversion Results -->
                        <div id="timestamp-conversion-results" class="hidden">
                            <h4 class="text-lg font-bold text-gray-800 mb-3">üîÑ Conversion Results</h4>
                            <div class="bg-cyan-50 p-4 rounded-lg">
                                <div id="timestamp-conversion-content" class="text-sm text-gray-600"></div>
                            </div>
                        </div>
                        
                        <!-- Current Time Results -->
                        <div id="current-time-results" class="hidden">
                            <h4 class="text-lg font-bold text-gray-800 mb-3">üïê Current Time</h4>
                            <div class="bg-blue-50 p-4 rounded-lg">
                                <div id="current-time-content" class="text-sm text-gray-600"></div>
                            </div>
                        </div>
                        
                        <!-- Time Difference Results -->
                        <div id="time-difference-results" class="hidden">
                            <h4 class="text-lg font-bold text-gray-800 mb-3">‚è±Ô∏è Time Difference</h4>
                            <div class="bg-purple-50 p-4 rounded-lg">
                                <div id="time-difference-content" class="text-sm text-gray-600"></div>
                            </div>
                        </div>
                        
                        <!-- Add Time Results -->
                        <div id="add-time-results" class="hidden">
                            <h4 class="text-lg font-bold text-gray-800 mb-3">‚ûï Add Time Results</h4>
                            <div class="bg-indigo-50 p-4 rounded-lg">
                                <div id="add-time-content" class="text-sm text-gray-600"></div>
                            </div>
                        </div>
                        
                        <!-- Timestamp Info -->
                        <div id="timestamp-info-results" class="hidden">
                            <h4 class="text-lg font-bold text-gray-800 mb-3">‚ÑπÔ∏è Timestamp Information</h4>
                            <div class="bg-green-50 p-4 rounded-lg">
                                <div id="timestamp-info-content" class="text-sm text-gray-600"></div>
                            </div>
                        </div>
                        
                        <!-- Validation Results -->
                        <div id="timestamp-validation-results" class="hidden">
                            <h4 class="text-lg font-bold text-gray-800 mb-3">‚úÖ Validation Results</h4>
                            <div class="bg-orange-50 p-4 rounded-lg">
                                <div id="timestamp-validation-content" class="text-sm text-gray-600"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Study Timer & Pomodoro Modal -->
    <div id="study-timer-modal" class="modal fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="modal-content bg-white rounded-2xl shadow-2xl max-w-6xl w-full mx-4 my-8 max-h-[90vh] overflow-y-auto">
            <div class="bg-gradient-to-r from-orange-500 to-red-600 p-6 text-white rounded-t-2xl">
                <div class="flex justify-between items-center">
                    <div>
                        <h3 class="text-3xl font-bold mb-2">Study Timer & Pomodoro</h3>
                        <p class="text-orange-100">Advanced study timer with Pomodoro technique, focus sessions, and productivity analytics</p>
                    </div>
                    <button onclick="closeModal('study-timer-modal')" class="text-white hover:text-gray-200 text-3xl font-bold">&times;</button>
                </div>
            </div>
            
            <div class="p-6">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Timer Section -->
                    <div class="space-y-6">
                        <!-- Focus Mode Selection -->
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Focus Mode</label>
                            <select id="focus-mode" class="w-full p-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-orange-500 focus:border-transparent">
                                <option value="pomodoro">Pomodoro (25/5/15)</option>
                                <option value="deep">Deep Focus (45/10/20)</option>
                                <option value="sprint">Study Sprint (15/3/10)</option>
                                <option value="marathon">Study Marathon (60/15/30)</option>
                                <option value="custom">Custom Settings</option>
                            </select>
                        </div>
                        
                        <!-- Custom Settings (hidden by default) -->
                        <div id="custom-settings" class="hidden space-y-4">
                            <div class="grid grid-cols-3 gap-4">
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Work (min)</label>
                                    <input type="number" id="custom-work" value="25" min="5" max="120" class="w-full p-2 border border-gray-300 rounded-lg">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Short Break (min)</label>
                                    <input type="number" id="custom-short" value="5" min="1" max="30" class="w-full p-2 border border-gray-300 rounded-lg">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Long Break (min)</label>
                                    <input type="number" id="custom-long" value="15" min="5" max="60" class="w-full p-2 border border-gray-300 rounded-lg">
                                </div>
                            </div>
                        </div>
                        
                        <!-- Timer Display -->
                        <div class="text-center">
                            <div class="bg-gray-50 rounded-2xl p-8">
                                <div id="timer-display" class="text-6xl font-bold text-gray-800 mb-4">25:00</div>
                                <div id="timer-progress" class="w-full bg-gray-200 rounded-full h-4 mb-4">
                                    <div id="progress-bar" class="bg-orange-500 h-4 rounded-full transition-all duration-1000" style="width: 0%"></div>
                                </div>
                                <div id="timer-status" class="text-lg text-gray-600 mb-6">Ready to start</div>
                                
                                <!-- Timer Controls -->
                                <div class="flex justify-center space-x-4">
                                    <button id="start-btn" onclick="startStudyTimer()" class="bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-6 rounded-xl transition-all duration-300 transform hover:scale-105">
                                        Start
                                    </button>
                                    <button id="pause-btn" onclick="pauseStudyTimer()" class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-3 px-6 rounded-xl transition-all duration-300 transform hover:scale-105" disabled>
                                        Pause
                                    </button>
                                    <button id="stop-btn" onclick="stopStudyTimer()" class="bg-red-500 hover:bg-red-600 text-white font-bold py-3 px-6 rounded-xl transition-all duration-300 transform hover:scale-105" disabled>
                                        Stop
                                    </button>
                                    <button id="reset-btn" onclick="resetStudyTimer()" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-3 px-6 rounded-xl transition-all duration-300 transform hover:scale-105">
                                        Reset
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Session Type -->
                        <div>
                            <label class="block text-lg font-semibold text-gray-700 mb-3">Session Type</label>
                            <div class="flex space-x-4">
                                <button id="work-session" onclick="setSessionType('work')" class="flex-1 bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    Work Session
                                </button>
                                <button id="short-break" onclick="setSessionType('shortBreak')" class="flex-1 bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    Short Break
                                </button>
                                <button id="long-break" onclick="setSessionType('longBreak')" class="flex-1 bg-purple-500 hover:bg-purple-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    Long Break
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Analytics Section -->
                    <div class="space-y-6">
                        <!-- Today's Stats -->
                        <div>
                            <h4 class="text-lg font-bold text-gray-800 mb-4">Today's Progress</h4>
                            <div id="daily-stats" class="grid grid-cols-2 gap-4">
                                <div class="bg-blue-50 p-4 rounded-lg text-center">
                                    <div id="today-study-time" class="text-2xl font-bold text-blue-600">0</div>
                                    <div class="text-sm text-gray-600">Minutes Studied</div>
                                </div>
                                <div class="bg-green-50 p-4 rounded-lg text-center">
                                    <div id="today-sessions" class="text-2xl font-bold text-green-600">0</div>
                                    <div class="text-sm text-gray-600">Sessions Completed</div>
                                </div>
                                <div class="bg-purple-50 p-4 rounded-lg text-center">
                                    <div id="today-breaks" class="text-2xl font-bold text-purple-600">0</div>
                                    <div class="text-sm text-gray-600">Breaks Taken</div>
                                </div>
                                <div class="bg-orange-50 p-4 rounded-lg text-center">
                                    <div id="focus-score" class="text-2xl font-bold text-orange-600">0</div>
                                    <div class="text-sm text-gray-600">Focus Score</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Session History -->
                        <div>
                            <h4 class="text-lg font-bold text-gray-800 mb-4">Recent Sessions</h4>
                            <div id="session-history" class="space-y-2 max-h-48 overflow-y-auto">
                                <div class="text-gray-500 text-center py-4">No sessions yet</div>
                            </div>
                        </div>
                        
                        <!-- Quick Actions -->
                        <div>
                            <h4 class="text-lg font-bold text-gray-800 mb-4">Quick Actions</h4>
                            <div class="space-y-3">
                                <button onclick="startQuickSession(15)" class="w-full bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    15-Minute Quick Session
                                </button>
                                <button onclick="startQuickSession(30)" class="w-full bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    30-Minute Focus Session
                                </button>
                                <button onclick="startQuickSession(60)" class="w-full bg-purple-500 hover:bg-purple-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                                    60-Minute Deep Work
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- More modals will be added here -->

    <!-- Calculator JavaScript Files (Load in dependency order) -->
    <script src="src/js/OperatorTable.js?v=fixed&t=1726744800"></script>
    <script src="src/js/Tokenizer.js?v=fixed&t=1726744800"></script>
    <script src="src/js/Parser.js?v=fixed&t=1726744800"></script>
    <script src="src/js/Evaluator.js?v=fixed&t=1726744800"></script>
    <script src="src/js/FunctionRegistry.js?v=fixed&t=1726744800"></script>
    <script src="src/js/NumericTypes.js?v=fixed2&t=1726744900"></script>
    <script src="src/js/ScientificModes.js?v=fixed&t=1726744800"></script>
    <script src="src/js/ScientificFunctions.js?v=fixed&t=1726744800"></script>
    <script src="src/js/BasicCalculator.js?v=fixed&t=1726744800"></script>
    <script src="src/js/AdvancedCalculator.js?v=fixed&t=1726744800"></script>
    <script src="src/js/ScientificCalculator.js?v=fixed&t=1726744800"></script>
    <script src="src/js/CalculatorManagerFixed.js?v=fixed&t=1726745000"></script>
    
    <!-- Professional Tools JavaScript Files -->
    <script src="src/js/LoanCalculator.js?v=1&t=1726745000"></script>
    <script src="src/js/InvestmentCalculator.js?v=1&t=1726745000"></script>
    <script src="src/js/TaxCalculator.js?v=1&t=1726745000"></script>
    <script src="src/js/BusinessMetricsCalculator.js?v=1&t=1726745000"></script>
    <script src="src/js/CurrencyConverter.js?v=1&t=1726745000"></script>
    <script src="src/js/RetirementCalculator.js?v=1&t=1726745000"></script>
    <script src="src/js/MortgageCalculator.js?v=1&t=1726745000"></script>
    <script src="src/js/BudgetPlanner.js?v=1&t=1726745000"></script>
    <script src="src/js/SalaryCalculator.js?v=1&t=1726745000"></script>
    
    <!-- Developer Tools JavaScript Files -->
    <script src="src/js/JsonFormatter.js?v=1&t=1726745000"></script>
    <script src="src/js/XmlFormatter.js?v=1&t=1726745000"></script>
    <script src="src/js/Base64Encoder.js?v=1&t=1726745000"></script>
    <script src="src/js/HashGenerator.js?v=1&t=1726745000"></script>
    <script src="src/js/UrlEncoder.js?v=1&t=1726745000"></script>
    <script src="src/js/RegexTester.js?v=1&t=1726745000"></script>
    <script src="src/js/CssJsMinifier.js?v=1&t=1726745000"></script>
    <script src="src/js/ColorPaletteGenerator.js?v=1&t=1726745000"></script>
    <script src="src/js/LoremIpsumGenerator.js?v=1&t=1726745000"></script>
    <script src="src/js/StudyTimer.js?v=1&t=1726745000"></script>
    <script src="src/js/NoteTaker.js?v=1&t=1726745000"></script>
    <script src="src/js/MathSolver.js?v=1&t=1726745000"></script>
    <script src="src/js/GradeCalculator.js?v=1&t=1726745000"></script>
    <script src="src/js/CitationGenerator.js?v=1&t=1726745000"></script>
    <script src="src/js/StudyPlanner.js?v=1&t=1726745000"></script>
    <script src="src/js/FlashcardGenerator.js?v=1&t=1726745000"></script>
    <script src="src/js/ProgressTracker.js?v=1&t=1726745000"></script>
    <script src="src/js/TimestampConverter.js?v=1&t=1726745000"></script>
    <script src="src/js/AgeCalculator.js?v=1&t=1726745000"></script>
    <script src="src/js/BMICalculator.js?v=1&t=1726745000"></script>
    
    <!-- Diagnostic Check -->
    <script>
        console.log('=== BMI CALCULATOR DIAGNOSTIC ===');
        console.log('1. BMICalculator type:', typeof BMICalculator);
        console.log('2. BMICalculator defined:', typeof BMICalculator !== 'undefined');
        if (typeof BMICalculator !== 'undefined') {
            console.log('3. BMICalculator constructor:', BMICalculator.constructor.name);
            console.log('‚úÖ BMICalculator class is available!');
        } else {
            console.error('‚ùå BMICalculator class is NOT available!');
            console.error('Check if src/js/BMICalculator.js loaded correctly.');
        }
        console.log('=================================');
    </script>
    
    <!-- EmailJS Integration -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>

    <script>
        // Global Variables
        let calculatorManager = null;
        let currentExpression = '';
        let calculationHistory = [];

        // EmailJS Configuration
        (function() {
            emailjs.init("YOUR_PUBLIC_KEY"); // Replace with your EmailJS public key
        })();

        // ============================================
        // WEATHER WIDGET FUNCTIONALITY
        // ============================================
        
        // Weather widget state
        let weatherData = null;
        let userLocation = null;
        let locationName = null;
        let permissionAsked = false;
        
        // Initialize weather widget
        function initWeatherWidget() {
            updateTimeAndDate();
            getLocationAndWeather();
            
            // Update time every second
            setInterval(updateTimeAndDate, 1000);
            
            // Update weather every 10 minutes
            setInterval(getLocationAndWeather, 600000);
        }
        
        // Update time and date display
        function updateTimeAndDate() {
            const now = new Date();
            
            // Desktop elements
            const timeElement = document.getElementById('current-time');
            const dateElement = document.getElementById('current-date');
            
            // Mobile elements
            const mobileTimeElement = document.getElementById('mobile-current-time');
            const mobileDateElement = document.getElementById('mobile-current-date');
            
            // Format time (12-hour format with AM/PM)
            const timeOptions = { 
                hour: 'numeric', 
                minute: '2-digit',
                hour12: true 
            };
            const timeString = now.toLocaleTimeString('en-US', timeOptions);
            
            // Format date
            const dateOptions = { 
                weekday: 'short', 
                month: 'short', 
                day: 'numeric' 
            };
            const dateString = now.toLocaleDateString('en-US', dateOptions);
            
            // Update desktop elements
            if (timeElement && dateElement) {
                timeElement.textContent = timeString;
                dateElement.textContent = dateString;
            }
            
            // Update mobile elements
            if (mobileTimeElement && mobileDateElement) {
                mobileTimeElement.textContent = timeString;
                mobileDateElement.textContent = dateString;
            }
        }
        
        // Get user location and fetch weather
        async function getLocationAndWeather() {
            try {
                // Check if permission was already asked in this session
                const sessionPermission = sessionStorage.getItem('weatherPermissionAsked');
                if (sessionPermission === 'true') {
                    permissionAsked = true;
                }
                
                // Show loading state for desktop
                const weatherDesc = document.getElementById('weather-desc');
                if (weatherDesc) {
                    weatherDesc.textContent = 'Getting location...';
                    weatherDesc.classList.add('weather-loading');
                }
                
                // Show loading state for mobile
                const mobileWeatherDesc = document.getElementById('mobile-weather-desc');
                if (mobileWeatherDesc) {
                    mobileWeatherDesc.textContent = 'Getting location...';
                    mobileWeatherDesc.classList.add('weather-loading');
                }
                
                // Get user's location with smart permission handling
                const position = await getCurrentPosition();
                userLocation = {
                    lat: position.coords.latitude,
                    lon: position.coords.longitude
                };
                
                // Get location name using reverse geocoding
                await getLocationName(userLocation.lat, userLocation.lon);
                
                // Fetch weather data
                await fetchWeatherData(userLocation.lat, userLocation.lon);
                
            } catch (error) {
                console.error('Weather widget error:', error);
                showWeatherError();
            }
        }
        
        // Get current position with fallback
        function getCurrentPosition() {
            return new Promise((resolve, reject) => {
                if (!navigator.geolocation) {
                    reject(new Error('Geolocation not supported'));
                    return;
                }
                
                // Mark that we've asked for permission in this session
                if (!permissionAsked) {
                    sessionStorage.setItem('weatherPermissionAsked', 'true');
                    permissionAsked = true;
                }
                
                navigator.geolocation.getCurrentPosition(
                    resolve,
                    (error) => {
                        // Fallback to a default location (New York) if user denies location
                        console.warn('Location access denied, using default location');
                        resolve({
                            coords: {
                                latitude: 40.7128,
                                longitude: -74.0060
                            }
                        });
                    },
                    {
                        enableHighAccuracy: true,
                        timeout: 10000,
                        maximumAge: 300000 // 5 minutes
                    }
                );
            });
        }
        
        // Get location name using reverse geocoding
        async function getLocationName(lat, lon) {
            try {
                // Try browser timezone first (fastest, free)
                const timezone = Intl.DateTimeFormat().resolvedOptions().timeZone;
                const cityFromTimezone = timezone.split('/').pop().replace('_', ' ');
                
                // Update location display with timezone-based name
                updateLocationDisplay(cityFromTimezone);
                
                // Try reverse geocoding for more accurate location name
                const response = await fetch(`https://nominatim.openstreetmap.org/reverse?lat=${lat}&lon=${lon}&format=json&addressdetails=1`);
                
                if (response.ok) {
                    const data = await response.json();
                    if (data.address) {
                        const city = data.address.city || data.address.town || data.address.village;
                        const country = data.address.country;
                        const state = data.address.state;
                        
                        let locationString = '';
                        if (city && country) {
                            if (state && (country === 'United States' || country === 'Canada')) {
                                locationString = `${city}, ${state}`;
                            } else {
                                locationString = `${city}, ${country}`;
                            }
                        } else if (city) {
                            locationString = city;
                        } else {
                            locationString = cityFromTimezone;
                        }
                        
                        locationName = locationString;
                        updateLocationDisplay(locationString);
                    }
                }
            } catch (error) {
                console.warn('Reverse geocoding failed, using timezone-based location');
                // Fallback to timezone-based location name
                const timezone = Intl.DateTimeFormat().resolvedOptions().timeZone;
                const cityFromTimezone = timezone.split('/').pop().replace('_', ' ');
                updateLocationDisplay(cityFromTimezone);
            }
        }
        
        // Update location display in both desktop and mobile widgets
        function updateLocationDisplay(locationText) {
            // Desktop elements
            const locationNameElement = document.getElementById('location-name');
            const weatherLocationElement = document.getElementById('weather-location');
            
            if (locationNameElement) {
                locationNameElement.textContent = locationText;
                // Add slide-in animation
                if (weatherLocationElement) {
                    weatherLocationElement.classList.add('location-slide-in');
                    setTimeout(() => {
                        weatherLocationElement.classList.remove('location-slide-in');
                    }, 500);
                }
            }
            
            // Mobile elements
            const mobileLocationNameElement = document.getElementById('mobile-location-name');
            const mobileWeatherLocationElement = document.getElementById('mobile-weather-location');
            
            if (mobileLocationNameElement) {
                mobileLocationNameElement.textContent = locationText;
                // Add slide-in animation
                if (mobileWeatherLocationElement) {
                    mobileWeatherLocationElement.classList.add('location-slide-in');
                    setTimeout(() => {
                        mobileWeatherLocationElement.classList.remove('location-slide-in');
                    }, 500);
                }
            }
        }
        
        // Fetch weather data from OpenWeatherMap API
        async function fetchWeatherData(lat, lon) {
            try {
                // Using a free weather API (OpenWeatherMap)
                const API_KEY = 'demo'; // You can get a free API key from OpenWeatherMap
                const API_URL = `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&appid=${API_KEY}&units=metric`;
                
                // For demo purposes, we'll use a mock weather service
                // In production, replace with actual API call
                const response = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true&timezone=auto`);
                
                if (!response.ok) {
                    throw new Error('Weather API error');
                }
                
                const data = await response.json();
                updateWeatherDisplay(data);
                
            } catch (error) {
                console.error('Weather fetch error:', error);
                // Fallback to mock data for demo
                updateWeatherDisplay(getMockWeatherData());
            }
        }
        
        // Update weather display
        function updateWeatherDisplay(data) {
            // Desktop elements
            const weatherIcon = document.getElementById('weather-icon');
            const weatherTemp = document.getElementById('weather-temp');
            const weatherDesc = document.getElementById('weather-desc');
            
            // Mobile elements
            const mobileWeatherIcon = document.getElementById('mobile-weather-icon');
            const mobileWeatherTemp = document.getElementById('mobile-weather-temp');
            const mobileWeatherDesc = document.getElementById('mobile-weather-desc');
            
            // Get weather data
            const temp = data.current_weather ? data.current_weather.temperature : 22;
            const weatherCode = data.current_weather ? data.current_weather.weathercode : 0;
            const description = getWeatherDescription(weatherCode);
            const icon = getWeatherIcon(weatherCode);
            const tempString = `${Math.round(temp)}¬∞C`;
            
            // Update desktop elements
            if (weatherIcon && weatherTemp && weatherDesc) {
                weatherDesc.classList.remove('weather-loading');
                weatherTemp.textContent = tempString;
                weatherDesc.textContent = description;
                weatherIcon.textContent = icon;
            }
            
            // Update mobile elements
            if (mobileWeatherIcon && mobileWeatherTemp && mobileWeatherDesc) {
                mobileWeatherDesc.classList.remove('weather-loading');
                mobileWeatherTemp.textContent = tempString;
                mobileWeatherDesc.textContent = description;
                mobileWeatherIcon.textContent = icon;
            }
        }
        
        // Get weather description from weather code
        function getWeatherDescription(code) {
            const descriptions = {
                0: 'Clear sky',
                1: 'Mainly clear',
                2: 'Partly cloudy',
                3: 'Overcast',
                45: 'Fog',
                48: 'Depositing rime fog',
                51: 'Light drizzle',
                53: 'Moderate drizzle',
                55: 'Dense drizzle',
                61: 'Slight rain',
                63: 'Moderate rain',
                65: 'Heavy rain',
                71: 'Slight snow',
                73: 'Moderate snow',
                75: 'Heavy snow',
                80: 'Rain showers',
                81: 'Moderate rain showers',
                82: 'Violent rain showers',
                95: 'Thunderstorm',
                96: 'Thunderstorm with hail',
                99: 'Heavy thunderstorm with hail'
            };
            return descriptions[code] || 'Unknown';
        }
        
        // Get weather icon from weather code
        function getWeatherIcon(code) {
            const icons = {
                0: '‚òÄÔ∏è', // Clear sky
                1: 'üå§Ô∏è', // Mainly clear
                2: '‚õÖ', // Partly cloudy
                3: '‚òÅÔ∏è', // Overcast
                45: 'üå´Ô∏è', // Fog
                48: 'üå´Ô∏è', // Fog
                51: 'üå¶Ô∏è', // Light drizzle
                53: 'üå¶Ô∏è', // Moderate drizzle
                55: 'üåßÔ∏è', // Dense drizzle
                61: 'üå¶Ô∏è', // Slight rain
                63: 'üåßÔ∏è', // Moderate rain
                65: 'üåßÔ∏è', // Heavy rain
                71: 'üå®Ô∏è', // Slight snow
                73: 'üå®Ô∏è', // Moderate snow
                75: 'üå®Ô∏è', // Heavy snow
                80: 'üå¶Ô∏è', // Rain showers
                81: 'üåßÔ∏è', // Moderate rain showers
                82: 'üåßÔ∏è', // Violent rain showers
                95: '‚õàÔ∏è', // Thunderstorm
                96: '‚õàÔ∏è', // Thunderstorm with hail
                99: '‚õàÔ∏è' // Heavy thunderstorm with hail
            };
            return icons[code] || 'üå§Ô∏è';
        }
        
        // Show weather error state
        function showWeatherError() {
            // Desktop elements
            const weatherDesc = document.getElementById('weather-desc');
            const weatherTemp = document.getElementById('weather-temp');
            const weatherIcon = document.getElementById('weather-icon');
            const locationNameElement = document.getElementById('location-name');
            
            // Mobile elements
            const mobileWeatherDesc = document.getElementById('mobile-weather-desc');
            const mobileWeatherTemp = document.getElementById('mobile-weather-temp');
            const mobileWeatherIcon = document.getElementById('mobile-weather-icon');
            const mobileLocationNameElement = document.getElementById('mobile-location-name');
            
            // Update desktop elements
            if (weatherDesc) {
                weatherDesc.textContent = 'Location unavailable';
                weatherDesc.classList.remove('weather-loading');
            }
            if (weatherTemp) {
                weatherTemp.textContent = '--¬∞C';
            }
            if (weatherIcon) {
                weatherIcon.textContent = '‚ùì';
            }
            if (locationNameElement) {
                locationNameElement.textContent = 'Location unavailable';
            }
            
            // Update mobile elements
            if (mobileWeatherDesc) {
                mobileWeatherDesc.textContent = 'Location unavailable';
                mobileWeatherDesc.classList.remove('weather-loading');
            }
            if (mobileWeatherTemp) {
                mobileWeatherTemp.textContent = '--¬∞C';
            }
            if (mobileWeatherIcon) {
                mobileWeatherIcon.textContent = '‚ùì';
            }
            if (mobileLocationNameElement) {
                mobileLocationNameElement.textContent = 'Location unavailable';
            }
        }
        
        // Mock weather data for demo purposes
        function getMockWeatherData() {
            const weatherCodes = [0, 1, 2, 3, 45, 61, 63, 65, 71, 73, 80, 95];
            const randomCode = weatherCodes[Math.floor(Math.random() * weatherCodes.length)];
            const randomTemp = Math.floor(Math.random() * 30) + 5; // 5-35¬∞C
            
            return {
                current_weather: {
                    temperature: randomTemp,
                    weathercode: randomCode
                }
            };
        }
        
        // Initialize weather widget when page loads
        document.addEventListener('DOMContentLoaded', function() {
            initWeatherWidget();
        });

        // ============================================
        // CONGRATULATIONS POPUP FOR NEW TOOLS
        // ============================================

        // Complete list of all tools for random selection
        const allTools = [
            // Student Tools
            {
                icon: 'üßÆ',
                name: 'Scientific Calculator',
                description: 'Advanced calculator with scientific functions, variables, and expression evaluation',
                sectionId: 'student-tools'
            },
            {
                icon: '‚è∞',
                name: 'Study Timer & Pomodoro',
                description: 'Advanced study timer with Pomodoro technique, focus sessions, and productivity analytics',
                sectionId: 'student-tools'
            },
            {
                icon: 'üß†',
                name: 'Math Solver',
                description: 'Solve complex mathematical equations and problems step by step',
                sectionId: 'student-tools'
            },
            {
                icon: 'üìä',
                name: 'Grade Calculator',
                description: 'Calculate your GPA and track academic performance',
                sectionId: 'student-tools'
            },
            {
                icon: 'üìö',
                name: 'Citation Generator',
                description: 'Generate citations in APA, MLA, Chicago, and other formats',
                sectionId: 'student-tools'
            },
            {
                icon: 'üìÖ',
                name: 'Study Planner & Schedule',
                description: 'Create personalized study schedules and track your progress',
                sectionId: 'student-tools'
            },
            {
                icon: 'üé¥',
                name: 'Flashcard Generator',
                description: 'Create and study with digital flashcards for better retention',
                sectionId: 'student-tools'
            },
            {
                icon: 'üìà',
                name: 'Progress Tracker & Analytics',
                description: 'Track your learning progress with detailed analytics and insights',
                sectionId: 'student-tools'
            },
            {
                icon: 'üéÇ',
                name: 'Age Calculator',
                description: 'Calculate your exact age in years, months, days, and more',
                sectionId: 'student-tools'
            },
            {
                icon: '‚öñÔ∏è',
                name: 'BMI Calculator',
                description: 'Calculate your Body Mass Index and health metrics',
                sectionId: 'student-tools'
            },
            
            // Professional Tools
            {
                icon: 'üè¶',
                name: 'Professional Loan Calculator',
                description: 'Calculate loan payments, interest, and amortization schedules',
                sectionId: 'professional-tools'
            },
            {
                icon: 'üìà',
                name: 'Investment Calculator',
                description: 'Plan your investments with compound interest calculations',
                sectionId: 'professional-tools'
            },
            {
                icon: 'üßæ',
                name: 'Tax Calculator',
                description: 'Calculate income tax, deductions, and tax planning',
                sectionId: 'professional-tools'
            },
            {
                icon: 'üìä',
                name: 'Business Metrics Calculator',
                description: 'Calculate key business metrics and financial ratios',
                sectionId: 'professional-tools'
            },
            {
                icon: 'üí±',
                name: 'Currency Converter',
                description: 'Convert between different currencies with real-time rates',
                sectionId: 'professional-tools'
            },
            {
                icon: 'üè†',
                name: 'Mortgage Calculator',
                description: 'Calculate mortgage payments, interest, and loan terms',
                sectionId: 'professional-tools'
            },
            {
                icon: 'üí∞',
                name: 'Retirement Calculator',
                description: 'Plan your retirement savings and investment goals',
                sectionId: 'professional-tools'
            },
            {
                icon: 'üìä',
                name: 'Budget Planner',
                description: 'Create and manage your personal or business budget',
                sectionId: 'professional-tools'
            },
            {
                icon: 'üíº',
                name: 'Salary Calculator',
                description: 'Calculate salary, benefits, and compensation packages',
                sectionId: 'professional-tools'
            },
            
            // Developer Tools
            {
                icon: 'üìÑ',
                name: 'JSON Formatter & Validator',
                description: 'Format, validate, and beautify JSON data',
                sectionId: 'developer-tools'
            },
            {
                icon: 'üìÑ',
                name: 'XML Formatter & Validator',
                description: 'Format, validate, and beautify XML data',
                sectionId: 'developer-tools'
            },
            {
                icon: 'üîê',
                name: 'Base64 Encoder/Decoder',
                description: 'Encode and decode Base64 strings',
                sectionId: 'developer-tools'
            },
            {
                icon: 'üîë',
                name: 'Hash Generator',
                description: 'Generate MD5, SHA-1, SHA-256, and other hash values',
                sectionId: 'developer-tools'
            },
            {
                icon: 'üîó',
                name: 'URL Encoder/Decoder',
                description: 'Encode and decode URL strings and parameters',
                sectionId: 'developer-tools'
            },
            {
                icon: 'üîç',
                name: 'Regex Tester',
                description: 'Test and debug regular expressions with live preview',
                sectionId: 'developer-tools'
            },
            {
                icon: 'üé®',
                name: 'Color Palette Generator',
                description: 'Generate beautiful color palettes for your projects',
                sectionId: 'developer-tools'
            },
            {
                icon: '‚ö°',
                name: 'CSS/JS Minifier',
                description: 'Minify CSS and JavaScript code for better performance',
                sectionId: 'developer-tools'
            },
            {
                icon: 'üìù',
                name: 'Lorem Ipsum Generator',
                description: 'Generate placeholder text for your designs and prototypes',
                sectionId: 'developer-tools'
            },
            {
                icon: '‚è∞',
                name: 'Timestamp Converter',
                description: 'Convert between different timestamp formats and timezones',
                sectionId: 'developer-tools'
            },
            
            // PDF Tools
            {
                icon: 'üîì',
                name: 'PDF Password Remover',
                description: 'Remove password protection from your PDFs instantly',
                sectionId: 'pdf-tools'
            },
            {
                icon: 'üìÑ',
                name: 'PDF Merger',
                description: 'Combine multiple PDFs into one document',
                sectionId: 'pdf-tools'
            },
            {
                icon: '‚úÇÔ∏è',
                name: 'PDF Splitter',
                description: 'Split PDFs into separate pages or ranges',
                sectionId: 'pdf-tools'
            },
            {
                icon: 'üîí',
                name: 'PDF Encryptor',
                description: 'Add password protection to your PDFs',
                sectionId: 'pdf-tools'
            },
            {
                icon: 'üñºÔ∏è',
                name: 'PDF to Images',
                description: 'Convert PDF pages to JPG or PNG images',
                sectionId: 'pdf-tools'
            },
            
            // Image Tools
            {
                icon: 'üì∏',
                name: 'Image to PDF Converter',
                description: 'Convert multiple images to a single PDF document',
                sectionId: 'image-tools'
            },
            {
                icon: 'üìè',
                name: 'Image Compressor',
                description: 'Reduce image file size while maintaining quality',
                sectionId: 'image-tools'
            },
            {
                icon: 'üé®',
                name: 'Image Format Converter',
                description: 'Convert between JPG, PNG, WebP formats',
                sectionId: 'image-tools'
            },
            {
                icon: 'üìê',
                name: 'Image Resizer',
                description: 'Resize images to any dimensions',
                sectionId: 'image-tools'
            },
            
            // Utility Tools
            {
                icon: '‚úçÔ∏è',
                name: 'Digital Signature Generator',
                description: 'Create professional digital signatures',
                sectionId: 'utilities'
            },
            {
                icon: 'üìä',
                name: 'CSV to JSON Converter',
                description: 'Convert between CSV and JSON formats',
                sectionId: 'utilities'
            }
        ];

        // Store current featured tool globally
        let currentFeaturedTool = null;

        // Show congratulations popup on page load (once per session)
        function showCongratsPopup() {
            // Check if popup was already shown in this session
            if (sessionStorage.getItem('congratsPopupShown')) {
                return;
            }

            // Select a random tool from all available tools
            const randomTool = allTools[Math.floor(Math.random() * allTools.length)];
            
            // Store the current tool globally
            currentFeaturedTool = randomTool;

            // Populate the featured tool content
            const featuredToolContent = document.getElementById('featured-tool-content');
            featuredToolContent.innerHTML = `
                <div class="text-5xl mb-3">${randomTool.icon}</div>
                <h4 class="text-xl font-bold text-gray-800 mb-2">${randomTool.name}</h4>
                <p class="text-gray-600 text-sm">${randomTool.description}</p>
            `;

            // Show the popup
            const popup = document.getElementById('congrats-popup');
            const popupContent = document.getElementById('congrats-popup-content');
            
            popup.classList.remove('hidden');
            
            // Animate in
            setTimeout(() => {
                popupContent.style.transform = 'scale(1)';
                popupContent.style.opacity = '1';
            }, 50);

            // Auto-close countdown
            let countdown = 7;
            const countdownElement = document.getElementById('popup-countdown');
            
            const countdownInterval = setInterval(() => {
                countdown--;
                if (countdownElement) {
                    countdownElement.textContent = countdown;
                }
                
                if (countdown <= 0) {
                    clearInterval(countdownInterval);
                    closeCongratsPopup();
                }
            }, 1000);

            // Store interval ID for manual close
            popup.dataset.countdownInterval = countdownInterval;

            // Mark as shown in session
            sessionStorage.setItem('congratsPopupShown', 'true');
        }

        // Close congratulations popup
        function closeCongratsPopup() {
            const popup = document.getElementById('congrats-popup');
            const popupContent = document.getElementById('congrats-popup-content');
            
            // Clear countdown if exists
            if (popup.dataset.countdownInterval) {
                clearInterval(parseInt(popup.dataset.countdownInterval));
            }
            
            // Animate out
            popupContent.style.transform = 'scale(0.95)';
            popupContent.style.opacity = '0';
            
            setTimeout(() => {
                popup.classList.add('hidden');
            }, 300);
        }

        // Open the featured tool and close popup
        function openFeaturedTool() {
            if (!currentFeaturedTool) {
                closeCongratsPopup();
                return;
            }

            // Close the popup first
            closeCongratsPopup();

            // Scroll to the tool section and open the specific tool
            setTimeout(() => {
                // Scroll to the appropriate section
                const sectionId = currentFeaturedTool.sectionId;
                const section = document.getElementById(sectionId);
                if (section) {
                    section.scrollIntoView({ behavior: 'smooth' });
                }

                // Open the specific tool modal based on the tool name
                const toolName = currentFeaturedTool.name.toLowerCase();
                
                // Map tool names to their modal IDs
                const toolModalMap = {
                    'scientific calculator': 'scientific-calculator-modal',
                    'study timer & pomodoro': 'study-timer-modal',
                    'math solver': 'math-solver-modal',
                    'grade calculator': 'grade-calculator-modal',
                    'citation generator': 'citation-generator-modal',
                    'study planner & schedule': 'study-planner-modal',
                    'flashcard generator': 'flashcard-generator-modal',
                    'progress tracker & analytics': 'progress-tracker-modal',
                    'age calculator': 'age-calculator-modal',
                    'bmi calculator': 'bmi-calculator-modal',
                    'professional loan calculator': 'loan-calculator-modal',
                    'investment calculator': 'investment-calculator-modal',
                    'tax calculator': 'tax-calculator-modal',
                    'business metrics calculator': 'business-metrics-calculator-modal',
                    'currency converter': 'currency-converter-modal',
                    'mortgage calculator': 'mortgage-calculator-modal',
                    'retirement calculator': 'retirement-calculator-modal',
                    'budget planner': 'budget-planner-modal',
                    'salary calculator': 'salary-calculator-modal',
                    'json formatter & validator': 'json-formatter-modal',
                    'xml formatter & validator': 'xml-formatter-modal',
                    'base64 encoder/decoder': 'base64-encoder-modal',
                    'hash generator': 'hash-generator-modal',
                    'url encoder/decoder': 'url-encoder-modal',
                    'regex tester': 'regex-tester-modal',
                    'color palette generator': 'color-palette-generator-modal',
                    'css/js minifier': 'css-js-minifier-modal',
                    'lorem ipsum generator': 'lorem-ipsum-generator-modal',
                    'timestamp converter': 'timestamp-converter-modal',
                    'pdf password remover': 'pdf-password-remover-modal',
                    'pdf merger': 'pdf-merger-modal',
                    'pdf splitter': 'pdf-splitter-modal',
                    'pdf encryptor': 'pdf-encryptor-modal',
                    'pdf to images': 'pdf-to-images-modal',
                    'image to pdf converter': 'image-to-pdf-modal',
                    'image compressor': 'image-compressor-modal',
                    'image format converter': 'image-format-converter-modal',
                    'image resizer': 'image-resizer-modal',
                    'digital signature generator': 'digital-signature-generator-modal',
                    'csv to json converter': 'csv-to-json-converter-modal'
                };

                const modalId = toolModalMap[toolName];
                if (modalId && typeof openModal === 'function') {
                    openModal(modalId);
                }
            }, 350); // Wait for popup close animation
        }

        // Show popup on page load (after a short delay for better UX)
        window.addEventListener('load', function() {
            setTimeout(showCongratsPopup, 1000);
        });

        // ============================================
        // END OF CONGRATULATIONS POPUP
        // ============================================

        // Mobile Menu Toggle
        function toggleMobileMenu() {
            const mobileMenu = document.getElementById('mobile-menu');
            if (mobileMenu.classList.contains('hidden')) {
                mobileMenu.classList.remove('hidden');
            } else {
                mobileMenu.classList.add('hidden');
            }
        }

        // ============================================
        // PDF PASSWORD REMOVER FUNCTIONALITY
        // ============================================

        let pdfPasswordFile = null;
        let unprotectedPdfBytes = null;

        // Initialize PDF Password Remover
        function initPdfPasswordRemover() {
            const dropZone = document.getElementById('pdf-password-drop-zone');
            const fileInput = document.getElementById('pdf-password-file-input');

            // Click to browse
            dropZone.addEventListener('click', () => {
                fileInput.click();
            });

            // File input change
            fileInput.addEventListener('change', (e) => {
                const file = e.target.files[0];
                if (file && file.type === 'application/pdf') {
                    handlePdfPasswordFile(file);
                }
            });

            // Drag and drop
            dropZone.addEventListener('dragover', (e) => {
                e.preventDefault();
                dropZone.classList.add('border-red-500', 'bg-red-50');
            });

            dropZone.addEventListener('dragleave', (e) => {
                e.preventDefault();
                dropZone.classList.remove('border-red-500', 'bg-red-50');
            });

            dropZone.addEventListener('drop', (e) => {
                e.preventDefault();
                dropZone.classList.remove('border-red-500', 'bg-red-50');
                
                const file = e.dataTransfer.files[0];
                if (file && file.type === 'application/pdf') {
                    handlePdfPasswordFile(file);
                } else {
                    showPdfPasswordError('Please upload a valid PDF file.');
                }
            });

            // Enter key to process
            document.getElementById('pdf-password-input').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    removePdfPassword();
                }
            });
        }

        // Handle PDF file upload
        function handlePdfPasswordFile(file) {
            pdfPasswordFile = file;
            
            // Show file info
            document.getElementById('pdf-password-filename').textContent = file.name;
            document.getElementById('pdf-password-filesize').textContent = formatFileSize(file.size);
            document.getElementById('pdf-password-file-info').classList.remove('hidden');
            
            // Show password input and process button
            document.getElementById('pdf-password-input-section').classList.remove('hidden');
            document.getElementById('pdf-password-process-section').classList.remove('hidden');
            
            // Hide error if any
            document.getElementById('pdf-password-error').classList.add('hidden');
            document.getElementById('pdf-password-success').classList.add('hidden');
        }

        // Clear uploaded file
        function clearPdfPasswordFile() {
            pdfPasswordFile = null;
            unprotectedPdfBytes = null;
            
            // Reset file input
            document.getElementById('pdf-password-file-input').value = '';
            
            // Hide all sections
            document.getElementById('pdf-password-file-info').classList.add('hidden');
            document.getElementById('pdf-password-input-section').classList.add('hidden');
            document.getElementById('pdf-password-process-section').classList.add('hidden');
            document.getElementById('pdf-password-success').classList.add('hidden');
            document.getElementById('pdf-password-error').classList.add('hidden');
            
            // Clear password input
            document.getElementById('pdf-password-input').value = '';
        }

        // Toggle password visibility
        function togglePasswordVisibility() {
            const passwordInput = document.getElementById('pdf-password-input');
            const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
            passwordInput.setAttribute('type', type);
        }

        // Remove PDF password
        async function removePdfPassword() {
            if (!pdfPasswordFile) {
                showPdfPasswordError('Please upload a PDF file first.');
                return;
            }

            const password = document.getElementById('pdf-password-input').value;
            if (!password) {
                showPdfPasswordError('Please enter the PDF password.');
                return;
            }

            try {
                // Show progress
                document.getElementById('pdf-password-progress').classList.remove('hidden');
                document.getElementById('pdf-password-error').classList.add('hidden');
                document.getElementById('pdf-password-success').classList.add('hidden');
                document.getElementById('pdf-password-remove-btn').disabled = true;

                // Read PDF file
                const fileBytes = await pdfPasswordFile.arrayBuffer();
                const uint8Array = new Uint8Array(fileBytes);

                // Configure PDF.js worker
                pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';

                // Load PDF with PDF.js (handles decryption)
                const loadingTask = pdfjsLib.getDocument({
                    data: uint8Array,
                    password: password
                });

                const pdfDocument = await loadingTask.promise;
                const numPages = pdfDocument.numPages;

                // Create new PDF with pdf-lib
                const { PDFDocument, rgb } = PDFLib;
                const newPdfDoc = await PDFDocument.create();

                // Process each page
                for (let pageNum = 1; pageNum <= numPages; pageNum++) {
                    const page = await pdfDocument.getPage(pageNum);
                    const viewport = page.getViewport({ scale: 2.0 });

                    // Create canvas for rendering
                    const canvas = document.createElement('canvas');
                    const context = canvas.getContext('2d');
                    canvas.width = viewport.width;
                    canvas.height = viewport.height;

                    // Render page to canvas
                    await page.render({
                        canvasContext: context,
                        viewport: viewport
                    }).promise;

                    // Convert canvas to image
                    const imageData = canvas.toDataURL('image/jpeg', 0.95);
                    const imageBytes = await fetch(imageData).then(res => res.arrayBuffer());

                    // Embed image in new PDF
                    const jpgImage = await newPdfDoc.embedJpg(imageBytes);
                    const pdfPage = newPdfDoc.addPage([viewport.width, viewport.height]);
                    pdfPage.drawImage(jpgImage, {
                        x: 0,
                        y: 0,
                        width: viewport.width,
                        height: viewport.height,
                    });

                    // Update progress (optional visual feedback)
                    console.log(`Processed page ${pageNum}/${numPages}`);
                }

                // Save PDF without password
                unprotectedPdfBytes = await newPdfDoc.save();

                // Hide progress, show success
                document.getElementById('pdf-password-progress').classList.add('hidden');
                document.getElementById('pdf-password-success').classList.remove('hidden');
                document.getElementById('pdf-password-remove-btn').disabled = false;

            } catch (error) {
                console.error('PDF password removal error:', error);
                document.getElementById('pdf-password-progress').classList.add('hidden');
                document.getElementById('pdf-password-remove-btn').disabled = false;

                // Check for specific error types
                if (error.name === 'PasswordException' || 
                    (error.message && (error.message.includes('password') || 
                    error.message.includes('encrypted') || 
                    error.message.includes('decrypt')))) {
                    showPdfPasswordError('Incorrect password. Please verify and try again.');
                } else if (error.message && error.message.includes('Invalid PDF')) {
                    showPdfPasswordError('Invalid or corrupted PDF file. Please ensure the file is a valid PDF.');
                } else {
                    showPdfPasswordError('Failed to process PDF: ' + error.message);
                }
            }
        }

        // Download unprotected PDF
        function downloadUnprotectedPdf() {
            if (!unprotectedPdfBytes) {
                showPdfPasswordError('No unprotected PDF available. Please process a PDF first.');
                return;
            }

            try {
                const blob = new Blob([unprotectedPdfBytes], { type: 'application/pdf' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = pdfPasswordFile.name.replace('.pdf', '_unlocked.pdf');
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            } catch (error) {
                console.error('Download error:', error);
                showPdfPasswordError('Failed to download PDF: ' + error.message);
            }
        }

        // Show error message
        function showPdfPasswordError(message) {
            document.getElementById('pdf-password-error-message').textContent = message;
            document.getElementById('pdf-password-error').classList.remove('hidden');
        }

        // Format file size
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return Math.round(bytes / Math.pow(k, i) * 100) / 100 + ' ' + sizes[i];
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            initPdfPasswordRemover();
        });

        // ============================================
        // END OF PDF PASSWORD REMOVER
        // ============================================

        // ============================================
        // PDF MERGER FUNCTIONALITY
        // ============================================

        let pdfMergerFiles = [];
        let mergedPdfBytes = null;
        let draggedIndex = null;

        // Initialize PDF Merger
        function initPdfMerger() {
            const dropZone = document.getElementById('pdf-merger-drop-zone');
            const fileInput = document.getElementById('pdf-merger-file-input');

            // Click to browse
            dropZone.addEventListener('click', () => {
                fileInput.click();
            });

            // File input change
            fileInput.addEventListener('change', (e) => {
                handlePdfMergerFiles(Array.from(e.target.files));
            });

            // Drag and drop
            dropZone.addEventListener('dragover', (e) => {
                e.preventDefault();
                dropZone.classList.add('border-blue-500', 'bg-blue-50');
            });

            dropZone.addEventListener('dragleave', (e) => {
                e.preventDefault();
                dropZone.classList.remove('border-blue-500', 'bg-blue-50');
            });

            dropZone.addEventListener('drop', (e) => {
                e.preventDefault();
                dropZone.classList.remove('border-blue-500', 'bg-blue-50');
                
                const files = Array.from(e.dataTransfer.files).filter(f => f.type === 'application/pdf');
                if (files.length > 0) {
                    handlePdfMergerFiles(files);
                } else {
                    showPdfMergerError('Please upload valid PDF files.');
                }
            });
        }

        // Handle PDF files upload
        function handlePdfMergerFiles(files) {
            // Add new files to the array
            pdfMergerFiles.push(...files);
            
            // Update the display
            updatePdfMergerFileList();
            
            // Show file list and merge button
            document.getElementById('pdf-merger-files-section').classList.remove('hidden');
            document.getElementById('pdf-merger-merge-section').classList.remove('hidden');
            
            // Hide error and success
            document.getElementById('pdf-merger-error').classList.add('hidden');
            document.getElementById('pdf-merger-success').classList.add('hidden');
        }

        // Update file list display
        function updatePdfMergerFileList() {
            const fileList = document.getElementById('pdf-merger-file-list');
            fileList.innerHTML = '';

            pdfMergerFiles.forEach((file, index) => {
                const fileItem = document.createElement('div');
                fileItem.className = 'bg-blue-50 p-4 rounded-lg border border-blue-200 flex items-center justify-between cursor-move hover:bg-blue-100 transition-all';
                fileItem.draggable = true;
                fileItem.dataset.index = index;

                fileItem.innerHTML = `
                    <div class="flex items-center gap-3 flex-1">
                        <div class="cursor-grab active:cursor-grabbing">
                            <svg class="w-6 h-6 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8h16M4 16h16"></path>
                            </svg>
                        </div>
                        <span class="text-2xl">üìÑ</span>
                        <div class="flex-1">
                            <p class="font-semibold text-gray-800">${index + 1}. ${file.name}</p>
                            <p class="text-sm text-gray-600">${formatFileSize(file.size)}</p>
                        </div>
                    </div>
                    <button onclick="removePdfMergerFile(${index})" class="text-red-600 hover:text-red-700 font-semibold ml-3">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                `;

                // Drag events
                fileItem.addEventListener('dragstart', (e) => {
                    draggedIndex = index;
                    fileItem.style.opacity = '0.5';
                });

                fileItem.addEventListener('dragend', (e) => {
                    fileItem.style.opacity = '1';
                });

                fileItem.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    fileItem.style.borderColor = '#3b82f6';
                });

                fileItem.addEventListener('dragleave', (e) => {
                    fileItem.style.borderColor = '#93c5fd';
                });

                fileItem.addEventListener('drop', (e) => {
                    e.preventDefault();
                    fileItem.style.borderColor = '#93c5fd';
                    
                    if (draggedIndex !== null && draggedIndex !== index) {
                        // Reorder array
                        const draggedFile = pdfMergerFiles[draggedIndex];
                        pdfMergerFiles.splice(draggedIndex, 1);
                        pdfMergerFiles.splice(index, 0, draggedFile);
                        updatePdfMergerFileList();
                    }
                });

                fileList.appendChild(fileItem);
            });
        }

        // Remove a file from the list
        function removePdfMergerFile(index) {
            pdfMergerFiles.splice(index, 1);
            
            if (pdfMergerFiles.length === 0) {
                document.getElementById('pdf-merger-files-section').classList.add('hidden');
                document.getElementById('pdf-merger-merge-section').classList.add('hidden');
            } else {
                updatePdfMergerFileList();
            }
        }

        // Clear all files
        function clearAllPdfMergerFiles() {
            pdfMergerFiles = [];
            mergedPdfBytes = null;
            document.getElementById('pdf-merger-file-input').value = '';
            document.getElementById('pdf-merger-files-section').classList.add('hidden');
            document.getElementById('pdf-merger-merge-section').classList.add('hidden');
            document.getElementById('pdf-merger-success').classList.add('hidden');
            document.getElementById('pdf-merger-error').classList.add('hidden');
        }

        // Merge PDFs
        async function mergePdfs() {
            if (pdfMergerFiles.length < 2) {
                showPdfMergerError('Please upload at least 2 PDF files to merge.');
                return;
            }

            try {
                // Show progress
                document.getElementById('pdf-merger-progress').classList.remove('hidden');
                document.getElementById('pdf-merger-error').classList.add('hidden');
                document.getElementById('pdf-merger-success').classList.add('hidden');
                document.getElementById('pdf-merger-merge-btn').disabled = true;

                const progressBar = document.getElementById('pdf-merger-progress-bar');
                const progressText = document.getElementById('pdf-merger-progress-text');

                // Create new PDF document
                const { PDFDocument } = PDFLib;
                const mergedPdf = await PDFDocument.create();

                // Process each PDF
                for (let i = 0; i < pdfMergerFiles.length; i++) {
                    const file = pdfMergerFiles[i];
                    
                    // Update progress
                    const progress = ((i / pdfMergerFiles.length) * 100).toFixed(0);
                    progressBar.style.width = `${progress}%`;
                    progressText.textContent = `Processing ${i + 1} of ${pdfMergerFiles.length}: ${file.name}`;

                    // Read PDF file
                    const fileBytes = await file.arrayBuffer();
                    
                    // Load the PDF
                    const pdf = await PDFDocument.load(fileBytes);
                    
                    // Copy all pages from this PDF
                    const copiedPages = await mergedPdf.copyPages(pdf, pdf.getPageIndices());
                    copiedPages.forEach((page) => {
                        mergedPdf.addPage(page);
                    });
                }

                // Update progress to 100%
                progressBar.style.width = '100%';
                progressText.textContent = 'Finalizing merged PDF...';

                // Save the merged PDF
                mergedPdfBytes = await mergedPdf.save();

                // Hide progress, show success
                document.getElementById('pdf-merger-progress').classList.add('hidden');
                document.getElementById('pdf-merger-success').classList.remove('hidden');
                document.getElementById('pdf-merger-merge-btn').disabled = false;

            } catch (error) {
                console.error('PDF merger error:', error);
                document.getElementById('pdf-merger-progress').classList.add('hidden');
                document.getElementById('pdf-merger-merge-btn').disabled = false;
                
                if (error.message && error.message.includes('password')) {
                    showPdfMergerError('One or more PDFs are password-protected. Please remove passwords first using the PDF Password Remover tool.');
                } else if (error.message && error.message.includes('Invalid PDF')) {
                    showPdfMergerError('One or more files are invalid or corrupted PDF files.');
                } else {
                    showPdfMergerError('Failed to merge PDFs: ' + error.message);
                }
            }
        }

        // Download merged PDF
        function downloadMergedPdf() {
            if (!mergedPdfBytes) {
                showPdfMergerError('No merged PDF available. Please merge PDFs first.');
                return;
            }

            try {
                const blob = new Blob([mergedPdfBytes], { type: 'application/pdf' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'merged_document.pdf';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            } catch (error) {
                console.error('Download error:', error);
                showPdfMergerError('Failed to download merged PDF: ' + error.message);
            }
        }

        // Show error message
        function showPdfMergerError(message) {
            document.getElementById('pdf-merger-error-message').textContent = message;
            document.getElementById('pdf-merger-error').classList.remove('hidden');
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            initPdfMerger();
        });

        // ============================================
        // END OF PDF MERGER
        // ============================================

        // ============================================
        // PDF SPLITTER FUNCTIONALITY
        // ============================================

        let pdfSplitterFile = null;
        let pdfSplitterDocument = null;
        let splitPdfPages = [];

        // Initialize PDF Splitter
        function initPdfSplitter() {
            const dropZone = document.getElementById('pdf-splitter-drop-zone');
            const fileInput = document.getElementById('pdf-splitter-file-input');

            // Click to browse
            dropZone.addEventListener('click', () => {
                fileInput.click();
            });

            // File input change
            fileInput.addEventListener('change', async (e) => {
                const file = e.target.files[0];
                if (file && file.type === 'application/pdf') {
                    await handlePdfSplitterFile(file);
                }
            });

            // Drag and drop
            dropZone.addEventListener('dragover', (e) => {
                e.preventDefault();
                dropZone.classList.add('border-green-500', 'bg-green-50');
            });

            dropZone.addEventListener('dragleave', (e) => {
                e.preventDefault();
                dropZone.classList.remove('border-green-500', 'bg-green-50');
            });

            dropZone.addEventListener('drop', async (e) => {
                e.preventDefault();
                dropZone.classList.remove('border-green-500', 'bg-green-50');
                
                const file = e.dataTransfer.files[0];
                if (file && file.type === 'application/pdf') {
                    await handlePdfSplitterFile(file);
                } else {
                    showPdfSplitterError('Please upload a valid PDF file.');
                }
            });
        }

        // Handle PDF file upload
        async function handlePdfSplitterFile(file) {
            try {
                pdfSplitterFile = file;
                
                // Read PDF file
                const fileBytes = await file.arrayBuffer();
                
                // Load PDF
                const { PDFDocument } = PDFLib;
                pdfSplitterDocument = await PDFDocument.load(fileBytes);
                
                const pageCount = pdfSplitterDocument.getPageCount();
                
                // Show file info
                document.getElementById('pdf-splitter-filename').textContent = file.name;
                document.getElementById('pdf-splitter-fileinfo').textContent = `${formatFileSize(file.size)} ‚Ä¢ ${pageCount} pages`;
                document.getElementById('pdf-splitter-file-info').classList.remove('hidden');
                
                // Show options and split button
                document.getElementById('pdf-splitter-options-section').classList.remove('hidden');
                document.getElementById('pdf-splitter-split-section').classList.remove('hidden');
                
                // Set max values for range inputs
                document.getElementById('pdf-splitter-range-start').max = pageCount;
                document.getElementById('pdf-splitter-range-end').max = pageCount;
                
                // Hide error and success
                document.getElementById('pdf-splitter-error').classList.add('hidden');
                document.getElementById('pdf-splitter-success').classList.add('hidden');
                
            } catch (error) {
                console.error('PDF loading error:', error);
                showPdfSplitterError('Failed to load PDF: ' + error.message);
            }
        }

        // Clear uploaded file
        function clearPdfSplitterFile() {
            pdfSplitterFile = null;
            pdfSplitterDocument = null;
            splitPdfPages = [];
            
            // Reset file input
            document.getElementById('pdf-splitter-file-input').value = '';
            
            // Hide all sections
            document.getElementById('pdf-splitter-file-info').classList.add('hidden');
            document.getElementById('pdf-splitter-options-section').classList.add('hidden');
            document.getElementById('pdf-splitter-split-section').classList.add('hidden');
            document.getElementById('pdf-splitter-success').classList.add('hidden');
            document.getElementById('pdf-splitter-error').classList.add('hidden');
            
            // Reset inputs
            document.getElementById('pdf-splitter-specific-pages').value = '';
            document.getElementById('pdf-splitter-range-start').value = '';
            document.getElementById('pdf-splitter-range-end').value = '';
        }

        // Update split method (enable/disable inputs)
        function updateSplitMethod() {
            const method = document.querySelector('input[name="split-method"]:checked').value;
            
            // Disable all inputs first
            document.getElementById('pdf-splitter-specific-pages').disabled = true;
            document.getElementById('pdf-splitter-range-start').disabled = true;
            document.getElementById('pdf-splitter-range-end').disabled = true;
            
            // Enable relevant inputs
            if (method === 'specific') {
                document.getElementById('pdf-splitter-specific-pages').disabled = false;
            } else if (method === 'range') {
                document.getElementById('pdf-splitter-range-start').disabled = false;
                document.getElementById('pdf-splitter-range-end').disabled = false;
            }
        }

        // Split PDF
        async function splitPdf() {
            if (!pdfSplitterDocument) {
                showPdfSplitterError('Please upload a PDF file first.');
                return;
            }

            const method = document.querySelector('input[name="split-method"]:checked').value;
            const totalPages = pdfSplitterDocument.getPageCount();
            let pagesToExtract = [];

            try {
                // Determine which pages to extract
                if (method === 'all') {
                    // All pages
                    pagesToExtract = Array.from({ length: totalPages }, (_, i) => i);
                } else if (method === 'specific') {
                    // Specific pages
                    const input = document.getElementById('pdf-splitter-specific-pages').value;
                    if (!input.trim()) {
                        showPdfSplitterError('Please enter page numbers (e.g., 1, 3, 5)');
                        return;
                    }
                    
                    const pageNumbers = input.split(',').map(p => parseInt(p.trim())).filter(p => !isNaN(p) && p > 0 && p <= totalPages);
                    if (pageNumbers.length === 0) {
                        showPdfSplitterError('Please enter valid page numbers between 1 and ' + totalPages);
                        return;
                    }
                    pagesToExtract = pageNumbers.map(p => p - 1); // Convert to 0-indexed
                    
                } else if (method === 'range') {
                    // Page range
                    const start = parseInt(document.getElementById('pdf-splitter-range-start').value);
                    const end = parseInt(document.getElementById('pdf-splitter-range-end').value);
                    
                    if (isNaN(start) || isNaN(end)) {
                        showPdfSplitterError('Please enter valid start and end page numbers');
                        return;
                    }
                    
                    if (start < 1 || end > totalPages || start > end) {
                        showPdfSplitterError(`Please enter valid page range (1-${totalPages})`);
                        return;
                    }
                    
                    pagesToExtract = Array.from({ length: end - start + 1 }, (_, i) => start - 1 + i);
                }

                // Show progress
                document.getElementById('pdf-splitter-progress').classList.remove('hidden');
                document.getElementById('pdf-splitter-error').classList.add('hidden');
                document.getElementById('pdf-splitter-success').classList.add('hidden');
                document.getElementById('pdf-splitter-split-btn').disabled = true;

                const progressBar = document.getElementById('pdf-splitter-progress-bar');
                const progressText = document.getElementById('pdf-splitter-progress-text');

                splitPdfPages = [];
                const { PDFDocument } = PDFLib;

                // Create separate PDF for each page
                for (let i = 0; i < pagesToExtract.length; i++) {
                    const pageIndex = pagesToExtract[i];
                    
                    // Update progress
                    const progress = ((i / pagesToExtract.length) * 100).toFixed(0);
                    progressBar.style.width = `${progress}%`;
                    progressText.textContent = `Extracting page ${i + 1} of ${pagesToExtract.length}...`;

                    // Create new PDF with single page
                    const newPdf = await PDFDocument.create();
                    const [copiedPage] = await newPdf.copyPages(pdfSplitterDocument, [pageIndex]);
                    newPdf.addPage(copiedPage);

                    // Save as bytes
                    const pdfBytes = await newPdf.save();
                    splitPdfPages.push({
                        pageNumber: pageIndex + 1,
                        bytes: pdfBytes
                    });
                }

                // Update progress to 100%
                progressBar.style.width = '100%';
                progressText.textContent = 'Preparing download...';

                // Hide progress, show success
                document.getElementById('pdf-splitter-progress').classList.add('hidden');
                document.getElementById('pdf-splitter-success-text').textContent = `Successfully extracted ${splitPdfPages.length} page(s)`;
                document.getElementById('pdf-splitter-success').classList.remove('hidden');
                document.getElementById('pdf-splitter-split-btn').disabled = false;

            } catch (error) {
                console.error('PDF splitter error:', error);
                document.getElementById('pdf-splitter-progress').classList.add('hidden');
                document.getElementById('pdf-splitter-split-btn').disabled = false;
                
                if (error.message && error.message.includes('password')) {
                    showPdfSplitterError('This PDF is password-protected. Please remove the password first.');
                } else {
                    showPdfSplitterError('Failed to split PDF: ' + error.message);
                }
            }
        }

        // Download split PDFs as ZIP
        async function downloadSplitPdfs() {
            if (splitPdfPages.length === 0) {
                showPdfSplitterError('No pages to download. Please split the PDF first.');
                return;
            }

            try {
                const zip = new JSZip();
                const baseFilename = pdfSplitterFile.name.replace('.pdf', '');

                // Add each page to ZIP
                splitPdfPages.forEach((page) => {
                    const filename = `${baseFilename}_page_${page.pageNumber}.pdf`;
                    zip.file(filename, page.bytes);
                });

                // Generate ZIP
                const zipBlob = await zip.generateAsync({ 
                    type: 'blob',
                    compression: 'DEFLATE',
                    compressionOptions: { level: 6 }
                });

                // Download ZIP
                const url = URL.createObjectURL(zipBlob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `${baseFilename}_split.zip`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);

            } catch (error) {
                console.error('Download error:', error);
                showPdfSplitterError('Failed to download ZIP: ' + error.message);
            }
        }

        // Show error message
        function showPdfSplitterError(message) {
            document.getElementById('pdf-splitter-error-message').textContent = message;
            document.getElementById('pdf-splitter-error').classList.remove('hidden');
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            initPdfSplitter();
        });

        // ============================================
        // END OF PDF SPLITTER
        // ============================================

        // ============================================
        // PDF ENCRYPTOR FUNCTIONALITY (Using Pyodide + PyPDF2)
        // ============================================

        let pdfEncryptorFile = null;
        let encryptedPdfBytes = null;
        let pyodideInstance = null;
        let pyodideLoaded = false;

        // Initialize PDF Encryptor
        function initPdfEncryptor() {
            const dropZone = document.getElementById('pdf-encryptor-drop-zone');
            const fileInput = document.getElementById('pdf-encryptor-file-input');

            // Click to browse
            dropZone.addEventListener('click', () => {
                fileInput.click();
            });

            // File input change
            fileInput.addEventListener('change', (e) => {
                const file = e.target.files[0];
                if (file && file.type === 'application/pdf') {
                    handlePdfEncryptorFile(file);
                }
            });

            // Drag and drop
            dropZone.addEventListener('dragover', (e) => {
                e.preventDefault();
                dropZone.classList.add('border-purple-500', 'bg-purple-50');
            });

            dropZone.addEventListener('dragleave', (e) => {
                e.preventDefault();
                dropZone.classList.remove('border-purple-500', 'bg-purple-50');
            });

            dropZone.addEventListener('drop', (e) => {
                e.preventDefault();
                dropZone.classList.remove('border-purple-500', 'bg-purple-50');
                
                const file = e.dataTransfer.files[0];
                if (file && file.type === 'application/pdf') {
                    handlePdfEncryptorFile(file);
                } else {
                    showPdfEncryptorError('Please upload a valid PDF file.');
                }
            });
        }

        // Load Pyodide and PyPDF2
        async function initializePyodideEncryption() {
            if (pyodideLoaded) return pyodideInstance;

            try {
                console.log('Loading Pyodide...');
                pyodideInstance = await loadPyodide(); // Global function from Pyodide CDN
                
                console.log('Installing PyPDF2...');
                await pyodideInstance.loadPackage('micropip');
                await pyodideInstance.runPythonAsync(`
                    import micropip
                    await micropip.install('pypdf2')
                `);
                
                pyodideLoaded = true;
                console.log('Pyodide and PyPDF2 loaded successfully!');
                return pyodideInstance;
            } catch (error) {
                console.error('Pyodide loading error:', error);
                throw new Error('Failed to initialize PDF encryption engine.');
            }
        }

        // Handle PDF file upload
        function handlePdfEncryptorFile(file) {
            pdfEncryptorFile = file;
            
            // Show file info
            document.getElementById('pdf-encryptor-filename').textContent = file.name;
            document.getElementById('pdf-encryptor-filesize').textContent = formatFileSize(file.size);
            document.getElementById('pdf-encryptor-file-info').classList.remove('hidden');
            
            // Show password section and encrypt button
            document.getElementById('pdf-encryptor-password-section').classList.remove('hidden');
            document.getElementById('pdf-encryptor-encrypt-section').classList.remove('hidden');
            
            // Hide error and success
            document.getElementById('pdf-encryptor-error').classList.add('hidden');
            document.getElementById('pdf-encryptor-success').classList.add('hidden');
        }

        // Clear uploaded file
        function clearPdfEncryptorFile() {
            pdfEncryptorFile = null;
            encryptedPdfBytes = null;
            
            // Reset file input
            document.getElementById('pdf-encryptor-file-input').value = '';
            
            // Hide all sections
            document.getElementById('pdf-encryptor-file-info').classList.add('hidden');
            document.getElementById('pdf-encryptor-password-section').classList.add('hidden');
            document.getElementById('pdf-encryptor-encrypt-section').classList.add('hidden');
            document.getElementById('pdf-encryptor-success').classList.add('hidden');
            document.getElementById('pdf-encryptor-error').classList.add('hidden');
            document.getElementById('pdf-encryptor-strength-section').classList.add('hidden');
            
            // Clear password inputs
            document.getElementById('pdf-encryptor-password').value = '';
            document.getElementById('pdf-encryptor-password-confirm').value = '';
        }

        // Toggle password visibility
        function toggleEncryptPasswordVisibility(inputId) {
            const passwordInput = document.getElementById(inputId);
            const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
            passwordInput.setAttribute('type', type);
        }

        // Check password strength
        function checkEncryptPasswordStrength() {
            const password = document.getElementById('pdf-encryptor-password').value;
            const strengthSection = document.getElementById('pdf-encryptor-strength-section');
            const strengthBar = document.getElementById('pdf-encryptor-strength-bar');
            const strengthText = document.getElementById('pdf-encryptor-strength-text');

            if (!password) {
                strengthSection.classList.add('hidden');
                return;
            }

            strengthSection.classList.remove('hidden');

            let strength = 0;
            let label = '';
            let color = '';

            // Check password criteria
            if (password.length >= 8) strength += 25;
            if (password.length >= 12) strength += 25;
            if (/[a-z]/.test(password) && /[A-Z]/.test(password)) strength += 25;
            if (/\d/.test(password)) strength += 15;
            if (/[^a-zA-Z0-9]/.test(password)) strength += 10;

            // Determine label and color
            if (strength < 40) {
                label = 'Weak';
                color = '#ef4444';
            } else if (strength < 60) {
                label = 'Fair';
                color = '#f59e0b';
            } else if (strength < 80) {
                label = 'Good';
                color = '#3b82f6';
            } else {
                label = 'Strong';
                color = '#10b981';
            }

            strengthBar.style.width = `${strength}%`;
            strengthBar.style.backgroundColor = color;
            strengthText.textContent = label;
            strengthText.style.color = color;

            // Also check match
            checkPasswordMatch();
        }

        // Check password match
        function checkPasswordMatch() {
            const password = document.getElementById('pdf-encryptor-password').value;
            const confirm = document.getElementById('pdf-encryptor-password-confirm').value;
            const matchText = document.getElementById('pdf-encryptor-password-match');

            if (!confirm) {
                matchText.classList.add('hidden');
                return;
            }

            matchText.classList.remove('hidden');

            if (password === confirm) {
                matchText.textContent = '‚úì Passwords match';
                matchText.className = 'text-sm mt-1 text-green-600';
            } else {
                matchText.textContent = '‚úó Passwords do not match';
                matchText.className = 'text-sm mt-1 text-red-600';
            }
        }

        // Encrypt PDF
        async function encryptPdf() {
            if (!pdfEncryptorFile) {
                showPdfEncryptorError('Please upload a PDF file first.');
                return;
            }

            const password = document.getElementById('pdf-encryptor-password').value;
            const confirmPassword = document.getElementById('pdf-encryptor-password-confirm').value;

            if (!password) {
                showPdfEncryptorError('Please enter a password.');
                return;
            }

            if (password !== confirmPassword) {
                showPdfEncryptorError('Passwords do not match. Please re-enter.');
                return;
            }

            if (password.length < 6) {
                showPdfEncryptorError('Password must be at least 6 characters long.');
                return;
            }

            try {
                // Show progress
                const progressDiv = document.getElementById('pdf-encryptor-progress');
                progressDiv.classList.remove('hidden');
                progressDiv.querySelector('.font-semibold').textContent = 'Initializing encryption engine...';
                document.getElementById('pdf-encryptor-error').classList.add('hidden');
                document.getElementById('pdf-encryptor-success').classList.add('hidden');
                document.getElementById('pdf-encryptor-encrypt-btn').disabled = true;

                // Load Pyodide (first time only)
                if (!pyodideLoaded) {
                    progressDiv.querySelector('.font-semibold').textContent = 'Loading encryption engine (this may take a moment on first use)...';
                    await initializePyodideEncryption();
                }

                progressDiv.querySelector('.font-semibold').textContent = 'Encrypting your PDF...';

                // Read PDF file
                const fileBytes = await pdfEncryptorFile.arrayBuffer();
                const uint8Array = new Uint8Array(fileBytes);

                // Store PDF in Pyodide's file system
                pyodideInstance.FS.writeFile('input.pdf', uint8Array);

                // Run Python encryption code
                await pyodideInstance.runPythonAsync(`
from PyPDF2 import PdfReader, PdfWriter
import js

# Read the input PDF
reader = PdfReader('input.pdf')
writer = PdfWriter()

# Copy all pages
for page in reader.pages:
    writer.add_page(page)

# Encrypt with password
writer.encrypt('${password.replace(/'/g, "\\'")}')

# Write to output
with open('output.pdf', 'wb') as output_file:
    writer.write(output_file)
                `);

                // Read encrypted PDF from Pyodide's file system
                const encryptedBytes = pyodideInstance.FS.readFile('output.pdf');
                encryptedPdfBytes = encryptedBytes.buffer;

                // Clean up files from Pyodide FS
                try {
                    pyodideInstance.FS.unlink('input.pdf');
                    pyodideInstance.FS.unlink('output.pdf');
                } catch (e) {
                    // Ignore cleanup errors
                }

                // Hide progress, show success
                progressDiv.classList.add('hidden');
                document.getElementById('pdf-encryptor-success').classList.remove('hidden');
                document.getElementById('pdf-encryptor-encrypt-btn').disabled = false;

            } catch (error) {
                console.error('PDF encryption error:', error);
                document.getElementById('pdf-encryptor-progress').classList.add('hidden');
                document.getElementById('pdf-encryptor-encrypt-btn').disabled = false;

                if (error.message.includes('Failed to initialize')) {
                    showPdfEncryptorError('Failed to load encryption engine. Please try again or refresh the page.');
                } else {
                    showPdfEncryptorError('Failed to encrypt PDF: ' + error.message);
                }
            }
        }

        // Download encrypted PDF
        function downloadEncryptedPdf() {
            if (!encryptedPdfBytes) {
                showPdfEncryptorError('No encrypted PDF available. Please encrypt a PDF first.');
                return;
            }

            try {
                const blob = new Blob([encryptedPdfBytes], { type: 'application/pdf' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = pdfEncryptorFile.name.replace('.pdf', '_protected.pdf');
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            } catch (error) {
                console.error('Download error:', error);
                showPdfEncryptorError('Failed to download encrypted PDF: ' + error.message);
            }
        }

        // Show error message
        function showPdfEncryptorError(message) {
            document.getElementById('pdf-encryptor-error-message').textContent = message;
            document.getElementById('pdf-encryptor-error').classList.remove('hidden');
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            initPdfEncryptor();
        });

        // ============================================
        // END OF PDF ENCRYPTOR
        // ============================================



        // Privacy Policy Toggle Function
        function togglePrivacyDetails() {
            const detailsSection = document.getElementById('privacy-details');
            const toggleBtn = document.getElementById('privacy-toggle-btn');
            
            if (detailsSection.style.display === 'none') {
                // Show full privacy policy
                detailsSection.style.display = 'block';
                toggleBtn.innerHTML = '‚Üë Show Less';
                toggleBtn.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            } else {
                // Hide full privacy policy
                detailsSection.style.display = 'none';
                toggleBtn.innerHTML = 'üìñ Read Full Privacy Policy';
            }
        }

        // Privacy Modal Functions
        function openPrivacyModal() {
            document.getElementById('privacy-modal').style.display = 'block';
            document.body.style.overflow = 'hidden';
        }

        function closePrivacyModal() {
            document.getElementById('privacy-modal').style.display = 'none';
            document.body.style.overflow = 'auto';
            // Reset to collapsed state
            const detailsSection = document.getElementById('privacy-details');
            const toggleBtn = document.getElementById('privacy-toggle-btn');
            if (detailsSection && toggleBtn) {
                detailsSection.style.display = 'none';
                toggleBtn.innerHTML = 'üìñ Read Full Privacy Policy';
            }
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const privacyModal = document.getElementById('privacy-modal');
            if (event.target == privacyModal) {
                closePrivacyModal();
            }
            const supportModal = document.getElementById('support-modal');
            if (event.target == supportModal) {
                closeSupportModal();
            }
        }

        // Support Modal Functions
        function openSupportModal() {
            document.getElementById('support-modal').style.display = 'block';
            document.body.style.overflow = 'hidden';
        }

        function closeSupportModal() {
            document.getElementById('support-modal').style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        // Share Website Function
        function shareWebsite() {
            if (navigator.share) {
                navigator.share({
                    title: 'FreeToolHub - Free Online Tools',
                    text: 'Check out FreeToolHub! Amazing free tools for everyone!',
                    url: 'https://freetoolhub.in'
                }).then(() => {
                    console.log('Thanks for sharing!');
                }).catch((error) => {
                    console.log('Share cancelled');
                });
            } else {
                // Fallback: copy link
                const url = 'https://freetoolhub.in';
                navigator.clipboard.writeText(url).then(() => {
                    alert('Link copied to clipboard! Share it with your friends! üéâ');
                }).catch(() => {
                    alert('Share this link: https://freetoolhub.in');
                });
            }
        }

        // Initialize Calculator on page load
        document.addEventListener('DOMContentLoaded', function() {
            // Add a delay to ensure all scripts are loaded
            setTimeout(function() {
                try {
                    console.log('üîß Initializing Calculator System...');
                    console.log('Available classes:', {
                        OperatorTable: typeof OperatorTable,
                        Tokenizer: typeof Tokenizer,
                        Parser: typeof Parser,
                        Evaluator: typeof Evaluator,
                        FunctionRegistry: typeof FunctionRegistry,
                        NumericTypes: typeof NumericTypes,
                        ScientificModes: typeof ScientificModes,
                        ScientificFunctions: typeof ScientificFunctions,
                        BasicCalculator: typeof BasicCalculator,
                        AdvancedCalculator: typeof AdvancedCalculator,
                        ScientificCalculator: typeof ScientificCalculator,
                        CalculatorManager: typeof CalculatorManager
                    });
                    
                    // Show any undefined classes
                    const undefinedClasses = [];
                    if (typeof OperatorTable === 'undefined') undefinedClasses.push('OperatorTable');
                    if (typeof Tokenizer === 'undefined') undefinedClasses.push('Tokenizer');
                    if (typeof Parser === 'undefined') undefinedClasses.push('Parser');
                    if (typeof Evaluator === 'undefined') undefinedClasses.push('Evaluator');
                    if (typeof FunctionRegistry === 'undefined') undefinedClasses.push('FunctionRegistry');
                    if (typeof BasicCalculator === 'undefined') undefinedClasses.push('BasicCalculator');
                    if (typeof AdvancedCalculator === 'undefined') undefinedClasses.push('AdvancedCalculator');
                    if (typeof CalculatorManagerFixed === 'undefined') undefinedClasses.push('CalculatorManagerFixed');
                    
                    if (undefinedClasses.length > 0) {
                        console.error('‚ùå Missing classes:', undefinedClasses);
                    }
                    
                    // Check if all calculator classes are available
                    if (typeof CalculatorManagerFixed !== 'undefined') {
                        calculatorManager = new CalculatorManagerFixed();
                        console.log('‚úÖ Calculator Manager initialized successfully');
                        
                        // Test basic functionality
                        const testResult = calculatorManager.calculate('2 + 3');
                        console.log('‚úÖ Calculator test: 2 + 3 =', testResult);
                        
                        
                    } else {
                        console.error('‚ùå CalculatorManagerFixed not found');
                        console.log('Window object keys containing "Calculator":', 
                            Object.keys(window).filter(key => key.includes('Calculator')));
                        
                    }
                } catch (error) {
                    console.error('‚ùå Calculator initialization failed:', error);
                    console.error('Error stack:', error.stack);
                    
                }
            }, 100);
        });

        // Contact Form Handler
        document.addEventListener('DOMContentLoaded', function() {
            const contactForm = document.getElementById('contact-form');
            const contactStatus = document.getElementById('contact-status');
            
            if (contactForm) {
                contactForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    // Get form data
                    const name = document.getElementById('contact-name').value;
                    const email = document.getElementById('contact-email').value;
                    const subject = document.getElementById('contact-subject').value;
                    const message = document.getElementById('contact-message').value;
                    
                    // Validate form
                    if (!name || !email || !message) {
                        showContactStatus('Please fill in all required fields.', 'error');
                        return;
                    }
                    
                    // Show loading state
                    showContactStatus('Sending message...', 'loading');
                    
                    // Prepare email template parameters
                    const templateParams = {
                        from_name: name,
                        from_email: email,
                        subject: getSubjectText(subject),
                        message: message,
                        to_email: 'freetoolhubcommunity@gmail.com'
                    };
                    
                    // Send email using EmailJS
                    emailjs.send('YOUR_SERVICE_ID', 'YOUR_TEMPLATE_ID', templateParams)
                        .then(function(response) {
                            console.log('SUCCESS!', response.status, response.text);
                            showContactStatus('‚úÖ Message sent successfully! We\'ll get back to you soon.', 'success');
                            contactForm.reset();
                        })
                        .catch(function(error) {
                            console.error('FAILED...', error);
                            showContactStatus('‚ùå Failed to send message. Please try again or email us directly at freetoolhubcommunity@gmail.com', 'error');
                        });
                });
            }
        });
        
        // Helper function to get subject text
        function getSubjectText(subject) {
            const subjects = {
                'suggestion': 'üí° Tool Suggestion',
                'bug': 'üêõ Bug Report', 
                'feedback': 'üí¨ General Feedback',
                'other': '‚ùì Other'
            };
            return subjects[subject] || 'Contact Form Message';
        }
        
        // Helper function to show contact status
        function showContactStatus(message, type) {
            const contactStatus = document.getElementById('contact-status');
            if (contactStatus) {
                contactStatus.innerHTML = `
                    <div class="p-4 rounded-lg ${
                        type === 'success' ? 'bg-green-100 text-green-800 border border-green-200' :
                        type === 'error' ? 'bg-red-100 text-red-800 border border-red-200' :
                        type === 'loading' ? 'bg-blue-100 text-blue-800 border border-blue-200' :
                        'bg-gray-100 text-gray-800 border border-gray-200'
                    }">
                        ${message}
                    </div>
                `;
                
                // Auto-hide success messages after 5 seconds
                if (type === 'success') {
                    setTimeout(() => {
                        contactStatus.innerHTML = '';
                    }, 5000);
                }
            }
        }

        // Modal Functions
        function openModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.style.display = 'block';
                document.body.style.overflow = 'hidden';
                
                // Initialize calculator display if opening calculator modal
                if (modalId === 'calculator-modal') {
                    updateDisplay();
                }
                // Initialize line numbers for formatter modals
                else if (modalId === 'xml-formatter-modal') {
                    setTimeout(() => {
                        initializeXmlLineNumbers();
                    }, 100);
                } else if (modalId === 'json-formatter-modal') {
                    setTimeout(() => {
                        updateJsonInputLineNumbers();
                        updateJsonOutputLineNumbers();
                    }, 100);
                } else if (modalId === 'base64-encoder-modal') {
                    setTimeout(() => {
                        initializeBase64LineNumbers();
                    }, 100);
                } else if (modalId === 'hash-generator-modal') {
                    setTimeout(() => {
                        initializeHashLineNumbers();
                    }, 100);
                } else if (modalId === 'url-encoder-modal') {
                    setTimeout(() => {
                        initializeUrlLineNumbers();
                    }, 100);
                } else if (modalId === 'regex-tester-modal') {
                    setTimeout(() => {
                        initializeRegexLineNumbers();
                    }, 100);
                } else if (modalId === 'css-js-minifier-modal') {
                    setTimeout(() => {
                        initializeMinifierLineNumbers();
                    }, 100);
                } else if (modalId === 'color-palette-modal') {
                    setTimeout(() => {
                        initializeColorPaletteGenerator();
                    }, 100);
                } else if (modalId === 'lorem-ipsum-modal') {
                    setTimeout(() => {
                        initializeLoremIpsumGenerator();
                    }, 100);
                } else if (modalId === 'study-timer-modal') {
                    setTimeout(() => {
                        initializeStudyTimer();
                    }, 100);
                } else if (modalId === 'note-taker-modal') {
                    setTimeout(() => {
                        initializeNoteTaker();
                    }, 100);
                } else if (modalId === 'math-solver-modal') {
                    setTimeout(() => {
                        initializeMathSolver();
                    }, 100);
                } else if (modalId === 'grade-calculator-modal') {
                    setTimeout(() => {
                        initializeGradeCalculator();
                    }, 100);
                } else if (modalId === 'citation-generator-modal') {
                    setTimeout(() => {
                        initializeCitationGenerator();
                    }, 100);
                } else if (modalId === 'study-planner-modal') {
                    setTimeout(() => {
                        initializeStudyPlanner();
                    }, 100);
                } else if (modalId === 'flashcard-generator-modal') {
                    setTimeout(() => {
                        initializeFlashcardGenerator();
                    }, 100);
                } else if (modalId === 'progress-tracker-modal') {
                    setTimeout(() => {
                        initializeProgressTracker();
                    }, 100);
                } else if (modalId === 'timestamp-converter-modal') {
                    setTimeout(() => {
                        initializeTimestampConverter();
                    }, 100);
                } else if (modalId === 'age-calculator-modal') {
                    setTimeout(() => {
                        initializeAgeCalculator();
                    }, 100);
                } else if (modalId === 'bmi-calculator-modal') {
                    setTimeout(() => {
                        if (!bmiCalculator) {
                            initializeBMICalculator();
                        }
                    }, 100);
                }
            }
        }

        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.style.display = 'none';
                document.body.style.overflow = 'auto';
            }
        }

        // Calculator Functions
        function calcInput(value) {
            if (value === 'pi') {
                currentExpression += 'œÄ';
            } else if (value === '*') {
                currentExpression += '√ó';
            } else if (value === '/') {
                currentExpression += '√∑';
            } else {
                currentExpression += value;
            }
            updateDisplay();
        }

        function calcFunction(func) {
            currentExpression += func + '(';
            updateDisplay();
        }

        function calcClear() {
            currentExpression = '';
            updateDisplay();
        }

        function calcDelete() {
            currentExpression = currentExpression.slice(0, -1);
            updateDisplay();
        }

        function calcCalculate() {
            if (!currentExpression.trim()) return;
            
            try {
                let result;
                
                // Convert display symbols to calculator format
                let expression = currentExpression
                    .replace(/√ó/g, '*')
                    .replace(/√∑/g, '/')
                    .replace(/œÄ/g, Math.PI)
                    .replace(/e/g, Math.E);
                
                if (calculatorManager) {
                    // Use the full calculator system if available
                    result = calculatorManager.calculate(expression);
                } else if (typeof BasicCalculator !== 'undefined') {
                    // Fallback to BasicCalculator
                    console.log('Using BasicCalculator fallback');
                    const basicCalc = new BasicCalculator();
                    result = basicCalc.calculate(expression);
                } else {
                    // Final fallback to eval (limited but functional)
                    console.log('Using eval fallback');
                    
                    // Basic function replacements for eval
                    expression = expression
                        .replace(/sin\(/g, 'Math.sin(')
                        .replace(/cos\(/g, 'Math.cos(')
                        .replace(/tan\(/g, 'Math.tan(')
                        .replace(/log\(/g, 'Math.log10(')
                        .replace(/ln\(/g, 'Math.log(')
                        .replace(/sqrt\(/g, 'Math.sqrt(')
                        .replace(/\^/g, '**');
                    
                    result = eval(expression);
                }
                
                // Extract the actual result value
                let resultValue;
                if (result && typeof result === 'object' && result.success !== undefined) {
                    // CalculatorManager result object
                    if (result.success) {
                        resultValue = result.result;
                    } else {
                        throw new Error(result.error || 'Calculation failed');
                    }
                } else {
                    // Direct result value
                    resultValue = result;
                }
                
                // Add to history
                addToHistory(currentExpression, resultValue);
                
                // Update display
                document.getElementById('calc-result').textContent = resultValue;
                currentExpression = resultValue.toString();
                updateDisplay();
                
            } catch (error) {
                console.error('Calculation error:', error);
                document.getElementById('calc-result').textContent = 'Error: ' + error.message;
            }
        }

        function updateDisplay() {
            const expressionEl = document.getElementById('calc-expression');
            const resultEl = document.getElementById('calc-result');
            
            if (expressionEl) {
                expressionEl.value = currentExpression;
            }
            
            if (!currentExpression && resultEl) {
                resultEl.textContent = '0';
            }
        }

        function addToHistory(expression, result) {
            const historyItem = {
                expression: expression,
                result: result,
                timestamp: new Date()
            };
            
            calculationHistory.unshift(historyItem);
            
            // Keep only last 50 calculations
            if (calculationHistory.length > 50) {
                calculationHistory = calculationHistory.slice(0, 50);
            }
            
            updateHistoryDisplay();
        }

        function updateHistoryDisplay() {
            const historyEl = document.getElementById('calc-history');
            if (!historyEl) return;
            
            if (calculationHistory.length === 0) {
                historyEl.innerHTML = '<div class="text-gray-500 text-center">No calculations yet</div>';
                return;
            }
            
            let historyHTML = '';
            calculationHistory.forEach((item, index) => {
                historyHTML += `
                    <div class="mb-3 p-3 bg-white rounded-lg shadow-sm border cursor-pointer hover:bg-gray-50" onclick="useHistoryItem(${index})">
                        <div class="font-mono text-sm text-gray-600">${item.expression}</div>
                        <div class="font-mono font-bold text-lg text-blue-600">= ${item.result}</div>
                        <div class="text-xs text-gray-400">${item.timestamp.toLocaleTimeString()}</div>
                    </div>
                `;
            });
            
            historyEl.innerHTML = historyHTML;
        }

        function useHistoryItem(index) {
            if (calculationHistory[index]) {
                currentExpression = calculationHistory[index].result.toString();
                updateDisplay();
            }
        }

        function clearHistory() {
            calculationHistory = [];
            updateHistoryDisplay();
        }

        function exportHistory() {
            if (calculationHistory.length === 0) {
                alert('No calculations to export');
                return;
            }
            
            let exportText = 'FreeToolHub Calculator History\n';
            exportText += '=================================\n\n';
            
            calculationHistory.forEach((item, index) => {
                exportText += `${index + 1}. ${item.expression} = ${item.result}\n`;
                exportText += `   Time: ${item.timestamp.toLocaleString()}\n\n`;
            });
            
            // Create and download file
            const blob = new Blob([exportText], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'calculator-history.txt';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function switchMode() {
            // Toggle between RAD, DEG, GRAD modes
            const modeBtn = document.getElementById('mode-btn');
            if (!modeBtn) return;
            
            const currentMode = modeBtn.textContent;
            let newMode;
            
            switch (currentMode) {
                case 'RAD': newMode = 'DEG'; break;
                case 'DEG': newMode = 'GRAD'; break;
                case 'GRAD': newMode = 'RAD'; break;
                default: newMode = 'RAD';
            }
            
            modeBtn.textContent = newMode;
            
            if (calculatorManager && calculatorManager.scientificCalculator) {
                calculatorManager.scientificCalculator.setAngleMode(newMode.toLowerCase());
            }
        }

        // Close modal when clicking outside
        window.addEventListener('click', function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.style.display = 'none';
                document.body.style.overflow = 'auto';
            }
        });

        // Filter Tools Function
        function filterTools(category, button) {
            console.log('Filtering tools by category:', category);
            
            // Update filter button styles
            const filterButtons = document.querySelectorAll('.filter-btn');
            filterButtons.forEach(btn => {
                btn.classList.remove('active', 'bg-gray-600', 'bg-gray-700');
                btn.classList.add('bg-gray-400', 'bg-gray-500');
            });
            
            if (button) {
                button.classList.remove('bg-gray-400', 'bg-gray-500');
                button.classList.add('active', 'bg-gray-600', 'bg-gray-700');
            }
            
            // Show/hide tool categories
            const categories = ['student-tools', 'professional-tools', 'developer-tools'];
            categories.forEach(cat => {
                const section = document.getElementById(cat);
                if (section) {
                    const parentSection = section.closest('.mb-16');
                    if (category === 'all') {
                        parentSection.style.display = 'block';
                    } else if (cat.includes(category)) {
                        parentSection.style.display = 'block';
                    } else {
                        parentSection.style.display = 'none';
                    }
                }
            });
            
            console.log(`‚úÖ Tools filtered by category: ${category}`);
        }

        // Filter Coming Soon Tools Function
        function filterComingSoon(category, button) {
            console.log('Filtering coming soon tools by category:', category);
            
            // Update filter button styles
            const filterButtons = document.querySelectorAll('.coming-soon-filter-btn');
            filterButtons.forEach(btn => {
                btn.classList.remove('active', 'bg-gray-600', 'bg-gray-700');
                btn.classList.add('bg-gray-400', 'bg-gray-500');
            });
            
            if (button) {
                button.classList.remove('bg-gray-400', 'bg-gray-500');
                button.classList.add('active', 'bg-gray-600', 'bg-gray-700');
            }
            
            // Show/hide coming soon categories
            const categories = ['coming-soon-student', 'coming-soon-professional', 'coming-soon-developer'];
            categories.forEach(cat => {
                const section = document.getElementById(cat);
                if (section) {
                    const parentSection = section.closest('.mb-16');
                    if (category === 'all') {
                        parentSection.style.display = 'block';
                    } else if (cat.includes(category)) {
                        parentSection.style.display = 'block';
                    } else {
                        parentSection.style.display = 'none';
                    }
                }
            });
            
            console.log(`‚úÖ Coming soon tools filtered by category: ${category}`);
        }

        // Header Animation
        function initializeHeaderAnimations() {
            const headerElements = document.querySelectorAll('.header-animation');
            
            headerElements.forEach(element => {
                element.addEventListener('mouseenter', function() {
                    this.style.animationPlayState = 'paused';
                    this.style.color = '#fbbf24';
                    this.style.textShadow = '0 0 20px #fbbf24';
                });
                
                element.addEventListener('mouseleave', function() {
                    this.style.animationPlayState = 'running';
                });
            });
            
            console.log('‚úÖ Header animations initialized');
        }

        // Initialize when DOM is ready
        document.addEventListener('DOMContentLoaded', function() {
            initializeHeaderAnimations();
            console.log('‚úÖ Fresh FreeToolHub initialized successfully');
        });

        console.log('‚úÖ Fresh FreeToolHub script loaded');

        // Loan Calculator Functions
        let loanCalculator = null;

        // Initialize Loan Calculator
        function initializeLoanCalculator() {
            try {
                if (typeof LoanCalculator !== 'undefined') {
                    loanCalculator = new LoanCalculator();
                    console.log('‚úÖ Loan Calculator initialized successfully');
                } else {
                    console.error('‚ùå LoanCalculator class not found');
                }
            } catch (error) {
                console.error('‚ùå Loan Calculator initialization failed:', error);
            }
        }

        // Update currency display
        function updateCurrencyDisplay() {
            const selectedCurrency = document.getElementById('loan-currency').value;
            if (loanCalculator) {
                loanCalculator.setCurrency(selectedCurrency);
                console.log('Currency updated to:', selectedCurrency);
            }
        }

        // Calculate basic loan
        function calculateLoan() {
            if (!loanCalculator) {
                alert('Loan Calculator not initialized. Please refresh the page.');
                return;
            }

            try {
                const principal = parseFloat(document.getElementById('loan-amount').value);
                const annualRate = parseFloat(document.getElementById('interest-rate').value);
                const years = parseInt(document.getElementById('loan-term').value);
                const frequency = parseInt(document.getElementById('payment-frequency').value);
                const selectedCurrency = document.getElementById('loan-currency').value;

                if (isNaN(principal) || isNaN(annualRate) || isNaN(years)) {
                    alert('Please enter valid numbers for all fields.');
                    return;
                }

                // Set the selected currency
                loanCalculator.setCurrency(selectedCurrency);

                const result = loanCalculator.calculateLoan(principal, annualRate, years, frequency);
                
                if (result.success) {
                    displayLoanResults(result);
                    displayAmortizationSchedule(result.amortizationSchedule);
                    loanCalculator.addToHistory({
                        type: 'loan',
                        principal: principal,
                        rate: annualRate,
                        years: years,
                        currency: selectedCurrency,
                        result: result
                    });
                } else {
                    alert('Error: ' + result.error);
                }
            } catch (error) {
                console.error('Loan calculation error:', error);
                alert('Error calculating loan: ' + error.message);
            }
        }

        // Calculate extra payment analysis
        function calculateExtraPayment() {
            if (!loanCalculator) {
                alert('Loan Calculator not initialized. Please refresh the page.');
                return;
            }

            try {
                const principal = parseFloat(document.getElementById('loan-amount').value);
                const annualRate = parseFloat(document.getElementById('interest-rate').value);
                const years = parseInt(document.getElementById('loan-term').value);
                const frequency = parseInt(document.getElementById('payment-frequency').value);
                const extraPayment = parseFloat(document.getElementById('extra-payment').value);
                const selectedCurrency = document.getElementById('loan-currency').value;

                if (isNaN(principal) || isNaN(annualRate) || isNaN(years) || isNaN(extraPayment)) {
                    alert('Please enter valid numbers for all fields.');
                    return;
                }

                // Set the selected currency
                loanCalculator.setCurrency(selectedCurrency);

                const result = loanCalculator.calculateExtraPayment(principal, annualRate, years, extraPayment, frequency);
                
                if (result.success) {
                    displayExtraPaymentResults(result);
                } else {
                    alert('Error: ' + result.error);
                }
            } catch (error) {
                console.error('Extra payment calculation error:', error);
                alert('Error calculating extra payments: ' + error.message);
            }
        }

        // Display loan results
        function displayLoanResults(result) {
            const resultsDiv = document.getElementById('loan-results');
            resultsDiv.innerHTML = `
                <div class="grid grid-cols-2 gap-4">
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="text-sm text-gray-600">Monthly Payment</div>
                        <div class="text-xl font-bold text-green-600">${loanCalculator.formatCurrency(result.monthlyPayment)}</div>
                    </div>
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="text-sm text-gray-600">Total Interest</div>
                        <div class="text-xl font-bold text-red-600">${loanCalculator.formatCurrency(result.totalInterest)}</div>
                    </div>
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="text-sm text-gray-600">Total Amount</div>
                        <div class="text-xl font-bold text-blue-600">${loanCalculator.formatCurrency(result.totalAmount)}</div>
                    </div>
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="text-sm text-gray-600">Total Payments</div>
                        <div class="text-xl font-bold text-purple-600">${result.totalPayments}</div>
                    </div>
                </div>
            `;
        }

        // Display extra payment results
        function displayExtraPaymentResults(result) {
            const resultsDiv = document.getElementById('extra-payment-results');
            resultsDiv.innerHTML = `
                <div class="space-y-3">
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="text-sm text-gray-600">New Monthly Payment</div>
                        <div class="text-lg font-bold text-blue-600">${loanCalculator.formatCurrency(result.newPayment)}</div>
                    </div>
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="text-sm text-gray-600">Time Saved</div>
                        <div class="text-lg font-bold text-green-600">${result.timeSaved} payments</div>
                    </div>
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="text-sm text-gray-600">Interest Saved</div>
                        <div class="text-lg font-bold text-green-600">${loanCalculator.formatCurrency(result.interestSaved)}</div>
                    </div>
                </div>
            `;
        }

        // Display amortization schedule
        function displayAmortizationSchedule(schedule) {
            const scheduleDiv = document.getElementById('amortization-schedule');
            
            if (schedule.length === 0) {
                scheduleDiv.innerHTML = '<div class="text-center text-gray-500">No schedule available</div>';
                return;
            }

            let scheduleHTML = '<div class="overflow-x-auto"><table class="w-full text-sm">';
            scheduleHTML += '<thead><tr class="bg-gray-100"><th class="p-2 text-left">Payment</th><th class="p-2 text-right">Payment</th><th class="p-2 text-right">Principal</th><th class="p-2 text-right">Interest</th><th class="p-2 text-right">Balance</th></tr></thead>';
            scheduleHTML += '<tbody>';
            
            // Show first 5 and last 5 payments
            const showPayments = schedule.slice(0, 5).concat(schedule.slice(-5));
            
            showPayments.forEach((payment, index) => {
                if (index === 5) {
                    scheduleHTML += '<tr><td colspan="5" class="p-2 text-center text-gray-500">...</td></tr>';
                }
                scheduleHTML += `
                    <tr class="border-b">
                        <td class="p-2">${payment.payment}</td>
                        <td class="p-2 text-right">${loanCalculator.formatCurrency(payment.paymentAmount)}</td>
                        <td class="p-2 text-right">${loanCalculator.formatCurrency(payment.principalPayment)}</td>
                        <td class="p-2 text-right">${loanCalculator.formatCurrency(payment.interestPayment)}</td>
                        <td class="p-2 text-right">${loanCalculator.formatCurrency(payment.remainingBalance)}</td>
                    </tr>
                `;
            });
            
            scheduleHTML += '</tbody></table></div>';
            scheduleDiv.innerHTML = scheduleHTML;
        }

        // Initialize Loan Calculator when page loads
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(function() {
                initializeLoanCalculator();
                initializeInvestmentCalculator();
                initializeTaxCalculator();
                initializeBusinessMetricsCalculator();
                initializeCurrencyConverter();
                initializeRetirementCalculator();
                initializeMortgageCalculator();
                initializeBudgetPlanner();
                initializeSalaryCalculator();
                initializeJsonFormatter();
                initializeXmlFormatter();
                initializeBase64Encoder();
                initializeHashGenerator();
                initializeUrlEncoder();
                initializeRegexTester();
                initializeCssJsMinifier();
            }, 200);
        });

        // Investment Calculator Functions
        let investmentCalculator = null;

        // Initialize Investment Calculator
        function initializeInvestmentCalculator() {
            try {
                if (typeof InvestmentCalculator !== 'undefined') {
                    investmentCalculator = new InvestmentCalculator();
                    console.log('‚úÖ Investment Calculator initialized successfully');
                } else {
                    console.error('‚ùå InvestmentCalculator class not found');
                }
            } catch (error) {
                console.error('‚ùå Investment Calculator initialization failed:', error);
            }
        }

        // Update investment currency display
        function updateInvestmentCurrencyDisplay() {
            const selectedCurrency = document.getElementById('investment-currency').value;
            if (investmentCalculator) {
                investmentCalculator.setCurrency(selectedCurrency);
                console.log('Investment currency updated to:', selectedCurrency);
            }
        }

        // Calculate basic investment
        function calculateInvestment() {
            if (!investmentCalculator) {
                alert('Investment Calculator not initialized. Please refresh the page.');
                return;
            }

            try {
                const principal = parseFloat(document.getElementById('initial-investment').value);
                const monthlyContribution = parseFloat(document.getElementById('monthly-contribution').value);
                const annualRate = parseFloat(document.getElementById('annual-return').value);
                const years = parseInt(document.getElementById('investment-years').value);
                const selectedCurrency = document.getElementById('investment-currency').value;

                if (isNaN(principal) || isNaN(monthlyContribution) || isNaN(annualRate) || isNaN(years)) {
                    alert('Please enter valid numbers for all fields.');
                    return;
                }

                // Set the selected currency
                investmentCalculator.setCurrency(selectedCurrency);

                const result = investmentCalculator.calculateInvestment(principal, monthlyContribution, annualRate, years);
                
                if (result.success) {
                    displayInvestmentResults(result);
                    displayGrowthProjection(principal, monthlyContribution, annualRate, years);
                    investmentCalculator.addToHistory({
                        type: 'investment',
                        principal: principal,
                        monthlyContribution: monthlyContribution,
                        annualRate: annualRate,
                        years: years,
                        currency: selectedCurrency,
                        result: result
                    });
                } else {
                    alert('Error: ' + result.error);
                }
            } catch (error) {
                console.error('Investment calculation error:', error);
                alert('Error calculating investment: ' + error.message);
            }
        }

        // Calculate retirement planning
        function calculateRetirement() {
            if (!investmentCalculator) {
                alert('Investment Calculator not initialized. Please refresh the page.');
                return;
            }

            try {
                const currentAge = parseInt(document.getElementById('current-age').value);
                const retirementAge = parseInt(document.getElementById('retirement-age').value);
                const currentSavings = parseFloat(document.getElementById('current-savings').value);
                const desiredIncome = parseFloat(document.getElementById('desired-income').value);
                const monthlyContribution = parseFloat(document.getElementById('monthly-contribution').value);
                const annualRate = parseFloat(document.getElementById('annual-return').value);
                const selectedCurrency = document.getElementById('investment-currency').value;

                if (isNaN(currentAge) || isNaN(retirementAge) || isNaN(currentSavings) || isNaN(desiredIncome)) {
                    alert('Please enter valid numbers for all fields.');
                    return;
                }

                // Set the selected currency
                investmentCalculator.setCurrency(selectedCurrency);

                const result = investmentCalculator.calculateRetirement(
                    currentAge, retirementAge, currentSavings, monthlyContribution, annualRate, desiredIncome
                );
                
                if (result.success) {
                    displayRetirementResults(result);
                } else {
                    alert('Error: ' + result.error);
                }
            } catch (error) {
                console.error('Retirement calculation error:', error);
                alert('Error calculating retirement: ' + error.message);
            }
        }

        // Display investment results
        function displayInvestmentResults(result) {
            const resultsDiv = document.getElementById('investment-results');
            resultsDiv.innerHTML = `
                <div class="space-y-3">
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="text-sm text-gray-600">Total Value</div>
                        <div class="text-xl font-bold text-blue-600">${investmentCalculator.formatCurrency(result.totalValue)}</div>
                    </div>
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="text-sm text-gray-600">Total Contributions</div>
                        <div class="text-lg font-bold text-gray-600">${investmentCalculator.formatCurrency(result.totalContributions)}</div>
                    </div>
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="text-sm text-gray-600">Total Growth</div>
                        <div class="text-lg font-bold text-green-600">${investmentCalculator.formatCurrency(result.totalInterest)}</div>
                    </div>
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="text-sm text-gray-600">ROI</div>
                        <div class="text-lg font-bold text-purple-600">${investmentCalculator.formatPercentage(result.roi)}</div>
                    </div>
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="text-sm text-gray-600">Annualized Return</div>
                        <div class="text-lg font-bold text-indigo-600">${investmentCalculator.formatPercentage(result.annualizedReturn)}</div>
                    </div>
                </div>
            `;
        }

        // Display retirement results
        function displayRetirementResults(result) {
            const resultsDiv = document.getElementById('retirement-results');
            const statusClass = result.isSufficient ? 'text-green-600' : 'text-red-600';
            const statusText = result.isSufficient ? '‚úÖ Sufficient' : '‚ùå Insufficient';
            
            resultsDiv.innerHTML = `
                <div class="space-y-3">
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="text-sm text-gray-600">Retirement Fund</div>
                        <div class="text-xl font-bold text-blue-600">${investmentCalculator.formatCurrency(result.totalRetirementFund)}</div>
                    </div>
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="text-sm text-gray-600">Required Fund</div>
                        <div class="text-lg font-bold text-gray-600">${investmentCalculator.formatCurrency(result.requiredFund)}</div>
                    </div>
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="text-sm text-gray-600">Status</div>
                        <div class="text-lg font-bold ${statusClass}">${statusText}</div>
                    </div>
                    ${!result.isSufficient ? `
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="text-sm text-gray-600">Shortfall</div>
                            <div class="text-lg font-bold text-red-600">${investmentCalculator.formatCurrency(result.shortfall)}</div>
                        </div>
                    ` : ''}
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="text-sm text-gray-600">Years to Retirement</div>
                        <div class="text-lg font-bold text-purple-600">${result.yearsToRetirement} years</div>
                    </div>
                </div>
            `;
        }

        // Display growth projection
        function displayGrowthProjection(principal, monthlyContribution, annualRate, years) {
            const projection = investmentCalculator.calculateGrowthProjection(principal, monthlyContribution, annualRate, years);
            
            if (projection.success) {
                const projectionDiv = document.getElementById('growth-projection');
                let projectionHTML = '<div class="space-y-2">';
                
                projection.projection.forEach((year, index) => {
                    if (index % 5 === 0 || index === projection.projection.length - 1) { // Show every 5 years
                        projectionHTML += `
                            <div class="flex justify-between items-center bg-white p-2 rounded border">
                                <span class="font-medium">Year ${year.year}</span>
                                <span class="font-bold text-blue-600">${investmentCalculator.formatCurrency(year.value)}</span>
                            </div>
                        `;
                    }
                });
                
                projectionHTML += '</div>';
                projectionDiv.innerHTML = projectionHTML;
            }
        }

        // Tax Calculator Functions
        let taxCalculator = null;

        // Initialize Tax Calculator
        function initializeTaxCalculator() {
            try {
                if (typeof TaxCalculator !== 'undefined') {
                    taxCalculator = new TaxCalculator();
                    console.log('‚úÖ Tax Calculator initialized successfully');
                } else {
                    console.error('‚ùå TaxCalculator class not found');
                }
            } catch (error) {
                console.error('‚ùå Tax Calculator initialization failed:', error);
            }
        }

        // Update tax currency display
        function updateTaxCurrencyDisplay() {
            const selectedCurrency = document.getElementById('tax-currency').value;
            if (taxCalculator) {
                taxCalculator.setCurrency(selectedCurrency);
                console.log('Tax currency updated to:', selectedCurrency);
            }
        }

        // Calculate tax
        function calculateTax() {
            if (!taxCalculator) {
                alert('Tax Calculator not initialized. Please refresh the page.');
                return;
            }

            try {
                const country = document.getElementById('tax-country').value;
                const filingStatus = document.getElementById('filing-status').value;
                const grossIncome = parseFloat(document.getElementById('gross-income').value);
                const deductions = parseFloat(document.getElementById('deductions').value);
                const selectedCurrency = document.getElementById('tax-currency').value;

                if (isNaN(grossIncome) || isNaN(deductions)) {
                    alert('Please enter valid numbers for all fields.');
                    return;
                }

                // Set the selected currency
                taxCalculator.setCurrency(selectedCurrency);

                const result = taxCalculator.calculateTax(grossIncome, country, filingStatus, deductions);
                
                if (result.success) {
                    displayTaxResults(result);
                    displayTaxBreakdown(result.bracketBreakdown);
                    taxCalculator.addToHistory({
                        type: 'tax',
                        country: country,
                        filingStatus: filingStatus,
                        grossIncome: grossIncome,
                        deductions: deductions,
                        currency: selectedCurrency,
                        result: result
                    });
                } else {
                    alert('Error: ' + result.error);
                }
            } catch (error) {
                console.error('Tax calculation error:', error);
                alert('Error calculating tax: ' + error.message);
            }
        }

        // Calculate take-home pay
        function calculateTakeHomePay() {
            if (!taxCalculator) {
                alert('Tax Calculator not initialized. Please refresh the page.');
                return;
            }

            try {
                const country = document.getElementById('tax-country').value;
                const filingStatus = document.getElementById('filing-status').value;
                const grossSalary = parseFloat(document.getElementById('gross-income').value);
                const deductions = parseFloat(document.getElementById('deductions').value);
                const otherDeductions = parseFloat(document.getElementById('other-deductions').value);
                const selectedCurrency = document.getElementById('tax-currency').value;

                if (isNaN(grossSalary) || isNaN(deductions) || isNaN(otherDeductions)) {
                    alert('Please enter valid numbers for all fields.');
                    return;
                }

                // Set the selected currency
                taxCalculator.setCurrency(selectedCurrency);

                const result = taxCalculator.calculateTakeHomePay(grossSalary, country, filingStatus, deductions, otherDeductions);
                
                if (result.success) {
                    displayTakeHomeResults(result);
                } else {
                    alert('Error: ' + result.error);
                }
            } catch (error) {
                console.error('Take-home pay calculation error:', error);
                alert('Error calculating take-home pay: ' + error.message);
            }
        }

        // Display tax results
        function displayTaxResults(result) {
            const resultsDiv = document.getElementById('tax-results');
            resultsDiv.innerHTML = `
                <div class="space-y-3">
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="text-sm text-gray-600">Gross Income</div>
                        <div class="text-xl font-bold text-blue-600">${taxCalculator.formatCurrency(result.grossIncome)}</div>
                    </div>
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="text-sm text-gray-600">Taxable Income</div>
                        <div class="text-lg font-bold text-gray-600">${taxCalculator.formatCurrency(result.taxableIncome)}</div>
                    </div>
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="text-sm text-gray-600">Total Tax</div>
                        <div class="text-xl font-bold text-red-600">${taxCalculator.formatCurrency(result.totalTax)}</div>
                    </div>
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="text-sm text-gray-600">After-Tax Income</div>
                        <div class="text-xl font-bold text-green-600">${taxCalculator.formatCurrency(result.afterTaxIncome)}</div>
                    </div>
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="text-sm text-gray-600">Effective Tax Rate</div>
                        <div class="text-lg font-bold text-purple-600">${taxCalculator.formatPercentage(result.effectiveRate)}</div>
                    </div>
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="text-sm text-gray-600">Marginal Tax Rate</div>
                        <div class="text-lg font-bold text-indigo-600">${taxCalculator.formatPercentage(result.marginalRate)}</div>
                    </div>
                </div>
            `;
        }

        // Display take-home pay results
        function displayTakeHomeResults(result) {
            const resultsDiv = document.getElementById('take-home-results');
            resultsDiv.innerHTML = `
                <div class="space-y-3">
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="text-sm text-gray-600">Gross Salary</div>
                        <div class="text-xl font-bold text-blue-600">${taxCalculator.formatCurrency(result.grossSalary)}</div>
                    </div>
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="text-sm text-gray-600">Income Tax</div>
                        <div class="text-lg font-bold text-red-600">${taxCalculator.formatCurrency(result.incomeTax)}</div>
                    </div>
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="text-sm text-gray-600">Other Deductions</div>
                        <div class="text-lg font-bold text-orange-600">${taxCalculator.formatCurrency(result.otherDeductions)}</div>
                    </div>
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="text-sm text-gray-600">Take-Home Pay</div>
                        <div class="text-xl font-bold text-green-600">${taxCalculator.formatCurrency(result.takeHomePay)}</div>
                    </div>
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="text-sm text-gray-600">Take-Home Percentage</div>
                        <div class="text-lg font-bold text-purple-600">${taxCalculator.formatPercentage(result.takeHomePercentage)}</div>
                    </div>
                </div>
            `;
        }

        // Display tax bracket breakdown
        function displayTaxBreakdown(breakdown) {
            const breakdownDiv = document.getElementById('tax-breakdown');
            
            if (breakdown.length === 0) {
                breakdownDiv.innerHTML = '<div class="text-center text-gray-500">No breakdown available</div>';
                return;
            }

            let breakdownHTML = '<div class="space-y-2">';
            
            breakdown.forEach((bracket, index) => {
                if (bracket.taxableAmount > 0) {
                    breakdownHTML += `
                        <div class="bg-white p-3 rounded border">
                            <div class="flex justify-between items-center">
                                <div>
                                    <div class="font-medium text-sm">${bracket.bracket}</div>
                                    <div class="text-xs text-gray-500">Rate: ${bracket.rate}%</div>
                                </div>
                                <div class="text-right">
                                    <div class="font-bold text-blue-600">${taxCalculator.formatCurrency(bracket.taxableAmount)}</div>
                                    <div class="text-sm text-red-600">${taxCalculator.formatCurrency(bracket.taxAmount)}</div>
                                </div>
                            </div>
                        </div>
                    `;
                }
            });
            
            breakdownHTML += '</div>';
            breakdownDiv.innerHTML = breakdownHTML;
        }

        // Business Metrics Calculator Functions
        let businessMetricsCalculator = null;

        // Initialize Business Metrics Calculator
        function initializeBusinessMetricsCalculator() {
            try {
                if (typeof BusinessMetricsCalculator !== 'undefined') {
                    businessMetricsCalculator = new BusinessMetricsCalculator();
                    console.log('‚úÖ Business Metrics Calculator initialized successfully');
                } else {
                    console.error('‚ùå BusinessMetricsCalculator class not found');
                }
            } catch (error) {
                console.error('‚ùå Business Metrics Calculator initialization failed:', error);
            }
        }

        // Update business currency display
        function updateBusinessCurrencyDisplay() {
            const selectedCurrency = document.getElementById('business-currency').value;
            if (businessMetricsCalculator) {
                businessMetricsCalculator.setCurrency(selectedCurrency);
                console.log('Business currency updated to:', selectedCurrency);
            }
        }

        // Calculate business metrics
        function calculateBusinessMetrics() {
            if (!businessMetricsCalculator) {
                alert('Business Metrics Calculator not initialized. Please refresh the page.');
                return;
            }

            try {
                const revenue = parseFloat(document.getElementById('revenue').value);
                const costs = parseFloat(document.getElementById('costs').value);
                const expenses = parseFloat(document.getElementById('expenses').value);
                const assets = parseFloat(document.getElementById('assets').value);
                const liabilities = parseFloat(document.getElementById('liabilities').value);
                const equity = parseFloat(document.getElementById('equity').value);
                const selectedCurrency = document.getElementById('business-currency').value;

                if (isNaN(revenue) || isNaN(costs) || isNaN(expenses) || isNaN(assets) || isNaN(liabilities) || isNaN(equity)) {
                    alert('Please enter valid numbers for all fields.');
                    return;
                }

                // Set the selected currency
                businessMetricsCalculator.setCurrency(selectedCurrency);

                const result = businessMetricsCalculator.calculateBusinessMetrics(revenue, costs, expenses, assets, liabilities, equity);
                
                if (result.success) {
                    displayBusinessResults(result);
                    displayFinancialRatios(result);
                    businessMetricsCalculator.addToHistory({
                        type: 'business_metrics',
                        revenue: revenue,
                        costs: costs,
                        expenses: expenses,
                        assets: assets,
                        liabilities: liabilities,
                        equity: equity,
                        currency: selectedCurrency,
                        result: result
                    });
                } else {
                    alert('Error: ' + result.error);
                }
            } catch (error) {
                console.error('Business metrics calculation error:', error);
                alert('Error calculating business metrics: ' + error.message);
            }
        }

        // Calculate break-even analysis
        function calculateBreakEven() {
            if (!businessMetricsCalculator) {
                alert('Business Metrics Calculator not initialized. Please refresh the page.');
                return;
            }

            try {
                const fixedCosts = parseFloat(document.getElementById('fixed-costs').value);
                const variableCost = parseFloat(document.getElementById('variable-cost').value);
                const sellingPrice = parseFloat(document.getElementById('selling-price').value);
                const selectedCurrency = document.getElementById('business-currency').value;

                if (isNaN(fixedCosts) || isNaN(variableCost) || isNaN(sellingPrice)) {
                    alert('Please enter valid numbers for all fields.');
                    return;
                }

                // Set the selected currency
                businessMetricsCalculator.setCurrency(selectedCurrency);

                const result = businessMetricsCalculator.calculateBreakEven(fixedCosts, variableCost, sellingPrice);
                
                if (result.success) {
                    displayBreakEvenResults(result);
                } else {
                    alert('Error: ' + result.error);
                }
            } catch (error) {
                console.error('Break-even calculation error:', error);
                alert('Error calculating break-even: ' + error.message);
            }
        }

        // Display business results
        function displayBusinessResults(result) {
            const resultsDiv = document.getElementById('business-results');
            resultsDiv.innerHTML = `
                <div class="space-y-3">
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="text-sm text-gray-600">Gross Profit</div>
                        <div class="text-xl font-bold text-green-600">${businessMetricsCalculator.formatCurrency(result.grossProfit)}</div>
                    </div>
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="text-sm text-gray-600">Net Profit</div>
                        <div class="text-xl font-bold text-blue-600">${businessMetricsCalculator.formatCurrency(result.netProfit)}</div>
                    </div>
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="text-sm text-gray-600">Gross Margin</div>
                        <div class="text-lg font-bold text-green-600">${businessMetricsCalculator.formatPercentage(result.grossMargin)}</div>
                    </div>
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="text-sm text-gray-600">Net Margin</div>
                        <div class="text-lg font-bold text-blue-600">${businessMetricsCalculator.formatPercentage(result.netMargin)}</div>
                    </div>
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="text-sm text-gray-600">Return on Equity (ROE)</div>
                        <div class="text-lg font-bold text-purple-600">${businessMetricsCalculator.formatPercentage(result.roe)}</div>
                    </div>
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="text-sm text-gray-600">Return on Assets (ROA)</div>
                        <div class="text-lg font-bold text-indigo-600">${businessMetricsCalculator.formatPercentage(result.roa)}</div>
                    </div>
                </div>
            `;
        }

        // Display break-even results
        function displayBreakEvenResults(result) {
            const resultsDiv = document.getElementById('break-even-results');
            resultsDiv.innerHTML = `
                <div class="space-y-3">
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="text-sm text-gray-600">Break-Even Units</div>
                        <div class="text-xl font-bold text-blue-600">${Math.ceil(result.breakEvenUnits)} units</div>
                    </div>
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="text-sm text-gray-600">Break-Even Revenue</div>
                        <div class="text-xl font-bold text-green-600">${businessMetricsCalculator.formatCurrency(result.breakEvenRevenue)}</div>
                    </div>
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="text-sm text-gray-600">Contribution Margin</div>
                        <div class="text-lg font-bold text-purple-600">${businessMetricsCalculator.formatCurrency(result.contributionMargin)}</div>
                    </div>
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="text-sm text-gray-600">Contribution Margin %</div>
                        <div class="text-lg font-bold text-indigo-600">${businessMetricsCalculator.formatPercentage(result.contributionMarginRatio)}</div>
                    </div>
                </div>
            `;
        }

        // Display financial ratios
        function displayFinancialRatios(result) {
            const ratiosDiv = document.getElementById('financial-ratios');
            ratiosDiv.innerHTML = `
                <div class="space-y-3">
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="text-sm text-gray-600">Current Ratio</div>
                        <div class="text-lg font-bold text-blue-600">${businessMetricsCalculator.formatRatio(result.currentRatio)}</div>
                    </div>
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="text-sm text-gray-600">Debt-to-Equity Ratio</div>
                        <div class="text-lg font-bold text-red-600">${businessMetricsCalculator.formatPercentage(result.debtToEquity)}</div>
                    </div>
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="text-sm text-gray-600">Operating Margin</div>
                        <div class="text-lg font-bold text-green-600">${businessMetricsCalculator.formatPercentage(result.operatingMargin)}</div>
                    </div>
                </div>
            `;
        }

        // Currency Converter Functions
        let currencyConverter = null;

        // Initialize Currency Converter
        async function initializeCurrencyConverter() {
            try {
                if (typeof CurrencyConverter !== 'undefined') {
                    currencyConverter = new CurrencyConverter();
                    
                    // Initialize with real-time rates or fallback to static
                    await currencyConverter.initializeRates();
                    
                    // Update status indicator
                    updateRateStatus();
                    
                    console.log('‚úÖ Currency Converter initialized successfully');
                } else {
                    console.error('‚ùå CurrencyConverter class not found');
                }
            } catch (error) {
                console.error('‚ùå Currency Converter initialization failed:', error);
            }
        }

        // Convert currency
        function convertCurrency() {
            if (!currencyConverter) {
                alert('Currency Converter not initialized. Please refresh the page.');
                return;
            }

            try {
                const amount = parseFloat(document.getElementById('convert-amount').value);
                const fromCurrency = document.getElementById('from-currency').value;
                const toCurrency = document.getElementById('to-currency').value;

                if (isNaN(amount) || amount <= 0) {
                    alert('Please enter a valid amount.');
                    return;
                }

                if (fromCurrency === toCurrency) {
                    alert('Please select different currencies.');
                    return;
                }

                const result = currencyConverter.convertCurrency(amount, fromCurrency, toCurrency);
                
                if (result.success) {
                    displayConversionResults(result);
                    displayExchangeRates(fromCurrency);
                    currencyConverter.addToHistory({
                        type: 'currency_conversion',
                        amount: amount,
                        fromCurrency: fromCurrency,
                        toCurrency: toCurrency,
                        result: result
                    });
                } else {
                    alert('Error: ' + result.error);
                }
            } catch (error) {
                console.error('Currency conversion error:', error);
                alert('Error converting currency: ' + error.message);
            }
        }

        // Calculate travel expenses
        function calculateTravelExpenses() {
            if (!currencyConverter) {
                alert('Currency Converter not initialized. Please refresh the page.');
                return;
            }

            try {
                const hotelCost = parseFloat(document.getElementById('hotel-cost').value) || 0;
                const foodCost = parseFloat(document.getElementById('food-cost').value) || 0;
                const transportCost = parseFloat(document.getElementById('transport-cost').value) || 0;
                const fromCurrency = document.getElementById('from-currency').value;
                const toCurrency = document.getElementById('to-currency').value;

                const expenses = [
                    { category: 'Hotel', amount: hotelCost },
                    { category: 'Food', amount: foodCost },
                    { category: 'Transportation', amount: transportCost }
                ];

                const result = currencyConverter.calculateTravelExpenses(expenses, fromCurrency, toCurrency);
                
                if (result.success) {
                    displayTravelResults(result);
                } else {
                    alert('Error: ' + result.error);
                }
            } catch (error) {
                console.error('Travel expense calculation error:', error);
                alert('Error calculating travel expenses: ' + error.message);
            }
        }

        // Display conversion results
        function displayConversionResults(result) {
            const resultsDiv = document.getElementById('conversion-results');
            resultsDiv.innerHTML = `
                <div class="space-y-3">
                    <div class="bg-white p-4 rounded-lg border">
                        <div class="text-sm text-gray-600">Original Amount</div>
                        <div class="text-xl font-bold text-gray-800">${currencyConverter.formatCurrency(result.originalAmount, result.originalCurrency)}</div>
                    </div>
                    <div class="bg-white p-4 rounded-lg border">
                        <div class="text-sm text-gray-600">Converted Amount</div>
                        <div class="text-xl font-bold text-cyan-600">${currencyConverter.formatCurrency(result.convertedAmount, result.targetCurrency)}</div>
                    </div>
                    <div class="bg-white p-4 rounded-lg border">
                        <div class="text-sm text-gray-600">Exchange Rate</div>
                        <div class="text-lg font-bold text-blue-600">1 ${result.originalCurrency} = ${currencyConverter.formatExchangeRate(result.exchangeRate)} ${result.targetCurrency}</div>
                    </div>
                </div>
            `;
        }

        // Display travel results
        function displayTravelResults(result) {
            const resultsDiv = document.getElementById('travel-results');
            resultsDiv.innerHTML = `
                <div class="space-y-3">
                    <div class="bg-white p-4 rounded-lg border">
                        <div class="text-sm text-gray-600">Total Expenses (${result.fromCurrency})</div>
                        <div class="text-xl font-bold text-gray-800">${currencyConverter.formatCurrency(result.originalTotal, result.fromCurrency)}</div>
                    </div>
                    <div class="bg-white p-4 rounded-lg border">
                        <div class="text-sm text-gray-600">Total Expenses (${result.toCurrency})</div>
                        <div class="text-xl font-bold text-cyan-600">${currencyConverter.formatCurrency(result.convertedTotal, result.toCurrency)}</div>
                    </div>
                    <div class="space-y-2">
                        ${result.expenses.map(expense => `
                            <div class="bg-white p-3 rounded-lg border">
                                <div class="flex justify-between items-center">
                                    <span class="text-sm text-gray-600">${expense.category}</span>
                                    <span class="font-bold text-blue-600">${currencyConverter.formatCurrency(expense.convertedAmount, result.toCurrency)}</span>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        // Display exchange rates
        function displayExchangeRates(baseCurrency) {
            const ratesDiv = document.getElementById('exchange-rates');
            const allRates = currencyConverter.getAllRates(baseCurrency);
            
            if (allRates.success) {
                const ratesHTML = Object.entries(allRates.rates).map(([currency, rate]) => `
                    <div class="flex justify-between items-center py-2 border-b border-gray-200">
                        <div class="flex items-center">
                            <span class="text-lg mr-2">${rate.flag}</span>
                            <span class="font-medium">${currency}</span>
                        </div>
                        <span class="font-bold text-blue-600">${currencyConverter.formatExchangeRate(rate.rate)}</span>
                    </div>
                `).join('');
                
                ratesDiv.innerHTML = `
                    <div class="space-y-1">
                        <div class="text-sm text-gray-600 mb-2">Exchange rates for ${baseCurrency}</div>
                        ${ratesHTML}
                    </div>
                `;
            } else {
                ratesDiv.innerHTML = '<div class="text-center text-gray-500">Error loading exchange rates</div>';
            }
        }

        // Refresh exchange rates from API
        async function refreshExchangeRates() {
            if (!currencyConverter) {
                alert('Currency Converter not initialized. Please refresh the page.');
                return;
            }

            try {
                // Update status to loading
                updateRateStatus('loading');
                
                // Try to refresh rates from API
                const success = await currencyConverter.refreshRates();
                
                if (success) {
                    updateRateStatus('success');
                    console.log('‚úÖ Exchange rates refreshed successfully');
                    
                    // Update the display if there's a selected base currency
                    const fromCurrency = document.getElementById('from-currency').value;
                    if (fromCurrency) {
                        displayExchangeRates(fromCurrency);
                    }
                } else {
                    updateRateStatus('error');
                    console.warn('‚ö†Ô∏è Failed to refresh rates, using cached/static rates');
                }
            } catch (error) {
                updateRateStatus('error');
                console.error('Error refreshing exchange rates:', error);
            }
        }

        // Update rate status indicator
        function updateRateStatus(status = 'loading') {
            const statusDiv = document.getElementById('rate-status');
            if (!statusDiv) return;

            const currentRates = currencyConverter ? currencyConverter.getCurrentRates() : null;
            
            if (status === 'loading') {
                statusDiv.innerHTML = `
                    <span class="inline-block w-2 h-2 bg-yellow-400 rounded-full mr-1 animate-pulse"></span>
                    Loading...
                `;
            } else if (status === 'success' || (currentRates && currentRates.isRealTime)) {
                statusDiv.innerHTML = `
                    <span class="inline-block w-2 h-2 bg-green-400 rounded-full mr-1"></span>
                    Real-time (${currentRates ? currentRates.source : 'API'})
                `;
            } else if (status === 'error' || (currentRates && !currentRates.isRealTime)) {
                statusDiv.innerHTML = `
                    <span class="inline-block w-2 h-2 bg-orange-400 rounded-full mr-1"></span>
                    Static rates
                `;
            } else {
                statusDiv.innerHTML = `
                    <span class="inline-block w-2 h-2 bg-gray-400 rounded-full mr-1"></span>
                    Offline
                `;
            }
        }

        // Retirement Calculator Functions
        let retirementCalculator = null;

        // Initialize Retirement Calculator
        function initializeRetirementCalculator() {
            try {
                if (typeof RetirementCalculator !== 'undefined') {
                    retirementCalculator = new RetirementCalculator();
                    console.log('‚úÖ Retirement Calculator initialized successfully');
                } else {
                    console.error('‚ùå RetirementCalculator class not found');
                }
            } catch (error) {
                console.error('‚ùå Retirement Calculator initialization failed:', error);
            }
        }

        // Update retirement currency display
        function updateRetirementCurrencyDisplay() {
            const selectedCurrency = document.getElementById('retirement-currency').value;
            if (retirementCalculator) {
                retirementCalculator.setCurrency(selectedCurrency);
                console.log('Retirement currency updated to:', selectedCurrency);
            }
        }

        // Calculate retirement plan
        function calculateRetirementPlan() {
            if (!retirementCalculator) {
                alert('Retirement Calculator not initialized. Please refresh the page.');
                return;
            }

            try {
                const currentAge = parseInt(document.getElementById('current-age').value);
                const retirementAge = parseInt(document.getElementById('retirement-age').value);
                const currentSalary = parseFloat(document.getElementById('current-salary').value);
                const currentSavings = parseFloat(document.getElementById('current-savings').value);
                const monthlyContribution = parseFloat(document.getElementById('monthly-contribution').value);
                const annualReturn = parseFloat(document.getElementById('annual-return').value);
                const selectedCurrency = document.getElementById('retirement-currency').value;

                if (isNaN(currentAge) || isNaN(retirementAge) || isNaN(currentSalary) || isNaN(currentSavings) || isNaN(monthlyContribution) || isNaN(annualReturn)) {
                    alert('Please enter valid numbers for all fields.');
                    return;
                }

                if (retirementAge <= currentAge) {
                    alert('Retirement age must be greater than current age.');
                    return;
                }

                // Set the selected currency
                retirementCalculator.setCurrency(selectedCurrency);

                // Calculate retirement goal
                const goalResult = retirementCalculator.calculateRetirementGoal(
                    currentAge, retirementAge, currentSalary, 80, 3, annualReturn
                );

                // Calculate retirement projection
                const projectionResult = retirementCalculator.calculateRetirementProjection(
                    currentSavings, monthlyContribution, retirementAge - currentAge, annualReturn, 3
                );

                // Calculate readiness score
                const readinessResult = retirementCalculator.calculateReadinessScore(
                    currentSavings, monthlyContribution, currentAge, retirementAge, currentSalary
                );

                if (goalResult.success && projectionResult.success && readinessResult.success) {
                    displayRetirementResults(goalResult, projectionResult);
                    displayReadinessResults(readinessResult);
                    
                    retirementCalculator.addToHistory({
                        type: 'retirement_plan',
                        currentAge: currentAge,
                        retirementAge: retirementAge,
                        currentSalary: currentSalary,
                        currentSavings: currentSavings,
                        monthlyContribution: monthlyContribution,
                        annualReturn: annualReturn,
                        currency: selectedCurrency,
                        goalResult: goalResult,
                        projectionResult: projectionResult,
                        readinessResult: readinessResult
                    });
                } else {
                    alert('Error calculating retirement plan. Please check your inputs.');
                }
            } catch (error) {
                console.error('Retirement calculation error:', error);
                alert('Error calculating retirement plan: ' + error.message);
            }
        }

        // Calculate contribution limits
        function calculateContributionLimits() {
            if (!retirementCalculator) {
                alert('Retirement Calculator not initialized. Please refresh the page.');
                return;
            }

            try {
                const age = parseInt(document.getElementById('contribution-age').value);
                const accountType = document.getElementById('account-type').value;
                const income = parseFloat(document.getElementById('current-salary').value);

                if (isNaN(age) || isNaN(income)) {
                    alert('Please enter valid age and income.');
                    return;
                }

                const result = retirementCalculator.calculateContributionLimits(age, income, accountType);
                
                if (result.success) {
                    displayContributionResults(result);
                } else {
                    alert('Error: ' + result.error);
                }
            } catch (error) {
                console.error('Contribution limits calculation error:', error);
                alert('Error calculating contribution limits: ' + error.message);
            }
        }

        // Display retirement results
        function displayRetirementResults(goalResult, projectionResult) {
            const resultsDiv = document.getElementById('retirement-results');
            resultsDiv.innerHTML = `
                <div class="space-y-3">
                    <div class="bg-white p-4 rounded-lg border">
                        <div class="text-sm text-gray-600">Retirement Goal</div>
                        <div class="text-xl font-bold text-purple-600">${retirementCalculator.formatCurrency(goalResult.presentValueGoal)}</div>
                    </div>
                    <div class="bg-white p-4 rounded-lg border">
                        <div class="text-sm text-gray-600">Projected Savings at Retirement</div>
                        <div class="text-xl font-bold text-green-600">${retirementCalculator.formatCurrency(projectionResult.finalProjectedSavings)}</div>
                    </div>
                    <div class="bg-white p-4 rounded-lg border">
                        <div class="text-sm text-gray-600">Monthly Contribution Needed</div>
                        <div class="text-lg font-bold text-blue-600">${retirementCalculator.formatCurrency(goalResult.monthlyContribution)}</div>
                    </div>
                    <div class="bg-white p-4 rounded-lg border">
                        <div class="text-sm text-gray-600">Years to Retirement</div>
                        <div class="text-lg font-bold text-indigo-600">${goalResult.yearsToRetirement} years</div>
                    </div>
                </div>
            `;
        }

        // Display readiness results
        function displayReadinessResults(readinessResult) {
            const resultsDiv = document.getElementById('readiness-results');
            const scoreColor = readinessResult.score >= 80 ? 'text-green-600' : 
                             readinessResult.score >= 60 ? 'text-blue-600' : 
                             readinessResult.score >= 40 ? 'text-yellow-600' : 
                             readinessResult.score >= 20 ? 'text-orange-600' : 'text-red-600';
            
            resultsDiv.innerHTML = `
                <div class="space-y-3">
                    <div class="bg-white p-4 rounded-lg border">
                        <div class="text-sm text-gray-600">Readiness Score</div>
                        <div class="text-2xl font-bold ${scoreColor}">${readinessResult.score.toFixed(1)}/100</div>
                        <div class="text-sm font-medium ${scoreColor}">${readinessResult.readinessLevel}</div>
                    </div>
                    <div class="bg-white p-4 rounded-lg border">
                        <div class="text-sm text-gray-600">Savings Rate</div>
                        <div class="text-lg font-bold text-blue-600">${retirementCalculator.formatPercentage(readinessResult.savingsRate)}</div>
                    </div>
                    <div class="bg-white p-4 rounded-lg border">
                        <div class="text-sm text-gray-600">Current vs Target</div>
                        <div class="text-lg font-bold text-purple-600">${retirementCalculator.formatPercentage(readinessResult.currentRatio * 100)}</div>
                    </div>
                </div>
            `;
        }

        // Display contribution results
        function displayContributionResults(result) {
            const resultsDiv = document.getElementById('contribution-results');
            resultsDiv.innerHTML = `
                <div class="space-y-3">
                    <div class="bg-white p-4 rounded-lg border">
                        <div class="text-sm text-gray-600">Max Annual Contribution</div>
                        <div class="text-xl font-bold text-blue-600">${retirementCalculator.formatCurrency(result.maxAnnualContribution)}</div>
                    </div>
                    <div class="bg-white p-4 rounded-lg border">
                        <div class="text-sm text-gray-600">Max Monthly Contribution</div>
                        <div class="text-lg font-bold text-green-600">${retirementCalculator.formatCurrency(result.maxMonthlyContribution)}</div>
                    </div>
                    <div class="bg-white p-4 rounded-lg border">
                        <div class="text-sm text-gray-600">Recommended Contribution</div>
                        <div class="text-lg font-bold text-purple-600">${retirementCalculator.formatCurrency(result.recommendedContribution)}</div>
                    </div>
                    ${result.isEligibleForCatchUp ? `
                        <div class="bg-yellow-50 p-3 rounded-lg border border-yellow-200">
                            <div class="text-sm text-yellow-800 font-medium">üéâ Catch-up Contribution Eligible!</div>
                            <div class="text-xs text-yellow-600">You can contribute an additional ${retirementCalculator.formatCurrency(result.catchUpLimit)} annually</div>
                        </div>
                    ` : ''}
                </div>
            `;
        }

        // Mortgage Calculator Functions
        let mortgageCalculator = null;

        // Initialize Mortgage Calculator
        function initializeMortgageCalculator() {
            try {
                if (typeof MortgageCalculator !== 'undefined') {
                    mortgageCalculator = new MortgageCalculator();
                    console.log('‚úÖ Mortgage Calculator initialized successfully');
                } else {
                    console.error('‚ùå MortgageCalculator class not found');
                }
            } catch (error) {
                console.error('‚ùå Mortgage Calculator initialization failed:', error);
            }
        }

        // Update mortgage currency display
        function updateMortgageCurrencyDisplay() {
            const selectedCurrency = document.getElementById('mortgage-currency').value;
            if (mortgageCalculator) {
                mortgageCalculator.setCurrency(selectedCurrency);
                console.log('Mortgage currency updated to:', selectedCurrency);
            }
        }

        // Calculate mortgage payment
        function calculateMortgage() {
            if (!mortgageCalculator) {
                alert('Mortgage Calculator not initialized. Please refresh the page.');
                return;
            }

            try {
                const loanAmount = parseFloat(document.getElementById('loan-amount').value);
                const downPayment = parseFloat(document.getElementById('down-payment').value);
                const interestRate = parseFloat(document.getElementById('interest-rate').value);
                const loanTerm = parseInt(document.getElementById('loan-term').value);
                const propertyTax = parseFloat(document.getElementById('property-tax').value) || 0;
                const insurance = parseFloat(document.getElementById('insurance').value) || 0;
                const pmi = parseFloat(document.getElementById('pmi').value) || 0;
                const selectedCurrency = document.getElementById('mortgage-currency').value;

                if (isNaN(loanAmount) || isNaN(downPayment) || isNaN(interestRate) || isNaN(loanTerm)) {
                    alert('Please enter valid numbers for all required fields.');
                    return;
                }

                if (downPayment >= loanAmount) {
                    alert('Down payment must be less than loan amount.');
                    return;
                }

                // Set the selected currency
                mortgageCalculator.setCurrency(selectedCurrency);

                const result = mortgageCalculator.calculateMortgagePayment(
                    loanAmount, interestRate, loanTerm, downPayment, propertyTax, insurance, pmi
                );
                
                if (result.success) {
                    displayMortgageResults(result);
                    displayLoanSummary(result);
                    
                    mortgageCalculator.addToHistory({
                        type: 'mortgage_calculation',
                        loanAmount: loanAmount,
                        downPayment: downPayment,
                        interestRate: interestRate,
                        loanTerm: loanTerm,
                        propertyTax: propertyTax,
                        insurance: insurance,
                        pmi: pmi,
                        currency: selectedCurrency,
                        result: result
                    });
                } else {
                    alert('Error: ' + result.error);
                }
            } catch (error) {
                console.error('Mortgage calculation error:', error);
                alert('Error calculating mortgage: ' + error.message);
            }
        }

        // Calculate affordability
        function calculateAffordability() {
            if (!mortgageCalculator) {
                alert('Mortgage Calculator not initialized. Please refresh the page.');
                return;
            }

            try {
                const income = parseFloat(document.getElementById('annual-income').value);
                const monthlyDebts = parseFloat(document.getElementById('monthly-debts').value) || 0;
                const downPayment = parseFloat(document.getElementById('affordability-down').value);
                const interestRate = parseFloat(document.getElementById('affordability-rate').value);
                const loanTerm = 30; // Default 30-year term
                const selectedCurrency = document.getElementById('mortgage-currency').value;

                if (isNaN(income) || isNaN(downPayment) || isNaN(interestRate)) {
                    alert('Please enter valid numbers for all required fields.');
                    return;
                }

                // Set the selected currency
                mortgageCalculator.setCurrency(selectedCurrency);

                const result = mortgageCalculator.calculateAffordability(
                    income, monthlyDebts, downPayment, interestRate, loanTerm
                );
                
                if (result.success) {
                    displayAffordabilityResults(result);
                } else {
                    alert('Error: ' + result.error);
                }
            } catch (error) {
                console.error('Affordability calculation error:', error);
                alert('Error calculating affordability: ' + error.message);
            }
        }

        // Display mortgage results
        function displayMortgageResults(result) {
            const resultsDiv = document.getElementById('mortgage-results');
            resultsDiv.innerHTML = `
                <div class="space-y-3">
                    <div class="bg-white p-4 rounded-lg border">
                        <div class="text-sm text-gray-600">Monthly Payment</div>
                        <div class="text-xl font-bold text-green-600">${mortgageCalculator.formatCurrency(result.monthlyPayment)}</div>
                    </div>
                    <div class="bg-white p-4 rounded-lg border">
                        <div class="text-sm text-gray-600">Total Monthly Payment</div>
                        <div class="text-xl font-bold text-blue-600">${mortgageCalculator.formatCurrency(result.totalMonthlyPayment)}</div>
                    </div>
                    <div class="bg-white p-4 rounded-lg border">
                        <div class="text-sm text-gray-600">Total Interest</div>
                        <div class="text-lg font-bold text-red-600">${mortgageCalculator.formatCurrency(result.totalInterest)}</div>
                    </div>
                    <div class="bg-white p-4 rounded-lg border">
                        <div class="text-sm text-gray-600">Total Payment</div>
                        <div class="text-lg font-bold text-purple-600">${mortgageCalculator.formatCurrency(result.totalPayment)}</div>
                    </div>
                </div>
            `;
        }

        // Display affordability results
        function displayAffordabilityResults(result) {
            const resultsDiv = document.getElementById('affordability-results');
            resultsDiv.innerHTML = `
                <div class="space-y-3">
                    <div class="bg-white p-4 rounded-lg border">
                        <div class="text-sm text-gray-600">Max Home Price (28% Rule)</div>
                        <div class="text-xl font-bold text-green-600">${mortgageCalculator.formatCurrency(result.maxHomePrice)}</div>
                    </div>
                    <div class="bg-white p-4 rounded-lg border">
                        <div class="text-sm text-gray-600">Max Home Price (36% Rule)</div>
                        <div class="text-xl font-bold text-blue-600">${mortgageCalculator.formatCurrency(result.maxHomePriceWithDebt)}</div>
                    </div>
                    <div class="bg-white p-4 rounded-lg border">
                        <div class="text-sm text-gray-600">Max Monthly Payment</div>
                        <div class="text-lg font-bold text-purple-600">${mortgageCalculator.formatCurrency(result.maxPayment)}</div>
                    </div>
                    <div class="bg-white p-4 rounded-lg border">
                        <div class="text-sm text-gray-600">Debt-to-Income Ratio</div>
                        <div class="text-lg font-bold text-orange-600">${mortgageCalculator.formatPercentage(result.debtToIncomeRatio)}</div>
                    </div>
                </div>
            `;
        }

        // Display loan summary
        function displayLoanSummary(result) {
            const summaryDiv = document.getElementById('loan-summary');
            summaryDiv.innerHTML = `
                <div class="space-y-3">
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-600">Principal</span>
                            <span class="font-bold text-blue-600">${mortgageCalculator.formatCurrency(result.principal)}</span>
                        </div>
                    </div>
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-600">Interest Rate</span>
                            <span class="font-bold text-green-600">${mortgageCalculator.formatPercentage(result.interestRate)}</span>
                        </div>
                    </div>
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-600">Loan Term</span>
                            <span class="font-bold text-purple-600">${result.loanTerm} years</span>
                        </div>
                    </div>
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-600">Down Payment</span>
                            <span class="font-bold text-indigo-600">${mortgageCalculator.formatCurrency(result.downPayment)}</span>
                        </div>
                    </div>
                </div>
            `;
        }

        // Budget Planner Functions
        let budgetPlanner = null;

        // Initialize Budget Planner
        function initializeBudgetPlanner() {
            try {
                if (typeof BudgetPlanner !== 'undefined') {
                    budgetPlanner = new BudgetPlanner();
                    console.log('‚úÖ Budget Planner initialized successfully');
                } else {
                    console.error('‚ùå BudgetPlanner class not found');
                }
            } catch (error) {
                console.error('‚ùå Budget Planner initialization failed:', error);
            }
        }

        // Update budget currency display
        function updateBudgetCurrencyDisplay() {
            const selectedCurrency = document.getElementById('budget-currency').value;
            if (budgetPlanner) {
                budgetPlanner.setCurrency(selectedCurrency);
                console.log('Budget currency updated to:', selectedCurrency);
            }
        }

        // Calculate personal budget
        function calculatePersonalBudget() {
            if (!budgetPlanner) {
                alert('Budget Planner not initialized. Please refresh the page.');
                return;
            }

            try {
                const monthlyIncome = parseFloat(document.getElementById('monthly-income').value);
                const monthlyExpenses = parseFloat(document.getElementById('monthly-expenses').value);
                const monthlySavings = parseFloat(document.getElementById('monthly-savings').value);
                const monthlyDebt = parseFloat(document.getElementById('monthly-debt').value);
                const selectedCurrency = document.getElementById('budget-currency').value;

                if (isNaN(monthlyIncome) || isNaN(monthlyExpenses) || isNaN(monthlySavings) || isNaN(monthlyDebt)) {
                    alert('Please enter valid numbers for all fields.');
                    return;
                }

                // Set the selected currency
                budgetPlanner.setCurrency(selectedCurrency);

                // Create budget data
                const income = [{ name: 'Salary', amount: monthlyIncome }];
                const expenses = [{ name: 'Living Expenses', amount: monthlyExpenses, category: 'Needs' }];
                const savings = [{ name: 'Savings', amount: monthlySavings }];
                const debt = [{ name: 'Debt Payments', amount: monthlyDebt }];

                const result = budgetPlanner.createPersonalBudget(income, expenses, savings, debt);
                
                if (result.success) {
                    displayBudgetResults(result);
                    
                    budgetPlanner.addToHistory({
                        type: 'personal_budget',
                        monthlyIncome: monthlyIncome,
                        monthlyExpenses: monthlyExpenses,
                        monthlySavings: monthlySavings,
                        monthlyDebt: monthlyDebt,
                        currency: selectedCurrency,
                        result: result
                    });
                } else {
                    alert('Error: ' + result.error);
                }
            } catch (error) {
                console.error('Budget calculation error:', error);
                alert('Error calculating budget: ' + error.message);
            }
        }

        // Calculate 50/30/20 budget
        function calculate502030Budget() {
            if (!budgetPlanner) {
                alert('Budget Planner not initialized. Please refresh the page.');
                return;
            }

            try {
                const income = parseFloat(document.getElementById('rule-income').value);
                const selectedCurrency = document.getElementById('budget-currency').value;

                if (isNaN(income)) {
                    alert('Please enter a valid income amount.');
                    return;
                }

                // Set the selected currency
                budgetPlanner.setCurrency(selectedCurrency);

                const result = budgetPlanner.calculate502030Budget(income);
                
                if (result.success) {
                    display502030Results(result);
                } else {
                    alert('Error: ' + result.error);
                }
            } catch (error) {
                console.error('50/30/20 budget calculation error:', error);
                alert('Error calculating 50/30/20 budget: ' + error.message);
            }
        }

        // Calculate emergency fund
        function calculateEmergencyFund() {
            if (!budgetPlanner) {
                alert('Budget Planner not initialized. Please refresh the page.');
                return;
            }

            try {
                const monthlyExpenses = parseFloat(document.getElementById('emergency-expenses').value);
                const months = parseInt(document.getElementById('emergency-months').value);
                const selectedCurrency = document.getElementById('budget-currency').value;

                if (isNaN(monthlyExpenses)) {
                    alert('Please enter valid monthly expenses.');
                    return;
                }

                // Set the selected currency
                budgetPlanner.setCurrency(selectedCurrency);

                const result = budgetPlanner.calculateEmergencyFund(monthlyExpenses, months);
                
                if (result.success) {
                    displayEmergencyResults(result);
                } else {
                    alert('Error: ' + result.error);
                }
            } catch (error) {
                console.error('Emergency fund calculation error:', error);
                alert('Error calculating emergency fund: ' + error.message);
            }
        }

        // Display budget results
        function displayBudgetResults(result) {
            const resultsDiv = document.getElementById('budget-results');
            const healthColor = result.budgetHealth.score >= 80 ? 'text-green-600' : 
                              result.budgetHealth.score >= 60 ? 'text-blue-600' : 
                              result.budgetHealth.score >= 40 ? 'text-yellow-600' : 
                              result.budgetHealth.score >= 20 ? 'text-orange-600' : 'text-red-600';
            
            resultsDiv.innerHTML = `
                <div class="space-y-3">
                    <div class="bg-white p-4 rounded-lg border">
                        <div class="text-sm text-gray-600">Net Income</div>
                        <div class="text-xl font-bold ${result.netIncome >= 0 ? 'text-green-600' : 'text-red-600'}">${budgetPlanner.formatCurrency(result.netIncome)}</div>
                    </div>
                    <div class="bg-white p-4 rounded-lg border">
                        <div class="text-sm text-gray-600">Savings Rate</div>
                        <div class="text-lg font-bold text-blue-600">${budgetPlanner.formatPercentage(result.savingsRate)}</div>
                    </div>
                    <div class="bg-white p-4 rounded-lg border">
                        <div class="text-sm text-gray-600">Debt-to-Income Ratio</div>
                        <div class="text-lg font-bold text-purple-600">${budgetPlanner.formatPercentage(result.debtToIncomeRatio)}</div>
                    </div>
                    <div class="bg-white p-4 rounded-lg border">
                        <div class="text-sm text-gray-600">Budget Health Score</div>
                        <div class="text-2xl font-bold ${healthColor}">${result.budgetHealth.score.toFixed(1)}/100</div>
                        <div class="text-sm font-medium ${healthColor}">${result.budgetHealth.healthLevel}</div>
                    </div>
                    <div class="bg-yellow-50 p-3 rounded-lg border border-yellow-200">
                        <div class="text-sm text-yellow-800 font-medium">üí° Recommendations:</div>
                        <ul class="text-xs text-yellow-600 mt-1">
                            ${result.budgetHealth.recommendations.map(rec => `<li>‚Ä¢ ${rec}</li>`).join('')}
                        </ul>
                    </div>
                </div>
            `;
        }

        // Display 50/30/20 results
        function display502030Results(result) {
            const resultsDiv = document.getElementById('rule-results');
            resultsDiv.innerHTML = `
                <div class="space-y-3">
                    <div class="bg-white p-4 rounded-lg border">
                        <div class="text-sm text-gray-600">Needs (50%)</div>
                        <div class="text-xl font-bold text-red-600">${budgetPlanner.formatCurrency(result.needs)}</div>
                    </div>
                    <div class="bg-white p-4 rounded-lg border">
                        <div class="text-sm text-gray-600">Wants (30%)</div>
                        <div class="text-xl font-bold text-blue-600">${budgetPlanner.formatCurrency(result.wants)}</div>
                    </div>
                    <div class="bg-white p-4 rounded-lg border">
                        <div class="text-sm text-gray-600">Savings (20%)</div>
                        <div class="text-xl font-bold text-green-600">${budgetPlanner.formatCurrency(result.savings)}</div>
                    </div>
                    <div class="bg-gray-50 p-3 rounded-lg">
                        <div class="text-xs text-gray-600">
                            <strong>Needs:</strong> Housing, food, utilities, insurance<br>
                            <strong>Wants:</strong> Entertainment, dining out, hobbies<br>
                            <strong>Savings:</strong> Emergency fund, retirement, investments
                        </div>
                    </div>
                </div>
            `;
        }

        // Display emergency fund results
        function displayEmergencyResults(result) {
            const resultsDiv = document.getElementById('emergency-results');
            resultsDiv.innerHTML = `
                <div class="space-y-3">
                    <div class="bg-white p-4 rounded-lg border">
                        <div class="text-sm text-gray-600">Emergency Fund Target</div>
                        <div class="text-xl font-bold text-green-600">${budgetPlanner.formatCurrency(result.emergencyFund)}</div>
                    </div>
                    <div class="bg-white p-4 rounded-lg border">
                        <div class="text-sm text-gray-600">Monthly Savings Needed</div>
                        <div class="text-lg font-bold text-blue-600">${budgetPlanner.formatCurrency(result.monthlySavings)}</div>
                    </div>
                    <div class="bg-white p-4 rounded-lg border">
                        <div class="text-sm text-gray-600">Weekly Savings Needed</div>
                        <div class="text-lg font-bold text-purple-600">${budgetPlanner.formatCurrency(result.weeklySavings)}</div>
                    </div>
                    <div class="bg-white p-4 rounded-lg border">
                        <div class="text-sm text-gray-600">Daily Savings Needed</div>
                        <div class="text-lg font-bold text-indigo-600">${budgetPlanner.formatCurrency(result.dailySavings)}</div>
                    </div>
                </div>
            `;
        }

        // Salary Calculator Functions
        let salaryCalculator = null;

        // Initialize Salary Calculator
        function initializeSalaryCalculator() {
            try {
                if (typeof SalaryCalculator !== 'undefined') {
                    salaryCalculator = new SalaryCalculator();
                    console.log('‚úÖ Salary Calculator initialized successfully');
                } else {
                    console.error('‚ùå SalaryCalculator class not found');
                }
            } catch (error) {
                console.error('‚ùå Salary Calculator initialization failed:', error);
            }
        }

        // Update salary currency display
        function updateSalaryCurrencyDisplay() {
            const selectedCurrency = document.getElementById('salary-currency').value;
            if (salaryCalculator) {
                salaryCalculator.setCurrency(selectedCurrency);
            }
        }

        // Calculate take-home pay
        function calculateSalaryTakeHomePay() {
            if (!salaryCalculator) {
                alert('Salary Calculator not initialized. Please refresh the page.');
                return;
            }

            try {
                const grossSalary = parseFloat(document.getElementById('gross-salary').value);
                const filingStatus = document.getElementById('filing-status').value;
                const state = document.getElementById('state').value;
                const preTaxDeductions = parseFloat(document.getElementById('pre-tax-deductions').value) || 0;
                const selectedCurrency = document.getElementById('salary-currency').value;

                if (isNaN(grossSalary)) {
                    alert('Please enter a valid gross salary.');
                    return;
                }

                // Set the selected currency
                salaryCalculator.setCurrency(selectedCurrency);

                const result = salaryCalculator.calculateTakeHomePayUS(grossSalary, filingStatus, state, 0, preTaxDeductions, 0);
                
                if (result.success) {
                    displaySalaryTakeHomeResults(result);
                    
                    salaryCalculator.addToHistory({
                        type: 'take_home_pay',
                        grossSalary: grossSalary,
                        filingStatus: filingStatus,
                        state: state,
                        preTaxDeductions: preTaxDeductions,
                        currency: selectedCurrency,
                        result: result
                    });
                } else {
                    alert('Error: ' + result.error);
                }
            } catch (error) {
                console.error('Take-home pay calculation error:', error);
                alert('Error calculating take-home pay: ' + error.message);
            }
        }

        // Calculate salary comparison
        function calculateSalaryComparison() {
            if (!salaryCalculator) {
                alert('Salary Calculator not initialized. Please refresh the page.');
                return;
            }

            try {
                const currentSalary = parseFloat(document.getElementById('current-salary').value);
                const newSalary = parseFloat(document.getElementById('new-salary').value);
                const currentBenefits = parseFloat(document.getElementById('current-benefits').value) || 0;
                const newBenefits = parseFloat(document.getElementById('new-benefits').value) || 0;
                const selectedCurrency = document.getElementById('salary-currency').value;

                if (isNaN(currentSalary) || isNaN(newSalary)) {
                    alert('Please enter valid salary amounts.');
                    return;
                }

                // Set the selected currency
                salaryCalculator.setCurrency(selectedCurrency);

                const result = salaryCalculator.calculateSalaryComparison(currentSalary, newSalary, currentBenefits, newBenefits, selectedCurrency);
                
                if (result.success) {
                    displayComparisonResults(result);
                } else {
                    alert('Error: ' + result.error);
                }
            } catch (error) {
                console.error('Salary comparison calculation error:', error);
                alert('Error calculating salary comparison: ' + error.message);
            }
        }

        // Calculate hourly to salary
        function calculateSalaryHourlyToSalary() {
            console.log('calculateSalaryHourlyToSalary called');
            console.log('salaryCalculator:', salaryCalculator);
            
            if (!salaryCalculator) {
                alert('Salary Calculator not initialized. Please refresh the page.');
                return;
            }

            try {
                const hourlyRate = parseFloat(document.getElementById('hourly-rate').value);
                const hoursPerWeek = parseFloat(document.getElementById('hours-per-week').value);
                const weeksPerYear = parseFloat(document.getElementById('weeks-per-year').value);
                const selectedCurrency = document.getElementById('salary-currency').value;

                console.log('Input values:', { hourlyRate, hoursPerWeek, weeksPerYear, selectedCurrency });

                if (isNaN(hourlyRate) || isNaN(hoursPerWeek) || isNaN(weeksPerYear)) {
                    alert('Please enter valid numbers for all fields.');
                    return;
                }

                // Set the selected currency
                salaryCalculator.setCurrency(selectedCurrency);

                const result = salaryCalculator.calculateHourlyToSalary(hourlyRate, hoursPerWeek, weeksPerYear);
                
                console.log('Calculation result:', result);
                
                if (result.success) {
                    displaySalaryConversionResults(result);
                } else {
                    alert('Error: ' + result.error);
                }
            } catch (error) {
                console.error('Hourly to salary calculation error:', error);
                alert('Error calculating hourly to salary: ' + error.message);
            }
        }

        // Display take-home pay results
        function displaySalaryTakeHomeResults(result) {
            const resultsDiv = document.getElementById('salary-take-home-results');
            resultsDiv.innerHTML = `
                <div class="space-y-3">
                    <div class="bg-white p-4 rounded-lg border">
                        <div class="text-sm text-gray-600">Gross Salary</div>
                        <div class="text-xl font-bold text-blue-600">${salaryCalculator.formatCurrency(result.grossSalary)}</div>
                    </div>
                    <div class="bg-white p-4 rounded-lg border">
                        <div class="text-sm text-gray-600">Net Take-Home Pay</div>
                        <div class="text-2xl font-bold text-green-600">${salaryCalculator.formatCurrency(result.netPay)}</div>
                    </div>
                    <div class="bg-white p-4 rounded-lg border">
                        <div class="text-sm text-gray-600">Total Taxes</div>
                        <div class="text-lg font-bold text-red-600">${salaryCalculator.formatCurrency(result.totalTaxes)}</div>
                    </div>
                    <div class="grid grid-cols-2 gap-2 text-sm">
                        <div class="bg-gray-50 p-2 rounded">
                            <div class="text-gray-600">Federal Tax</div>
                            <div class="font-bold">${salaryCalculator.formatCurrency(result.federalTax)}</div>
                        </div>
                        <div class="bg-gray-50 p-2 rounded">
                            <div class="text-gray-600">State Tax</div>
                            <div class="font-bold">${salaryCalculator.formatCurrency(result.stateTax)}</div>
                        </div>
                        <div class="bg-gray-50 p-2 rounded">
                            <div class="text-gray-600">FICA Tax</div>
                            <div class="font-bold">${salaryCalculator.formatCurrency(result.ficaTax)}</div>
                        </div>
                        <div class="bg-gray-50 p-2 rounded">
                            <div class="text-gray-600">Effective Rate</div>
                            <div class="font-bold">${salaryCalculator.formatPercentage(result.effectiveTaxRate)}</div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Display comparison results
        function displayComparisonResults(result) {
            const resultsDiv = document.getElementById('comparison-results');
            const differenceColor = result.difference >= 0 ? 'text-green-600' : 'text-red-600';
            const percentageColor = result.percentageDifference >= 0 ? 'text-green-600' : 'text-red-600';
            
            resultsDiv.innerHTML = `
                <div class="space-y-3">
                    <div class="bg-white p-4 rounded-lg border">
                        <div class="text-sm text-gray-600">Total Compensation Difference</div>
                        <div class="text-xl font-bold ${differenceColor}">${salaryCalculator.formatCurrency(result.difference)}</div>
                    </div>
                    <div class="bg-white p-4 rounded-lg border">
                        <div class="text-sm text-gray-600">Percentage Change</div>
                        <div class="text-lg font-bold ${percentageColor}">${salaryCalculator.formatPercentage(result.percentageDifference)}</div>
                    </div>
                    <div class="grid grid-cols-2 gap-2 text-sm">
                        <div class="bg-blue-50 p-2 rounded">
                            <div class="text-gray-600">Current Total</div>
                            <div class="font-bold">${salaryCalculator.formatCurrency(result.totalCompensation1)}</div>
                        </div>
                        <div class="bg-green-50 p-2 rounded">
                            <div class="text-gray-600">New Total</div>
                            <div class="font-bold">${salaryCalculator.formatCurrency(result.totalCompensation2)}</div>
                        </div>
                    </div>
                    <div class="bg-yellow-50 p-3 rounded-lg border border-yellow-200">
                        <div class="text-sm text-yellow-800 font-medium">üí° Recommendation:</div>
                        <div class="text-xs text-yellow-600 mt-1">${result.betterOffer} is the better offer</div>
                    </div>
                </div>
            `;
        }

        // Display conversion results
        function displaySalaryConversionResults(result) {
            const resultsDiv = document.getElementById('salary-conversion-results');
            resultsDiv.innerHTML = `
                <div class="space-y-3">
                    <div class="bg-white p-4 rounded-lg border">
                        <div class="text-sm text-gray-600">Annual Salary</div>
                        <div class="text-2xl font-bold text-green-600">${salaryCalculator.formatCurrency(result.annualSalary)}</div>
                    </div>
                    <div class="bg-white p-4 rounded-lg border">
                        <div class="text-sm text-gray-600">Monthly Salary</div>
                        <div class="text-lg font-bold text-blue-600">${salaryCalculator.formatCurrency(result.monthlySalary)}</div>
                    </div>
                    <div class="bg-white p-4 rounded-lg border">
                        <div class="text-sm text-gray-600">Weekly Salary</div>
                        <div class="text-lg font-bold text-purple-600">${salaryCalculator.formatCurrency(result.weeklySalary)}</div>
                    </div>
                    <div class="bg-white p-4 rounded-lg border">
                        <div class="text-sm text-gray-600">Daily Salary</div>
                        <div class="text-lg font-bold text-indigo-600">${salaryCalculator.formatCurrency(result.dailySalary)}</div>
                    </div>
                </div>
            `;
        }

        // JSON Formatter Functions
        let jsonFormatter = null;

        // Initialize JSON Formatter
        function initializeJsonFormatter() {
            try {
                if (typeof JsonFormatter !== 'undefined') {
                    jsonFormatter = new JsonFormatter();
                    console.log('‚úÖ JSON Formatter initialized successfully');
                } else {
                    console.error('‚ùå JsonFormatter class not found');
                }
            } catch (error) {
                console.error('‚ùå JSON Formatter initialization failed:', error);
            }
        }

        // Format JSON
        function formatJson() {
            if (!jsonFormatter) {
                alert('JSON Formatter not initialized. Please refresh the page.');
                return;
            }

            const input = document.getElementById('json-input').value.trim();
            if (!input) {
                alert('Please enter JSON data to format.');
                return;
            }

            const result = jsonFormatter.formatJson(input);
            
            if (result.success) {
                document.getElementById('json-output').value = result.formatted;
                updateJsonOutputLineNumbers();
                hideAllResults();
                showValidationResults(result);
                jsonFormatter.addToHistory({
                    type: 'format',
                    input: input,
                    output: result.formatted,
                    size: result.size
                });
            } else {
                document.getElementById('json-output').value = '';
                updateJsonOutputLineNumbers();
                hideAllResults();
                showErrorResults(result);
            }
        }

        // Validate JSON
        function validateJson() {
            if (!jsonFormatter) {
                alert('JSON Formatter not initialized. Please refresh the page.');
                return;
            }

            const input = document.getElementById('json-input').value.trim();
            if (!input) {
                alert('Please enter JSON data to validate.');
                return;
            }

            const result = jsonFormatter.validateJson(input);
            
            if (result.success) {
                document.getElementById('json-output').value = JSON.stringify(result.parsed, null, 2);
                hideAllResults();
                showValidationResults(result);
                showStructureAnalysis(result.structure);
                jsonFormatter.addToHistory({
                    type: 'validate',
                    input: input,
                    valid: result.valid,
                    structure: result.structure
                });
            } else {
                document.getElementById('json-output').value = '';
                hideAllResults();
                showErrorResults(result);
            }
        }

        // Minify JSON
        function minifyJson() {
            if (!jsonFormatter) {
                alert('JSON Formatter not initialized. Please refresh the page.');
                return;
            }

            const input = document.getElementById('json-input').value.trim();
            if (!input) {
                alert('Please enter JSON data to minify.');
                return;
            }

            const result = jsonFormatter.minifyJson(input);
            
            if (result.success) {
                document.getElementById('json-output').value = result.minified;
                hideAllResults();
                showMinifyResults(result);
                jsonFormatter.addToHistory({
                    type: 'minify',
                    input: input,
                    output: result.minified,
                    size: result.size
                });
            } else {
                document.getElementById('json-output').value = '';
                hideAllResults();
                showErrorResults(result);
            }
        }

        // Convert JSON
        function convertJson(format) {
            if (!jsonFormatter) {
                alert('JSON Formatter not initialized. Please refresh the page.');
                return;
            }

            const input = document.getElementById('json-input').value.trim();
            if (!input) {
                alert('Please enter JSON data to convert.');
                return;
            }

            const result = jsonFormatter.convertJson(input, format);
            
            if (result.success) {
                document.getElementById('json-output').value = result.converted;
                hideAllResults();
                showConversionResults(result);
                jsonFormatter.addToHistory({
                    type: 'convert',
                    input: input,
                    output: result.converted,
                    format: result.format
                });
            } else {
                document.getElementById('json-output').value = '';
                hideAllResults();
                showErrorResults(result);
            }
        }

        // Clear JSON
        function clearJson() {
            document.getElementById('json-input').value = '';
            document.getElementById('json-output').value = '';
            // Clear line numbers and reset to single line
            document.getElementById('json-input-lines').innerHTML = '<div class="text-center text-xs" style="height: 24px; line-height: 24px; display: flex; align-items: center; justify-content: center;">1</div>';
            document.getElementById('json-output-lines').innerHTML = '<div class="text-center text-xs" style="height: 24px; line-height: 24px; display: flex; align-items: center; justify-content: center;">1</div>';
            hideAllResults();
        }

        // Copy JSON Output
        function copyJsonOutput() {
            const output = document.getElementById('json-output').value;
            if (!output) {
                alert('No output to copy.');
                return;
            }

            navigator.clipboard.writeText(output).then(() => {
                alert('Output copied to clipboard!');
            }).catch(() => {
                alert('Failed to copy to clipboard.');
            });
        }

        // Download JSON Output
        function downloadJsonOutput() {
            const output = document.getElementById('json-output').value;
            if (!output) {
                alert('No output to download.');
                return;
            }

            const blob = new Blob([output], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'json-output.txt';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // Show validation results
        function showValidationResults(result) {
            const resultsDiv = document.getElementById('validation-results');
            const contentDiv = document.getElementById('validation-content');
            
            let html = `
                <div class="flex items-center text-green-600 mb-2">
                    <span class="text-2xl mr-2">‚úÖ</span>
                    <span class="font-bold">Valid JSON</span>
                </div>
                <div class="text-sm text-gray-600">
                    Size: ${result.size || result.structure?.size || 'N/A'} characters
                </div>
            `;
            
            contentDiv.innerHTML = html;
            resultsDiv.classList.remove('hidden');
        }

        // Show minify results
        function showMinifyResults(result) {
            const resultsDiv = document.getElementById('validation-results');
            const contentDiv = document.getElementById('validation-content');
            
            let html = `
                <div class="flex items-center text-green-600 mb-2">
                    <span class="text-2xl mr-2">üì¶</span>
                    <span class="font-bold">Minified Successfully</span>
                </div>
                <div class="text-sm text-gray-600 space-y-1">
                    <div>Original: ${result.size.original} characters</div>
                    <div>Minified: ${result.size.minified} characters</div>
                    <div>Saved: ${result.size.saved} characters (${result.size.compression}% compression)</div>
                </div>
            `;
            
            contentDiv.innerHTML = html;
            resultsDiv.classList.remove('hidden');
        }

        // Show conversion results
        function showConversionResults(result) {
            const resultsDiv = document.getElementById('validation-results');
            const contentDiv = document.getElementById('validation-content');
            
            let html = `
                <div class="flex items-center text-green-600 mb-2">
                    <span class="text-2xl mr-2">üîÑ</span>
                    <span class="font-bold">Converted to ${result.format}</span>
                </div>
                <div class="text-sm text-gray-600">
                    Output size: ${result.converted.length} characters
                </div>
            `;
            
            contentDiv.innerHTML = html;
            resultsDiv.classList.remove('hidden');
        }

        // Show structure analysis
        function showStructureAnalysis(structure) {
            const resultsDiv = document.getElementById('structure-analysis');
            const contentDiv = document.getElementById('structure-content');
            
            let html = `
                <div class="grid grid-cols-2 gap-4 text-sm">
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="font-bold text-gray-700">Type</div>
                        <div class="text-blue-600">${structure.type}</div>
                    </div>
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="font-bold text-gray-700">Size</div>
                        <div class="text-blue-600">${structure.size}</div>
                    </div>
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="font-bold text-gray-700">Depth</div>
                        <div class="text-blue-600">${structure.depth}</div>
                    </div>
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="font-bold text-gray-700">Has Nested</div>
                        <div class="text-blue-600">${structure.hasNested ? 'Yes' : 'No'}</div>
                    </div>
                </div>
            `;
            
            if (structure.keys && structure.keys.length > 0) {
                html += `
                    <div class="mt-4">
                        <div class="font-bold text-gray-700 mb-2">Keys:</div>
                        <div class="flex flex-wrap gap-2">
                            ${structure.keys.map(key => `<span class="bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs">${key}</span>`).join('')}
                        </div>
                    </div>
                `;
            }
            
            contentDiv.innerHTML = html;
            resultsDiv.classList.remove('hidden');
        }

        // Show error results
        function showErrorResults(result) {
            const resultsDiv = document.getElementById('error-display');
            const contentDiv = document.getElementById('error-content');
            
            let html = `
                <div class="flex items-center text-red-600 mb-2">
                    <span class="text-2xl mr-2">‚ùå</span>
                    <span class="font-bold">JSON Syntax Error</span>
                </div>
                <div class="text-sm text-gray-600 space-y-3">
                    <div>
                        <div class="font-bold mb-1">Error Message:</div>
                        <div class="bg-red-50 p-3 rounded border-l-4 border-red-400 font-mono text-sm">${result.error}</div>
                    </div>
            `;
            
            if (result.line) {
                html += `
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700">Error Line</div>
                            <div class="text-red-600 font-bold">Line ${result.line}</div>
                        </div>
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700">File Size</div>
                            <div class="text-blue-600">${result.size} characters</div>
                        </div>
                    </div>
                `;
                
                // Show the problematic line if we can detect it
                const input = document.getElementById('json-input').value;
                const lines = input.split('\n');
                if (result.line <= lines.length) {
                    const problemLine = lines[result.line - 1];
                    html += `
                        <div class="bg-gray-50 p-3 rounded border">
                            <div class="font-bold text-gray-700 mb-1">Problematic Line ${result.line}:</div>
                            <div class="font-mono text-sm bg-white p-2 rounded border-l-4 border-red-400">${problemLine}</div>
                        </div>
                    `;
                }
            } else {
                html += `
                    <div class="bg-yellow-50 p-3 rounded border-l-4 border-yellow-400">
                        <div class="font-bold text-yellow-800">‚ö†Ô∏è Line number could not be determined</div>
                        <div class="text-sm text-yellow-700">Try checking for common JSON syntax errors manually</div>
                    </div>
                `;
            }
            
            // Add specific error suggestions based on error type
            let specificSuggestions = '';
            if (result.error.includes('Unterminated string')) {
                specificSuggestions = `
                    <div class="bg-blue-50 p-3 rounded border-l-4 border-blue-400">
                        <div class="font-bold text-blue-800 mb-2">üîç Unterminated String Fix:</div>
                        <ul class="text-sm text-blue-700 space-y-1">
                            <li>‚Ä¢ Look for missing closing quotes (")</li>
                            <li>‚Ä¢ Check for unescaped quotes inside strings</li>
                            <li>‚Ä¢ Ensure all string values are properly quoted</li>
                        </ul>
                    </div>
                `;
            } else if (result.error.includes('Unexpected token')) {
                specificSuggestions = `
                    <div class="bg-blue-50 p-3 rounded border-l-4 border-blue-400">
                        <div class="font-bold text-blue-800 mb-2">üîç Unexpected Token Fix:</div>
                        <ul class="text-sm text-blue-700 space-y-1">
                            <li>‚Ä¢ Check for missing commas between properties</li>
                            <li>‚Ä¢ Look for trailing commas before } or ]</li>
                            <li>‚Ä¢ Ensure property names are quoted</li>
                        </ul>
                    </div>
                `;
            }
            
            // Add common JSON error suggestions
            html += specificSuggestions + `
                <div class="bg-yellow-50 p-3 rounded border-l-4 border-yellow-400">
                    <div class="font-bold text-yellow-800 mb-2">üí° Common JSON Errors:</div>
                    <ul class="text-sm text-yellow-700 space-y-1">
                        <li>‚Ä¢ Missing commas between objects/arrays</li>
                        <li>‚Ä¢ Trailing commas (not allowed in JSON)</li>
                        <li>‚Ä¢ Unquoted property names</li>
                        <li>‚Ä¢ Single quotes instead of double quotes</li>
                        <li>‚Ä¢ Missing closing brackets/braces</li>
                    </ul>
                </div>
            `;
            
            html += `</div>`;
            
            contentDiv.innerHTML = html;
            resultsDiv.classList.remove('hidden');
        }

        // Hide all results
        function hideAllResults() {
            document.getElementById('validation-results').classList.add('hidden');
            document.getElementById('structure-analysis').classList.add('hidden');
            document.getElementById('error-display').classList.add('hidden');
        }

        // Update JSON input line numbers
        function updateJsonInputLineNumbers() {
            const textarea = document.getElementById('json-input');
            const linesDiv = document.getElementById('json-input-lines');
            
            // Get the actual content and split by lines
            const content = textarea.value;
            const lines = content.split('\n');
            
            // Calculate exact line count based on content
            let lineCount = lines.length;
            
            // If content is empty, show just one line
            if (content.trim() === '') {
                lineCount = 1;
            }
            
            let lineNumbers = '';
            for (let i = 1; i <= lineCount; i++) {
                lineNumbers += `<div class="text-center text-xs" style="height: 24px; line-height: 24px; display: flex; align-items: center; justify-content: center;">${i}</div>`;
            }
            
            linesDiv.innerHTML = lineNumbers;
        }

        // Update JSON output line numbers
        function updateJsonOutputLineNumbers() {
            const textarea = document.getElementById('json-output');
            const linesDiv = document.getElementById('json-output-lines');
            
            // Get the actual content and split by lines
            const content = textarea.value;
            const lines = content.split('\n');
            
            // Calculate exact line count based on content
            let lineCount = lines.length;
            
            // If content is empty, show just one line
            if (content.trim() === '') {
                lineCount = 1;
            }
            
            let lineNumbers = '';
            for (let i = 1; i <= lineCount; i++) {
                lineNumbers += `<div class="text-center text-xs" style="height: 24px; line-height: 24px; display: flex; align-items: center; justify-content: center;">${i}</div>`;
            }
            
            linesDiv.innerHTML = lineNumbers;
        }

        // Sync JSON input scroll
        function syncJsonInputScroll() {
            const textarea = document.getElementById('json-input');
            const linesDiv = document.getElementById('json-input-lines');
            linesDiv.scrollTop = textarea.scrollTop;
        }

        // Sync JSON output scroll
        function syncJsonOutputScroll() {
            const textarea = document.getElementById('json-output');
            const linesDiv = document.getElementById('json-output-lines');
            linesDiv.scrollTop = textarea.scrollTop;
        }

        // XML Formatter Functions
        let xmlFormatter = null;

        // Initialize XML Formatter
        function initializeXmlFormatter() {
            try {
                if (typeof XmlFormatter !== 'undefined') {
                    xmlFormatter = new XmlFormatter();
                    console.log('‚úÖ XML Formatter initialized successfully');
                } else {
                    console.error('‚ùå XmlFormatter class not found');
                }
            } catch (error) {
                console.error('‚ùå Error initializing XML Formatter:', error);
            }
        }

        // Initialize line numbers for XML formatter
        function initializeXmlLineNumbers() {
            updateXmlInputLineNumbers();
            updateXmlOutputLineNumbers();
        }

        // Format XML
        function formatXml() {
            if (!xmlFormatter) {
                alert('XML Formatter not initialized. Please refresh the page.');
                return;
            }

            const input = document.getElementById('xml-input').value.trim();
            if (!input) {
                alert('Please enter XML data to format.');
                return;
            }

            const result = xmlFormatter.formatXml(input);
            if (result.success) {
                document.getElementById('xml-output').value = result.formatted;
                updateXmlOutputLineNumbers();
                hideAllXmlResults();
                showXmlValidationResults(result);
                xmlFormatter.addToHistory('format', input, result.formatted);
            } else {
                document.getElementById('xml-output').value = '';
                updateXmlOutputLineNumbers();
                hideAllXmlResults();
                showXmlErrorResults(result);
            }
        }

        // Validate XML
        function validateXml() {
            if (!xmlFormatter) {
                alert('XML Formatter not initialized. Please refresh the page.');
                return;
            }

            const input = document.getElementById('xml-input').value.trim();
            if (!input) {
                alert('Please enter XML data to validate.');
                return;
            }

            const result = xmlFormatter.validateXml(input);
            if (result.success && result.isValid) {
                document.getElementById('xml-output').value = input;
                updateXmlOutputLineNumbers();
                hideAllXmlResults();
                showXmlValidationResults(result);
                showXmlStructureAnalysis(result);
                xmlFormatter.addToHistory('validate', input, 'Valid XML');
            } else {
                document.getElementById('xml-output').value = '';
                updateXmlOutputLineNumbers();
                hideAllXmlResults();
                showXmlErrorResults(result);
            }
        }

        // Minify XML
        function minifyXml() {
            if (!xmlFormatter) {
                alert('XML Formatter not initialized. Please refresh the page.');
                return;
            }

            const input = document.getElementById('xml-input').value.trim();
            if (!input) {
                alert('Please enter XML data to minify.');
                return;
            }

            const result = xmlFormatter.minifyXml(input);
            if (result.success) {
                document.getElementById('xml-output').value = result.minified;
                updateXmlOutputLineNumbers();
                hideAllXmlResults();
                showXmlMinifyResults(result);
                xmlFormatter.addToHistory('minify', input, result.minified);
            } else {
                document.getElementById('xml-output').value = '';
                updateXmlOutputLineNumbers();
                hideAllXmlResults();
                showXmlErrorResults(result);
            }
        }

        // Convert XML
        function convertXml(format) {
            if (!xmlFormatter) {
                alert('XML Formatter not initialized. Please refresh the page.');
                return;
            }

            const input = document.getElementById('xml-input').value.trim();
            if (!input) {
                alert('Please enter XML data to convert.');
                return;
            }

            const result = xmlFormatter.convertXml(input, format);
            if (result.success) {
                document.getElementById('xml-output').value = result.converted;
                updateXmlOutputLineNumbers();
                hideAllXmlResults();
                showXmlConversionResults(result);
                xmlFormatter.addToHistory('convert', input, result.converted, format);
            } else {
                document.getElementById('xml-output').value = '';
                updateXmlOutputLineNumbers();
                hideAllXmlResults();
                showXmlErrorResults(result);
            }
        }

        // Clear XML
        function clearXml() {
            document.getElementById('xml-input').value = '';
            document.getElementById('xml-output').value = '';
            // Clear line numbers and reset to single line
            document.getElementById('xml-input-lines').innerHTML = '<div class="text-center text-xs" style="height: 24px; line-height: 24px; display: flex; align-items: center; justify-content: center;">1</div>';
            document.getElementById('xml-output-lines').innerHTML = '<div class="text-center text-xs" style="height: 24px; line-height: 24px; display: flex; align-items: center; justify-content: center;">1</div>';
            hideAllXmlResults();
        }

        // Copy XML Output
        function copyXmlOutput() {
            const output = document.getElementById('xml-output').value;
            if (!output) {
                alert('No output to copy.');
                return;
            }

            navigator.clipboard.writeText(output).then(() => {
                alert('XML output copied to clipboard!');
            }).catch(err => {
                console.error('Failed to copy: ', err);
                alert('Failed to copy to clipboard.');
            });
        }

        // Download XML Output
        function downloadXmlOutput() {
            const output = document.getElementById('xml-output').value;
            if (!output) {
                alert('No output to download.');
                return;
            }

            const blob = new Blob([output], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'xml-output.txt';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // Show XML Validation Results
        function showXmlValidationResults(result) {
            const resultsDiv = document.getElementById('xml-validation-results');
            const contentDiv = document.getElementById('xml-validation-content');
            
            let html = `
                <div class="flex items-center text-green-600 mb-2">
                    <span class="text-2xl mr-2">‚úÖ</span>
                    <span class="font-bold">Valid XML</span>
                </div>
                <div class="text-sm text-gray-600 space-y-3">
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700">File Size</div>
                            <div class="text-blue-600">${result.size} characters</div>
                        </div>
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700">Elements</div>
                            <div class="text-green-600">${result.elementCount || 'N/A'}</div>
                        </div>
                    </div>
            `;
            
            if (result.attributeCount !== undefined) {
                html += `
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700">Attributes</div>
                            <div class="text-purple-600">${result.attributeCount}</div>
                        </div>
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700">Max Depth</div>
                            <div class="text-orange-600">${result.depth || 'N/A'}</div>
                        </div>
                    </div>
                `;
            }
            
            html += `</div>`;
            
            contentDiv.innerHTML = html;
            resultsDiv.classList.remove('hidden');
        }

        // Show XML Structure Analysis
        function showXmlStructureAnalysis(result) {
            const resultsDiv = document.getElementById('xml-structure-analysis');
            const contentDiv = document.getElementById('xml-structure-content');
            
            const structure = xmlFormatter.getXmlStructure(document.getElementById('xml-input').value);
            if (structure.success) {
                let html = `
                    <div class="space-y-4">
                        <div class="grid grid-cols-2 gap-4">
                            <div class="bg-white p-3 rounded-lg border">
                                <div class="font-bold text-gray-700">Has Declaration</div>
                                <div class="text-${structure.structure.hasDeclaration ? 'green' : 'red'}-600">${structure.structure.hasDeclaration ? 'Yes' : 'No'}</div>
                            </div>
                            <div class="bg-white p-3 rounded-lg border">
                                <div class="font-bold text-gray-700">Has Root Element</div>
                                <div class="text-${structure.structure.hasRoot ? 'green' : 'red'}-600">${structure.structure.hasRoot ? 'Yes' : 'No'}</div>
                            </div>
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div class="bg-white p-3 rounded-lg border">
                                <div class="font-bold text-gray-700">Has Comments</div>
                                <div class="text-${structure.structure.hasComments ? 'blue' : 'gray'}-600">${structure.structure.hasComments ? 'Yes' : 'No'}</div>
                            </div>
                            <div class="bg-white p-3 rounded-lg border">
                                <div class="font-bold text-gray-700">Has CDATA</div>
                                <div class="text-${structure.structure.hasCDATA ? 'purple' : 'gray'}-600">${structure.structure.hasCDATA ? 'Yes' : 'No'}</div>
                            </div>
                        </div>
                `;
                
                if (structure.structure.elements.length > 0) {
                    html += `
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700 mb-2">Elements Found</div>
                            <div class="flex flex-wrap gap-2">
                                ${structure.structure.elements.map(el => `<span class="bg-blue-100 text-blue-800 px-2 py-1 rounded text-sm">${el}</span>`).join('')}
                            </div>
                        </div>
                    `;
                }
                
                if (structure.structure.attributes.length > 0) {
                    html += `
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700 mb-2">Attributes Found</div>
                            <div class="flex flex-wrap gap-2">
                                ${structure.structure.attributes.map(attr => `<span class="bg-green-100 text-green-800 px-2 py-1 rounded text-sm">${attr}</span>`).join('')}
                            </div>
                        </div>
                    `;
                }
                
                html += `</div>`;
                contentDiv.innerHTML = html;
                resultsDiv.classList.remove('hidden');
            }
        }

        // Show XML Minify Results
        function showXmlMinifyResults(result) {
            const resultsDiv = document.getElementById('xml-validation-results');
            const contentDiv = document.getElementById('xml-validation-content');
            
            let html = `
                <div class="flex items-center text-orange-600 mb-2">
                    <span class="text-2xl mr-2">üóúÔ∏è</span>
                    <span class="font-bold">XML Minified</span>
                </div>
                <div class="text-sm text-gray-600 space-y-3">
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700">Original Size</div>
                            <div class="text-blue-600">${result.originalSize} characters</div>
                        </div>
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700">Minified Size</div>
                            <div class="text-green-600">${result.minifiedSize} characters</div>
                        </div>
                    </div>
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="font-bold text-gray-700">Compression Ratio</div>
                        <div class="text-orange-600">${result.compressionRatio}% smaller</div>
                    </div>
                </div>
            `;
            
            contentDiv.innerHTML = html;
            resultsDiv.classList.remove('hidden');
        }

        // Show XML Conversion Results
        function showXmlConversionResults(result) {
            const resultsDiv = document.getElementById('xml-validation-results');
            const contentDiv = document.getElementById('xml-validation-content');
            
            let html = `
                <div class="flex items-center text-purple-600 mb-2">
                    <span class="text-2xl mr-2">üîÑ</span>
                    <span class="font-bold">XML Converted to ${result.format.toUpperCase()}</span>
                </div>
                <div class="text-sm text-gray-600 space-y-3">
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700">Original Size</div>
                            <div class="text-blue-600">${result.originalSize} characters</div>
                        </div>
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700">Converted Size</div>
                            <div class="text-green-600">${result.convertedSize} characters</div>
                        </div>
                    </div>
                </div>
            `;
            
            contentDiv.innerHTML = html;
            resultsDiv.classList.remove('hidden');
        }

        // Show XML Error Results
        function showXmlErrorResults(result) {
            const resultsDiv = document.getElementById('xml-error-display');
            const contentDiv = document.getElementById('xml-error-content');
            
            let html = `
                <div class="flex items-center text-red-600 mb-2">
                    <span class="text-2xl mr-2">‚ùå</span>
                    <span class="font-bold">XML Error</span>
                </div>
                <div class="text-sm text-gray-600 space-y-3">
                    <div>
                        <div class="font-bold mb-1">Error Message:</div>
                        <div class="bg-red-50 p-3 rounded border-l-4 border-red-400 font-mono text-sm">${result.error}</div>
                    </div>
            `;
            
            if (result.line) {
                html += `
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700">Error Line</div>
                            <div class="text-red-600 font-bold">Line ${result.line}</div>
                        </div>
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700">File Size</div>
                            <div class="text-blue-600">${result.size} characters</div>
                        </div>
                    </div>
                `;
                
                // Show the problematic line if we can detect it
                const input = document.getElementById('xml-input').value;
                const lines = input.split('\n');
                if (result.line <= lines.length && result.line > 0) {
                    const problemLine = lines[result.line - 1];
                    // Escape HTML characters to prevent rendering issues
                    const escapedLine = problemLine.replace(/</g, '&lt;').replace(/>/g, '&gt;');
                    html += `
                        <div class="bg-gray-50 p-3 rounded border">
                            <div class="font-bold text-gray-700 mb-1">Problematic Line ${result.line}:</div>
                            <div class="font-mono text-sm bg-white p-2 rounded border-l-4 border-red-400">${escapedLine}</div>
                        </div>
                    `;
                }
            } else {
                html += `
                    <div class="bg-yellow-50 p-3 rounded border-l-4 border-yellow-400">
                        <div class="font-bold text-yellow-800">‚ö†Ô∏è Line number could not be determined</div>
                        <div class="text-sm text-yellow-700">Try checking for common XML syntax errors manually</div>
                    </div>
                `;
            }
            
            // Add specific error suggestions based on error type
            let specificSuggestions = '';
            if (result.error.includes('Unclosed tag') || result.error.includes('Malformed tag')) {
                specificSuggestions = `
                    <div class="bg-blue-50 p-3 rounded border-l-4 border-blue-400">
                        <div class="font-bold text-blue-800 mb-2">üîç Tag Error Fix:</div>
                        <ul class="text-sm text-blue-700 space-y-1">
                            <li>‚Ä¢ Check for missing closing '>' in tags</li>
                            <li>‚Ä¢ Ensure all opening tags have corresponding closing tags</li>
                            <li>‚Ä¢ Verify tag names don't contain invalid characters</li>
                        </ul>
                    </div>
                `;
            } else if (result.error.includes('Unclosed attribute')) {
                specificSuggestions = `
                    <div class="bg-blue-50 p-3 rounded border-l-4 border-blue-400">
                        <div class="font-bold text-blue-800 mb-2">üîç Attribute Error Fix:</div>
                        <ul class="text-sm text-blue-700 space-y-1">
                            <li>‚Ä¢ Check for missing closing quotes in attribute values</li>
                            <li>‚Ä¢ Ensure all attributes have proper quote pairs</li>
                            <li>‚Ä¢ Verify attribute syntax: name="value"</li>
                        </ul>
                    </div>
                `;
            }
            
            html += specificSuggestions + `
                <div class="bg-yellow-50 p-3 rounded border-l-4 border-yellow-400">
                    <div class="font-bold text-yellow-800 mb-2">üí° Common XML Errors:</div>
                    <ul class="text-sm text-yellow-700 space-y-1">
                        <li>‚Ä¢ Missing closing tags</li>
                        <li>‚Ä¢ Unclosed elements</li>
                        <li>‚Ä¢ Invalid characters in tag names</li>
                        <li>‚Ä¢ Mismatched quotes in attributes</li>
                        <li>‚Ä¢ Missing XML declaration</li>
                    </ul>
                </div>
            `;
            
            html += `</div>`;
            
            contentDiv.innerHTML = html;
            resultsDiv.classList.remove('hidden');
        }

        // Hide all XML results
        function hideAllXmlResults() {
            document.getElementById('xml-validation-results').classList.add('hidden');
            document.getElementById('xml-structure-analysis').classList.add('hidden');
            document.getElementById('xml-error-display').classList.add('hidden');
        }

        // Update XML input line numbers
        function updateXmlInputLineNumbers() {
            const textarea = document.getElementById('xml-input');
            const linesDiv = document.getElementById('xml-input-lines');
            
            // Get the actual content and split by lines
            const content = textarea.value;
            const lines = content.split('\n');
            
            // Calculate exact line count based on content
            let lineCount = lines.length;
            
            // If content is empty, show just one line
            if (content.trim() === '') {
                lineCount = 1;
            }
            
            let lineNumbers = '';
            for (let i = 1; i <= lineCount; i++) {
                lineNumbers += `<div class="text-center text-xs" style="height: 24px; line-height: 24px; display: flex; align-items: center; justify-content: center;">${i}</div>`;
            }
            
            linesDiv.innerHTML = lineNumbers;
        }

        // Update XML output line numbers
        function updateXmlOutputLineNumbers() {
            const textarea = document.getElementById('xml-output');
            const linesDiv = document.getElementById('xml-output-lines');
            
            // Get the actual content and split by lines
            const content = textarea.value;
            const lines = content.split('\n');
            
            // Calculate exact line count based on content
            let lineCount = lines.length;
            
            // If content is empty, show just one line
            if (content.trim() === '') {
                lineCount = 1;
            }
            
            let lineNumbers = '';
            for (let i = 1; i <= lineCount; i++) {
                lineNumbers += `<div class="text-center text-xs" style="height: 24px; line-height: 24px; display: flex; align-items: center; justify-content: center;">${i}</div>`;
            }
            
            linesDiv.innerHTML = lineNumbers;
        }

        // Sync XML input scroll
        function syncXmlInputScroll() {
            const textarea = document.getElementById('xml-input');
            const linesDiv = document.getElementById('xml-input-lines');
            linesDiv.scrollTop = textarea.scrollTop;
        }

        // Sync XML output scroll
        function syncXmlOutputScroll() {
            const textarea = document.getElementById('xml-output');
            const linesDiv = document.getElementById('xml-output-lines');
            linesDiv.scrollTop = textarea.scrollTop;
        }

        // Base64 Encoder Functions
        let base64Encoder = null;

        // Initialize Base64 Encoder
        function initializeBase64Encoder() {
            try {
                if (typeof Base64Encoder !== 'undefined') {
                    base64Encoder = new Base64Encoder();
                    console.log('‚úÖ Base64 Encoder initialized successfully');
                } else {
                    console.error('‚ùå Base64Encoder class not found');
                }
            } catch (error) {
                console.error('‚ùå Error initializing Base64 Encoder:', error);
            }
        }

        // Initialize line numbers for Base64 encoder
        function initializeBase64LineNumbers() {
            updateBase64InputLineNumbers();
            updateBase64OutputLineNumbers();
        }

        // Update Base64 input line numbers
        function updateBase64InputLineNumbers() {
            const textarea = document.getElementById('base64-input');
            const linesDiv = document.getElementById('base64-input-lines');
            
            // Get the actual content and split by lines
            const content = textarea.value;
            const lines = content.split('\n');
            
            // Calculate exact line count based on content
            let lineCount = lines.length;
            
            // If content is empty, show just one line
            if (content.trim() === '') {
                lineCount = 1;
            }
            
            let lineNumbers = '';
            for (let i = 1; i <= lineCount; i++) {
                lineNumbers += `<div class="text-center text-xs" style="height: 24px; line-height: 24px; display: flex; align-items: center; justify-content: center;">${i}</div>`;
            }
            
            linesDiv.innerHTML = lineNumbers;
        }

        // Update Base64 output line numbers
        function updateBase64OutputLineNumbers() {
            const textarea = document.getElementById('base64-output');
            const linesDiv = document.getElementById('base64-output-lines');
            
            // Get the actual content and split by lines
            const content = textarea.value;
            const lines = content.split('\n');
            
            // Calculate exact line count based on content
            let lineCount = lines.length;
            
            // If content is empty, show just one line
            if (content.trim() === '') {
                lineCount = 1;
            }
            
            let lineNumbers = '';
            for (let i = 1; i <= lineCount; i++) {
                lineNumbers += `<div class="text-center text-xs" style="height: 24px; line-height: 24px; display: flex; align-items: center; justify-content: center;">${i}</div>`;
            }
            
            linesDiv.innerHTML = lineNumbers;
        }

        // Sync Base64 input scroll
        function syncBase64InputScroll() {
            const textarea = document.getElementById('base64-input');
            const linesDiv = document.getElementById('base64-input-lines');
            linesDiv.scrollTop = textarea.scrollTop;
        }

        // Sync Base64 output scroll
        function syncBase64OutputScroll() {
            const textarea = document.getElementById('base64-output');
            const linesDiv = document.getElementById('base64-output-lines');
            linesDiv.scrollTop = textarea.scrollTop;
        }

        // Encode Base64
        function encodeBase64() {
            if (!base64Encoder) {
                alert('Base64 Encoder not initialized. Please refresh the page.');
                return;
            }

            const input = document.getElementById('base64-input').value.trim();
            if (!input) {
                alert('Please enter text to encode.');
                return;
            }

            const options = {
                urlSafe: document.getElementById('url-safe').checked,
                addLineBreaks: document.getElementById('line-breaks').checked,
                padding: !document.getElementById('no-padding').checked
            };

            const result = base64Encoder.encodeText(input, options);
            if (result.success) {
                document.getElementById('base64-output').value = result.encoded;
                updateBase64OutputLineNumbers();
                hideAllBase64Results();
                showBase64AnalysisResults(result);
                base64Encoder.addToHistory('encode', input, result.encoded, 'text');
            } else {
                document.getElementById('base64-output').value = '';
                updateBase64OutputLineNumbers();
                hideAllBase64Results();
                showBase64ErrorResults(result);
            }
        }

        // Decode Base64
        function decodeBase64() {
            if (!base64Encoder) {
                alert('Base64 Encoder not initialized. Please refresh the page.');
                return;
            }

            const input = document.getElementById('base64-input').value.trim();
            if (!input) {
                alert('Please enter Base64 to decode.');
                return;
            }

            const options = {
                urlSafe: document.getElementById('url-safe').checked,
                strict: false
            };

            const result = base64Encoder.decodeText(input, options);
            if (result.success) {
                document.getElementById('base64-output').value = result.decoded;
                updateBase64OutputLineNumbers();
                hideAllBase64Results();
                showBase64AnalysisResults(result);
                base64Encoder.addToHistory('decode', input, result.decoded, 'text');
            } else {
                document.getElementById('base64-output').value = '';
                updateBase64OutputLineNumbers();
                hideAllBase64Results();
                showBase64ErrorResults(result);
            }
        }

        // Validate Base64
        function validateBase64() {
            if (!base64Encoder) {
                alert('Base64 Encoder not initialized. Please refresh the page.');
                return;
            }

            const input = document.getElementById('base64-input').value.trim();
            if (!input) {
                alert('Please enter Base64 to validate.');
                return;
            }

            const options = {
                urlSafe: document.getElementById('url-safe').checked,
                strict: true
            };

            const result = base64Encoder.validateBase64(input, options);
            if (result.success && result.isValid) {
                hideAllBase64Results();
                showBase64ValidationResults(result);
                const info = base64Encoder.getBase64Info(input);
                if (info.success) {
                    showBase64AnalysisResults(info);
                }
            } else {
                hideAllBase64Results();
                showBase64ErrorResults(result);
            }
        }

        // Handle file upload
        function handleFileUpload() {
            const fileInput = document.getElementById('base64-file-input');
            const file = fileInput.files[0];
            
            if (!file) return;

            if (!base64Encoder) {
                alert('Base64 Encoder not initialized. Please refresh the page.');
                return;
            }

            const options = {
                urlSafe: document.getElementById('url-safe').checked,
                addLineBreaks: document.getElementById('line-breaks').checked,
                padding: !document.getElementById('no-padding').checked
            };

            base64Encoder.encodeFile(file, options).then(result => {
                if (result.success) {
                    document.getElementById('base64-output').value = result.encoded;
                    updateBase64OutputLineNumbers();
                    hideAllBase64Results();
                    showBase64AnalysisResults(result);
                    base64Encoder.addToHistory('encode', file.name, result.encoded, 'file');
                } else {
                    document.getElementById('base64-output').value = '';
                    updateBase64OutputLineNumbers();
                    hideAllBase64Results();
                    showBase64ErrorResults(result);
                }
            });
        }

        // Clear Base64
        function clearBase64() {
            document.getElementById('base64-input').value = '';
            document.getElementById('base64-output').value = '';
            document.getElementById('base64-file-input').value = '';
            // Clear line numbers and reset to single line
            document.getElementById('base64-input-lines').innerHTML = '<div class="text-center text-xs" style="height: 24px; line-height: 24px; display: flex; align-items: center; justify-content: center;">1</div>';
            document.getElementById('base64-output-lines').innerHTML = '<div class="text-center text-xs" style="height: 24px; line-height: 24px; display: flex; align-items: center; justify-content: center;">1</div>';
            hideAllBase64Results();
        }

        // Copy Base64 Output
        function copyBase64Output() {
            const output = document.getElementById('base64-output').value;
            if (!output) {
                alert('No output to copy.');
                return;
            }

            navigator.clipboard.writeText(output).then(() => {
                alert('Base64 output copied to clipboard!');
            }).catch(err => {
                console.error('Failed to copy: ', err);
                alert('Failed to copy to clipboard.');
            });
        }

        // Download Base64 Output
        function downloadBase64Output() {
            const output = document.getElementById('base64-output').value;
            if (!output) {
                alert('No output to download.');
                return;
            }

            const blob = new Blob([output], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'base64-output.txt';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // Show Base64 Analysis Results
        function showBase64AnalysisResults(result) {
            const resultsDiv = document.getElementById('base64-analysis-results');
            const contentDiv = document.getElementById('base64-analysis-content');
            
            let html = `
                <div class="flex items-center text-blue-600 mb-2">
                    <span class="text-2xl mr-2">üìä</span>
                    <span class="font-bold">Base64 Analysis</span>
                </div>
                <div class="text-sm text-gray-600 space-y-3">
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700">Original Size</div>
                            <div class="text-blue-600">${result.originalSize} characters</div>
                        </div>
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700">${result.type === 'text' ? 'Encoded' : 'Decoded'} Size</div>
                            <div class="text-green-600">${result.encodedSize || result.decodedSize} characters</div>
                        </div>
                    </div>
            `;
            
            if (result.compressionRatio) {
                html += `
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="font-bold text-gray-700">Size Change</div>
                        <div class="text-${result.compressionRatio > 0 ? 'red' : 'green'}-600">${result.compressionRatio}% ${result.compressionRatio > 0 ? 'larger' : 'smaller'}</div>
                    </div>
                `;
            }
            
            if (result.fileName) {
                html += `
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="font-bold text-gray-700">File Name</div>
                        <div class="text-purple-600">${result.fileName}</div>
                    </div>
                `;
            }
            
            html += `</div>`;
            
            contentDiv.innerHTML = html;
            resultsDiv.classList.remove('hidden');
        }

        // Show Base64 Validation Results
        function showBase64ValidationResults(result) {
            const resultsDiv = document.getElementById('base64-validation-results');
            const contentDiv = document.getElementById('base64-validation-content');
            
            let html = `
                <div class="flex items-center text-green-600 mb-2">
                    <span class="text-2xl mr-2">‚úÖ</span>
                    <span class="font-bold">Valid Base64</span>
                </div>
                <div class="text-sm text-gray-600 space-y-3">
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700">Size</div>
                            <div class="text-blue-600">${result.size} characters</div>
                        </div>
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700">Type</div>
                            <div class="text-green-600">${result.type}</div>
                        </div>
                    </div>
            `;
            
            if (result.cleanSize) {
                html += `
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="font-bold text-gray-700">Clean Size</div>
                        <div class="text-purple-600">${result.cleanSize} characters</div>
                    </div>
                `;
            }
            
            html += `</div>`;
            
            contentDiv.innerHTML = html;
            resultsDiv.classList.remove('hidden');
        }

        // Show Base64 Error Results
        function showBase64ErrorResults(result) {
            const resultsDiv = document.getElementById('base64-error-display');
            const contentDiv = document.getElementById('base64-error-content');
            
            let html = `
                <div class="flex items-center text-red-600 mb-2">
                    <span class="text-2xl mr-2">‚ùå</span>
                    <span class="font-bold">Base64 Error</span>
                </div>
                <div class="text-sm text-gray-600 space-y-3">
                    <div>
                        <div class="font-bold mb-1">Error Message:</div>
                        <div class="bg-red-50 p-3 rounded border-l-4 border-red-400 font-mono text-sm">${result.error}</div>
                    </div>
            `;
            
            if (result.originalSize) {
                html += `
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="font-bold text-gray-700">Input Size</div>
                        <div class="text-blue-600">${result.originalSize} characters</div>
                    </div>
                `;
            }
            
            html += `
                <div class="bg-yellow-50 p-3 rounded border-l-4 border-yellow-400">
                    <div class="font-bold text-yellow-800 mb-2">üí° Common Base64 Issues:</div>
                    <ul class="text-sm text-yellow-700 space-y-1">
                        <li>‚Ä¢ Invalid characters in Base64 string</li>
                        <li>‚Ä¢ Incorrect padding</li>
                        <li>‚Ä¢ Mixed URL-safe and standard Base64</li>
                        <li>‚Ä¢ Line breaks in the middle of data</li>
                    </ul>
                </div>
            `;
            
            html += `</div>`;
            
            contentDiv.innerHTML = html;
            resultsDiv.classList.remove('hidden');
        }

        // Hide all Base64 results
        function hideAllBase64Results() {
            document.getElementById('base64-analysis-results').classList.add('hidden');
            document.getElementById('base64-validation-results').classList.add('hidden');
            document.getElementById('base64-error-display').classList.add('hidden');
        }

        // Hash Generator Functions
        let hashGenerator = null;

        // Initialize Hash Generator
        function initializeHashGenerator() {
            try {
                if (typeof HashGenerator !== 'undefined') {
                    hashGenerator = new HashGenerator();
                    console.log('‚úÖ Hash Generator initialized successfully');
                } else {
                    console.error('‚ùå HashGenerator class not found');
                }
            } catch (error) {
                console.error('‚ùå Error initializing Hash Generator:', error);
            }
        }

        // Initialize line numbers for Hash generator
        function initializeHashLineNumbers() {
            updateHashInputLineNumbers();
            updateHashOutputLineNumbers();
        }

        // Update Hash input line numbers
        function updateHashInputLineNumbers() {
            const textarea = document.getElementById('hash-input');
            const linesDiv = document.getElementById('hash-input-lines');
            
            // Get the actual content and split by lines
            const content = textarea.value;
            const lines = content.split('\n');
            
            // Calculate exact line count based on content
            let lineCount = lines.length;
            
            // If content is empty, show just one line
            if (content.trim() === '') {
                lineCount = 1;
            }
            
            let lineNumbers = '';
            for (let i = 1; i <= lineCount; i++) {
                lineNumbers += `<div class="text-center text-xs" style="height: 24px; line-height: 24px; display: flex; align-items: center; justify-content: center;">${i}</div>`;
            }
            
            linesDiv.innerHTML = lineNumbers;
        }

        // Update Hash output line numbers
        function updateHashOutputLineNumbers() {
            const textarea = document.getElementById('hash-output');
            const linesDiv = document.getElementById('hash-output-lines');
            
            // Get the actual content and split by lines
            const content = textarea.value;
            const lines = content.split('\n');
            
            // Calculate exact line count based on content
            let lineCount = lines.length;
            
            // If content is empty, show just one line
            if (content.trim() === '') {
                lineCount = 1;
            }
            
            let lineNumbers = '';
            for (let i = 1; i <= lineCount; i++) {
                lineNumbers += `<div class="text-center text-xs" style="height: 24px; line-height: 24px; display: flex; align-items: center; justify-content: center;">${i}</div>`;
            }
            
            linesDiv.innerHTML = lineNumbers;
        }

        // Sync Hash input scroll
        function syncHashInputScroll() {
            const textarea = document.getElementById('hash-input');
            const linesDiv = document.getElementById('hash-input-lines');
            linesDiv.scrollTop = textarea.scrollTop;
        }

        // Sync Hash output scroll
        function syncHashOutputScroll() {
            const textarea = document.getElementById('hash-output');
            const linesDiv = document.getElementById('hash-output-lines');
            linesDiv.scrollTop = textarea.scrollTop;
        }

        // Generate Hash
        async function generateHash() {
            if (!hashGenerator) {
                alert('Hash Generator not initialized. Please refresh the page.');
                return;
            }

            const input = document.getElementById('hash-input').value.trim();
            if (!input) {
                alert('Please enter text to hash.');
                return;
            }

            const algorithm = document.getElementById('hash-algorithm').value;
            const options = {
                encoding: document.getElementById('hash-base64').checked ? 'base64' : 
                         document.getElementById('hash-binary').checked ? 'binary' : 'hex',
                iterations: parseInt(document.getElementById('hash-iterations').value),
                salt: document.getElementById('hash-salt').value,
                uppercase: document.getElementById('hash-uppercase').checked
            };

            try {
                const result = await hashGenerator.generateHash(input, algorithm, options);
                if (result.success) {
                    document.getElementById('hash-output').value = result.hash;
                    updateHashOutputLineNumbers();
                    hideAllHashResults();
                    showHashAnalysisResults(result);
                    hashGenerator.addToHistory('generate', input, result.hash, algorithm);
                } else {
                    document.getElementById('hash-output').value = '';
                    updateHashOutputLineNumbers();
                    hideAllHashResults();
                    showHashErrorResults(result);
                }
            } catch (error) {
                document.getElementById('hash-output').value = '';
                updateHashOutputLineNumbers();
                hideAllHashResults();
                showHashErrorResults({ success: false, error: error.message });
            }
        }

        // Generate Multiple Hashes
        async function generateMultipleHashes() {
            if (!hashGenerator) {
                alert('Hash Generator not initialized. Please refresh the page.');
                return;
            }

            const input = document.getElementById('hash-input').value.trim();
            if (!input) {
                alert('Please enter text to hash.');
                return;
            }

            const algorithms = ['MD5', 'SHA-1', 'SHA-224', 'SHA-256', 'SHA-384', 'SHA-512'];
            const options = {
                encoding: document.getElementById('hash-base64').checked ? 'base64' : 
                         document.getElementById('hash-binary').checked ? 'binary' : 'hex',
                iterations: parseInt(document.getElementById('hash-iterations').value),
                salt: document.getElementById('hash-salt').value,
                uppercase: document.getElementById('hash-uppercase').checked
            };

            try {
                const result = await hashGenerator.generateMultipleHashes(input, algorithms, options);
                if (result.success) {
                    let output = '';
                    for (const [algorithm, hashResult] of Object.entries(result.results)) {
                        output += `${algorithm}: ${hashResult.hash}\n`;
                    }
                    document.getElementById('hash-output').value = output;
                    updateHashOutputLineNumbers();
                    hideAllHashResults();
                    showHashMultipleResults(result);
                } else {
                    document.getElementById('hash-output').value = '';
                    updateHashOutputLineNumbers();
                    hideAllHashResults();
                    showHashErrorResults(result);
                }
            } catch (error) {
                document.getElementById('hash-output').value = '';
                updateHashOutputLineNumbers();
                hideAllHashResults();
                showHashErrorResults({ success: false, error: error.message });
            }
        }

        // Verify Hash
        async function verifyHash() {
            if (!hashGenerator) {
                alert('Hash Generator not initialized. Please refresh the page.');
                return;
            }

            const input = document.getElementById('hash-input').value.trim();
            const hashToVerify = document.getElementById('hash-output').value.trim();
            
            if (!input) {
                alert('Please enter text to verify.');
                return;
            }
            
            if (!hashToVerify) {
                alert('Please generate a hash first or enter a hash to verify.');
                return;
            }

            const algorithm = document.getElementById('hash-algorithm').value;
            const options = {
                encoding: document.getElementById('hash-base64').checked ? 'base64' : 
                         document.getElementById('hash-binary').checked ? 'binary' : 'hex',
                iterations: parseInt(document.getElementById('hash-iterations').value),
                salt: document.getElementById('hash-salt').value,
                uppercase: document.getElementById('hash-uppercase').checked
            };

            try {
                const result = await hashGenerator.verifyHash(input, hashToVerify, algorithm, options);
                if (result.success) {
                    hideAllHashResults();
                    showHashVerificationResults(result);
                } else {
                    hideAllHashResults();
                    showHashErrorResults(result);
                }
            } catch (error) {
                hideAllHashResults();
                showHashErrorResults({ success: false, error: error.message });
            }
        }

        // Handle file upload
        async function handleHashFileUpload() {
            const fileInput = document.getElementById('hash-file-input');
            const file = fileInput.files[0];
            
            if (!file) return;

            if (!hashGenerator) {
                alert('Hash Generator not initialized. Please refresh the page.');
                return;
            }

            const algorithm = document.getElementById('hash-algorithm').value;
            const options = {
                encoding: document.getElementById('hash-base64').checked ? 'base64' : 
                         document.getElementById('hash-binary').checked ? 'binary' : 'hex',
                iterations: parseInt(document.getElementById('hash-iterations').value),
                uppercase: document.getElementById('hash-uppercase').checked
            };

            try {
                const result = await hashGenerator.generateFileHash(file, algorithm, options);
                if (result.success) {
                    document.getElementById('hash-output').value = result.hash;
                    updateHashOutputLineNumbers();
                    hideAllHashResults();
                    showHashAnalysisResults(result);
                    hashGenerator.addToHistory('generate', file.name, result.hash, algorithm);
                } else {
                    document.getElementById('hash-output').value = '';
                    updateHashOutputLineNumbers();
                    hideAllHashResults();
                    showHashErrorResults(result);
                }
            } catch (error) {
                document.getElementById('hash-output').value = '';
                updateHashOutputLineNumbers();
                hideAllHashResults();
                showHashErrorResults({ success: false, error: error.message });
            }
        }

        // Clear Hash
        function clearHash() {
            document.getElementById('hash-input').value = '';
            document.getElementById('hash-output').value = '';
            document.getElementById('hash-file-input').value = '';
            document.getElementById('hash-salt').value = '';
            document.getElementById('hash-iterations').value = '1';
            document.getElementById('hash-uppercase').checked = false;
            document.getElementById('hash-base64').checked = false;
            document.getElementById('hash-binary').checked = false;
            // Clear line numbers and reset to single line
            document.getElementById('hash-input-lines').innerHTML = '<div class="text-center text-xs" style="height: 24px; line-height: 24px; display: flex; align-items: center; justify-content: center;">1</div>';
            document.getElementById('hash-output-lines').innerHTML = '<div class="text-center text-xs" style="height: 24px; line-height: 24px; display: flex; align-items: center; justify-content: center;">1</div>';
            hideAllHashResults();
        }

        // Copy Hash Output
        function copyHashOutput() {
            const output = document.getElementById('hash-output').value;
            if (!output) {
                alert('No hash to copy.');
                return;
            }

            navigator.clipboard.writeText(output).then(() => {
                alert('Hash copied to clipboard!');
            }).catch(err => {
                console.error('Failed to copy: ', err);
                alert('Failed to copy to clipboard.');
            });
        }

        // Download Hash Output
        function downloadHashOutput() {
            const output = document.getElementById('hash-output').value;
            if (!output) {
                alert('No hash to download.');
                return;
            }

            const blob = new Blob([output], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'hash-output.txt';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // Show Hash Analysis Results
        function showHashAnalysisResults(result) {
            const resultsDiv = document.getElementById('hash-analysis-results');
            const contentDiv = document.getElementById('hash-analysis-content');
            
            let html = `
                <div class="flex items-center text-blue-600 mb-2">
                    <span class="text-2xl mr-2">üîç</span>
                    <span class="font-bold">Hash Analysis</span>
                </div>
                <div class="text-sm text-gray-600 space-y-3">
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700">Algorithm</div>
                            <div class="text-blue-600">${result.algorithm}</div>
                        </div>
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700">Encoding</div>
                            <div class="text-green-600">${result.encoding}</div>
                        </div>
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700">Input Length</div>
                            <div class="text-purple-600">${result.inputLength} characters</div>
                        </div>
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700">Hash Length</div>
                            <div class="text-orange-600">${result.hashLength} characters</div>
                        </div>
                    </div>
            `;
            
            if (result.iterations > 1) {
                html += `
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="font-bold text-gray-700">Iterations</div>
                        <div class="text-red-600">${result.iterations}</div>
                    </div>
                `;
            }
            
            if (result.salt) {
                html += `
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="font-bold text-gray-700">Salt Applied</div>
                        <div class="text-indigo-600">Yes</div>
                    </div>
                `;
            }
            
            if (result.fileName) {
                html += `
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="font-bold text-gray-700">File Name</div>
                        <div class="text-teal-600">${result.fileName}</div>
                    </div>
                `;
            }
            
            html += `</div>`;
            
            contentDiv.innerHTML = html;
            resultsDiv.classList.remove('hidden');
        }

        // Show Hash Multiple Results
        function showHashMultipleResults(result) {
            const resultsDiv = document.getElementById('hash-multiple-results');
            const contentDiv = document.getElementById('hash-multiple-content');
            
            let html = `
                <div class="flex items-center text-green-600 mb-2">
                    <span class="text-2xl mr-2">üîê</span>
                    <span class="font-bold">Multiple Hash Results</span>
                </div>
                <div class="text-sm text-gray-600 space-y-3">
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700">Total Algorithms</div>
                            <div class="text-blue-600">${result.totalAlgorithms}</div>
                        </div>
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700">Successful</div>
                            <div class="text-green-600">${result.successfulAlgorithms}</div>
                        </div>
                    </div>
            `;
            
            if (result.failedAlgorithms > 0) {
                html += `
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="font-bold text-gray-700">Failed</div>
                        <div class="text-red-600">${result.failedAlgorithms}</div>
                    </div>
                `;
            }
            
            html += `</div>`;
            
            contentDiv.innerHTML = html;
            resultsDiv.classList.remove('hidden');
        }

        // Show Hash Verification Results
        function showHashVerificationResults(result) {
            const resultsDiv = document.getElementById('hash-verification-results');
            const contentDiv = document.getElementById('hash-verification-content');
            
            let html = `
                <div class="flex items-center text-purple-600 mb-2">
                    <span class="text-2xl mr-2">${result.isMatch ? '‚úÖ' : '‚ùå'}</span>
                    <span class="font-bold">Hash Verification</span>
                </div>
                <div class="text-sm text-gray-600 space-y-3">
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="font-bold text-gray-700">Result</div>
                        <div class="text-${result.isMatch ? 'green' : 'red'}-600 font-bold">${result.match}</div>
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700">Algorithm</div>
                            <div class="text-blue-600">${result.algorithm}</div>
                        </div>
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700">Provided Hash</div>
                            <div class="text-purple-600 font-mono text-xs break-all">${result.providedHash.substring(0, 32)}...</div>
                        </div>
                    </div>
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="font-bold text-gray-700">Generated Hash</div>
                        <div class="text-orange-600 font-mono text-xs break-all">${result.generatedHash.substring(0, 32)}...</div>
                    </div>
                </div>
            `;
            
            contentDiv.innerHTML = html;
            resultsDiv.classList.remove('hidden');
        }

        // Show Hash Error Results
        function showHashErrorResults(result) {
            const resultsDiv = document.getElementById('hash-error-display');
            const contentDiv = document.getElementById('hash-error-content');
            
            let html = `
                <div class="flex items-center text-red-600 mb-2">
                    <span class="text-2xl mr-2">‚ùå</span>
                    <span class="font-bold">Hash Error</span>
                </div>
                <div class="text-sm text-gray-600 space-y-3">
                    <div>
                        <div class="font-bold mb-1">Error Message:</div>
                        <div class="bg-red-50 p-3 rounded border-l-4 border-red-400 font-mono text-sm">${result.error}</div>
                    </div>
            `;
            
            if (result.algorithm) {
                html += `
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="font-bold text-gray-700">Algorithm</div>
                        <div class="text-blue-600">${result.algorithm}</div>
                    </div>
                `;
            }
            
            if (result.inputLength) {
                html += `
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="font-bold text-gray-700">Input Length</div>
                        <div class="text-purple-600">${result.inputLength} characters</div>
                    </div>
                `;
            }
            
            html += `
                <div class="bg-yellow-50 p-3 rounded border-l-4 border-yellow-400">
                    <div class="font-bold text-yellow-800 mb-2">üí° Common Hash Issues:</div>
                    <ul class="text-sm text-yellow-700 space-y-1">
                        <li>‚Ä¢ Invalid input characters</li>
                        <li>‚Ä¢ Unsupported algorithm</li>
                        <li>‚Ä¢ File too large for processing</li>
                        <li>‚Ä¢ Browser compatibility issues</li>
                    </ul>
                </div>
            `;
            
            html += `</div>`;
            
            contentDiv.innerHTML = html;
            resultsDiv.classList.remove('hidden');
        }

        // Hide all Hash results
        function hideAllHashResults() {
            document.getElementById('hash-analysis-results').classList.add('hidden');
            document.getElementById('hash-multiple-results').classList.add('hidden');
            document.getElementById('hash-verification-results').classList.add('hidden');
            document.getElementById('hash-error-display').classList.add('hidden');
        }

        // URL Encoder Functions
        let urlEncoder = null;
        let queryParams = {};

        // Initialize URL Encoder
        function initializeUrlEncoder() {
            try {
                if (typeof UrlEncoder !== 'undefined') {
                    urlEncoder = new UrlEncoder();
                    console.log('‚úÖ URL Encoder initialized successfully');
                } else {
                    console.error('‚ùå UrlEncoder class not found');
                }
            } catch (error) {
                console.error('‚ùå Error initializing URL Encoder:', error);
            }
        }

        // Initialize line numbers for URL encoder
        function initializeUrlLineNumbers() {
            updateUrlInputLineNumbers();
            updateUrlOutputLineNumbers();
        }

        // Update URL input line numbers
        function updateUrlInputLineNumbers() {
            const textarea = document.getElementById('url-input');
            const linesDiv = document.getElementById('url-input-lines');
            
            // Get the actual content and split by lines
            const content = textarea.value;
            const lines = content.split('\n');
            
            // Calculate exact line count based on content
            let lineCount = lines.length;
            
            // If content is empty, show just one line
            if (content.trim() === '') {
                lineCount = 1;
            }
            
            let lineNumbers = '';
            for (let i = 1; i <= lineCount; i++) {
                lineNumbers += `<div class="text-center text-xs" style="height: 24px; line-height: 24px; display: flex; align-items: center; justify-content: center;">${i}</div>`;
            }
            
            linesDiv.innerHTML = lineNumbers;
        }

        // Update URL output line numbers
        function updateUrlOutputLineNumbers() {
            const textarea = document.getElementById('url-output');
            const linesDiv = document.getElementById('url-output-lines');
            
            // Get the actual content and split by lines
            const content = textarea.value;
            const lines = content.split('\n');
            
            // Calculate exact line count based on content
            let lineCount = lines.length;
            
            // If content is empty, show just one line
            if (content.trim() === '') {
                lineCount = 1;
            }
            
            let lineNumbers = '';
            for (let i = 1; i <= lineCount; i++) {
                lineNumbers += `<div class="text-center text-xs" style="height: 24px; line-height: 24px; display: flex; align-items: center; justify-content: center;">${i}</div>`;
            }
            
            linesDiv.innerHTML = lineNumbers;
        }

        // Sync URL input scroll
        function syncUrlInputScroll() {
            const textarea = document.getElementById('url-input');
            const linesDiv = document.getElementById('url-input-lines');
            linesDiv.scrollTop = textarea.scrollTop;
        }

        // Sync URL output scroll
        function syncUrlOutputScroll() {
            const textarea = document.getElementById('url-output');
            const linesDiv = document.getElementById('url-output-lines');
            linesDiv.scrollTop = textarea.scrollTop;
        }

        // Add Query Parameter
        function addQueryParam() {
            const key = document.getElementById('query-key').value.trim();
            const value = document.getElementById('query-value').value.trim();
            
            if (!key) {
                alert('Please enter a parameter name.');
                return;
            }
            
            queryParams[key] = value;
            updateQueryParamsList();
            
            // Clear inputs
            document.getElementById('query-key').value = '';
            document.getElementById('query-value').value = '';
        }

        // Update Query Parameters List
        function updateQueryParamsList() {
            const listDiv = document.getElementById('query-params-list');
            listDiv.innerHTML = '';
            
            for (const [key, value] of Object.entries(queryParams)) {
                const paramDiv = document.createElement('div');
                paramDiv.className = 'flex items-center justify-between bg-gray-50 p-2 rounded border';
                paramDiv.innerHTML = `
                    <span class="text-sm font-mono">${key} = ${value}</span>
                    <button onclick="removeQueryParam('${key}')" class="text-red-500 hover:text-red-700 text-sm font-bold">√ó</button>
                `;
                listDiv.appendChild(paramDiv);
            }
        }

        // Remove Query Parameter
        function removeQueryParam(key) {
            delete queryParams[key];
            updateQueryParamsList();
        }

        // Encode URL
        function encodeUrl() {
            if (!urlEncoder) {
                alert('URL Encoder not initialized. Please refresh the page.');
                return;
            }

            let input = document.getElementById('url-input').value.trim();
            if (!input) {
                alert('Please enter a URL to encode.');
                return;
            }

            // Add query parameters if any
            if (Object.keys(queryParams).length > 0) {
                const baseUrl = input.split('?')[0];
                const existingParams = input.includes('?') ? input.split('?')[1] : '';
                
                // Merge existing and new parameters
                const allParams = { ...queryParams };
                if (existingParams) {
                    const existingPairs = existingParams.split('&');
                    for (const pair of existingPairs) {
                        const [key, value] = pair.split('=');
                        if (key && !allParams[key]) {
                            allParams[key] = value || '';
                        }
                    }
                }
                
                const encodedParams = urlEncoder.encodeQueryParams(allParams);
                if (encodedParams.success) {
                    input = baseUrl + '?' + encodedParams.encoded;
                }
            }

            const options = {
                encodeReserved: document.getElementById('url-encode-reserved').checked,
                encodeSpaces: document.getElementById('url-encode-spaces').checked,
                preserveProtocol: document.getElementById('url-preserve-protocol').checked
            };

            const result = urlEncoder.encodeUrl(input, options);
            if (result.success) {
                document.getElementById('url-output').value = result.encoded;
                updateUrlOutputLineNumbers();
                hideAllUrlResults();
                showUrlAnalysisResults(result);
                urlEncoder.addToHistory('encode', input, result.encoded, 'url');
            } else {
                document.getElementById('url-output').value = '';
                updateUrlOutputLineNumbers();
                hideAllUrlResults();
                showUrlErrorResults(result);
            }
        }

        // Decode URL
        function decodeUrl() {
            if (!urlEncoder) {
                alert('URL Encoder not initialized. Please refresh the page.');
                return;
            }

            const input = document.getElementById('url-input').value.trim();
            if (!input) {
                alert('Please enter a URL to decode.');
                return;
            }

            const options = {
                strict: document.getElementById('url-strict-decode').checked
            };

            const result = urlEncoder.decodeUrl(input, options);
            if (result.success) {
                document.getElementById('url-output').value = result.decoded;
                updateUrlOutputLineNumbers();
                hideAllUrlResults();
                showUrlAnalysisResults(result);
                urlEncoder.addToHistory('decode', input, result.decoded, 'url');
            } else {
                document.getElementById('url-output').value = '';
                updateUrlOutputLineNumbers();
                hideAllUrlResults();
                showUrlErrorResults(result);
            }
        }

        // Validate URL
        function validateUrl() {
            if (!urlEncoder) {
                alert('URL Encoder not initialized. Please refresh the page.');
                return;
            }

            const input = document.getElementById('url-input').value.trim();
            if (!input) {
                alert('Please enter a URL to validate.');
                return;
            }

            const result = urlEncoder.validateUrl(input);
            if (result.success && result.isValid) {
                hideAllUrlResults();
                showUrlValidationResults(result);
                const info = urlEncoder.getUrlInfo(input);
                if (info.success) {
                    showUrlAnalysisResults(info);
                }
            } else {
                hideAllUrlResults();
                showUrlErrorResults(result);
            }
        }

        // Beautify URL
        function beautifyUrl() {
            if (!urlEncoder) {
                alert('URL Encoder not initialized. Please refresh the page.');
                return;
            }

            const input = document.getElementById('url-input').value.trim();
            if (!input) {
                alert('Please enter a URL to beautify.');
                return;
            }

            const result = urlEncoder.beautifyUrl(input);
            if (result.success) {
                document.getElementById('url-output').value = result.beautified;
                updateUrlOutputLineNumbers();
                hideAllUrlResults();
                showUrlBeautificationResults(result);
                urlEncoder.addToHistory('beautify', input, result.beautified, 'url');
            } else {
                document.getElementById('url-output').value = '';
                updateUrlOutputLineNumbers();
                hideAllUrlResults();
                showUrlErrorResults(result);
            }
        }

        // Clear URL
        function clearUrl() {
            document.getElementById('url-input').value = '';
            document.getElementById('url-output').value = '';
            document.getElementById('query-key').value = '';
            document.getElementById('query-value').value = '';
            queryParams = {};
            updateQueryParamsList();
            // Clear line numbers and reset to single line
            document.getElementById('url-input-lines').innerHTML = '<div class="text-center text-xs" style="height: 24px; line-height: 24px; display: flex; align-items: center; justify-content: center;">1</div>';
            document.getElementById('url-output-lines').innerHTML = '<div class="text-center text-xs" style="height: 24px; line-height: 24px; display: flex; align-items: center; justify-content: center;">1</div>';
            hideAllUrlResults();
        }

        // Copy URL Output
        function copyUrlOutput() {
            const output = document.getElementById('url-output').value;
            if (!output) {
                alert('No URL to copy.');
                return;
            }

            navigator.clipboard.writeText(output).then(() => {
                alert('URL copied to clipboard!');
            }).catch(err => {
                console.error('Failed to copy: ', err);
                alert('Failed to copy to clipboard.');
            });
        }

        // Download URL Output
        function downloadUrlOutput() {
            const output = document.getElementById('url-output').value;
            if (!output) {
                alert('No URL to download.');
                return;
            }

            const blob = new Blob([output], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'url-output.txt';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // Show URL Analysis Results
        function showUrlAnalysisResults(result) {
            const resultsDiv = document.getElementById('url-analysis-results');
            const contentDiv = document.getElementById('url-analysis-content');
            
            let html = `
                <div class="flex items-center text-blue-600 mb-2">
                    <span class="text-2xl mr-2">üîç</span>
                    <span class="font-bold">URL Analysis</span>
                </div>
                <div class="text-sm text-gray-600 space-y-3">
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700">Original Length</div>
                            <div class="text-blue-600">${result.originalLength || result.length} characters</div>
                        </div>
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700">${result.encoded ? 'Encoded' : result.decoded ? 'Decoded' : 'Final'} Length</div>
                            <div class="text-green-600">${result.encodedLength || result.decodedLength || result.beautifiedLength || result.length} characters</div>
                        </div>
                    </div>
            `;
            
            if (result.compressionRatio) {
                html += `
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="font-bold text-gray-700">Size Change</div>
                        <div class="text-${result.compressionRatio > 0 ? 'red' : 'green'}-600">${result.compressionRatio}% ${result.compressionRatio > 0 ? 'larger' : 'smaller'}</div>
                    </div>
                `;
            }
            
            if (result.protocol) {
                html += `
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="font-bold text-gray-700">Protocol</div>
                        <div class="text-purple-600">${result.protocol}</div>
                    </div>
                `;
            }
            
            if (result.hostname) {
                html += `
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="font-bold text-gray-700">Hostname</div>
                        <div class="text-teal-600">${result.hostname}</div>
                    </div>
                `;
            }
            
            if (result.queryParams !== undefined) {
                html += `
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="font-bold text-gray-700">Query Parameters</div>
                        <div class="text-orange-600">${result.queryParams}</div>
                    </div>
                `;
            }
            
            html += `</div>`;
            
            contentDiv.innerHTML = html;
            resultsDiv.classList.remove('hidden');
        }

        // Show URL Validation Results
        function showUrlValidationResults(result) {
            const resultsDiv = document.getElementById('url-validation-results');
            const contentDiv = document.getElementById('url-validation-content');
            
            let html = `
                <div class="flex items-center text-green-600 mb-2">
                    <span class="text-2xl mr-2">‚úÖ</span>
                    <span class="font-bold">Valid URL</span>
                </div>
                <div class="text-sm text-gray-600 space-y-3">
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700">Protocol</div>
                            <div class="text-blue-600">${result.urlParts.protocol}</div>
                        </div>
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700">Hostname</div>
                            <div class="text-green-600">${result.urlParts.hostname}</div>
                        </div>
                    </div>
            `;
            
            if (result.urlParts.port) {
                html += `
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="font-bold text-gray-700">Port</div>
                        <div class="text-purple-600">${result.urlParts.port}</div>
                    </div>
                `;
            }
            
            if (result.urlParts.pathname) {
                html += `
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="font-bold text-gray-700">Path</div>
                        <div class="text-teal-600">${result.urlParts.pathname}</div>
                    </div>
                `;
            }
            
            if (result.urlParts.search) {
                html += `
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="font-bold text-gray-700">Query String</div>
                        <div class="text-orange-600 font-mono text-xs break-all">${result.urlParts.search}</div>
                    </div>
                `;
            }
            
            if (result.urlParts.hash) {
                html += `
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="font-bold text-gray-700">Hash</div>
                        <div class="text-indigo-600">${result.urlParts.hash}</div>
                    </div>
                `;
            }
            
            html += `</div>`;
            
            contentDiv.innerHTML = html;
            resultsDiv.classList.remove('hidden');
        }

        // Show URL Beautification Results
        function showUrlBeautificationResults(result) {
            const resultsDiv = document.getElementById('url-beautification-results');
            const contentDiv = document.getElementById('url-beautification-content');
            
            let html = `
                <div class="flex items-center text-purple-600 mb-2">
                    <span class="text-2xl mr-2">‚ú®</span>
                    <span class="font-bold">URL Beautified</span>
                </div>
                <div class="text-sm text-gray-600 space-y-3">
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700">Original Length</div>
                            <div class="text-blue-600">${result.originalLength} characters</div>
                        </div>
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700">Beautified Length</div>
                            <div class="text-green-600">${result.beautifiedLength} characters</div>
                        </div>
                    </div>
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="font-bold text-gray-700">Beautified URL</div>
                        <div class="text-purple-600 font-mono text-xs break-all">${result.beautified}</div>
                    </div>
                </div>
            `;
            
            contentDiv.innerHTML = html;
            resultsDiv.classList.remove('hidden');
        }

        // Show URL Error Results
        function showUrlErrorResults(result) {
            const resultsDiv = document.getElementById('url-error-display');
            const contentDiv = document.getElementById('url-error-content');
            
            let html = `
                <div class="flex items-center text-red-600 mb-2">
                    <span class="text-2xl mr-2">‚ùå</span>
                    <span class="font-bold">URL Error</span>
                </div>
                <div class="text-sm text-gray-600 space-y-3">
                    <div>
                        <div class="font-bold mb-1">Error Message:</div>
                        <div class="bg-red-50 p-3 rounded border-l-4 border-red-400 font-mono text-sm">${result.error}</div>
                    </div>
            `;
            
            if (result.originalLength) {
                html += `
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="font-bold text-gray-700">Input Length</div>
                        <div class="text-blue-600">${result.originalLength} characters</div>
                    </div>
                `;
            }
            
            html += `
                <div class="bg-yellow-50 p-3 rounded border-l-4 border-yellow-400">
                    <div class="font-bold text-yellow-800 mb-2">üí° Common URL Issues:</div>
                    <ul class="text-sm text-yellow-700 space-y-1">
                        <li>‚Ä¢ Missing protocol (http:// or https://)</li>
                        <li>‚Ä¢ Invalid characters in URL</li>
                        <li>‚Ä¢ Malformed query parameters</li>
                        <li>‚Ä¢ Invalid hostname format</li>
                    </ul>
                </div>
            `;
            
            html += `</div>`;
            
            contentDiv.innerHTML = html;
            resultsDiv.classList.remove('hidden');
        }

        // Hide all URL results
        function hideAllUrlResults() {
            document.getElementById('url-analysis-results').classList.add('hidden');
            document.getElementById('url-validation-results').classList.add('hidden');
            document.getElementById('url-beautification-results').classList.add('hidden');
            document.getElementById('url-error-display').classList.add('hidden');
        }

        // Regex Tester Functions
        let regexTester = null;

        // Initialize Regex Tester
        function initializeRegexTester() {
            try {
                if (typeof RegexTester !== 'undefined') {
                    regexTester = new RegexTester();
                    console.log('‚úÖ Regex Tester initialized successfully');
                    loadPatternLibrary();
                } else {
                    console.error('‚ùå RegexTester class not found');
                }
            } catch (error) {
                console.error('‚ùå Error initializing Regex Tester:', error);
            }
        }

        // Initialize line numbers for Regex tester
        function initializeRegexLineNumbers() {
            updateRegexPatternLineNumbers();
            updateRegexTextLineNumbers();
            updateRegexResultsLineNumbers();
        }

        // Update Regex pattern line numbers
        function updateRegexPatternLineNumbers() {
            const textarea = document.getElementById('regex-pattern');
            const linesDiv = document.getElementById('regex-pattern-lines');
            
            // Get the actual content and split by lines
            const content = textarea.value;
            const lines = content.split('\n');
            
            // Calculate exact line count based on content
            let lineCount = lines.length;
            
            // If content is empty, show just one line
            if (content.trim() === '') {
                lineCount = 1;
            }
            
            let lineNumbers = '';
            for (let i = 1; i <= lineCount; i++) {
                lineNumbers += `<div class="text-center text-xs" style="height: 24px; line-height: 24px; display: flex; align-items: center; justify-content: center;">${i}</div>`;
            }
            
            linesDiv.innerHTML = lineNumbers;
        }

        // Update Regex text line numbers
        function updateRegexTextLineNumbers() {
            const textarea = document.getElementById('regex-text');
            const linesDiv = document.getElementById('regex-text-lines');
            
            // Get the actual content and split by lines
            const content = textarea.value;
            const lines = content.split('\n');
            
            // Calculate exact line count based on content
            let lineCount = lines.length;
            
            // If content is empty, show just one line
            if (content.trim() === '') {
                lineCount = 1;
            }
            
            let lineNumbers = '';
            for (let i = 1; i <= lineCount; i++) {
                lineNumbers += `<div class="text-center text-xs" style="height: 24px; line-height: 24px; display: flex; align-items: center; justify-content: center;">${i}</div>`;
            }
            
            linesDiv.innerHTML = lineNumbers;
        }

        // Update Regex results line numbers
        function updateRegexResultsLineNumbers() {
            const resultsDiv = document.getElementById('regex-results');
            const linesDiv = document.getElementById('regex-results-lines');
            
            // Get the actual content and split by lines
            const content = resultsDiv.innerHTML;
            const lines = content.split('\n');
            
            // Calculate exact line count based on content
            let lineCount = lines.length;
            
            // If content is empty, show just one line
            if (content.trim() === '') {
                lineCount = 1;
            }
            
            let lineNumbers = '';
            for (let i = 1; i <= lineCount; i++) {
                lineNumbers += `<div class="text-center text-xs" style="height: 24px; line-height: 24px; display: flex; align-items: center; justify-content: center;">${i}</div>`;
            }
            
            linesDiv.innerHTML = lineNumbers;
        }

        // Sync Regex pattern scroll
        function syncRegexPatternScroll() {
            const textarea = document.getElementById('regex-pattern');
            const linesDiv = document.getElementById('regex-pattern-lines');
            linesDiv.scrollTop = textarea.scrollTop;
        }

        // Sync Regex text scroll
        function syncRegexTextScroll() {
            const textarea = document.getElementById('regex-text');
            const linesDiv = document.getElementById('regex-text-lines');
            linesDiv.scrollTop = textarea.scrollTop;
        }

        // Load Pattern Library
        function loadPatternLibrary() {
            if (!regexTester) return;
            
            const select = document.getElementById('pattern-library');
            const library = regexTester.getPatternLibrary();
            
            // Clear existing options except first
            select.innerHTML = '<option value="">Select a pattern from library...</option>';
            
            for (const [name, pattern] of Object.entries(library)) {
                const option = document.createElement('option');
                option.value = name;
                option.textContent = name;
                select.appendChild(option);
            }
        }

        // Load Pattern from Library
        function loadPatternFromLibrary() {
            const select = document.getElementById('pattern-library');
            const selectedPattern = select.value;
            
            if (!selectedPattern || !regexTester) return;
            
            const library = regexTester.getPatternLibrary();
            const pattern = library[selectedPattern];
            
            if (pattern) {
                document.getElementById('regex-pattern').value = pattern.source || pattern;
                updateRegexPatternLineNumbers();
            }
        }

        // Get Selected Flags
        function getSelectedFlags() {
            const flags = [];
            const flagCheckboxes = ['flag-g', 'flag-i', 'flag-m', 'flag-s', 'flag-u', 'flag-y'];
            
            for (const flagId of flagCheckboxes) {
                if (document.getElementById(flagId).checked) {
                    flags.push(flagId.replace('flag-', ''));
                }
            }
            
            return flags;
        }

        // Test Regex
        function testRegex() {
            if (!regexTester) {
                alert('Regex Tester not initialized. Please refresh the page.');
                return;
            }

            const pattern = document.getElementById('regex-pattern').value.trim();
            const text = document.getElementById('regex-text').value.trim();
            
            if (!pattern) {
                alert('Please enter a regex pattern.');
                return;
            }
            
            if (!text) {
                alert('Please enter text to test against the pattern.');
                return;
            }

            const flags = getSelectedFlags();
            const result = regexTester.testRegex(pattern, text, flags);
            
            if (result.success) {
                displayTestResults(result);
                regexTester.addToHistory('test', pattern, text, 'regex');
            } else {
                hideAllRegexResults();
                showRegexErrorResults(result);
            }
        }

        // Validate Regex
        function validateRegex() {
            if (!regexTester) {
                alert('Regex Tester not initialized. Please refresh the page.');
                return;
            }

            const pattern = document.getElementById('regex-pattern').value.trim();
            
            if (!pattern) {
                alert('Please enter a regex pattern.');
                return;
            }

            const flags = getSelectedFlags();
            const result = regexTester.validateRegex(pattern, flags);
            
            if (result.success && result.isValid) {
                hideAllRegexResults();
                showRegexValidationResults(result);
            } else {
                hideAllRegexResults();
                showRegexErrorResults(result);
            }
        }

        // Explain Regex
        function explainRegex() {
            if (!regexTester) {
                alert('Regex Tester not initialized. Please refresh the page.');
                return;
            }

            const pattern = document.getElementById('regex-pattern').value.trim();
            
            if (!pattern) {
                alert('Please enter a regex pattern.');
                return;
            }

            const result = regexTester.explainRegex(pattern);
            
            if (result.success) {
                hideAllRegexResults();
                showRegexExplanationResults(result);
            } else {
                hideAllRegexResults();
                showRegexErrorResults(result);
            }
        }

        // Get Statistics
        function getStats() {
            if (!regexTester) {
                alert('Regex Tester not initialized. Please refresh the page.');
                return;
            }

            const pattern = document.getElementById('regex-pattern').value.trim();
            const text = document.getElementById('regex-text').value.trim();
            
            if (!pattern) {
                alert('Please enter a regex pattern.');
                return;
            }
            
            if (!text) {
                alert('Please enter text to analyze for statistics.');
                return;
            }

            const result = regexTester.getRegexStats(pattern, text);
            
            if (result.success) {
                hideAllRegexResults();
                showRegexStatsResults(result);
            } else {
                hideAllRegexResults();
                showRegexErrorResults(result);
            }
        }

        // Highlight Matches
        function highlightMatches() {
            if (!regexTester) {
                alert('Regex Tester not initialized. Please refresh the page.');
                return;
            }

            const pattern = document.getElementById('regex-pattern').value.trim();
            const text = document.getElementById('regex-text').value.trim();
            
            if (!pattern) {
                alert('Please enter a regex pattern.');
                return;
            }
            
            if (!text) {
                alert('Please enter text to highlight matches.');
                return;
            }

            const flags = getSelectedFlags();
            const result = regexTester.highlightMatches(pattern, text, flags);
            
            if (result.success) {
                document.getElementById('regex-results').innerHTML = result.highlighted;
                updateRegexResultsLineNumbers();
                hideAllRegexResults();
                showRegexTestResults(result);
            } else {
                hideAllRegexResults();
                showRegexErrorResults(result);
            }
        }

        // Clear Regex
        function clearRegex() {
            document.getElementById('regex-pattern').value = '';
            document.getElementById('regex-text').value = '';
            document.getElementById('regex-results').innerHTML = '';
            
            // Clear all flags
            const flagCheckboxes = ['flag-g', 'flag-i', 'flag-m', 'flag-s', 'flag-u', 'flag-y'];
            for (const flagId of flagCheckboxes) {
                document.getElementById(flagId).checked = false;
            }
            
            // Clear line numbers and reset to single line
            document.getElementById('regex-pattern-lines').innerHTML = '<div class="text-center text-xs" style="height: 24px; line-height: 24px; display: flex; align-items: center; justify-content: center;">1</div>';
            document.getElementById('regex-text-lines').innerHTML = '<div class="text-center text-xs" style="height: 24px; line-height: 24px; display: flex; align-items: center; justify-content: center;">1</div>';
            document.getElementById('regex-results-lines').innerHTML = '<div class="text-center text-xs" style="height: 24px; line-height: 24px; display: flex; align-items: center; justify-content: center;">1</div>';
            
            hideAllRegexResults();
        }

        // Copy Regex Results
        function copyRegexResults() {
            const results = document.getElementById('regex-results').innerHTML;
            if (!results) {
                alert('No results to copy.');
                return;
            }

            // Strip HTML tags for plain text copy
            const plainText = results.replace(/<[^>]*>/g, '');
            
            navigator.clipboard.writeText(plainText).then(() => {
                alert('Results copied to clipboard!');
            }).catch(err => {
                console.error('Failed to copy: ', err);
                alert('Failed to copy to clipboard.');
            });
        }

        // Download Regex Results
        function downloadRegexResults() {
            const results = document.getElementById('regex-results').innerHTML;
            if (!results) {
                alert('No results to download.');
                return;
            }

            // Strip HTML tags for plain text download
            const plainText = results.replace(/<[^>]*>/g, '');
            
            const blob = new Blob([plainText], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'regex-results.txt';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // Display Test Results
        function displayTestResults(result) {
            const resultsDiv = document.getElementById('regex-results');
            let html = '';
            
            if (result.isMatch) {
                html += `<div class="text-green-600 font-bold mb-2">‚úÖ Pattern matches!</div>`;
                html += `<div class="text-sm text-gray-600 mb-4">Found ${result.matchCount} match(es)</div>`;
                
                if (result.matches.length > 0) {
                    html += `<div class="space-y-2">`;
                    result.matches.forEach((match, index) => {
                        html += `<div class="bg-yellow-50 p-2 rounded border">`;
                        html += `<div class="font-bold text-sm">Match ${index + 1}:</div>`;
                        html += `<div class="font-mono text-sm">"${match.match}"</div>`;
                        html += `<div class="text-xs text-gray-500">Position: ${match.index}</div>`;
                        if (match.groups && match.groups.length > 0) {
                            html += `<div class="text-xs text-gray-500">Groups: ${match.groups.join(', ')}</div>`;
                        }
                        html += `</div>`;
                    });
                    html += `</div>`;
                }
            } else {
                html += `<div class="text-red-600 font-bold mb-2">‚ùå No matches found</div>`;
            }
            
            resultsDiv.innerHTML = html;
            updateRegexResultsLineNumbers();
            hideAllRegexResults();
            showRegexTestResults(result);
        }

        // Show Regex Test Results
        function showRegexTestResults(result) {
            const resultsDiv = document.getElementById('regex-test-results');
            const contentDiv = document.getElementById('regex-test-content');
            
            let html = `
                <div class="flex items-center text-blue-600 mb-2">
                    <span class="text-2xl mr-2">${result.isMatch ? '‚úÖ' : '‚ùå'}</span>
                    <span class="font-bold">Test Results</span>
                </div>
                <div class="text-sm text-gray-600 space-y-3">
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700">Pattern</div>
                            <div class="text-blue-600 font-mono text-xs">${result.pattern}</div>
                        </div>
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700">Flags</div>
                            <div class="text-green-600">${result.flagString || 'none'}</div>
                        </div>
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700">Match Count</div>
                            <div class="text-purple-600">${result.matchCount}</div>
                        </div>
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700">Result</div>
                            <div class="text-${result.isMatch ? 'green' : 'red'}-600 font-bold">${result.isMatch ? 'Match Found' : 'No Match'}</div>
                        </div>
                    </div>
            `;
            
            if (result.firstMatch) {
                html += `
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="font-bold text-gray-700">First Match</div>
                        <div class="text-orange-600 font-mono text-sm">"${result.firstMatch[0]}"</div>
                    </div>
                `;
            }
            
            html += `</div>`;
            
            contentDiv.innerHTML = html;
            resultsDiv.classList.remove('hidden');
        }

        // Show Regex Validation Results
        function showRegexValidationResults(result) {
            const resultsDiv = document.getElementById('regex-validation-results');
            const contentDiv = document.getElementById('regex-validation-content');
            
            let html = `
                <div class="flex items-center text-green-600 mb-2">
                    <span class="text-2xl mr-2">‚úÖ</span>
                    <span class="font-bold">Valid Pattern</span>
                </div>
                <div class="text-sm text-gray-600 space-y-3">
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700">Pattern</div>
                            <div class="text-blue-600 font-mono text-xs">${result.pattern}</div>
                        </div>
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700">Flags</div>
                            <div class="text-green-600">${result.flagString || 'none'}</div>
                        </div>
                    </div>
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="font-bold text-gray-700">Source</div>
                        <div class="text-purple-600 font-mono text-sm">${result.source}</div>
                    </div>
                </div>
            `;
            
            contentDiv.innerHTML = html;
            resultsDiv.classList.remove('hidden');
        }

        // Show Regex Explanation Results
        function showRegexExplanationResults(result) {
            const resultsDiv = document.getElementById('regex-explanation-results');
            const contentDiv = document.getElementById('regex-explanation-content');
            
            let html = `
                <div class="flex items-center text-purple-600 mb-2">
                    <span class="text-2xl mr-2">üîç</span>
                    <span class="font-bold">Pattern Explanation</span>
                </div>
                <div class="text-sm text-gray-600 space-y-3">
            `;
            
            result.explanation.forEach((item, index) => {
                html += `
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="flex items-center justify-between mb-2">
                            <div class="font-bold text-gray-700">${item.symbol}</div>
                            <div class="text-blue-600 font-bold">${item.meaning}</div>
                        </div>
                        <div class="text-gray-600 text-sm">${item.description}</div>
                    </div>
                `;
            });
            
            html += `</div>`;
            
            contentDiv.innerHTML = html;
            resultsDiv.classList.remove('hidden');
        }

        // Show Regex Stats Results
        function showRegexStatsResults(result) {
            const resultsDiv = document.getElementById('regex-stats-results');
            const contentDiv = document.getElementById('regex-stats-content');
            
            let html = `
                <div class="flex items-center text-yellow-600 mb-2">
                    <span class="text-2xl mr-2">üìä</span>
                    <span class="font-bold">Statistics</span>
                </div>
                <div class="text-sm text-gray-600 space-y-3">
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700">Total Matches</div>
                            <div class="text-blue-600">${result.stats.totalMatches}</div>
                        </div>
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700">Unique Matches</div>
                            <div class="text-green-600">${result.stats.uniqueMatches}</div>
                        </div>
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700">Total Characters</div>
                            <div class="text-purple-600">${result.stats.totalCharacters}</div>
                        </div>
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700">Matched Characters</div>
                            <div class="text-orange-600">${result.stats.matchedCharacters}</div>
                        </div>
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700">Coverage</div>
                            <div class="text-teal-600">${result.stats.coverage}%</div>
                        </div>
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700">Avg Match Length</div>
                            <div class="text-indigo-600">${result.stats.averageMatchLength}</div>
                        </div>
                    </div>
                </div>
            `;
            
            contentDiv.innerHTML = html;
            resultsDiv.classList.remove('hidden');
        }

        // Show Regex Error Results
        function showRegexErrorResults(result) {
            const resultsDiv = document.getElementById('regex-error-display');
            const contentDiv = document.getElementById('regex-error-content');
            
            let html = `
                <div class="flex items-center text-red-600 mb-2">
                    <span class="text-2xl mr-2">‚ùå</span>
                    <span class="font-bold">Regex Error</span>
                </div>
                <div class="text-sm text-gray-600 space-y-3">
                    <div>
                        <div class="font-bold mb-1">Error Message:</div>
                        <div class="bg-red-50 p-3 rounded border-l-4 border-red-400 font-mono text-sm">${result.error}</div>
                    </div>
            `;
            
            if (result.pattern) {
                html += `
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="font-bold text-gray-700">Pattern</div>
                        <div class="text-blue-600 font-mono text-xs">${result.pattern}</div>
                    </div>
                `;
            }
            
            html += `
                <div class="bg-yellow-50 p-3 rounded border-l-4 border-yellow-400">
                    <div class="font-bold text-yellow-800 mb-2">üí° Common Regex Issues:</div>
                    <ul class="text-sm text-yellow-700 space-y-1">
                        <li>‚Ä¢ Unescaped special characters</li>
                        <li>‚Ä¢ Mismatched brackets or parentheses</li>
                        <li>‚Ä¢ Invalid quantifier usage</li>
                        <li>‚Ä¢ Incorrect flag combinations</li>
                    </ul>
                </div>
            `;
            
            html += `</div>`;
            
            contentDiv.innerHTML = html;
            resultsDiv.classList.remove('hidden');
        }

        // Hide all Regex results
        function hideAllRegexResults() {
            document.getElementById('regex-test-results').classList.add('hidden');
            document.getElementById('regex-validation-results').classList.add('hidden');
            document.getElementById('regex-explanation-results').classList.add('hidden');
            document.getElementById('regex-stats-results').classList.add('hidden');
            document.getElementById('regex-error-display').classList.add('hidden');
        }

        // CSS/JS Minifier Functions
        let cssJsMinifier = null;

        // Initialize CSS/JS Minifier
        function initializeCssJsMinifier() {
            try {
                if (typeof CssJsMinifier !== 'undefined') {
                    cssJsMinifier = new CssJsMinifier();
                    console.log('‚úÖ CSS/JS Minifier initialized successfully');
                } else {
                    console.error('‚ùå CssJsMinifier class not found');
                }
            } catch (error) {
                console.error('‚ùå Error initializing CSS/JS Minifier:', error);
            }
        }

        // Initialize line numbers for Minifier
        function initializeMinifierLineNumbers() {
            updateMinifierInputLineNumbers();
            updateMinifierOutputLineNumbers();
        }

        // Update Minifier input line numbers
        function updateMinifierInputLineNumbers() {
            const textarea = document.getElementById('minifier-input');
            const linesDiv = document.getElementById('minifier-input-lines');
            
            // Get the actual content and split by lines
            const content = textarea.value;
            const lines = content.split('\n');
            
            // Calculate exact line count based on content
            let lineCount = lines.length;
            
            // If content is empty, show just one line
            if (content.trim() === '') {
                lineCount = 1;
            }
            
            let lineNumbers = '';
            for (let i = 1; i <= lineCount; i++) {
                lineNumbers += `<div class="text-center text-xs" style="height: 24px; line-height: 24px; display: flex; align-items: center; justify-content: center;">${i}</div>`;
            }
            
            linesDiv.innerHTML = lineNumbers;
        }

        // Update Minifier output line numbers
        function updateMinifierOutputLineNumbers() {
            const textarea = document.getElementById('minifier-output');
            const linesDiv = document.getElementById('minifier-output-lines');
            
            // Get the actual content and split by lines
            const content = textarea.value;
            const lines = content.split('\n');
            
            // Calculate exact line count based on content
            let lineCount = lines.length;
            
            // If content is empty, show just one line
            if (content.trim() === '') {
                lineCount = 1;
            }
            
            let lineNumbers = '';
            for (let i = 1; i <= lineCount; i++) {
                lineNumbers += `<div class="text-center text-xs" style="height: 24px; line-height: 24px; display: flex; align-items: center; justify-content: center;">${i}</div>`;
            }
            
            linesDiv.innerHTML = lineNumbers;
        }

        // Sync Minifier input scroll
        function syncMinifierInputScroll() {
            const textarea = document.getElementById('minifier-input');
            const linesDiv = document.getElementById('minifier-input-lines');
            linesDiv.scrollTop = textarea.scrollTop;
        }

        // Sync Minifier output scroll
        function syncMinifierOutputScroll() {
            const textarea = document.getElementById('minifier-output');
            const linesDiv = document.getElementById('minifier-output-lines');
            linesDiv.scrollTop = textarea.scrollTop;
        }

        // Update Code Type
        function updateCodeType() {
            const codeType = document.getElementById('code-type').value;
            const cssOptions = document.getElementById('css-options');
            const jsOptions = document.getElementById('js-options');
            
            if (codeType === 'css') {
                cssOptions.classList.remove('hidden');
                jsOptions.classList.add('hidden');
            } else {
                cssOptions.classList.add('hidden');
                jsOptions.classList.remove('hidden');
            }
        }

        // Get Optimization Options
        function getOptimizationOptions() {
            const codeType = document.getElementById('code-type').value;
            
            if (codeType === 'css') {
                return {
                    removeComments: document.getElementById('remove-comments').checked,
                    removeWhitespace: document.getElementById('remove-whitespace').checked,
                    removeEmptyRules: document.getElementById('remove-empty-rules').checked,
                    optimizeColors: document.getElementById('optimize-colors').checked,
                    optimizeShorthand: document.getElementById('optimize-shorthand').checked
                };
            } else {
                return {
                    removeComments: document.getElementById('remove-js-comments').checked,
                    removeWhitespace: document.getElementById('remove-js-whitespace').checked,
                    removeConsoleLogs: document.getElementById('remove-console-logs').checked,
                    optimizeExpressions: document.getElementById('optimize-expressions').checked,
                    minifyIdentifiers: document.getElementById('minify-identifiers').checked
                };
            }
        }

        // Minify Code
        function minifyCode() {
            if (!cssJsMinifier) {
                alert('CSS/JS Minifier not initialized. Please refresh the page.');
                return;
            }

            const code = document.getElementById('minifier-input').value.trim();
            if (!code) {
                alert('Please enter code to minify.');
                return;
            }

            const codeType = document.getElementById('code-type').value;
            const options = getOptimizationOptions();

            let result;
            if (codeType === 'css') {
                result = cssJsMinifier.minifyCSS(code, options);
            } else {
                result = cssJsMinifier.minifyJS(code, options);
            }

            if (result.success) {
                document.getElementById('minifier-output').value = result.minified;
                updateMinifierOutputLineNumbers();
                hideAllMinifierResults();
                showMinificationResults(result);
                cssJsMinifier.addToHistory('minify', code, result.minified, codeType);
            } else {
                hideAllMinifierResults();
                showMinifierErrorResults(result);
            }
        }

        // Beautify Code
        function beautifyCode() {
            if (!cssJsMinifier) {
                alert('CSS/JS Minifier not initialized. Please refresh the page.');
                return;
            }

            const code = document.getElementById('minifier-input').value.trim();
            if (!code) {
                alert('Please enter code to beautify.');
                return;
            }

            const codeType = document.getElementById('code-type').value;

            let result;
            if (codeType === 'css') {
                result = cssJsMinifier.beautifyCSS(code);
            } else {
                result = cssJsMinifier.beautifyJS(code);
            }

            if (result.success) {
                document.getElementById('minifier-output').value = result.beautified;
                updateMinifierOutputLineNumbers();
                hideAllMinifierResults();
                showBeautificationResults(result);
                cssJsMinifier.addToHistory('beautify', code, result.beautified, codeType);
            } else {
                hideAllMinifierResults();
                showMinifierErrorResults(result);
            }
        }

        // Validate Code
        function validateCode() {
            if (!cssJsMinifier) {
                alert('CSS/JS Minifier not initialized. Please refresh the page.');
                return;
            }

            const code = document.getElementById('minifier-input').value.trim();
            if (!code) {
                alert('Please enter code to validate.');
                return;
            }

            const codeType = document.getElementById('code-type').value;

            let result;
            if (codeType === 'css') {
                result = cssJsMinifier.validateCSS(code);
            } else {
                result = cssJsMinifier.validateJS(code);
            }

            if (result.success) {
                hideAllMinifierResults();
                showValidationResults(result);
            } else {
                hideAllMinifierResults();
                showMinifierErrorResults(result);
            }
        }

        // Get File Statistics
        function getFileStats() {
            if (!cssJsMinifier) {
                alert('CSS/JS Minifier not initialized. Please refresh the page.');
                return;
            }

            const code = document.getElementById('minifier-input').value.trim();
            if (!code) {
                alert('Please enter code to analyze.');
                return;
            }

            const codeType = document.getElementById('code-type').value;
            const result = cssJsMinifier.getFileStats(code, codeType);

            if (result.success) {
                hideAllMinifierResults();
                showStatisticsResults(result);
            } else {
                hideAllMinifierResults();
                showMinifierErrorResults(result);
            }
        }

        // Clear Minifier
        function clearMinifier() {
            document.getElementById('minifier-input').value = '';
            document.getElementById('minifier-output').value = '';
            
            // Clear line numbers and reset to single line
            document.getElementById('minifier-input-lines').innerHTML = '<div class="text-center text-xs" style="height: 24px; line-height: 24px; display: flex; align-items: center; justify-content: center;">1</div>';
            document.getElementById('minifier-output-lines').innerHTML = '<div class="text-center text-xs" style="height: 24px; line-height: 24px; display: flex; align-items: center; justify-content: center;">1</div>';
            
            hideAllMinifierResults();
        }

        // Copy Minifier Output
        function copyMinifierOutput() {
            const output = document.getElementById('minifier-output').value;
            if (!output) {
                alert('No output to copy.');
                return;
            }

            navigator.clipboard.writeText(output).then(() => {
                alert('Output copied to clipboard!');
            }).catch(err => {
                console.error('Failed to copy: ', err);
                alert('Failed to copy to clipboard.');
            });
        }

        // Download Minifier Output
        function downloadMinifierOutput() {
            const output = document.getElementById('minifier-output').value;
            if (!output) {
                alert('No output to download.');
                return;
            }

            const codeType = document.getElementById('code-type').value;
            const extension = codeType === 'css' ? 'css' : 'js';
            
            const blob = new Blob([output], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `minified.${extension}`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // Show Minification Results
        function showMinificationResults(result) {
            const resultsDiv = document.getElementById('minification-results');
            const contentDiv = document.getElementById('minification-content');
            
            let html = `
                <div class="flex items-center text-orange-600 mb-2">
                    <span class="text-2xl mr-2">üõ†Ô∏è</span>
                    <span class="font-bold">Minification Complete</span>
                </div>
                <div class="text-sm text-gray-600 space-y-3">
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700">Original Size</div>
                            <div class="text-blue-600">${result.originalSize} characters</div>
                        </div>
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700">Minified Size</div>
                            <div class="text-green-600">${result.minifiedSize} characters</div>
                        </div>
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700">Compression Ratio</div>
                            <div class="text-purple-600">${result.compressionRatio}%</div>
                        </div>
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700">Space Saved</div>
                            <div class="text-orange-600">${result.originalSize - result.minifiedSize} characters</div>
                        </div>
                    </div>
                </div>
            `;
            
            contentDiv.innerHTML = html;
            resultsDiv.classList.remove('hidden');
        }

        // Show Beautification Results
        function showBeautificationResults(result) {
            const resultsDiv = document.getElementById('beautification-results');
            const contentDiv = document.getElementById('beautification-content');
            
            let html = `
                <div class="flex items-center text-red-600 mb-2">
                    <span class="text-2xl mr-2">‚ú®</span>
                    <span class="font-bold">Beautification Complete</span>
                </div>
                <div class="text-sm text-gray-600 space-y-3">
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700">Original Size</div>
                            <div class="text-blue-600">${result.originalSize} characters</div>
                        </div>
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700">Beautified Size</div>
                            <div class="text-green-600">${result.beautifiedSize} characters</div>
                        </div>
                    </div>
                </div>
            `;
            
            contentDiv.innerHTML = html;
            resultsDiv.classList.remove('hidden');
        }

        // Show Validation Results
        function showValidationResults(result) {
            const resultsDiv = document.getElementById('minifier-validation-results');
            const contentDiv = document.getElementById('minifier-validation-content');
            
            let html = `
                <div class="flex items-center text-blue-600 mb-2">
                    <span class="text-2xl mr-2">${result.isValid ? '‚úÖ' : '‚ùå'}</span>
                    <span class="font-bold">${result.isValid ? 'Valid Code' : 'Invalid Code'}</span>
                </div>
                <div class="text-sm text-gray-600 space-y-3">
            `;
            
            if (result.errors && result.errors.length > 0) {
                html += `
                    <div class="bg-red-50 p-3 rounded border-l-4 border-red-400">
                        <div class="font-bold text-red-800 mb-2">Errors:</div>
                        <ul class="text-sm text-red-700 space-y-1">
                `;
                result.errors.forEach(error => {
                    html += `<li>‚Ä¢ ${error}</li>`;
                });
                html += `</ul></div>`;
            }
            
            if (result.warnings && result.warnings.length > 0) {
                html += `
                    <div class="bg-yellow-50 p-3 rounded border-l-4 border-yellow-400">
                        <div class="font-bold text-yellow-800 mb-2">Warnings:</div>
                        <ul class="text-sm text-yellow-700 space-y-1">
                `;
                result.warnings.forEach(warning => {
                    html += `<li>‚Ä¢ ${warning}</li>`;
                });
                html += `</ul></div>`;
            }
            
            if (result.isValid && (!result.errors || result.errors.length === 0)) {
                html += `
                    <div class="bg-green-50 p-3 rounded border-l-4 border-green-400">
                        <div class="font-bold text-green-800">Code is valid and ready for production!</div>
                    </div>
                `;
            }
            
            html += `</div>`;
            
            contentDiv.innerHTML = html;
            resultsDiv.classList.remove('hidden');
        }

        // Show Statistics Results
        function showStatisticsResults(result) {
            const resultsDiv = document.getElementById('statistics-results');
            const contentDiv = document.getElementById('statistics-content');
            
            let html = `
                <div class="flex items-center text-green-600 mb-2">
                    <span class="text-2xl mr-2">üìä</span>
                    <span class="font-bold">File Statistics</span>
                </div>
                <div class="text-sm text-gray-600 space-y-3">
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700">Total Lines</div>
                            <div class="text-blue-600">${result.stats.totalLines}</div>
                        </div>
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700">Non-empty Lines</div>
                            <div class="text-green-600">${result.stats.nonEmptyLines}</div>
                        </div>
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700">Comment Lines</div>
                            <div class="text-purple-600">${result.stats.commentLines}</div>
                        </div>
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700">Blank Lines</div>
                            <div class="text-orange-600">${result.stats.blankLines}</div>
                        </div>
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700">Functions</div>
                            <div class="text-teal-600">${result.stats.functions}</div>
                        </div>
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700">Variables</div>
                            <div class="text-indigo-600">${result.stats.variables}</div>
                        </div>
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700">File Size</div>
                            <div class="text-red-600">${result.stats.fileSize} characters</div>
                        </div>
                        <div class="bg-white p-3 rounded-lg border">
                            <div class="font-bold text-gray-700">Avg Line Length</div>
                            <div class="text-yellow-600">${result.stats.averageLineLength} characters</div>
                        </div>
                    </div>
                </div>
            `;
            
            contentDiv.innerHTML = html;
            resultsDiv.classList.remove('hidden');
        }

        // Show Minifier Error Results
        function showMinifierErrorResults(result) {
            const resultsDiv = document.getElementById('minifier-error-display');
            const contentDiv = document.getElementById('minifier-error-content');
            
            let html = `
                <div class="flex items-center text-red-600 mb-2">
                    <span class="text-2xl mr-2">‚ùå</span>
                    <span class="font-bold">Minifier Error</span>
                </div>
                <div class="text-sm text-gray-600 space-y-3">
                    <div>
                        <div class="font-bold mb-1">Error Message:</div>
                        <div class="bg-red-50 p-3 rounded border-l-4 border-red-400 font-mono text-sm">${result.error}</div>
                    </div>
            `;
            
            if (result.originalSize) {
                html += `
                    <div class="bg-white p-3 rounded-lg border">
                        <div class="font-bold text-gray-700">Input Size</div>
                        <div class="text-blue-600">${result.originalSize} characters</div>
                    </div>
                `;
            }
            
            html += `
                <div class="bg-yellow-50 p-3 rounded border-l-4 border-yellow-400">
                    <div class="font-bold text-yellow-800 mb-2">üí° Common Issues:</div>
                    <ul class="text-sm text-yellow-700 space-y-1">
                        <li>‚Ä¢ Invalid syntax in CSS/JS</li>
                        <li>‚Ä¢ Mismatched brackets or braces</li>
                        <li>‚Ä¢ Unclosed strings or comments</li>
                        <li>‚Ä¢ Invalid characters or encoding</li>
                    </ul>
                </div>
            `;
            
            html += `</div>`;
            
            contentDiv.innerHTML = html;
            resultsDiv.classList.remove('hidden');
        }

        // Hide all Minifier results
        function hideAllMinifierResults() {
            document.getElementById('minification-results').classList.add('hidden');
            document.getElementById('beautification-results').classList.add('hidden');
            document.getElementById('minifier-validation-results').classList.add('hidden');
            document.getElementById('statistics-results').classList.add('hidden');
            document.getElementById('minifier-error-display').classList.add('hidden');
        }

        // Color Palette Generator Functions
        let colorPaletteGenerator = null;

        // Initialize Color Palette Generator
        function initializeColorPaletteGenerator() {
            try {
                if (typeof ColorPaletteGenerator !== 'undefined') {
                    colorPaletteGenerator = new ColorPaletteGenerator();
                    console.log('‚úÖ Color Palette Generator initialized successfully');
                } else {
                    console.error('‚ùå ColorPaletteGenerator class not found');
                }
            } catch (error) {
                console.error('‚ùå Error initializing Color Palette Generator:', error);
            }
        }

        // Generate Palette
        function generatePalette() {
            if (!colorPaletteGenerator) {
                alert('Color Palette Generator not initialized. Please refresh the page.');
                return;
            }

            const baseColor = document.getElementById('base-color').value;
            const paletteType = document.getElementById('palette-type').value;
            const colorCount = parseInt(document.getElementById('color-count').value);

            const result = colorPaletteGenerator.generatePalette(baseColor, paletteType, colorCount);

            if (result.success) {
                displayPalette(result.palette);
                displayAccessibilityResults(result.accessibility);
                colorPaletteGenerator.addToHistory('generate', baseColor, result.palette);
            } else {
                alert('Error generating palette: ' + result.error);
            }
        }

        // Display Palette
        function displayPalette(palette) {
            const preview = document.getElementById('palette-preview');
            preview.innerHTML = '';

            palette.forEach((color, index) => {
                const colorDiv = document.createElement('div');
                colorDiv.className = 'relative group cursor-pointer';
                colorDiv.style.backgroundColor = color.hex;
                colorDiv.style.height = '60px';
                colorDiv.style.borderRadius = '8px';
                colorDiv.style.border = '2px solid #e5e7eb';
                
                // Add hover effect
                colorDiv.innerHTML = `
                    <div class="absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-20 transition-all duration-300 rounded-lg flex items-center justify-center">
                        <div class="text-white text-xs font-bold opacity-0 group-hover:opacity-100 transition-opacity duration-300 text-center">
                            <div>${color.hex}</div>
                            <div class="text-xs">${color.name}</div>
                        </div>
                    </div>
                `;
                
                // Add click to copy functionality
                colorDiv.onclick = () => copyToClipboard(color.hex);
                
                preview.appendChild(colorDiv);
            });
        }

        // Display Accessibility Results
        function displayAccessibilityResults(accessibility) {
            const resultsDiv = document.getElementById('accessibility-results');
            const contentDiv = document.getElementById('accessibility-content');
            
            let html = '<div class="space-y-4">';
            
            // Contrast Ratios
            if (accessibility.contrastRatios && accessibility.contrastRatios.length > 0) {
                html += '<div><h5 class="font-bold text-gray-800 mb-2">Contrast Ratios:</h5><div class="space-y-2">';
                accessibility.contrastRatios.forEach(ratio => {
                    const levelClass = ratio.level === 'Fail' ? 'text-red-600' : ratio.level.includes('AAA') ? 'text-green-600' : 'text-yellow-600';
                    html += `<div class="text-sm ${levelClass}">${ratio.color1} ‚Üî ${ratio.color2}: ${ratio.ratio.toFixed(2)} (${ratio.level})</div>`;
                });
                html += '</div></div>';
            }
            
            // WCAG Compliance
            if (accessibility.wcagAA && accessibility.wcagAA.length > 0) {
                html += '<div><h5 class="font-bold text-gray-800 mb-2">WCAG AA Compliance:</h5><div class="space-y-2">';
                accessibility.wcagAA.forEach(wcag => {
                    const status = wcag.aaNormal ? '‚úÖ' : '‚ùå';
                    html += `<div class="text-sm">${status} ${wcag.color}: Luminance ${wcag.luminance.toFixed(3)}</div>`;
                });
                html += '</div></div>';
            }
            
            // Recommendations
            if (accessibility.recommendations && accessibility.recommendations.length > 0) {
                html += '<div><h5 class="font-bold text-gray-800 mb-2">Recommendations:</h5><ul class="list-disc list-inside space-y-1">';
                accessibility.recommendations.forEach(rec => {
                    html += `<li class="text-sm text-gray-700">${rec}</li>`;
                });
                html += '</ul></div>';
            }
            
            html += '</div>';
            contentDiv.innerHTML = html;
            resultsDiv.classList.remove('hidden');
        }

        // Random Color
        function randomColor() {
            const randomHex = '#' + Math.floor(Math.random()*16777215).toString(16).padStart(6, '0');
            document.getElementById('base-color').value = randomHex;
            document.getElementById('base-color-hex').value = randomHex;
        }

        // Copy to Clipboard
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                // Show temporary feedback
                const originalText = event.target.textContent;
                event.target.textContent = 'Copied!';
                setTimeout(() => {
                    event.target.textContent = originalText;
                }, 1000);
            });
        }

        // Export Functions
        function exportCSS() {
            if (!colorPaletteGenerator) return;
            
            const palette = getCurrentPalette();
            if (!palette) return;
            
            const css = colorPaletteGenerator.generateCSSVariables(palette);
            showExportResults(css);
        }

        function exportSCSS() {
            if (!colorPaletteGenerator) return;
            
            const palette = getCurrentPalette();
            if (!palette) return;
            
            const scss = colorPaletteGenerator.generateSCSSVariables(palette);
            showExportResults(scss);
        }

        function exportTailwind() {
            if (!colorPaletteGenerator) return;
            
            const palette = getCurrentPalette();
            if (!palette) return;
            
            const tailwind = colorPaletteGenerator.generateTailwindConfig(palette);
            showExportResults(tailwind);
        }

        // Get Current Palette
        function getCurrentPalette() {
            const preview = document.getElementById('palette-preview');
            const colorDivs = preview.querySelectorAll('div[style*="background-color"]');
            
            if (colorDivs.length === 0) {
                alert('Please generate a palette first.');
                return null;
            }
            
            const palette = [];
            colorDivs.forEach(div => {
                const style = div.style.backgroundColor;
                const hex = rgbToHex(style);
                palette.push({ hex: hex });
            });
            
            return palette;
        }

        // RGB to Hex conversion
        function rgbToHex(rgb) {
            const match = rgb.match(/\d+/g);
            if (!match || match.length !== 3) return rgb;
            
            const r = parseInt(match[0]);
            const g = parseInt(match[1]);
            const b = parseInt(match[2]);
            
            return "#" + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);
        }

        // Show Export Results
        function showExportResults(code) {
            const resultsDiv = document.getElementById('export-results');
            const outputDiv = document.getElementById('export-output');
            
            outputDiv.value = code;
            resultsDiv.classList.remove('hidden');
            
            // Update line numbers
            updateExportLineNumbers();
        }

        // Update Export Line Numbers
        function updateExportLineNumbers() {
            const output = document.getElementById('export-output');
            const lines = document.getElementById('export-lines');
            
            const lineCount = Math.max(1, output.value.split('\n').length);
            lines.innerHTML = '';
            
            for (let i = 1; i <= lineCount; i++) {
                const lineDiv = document.createElement('div');
                lineDiv.textContent = i;
                lineDiv.className = 'text-xs text-gray-500 text-center';
                lineDiv.style.height = '24px';
                lineDiv.style.lineHeight = '24px';
                lineDiv.style.display = 'flex';
                lineDiv.style.alignItems = 'center';
                lineDiv.style.justifyContent = 'center';
                lines.appendChild(lineDiv);
            }
        }

        // Copy Export
        function copyExport() {
            const output = document.getElementById('export-output');
            output.select();
            document.execCommand('copy');
            
            // Show feedback
            const button = event.target;
            const originalText = button.textContent;
            button.textContent = 'Copied!';
            button.classList.add('bg-green-500');
            setTimeout(() => {
                button.textContent = originalText;
                button.classList.remove('bg-green-500');
            }, 1000);
        }

        // Download Export
        function downloadExport() {
            const output = document.getElementById('export-output');
            const code = output.value;
            
            if (!code) {
                alert('No code to download.');
                return;
            }
            
            const blob = new Blob([code], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'color-palette.txt';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // Update Color Count Display
        function updateColorCountDisplay() {
            const slider = document.getElementById('color-count');
            const display = document.getElementById('color-count-value');
            display.textContent = slider.value;
        }

        // Initialize Color Palette Generator on page load
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                initializeColorPaletteGenerator();
                
                // Set up event listeners
                document.getElementById('color-count').addEventListener('input', updateColorCountDisplay);
                document.getElementById('base-color').addEventListener('change', function() {
                    document.getElementById('base-color-hex').value = this.value;
                });
                document.getElementById('base-color-hex').addEventListener('input', function() {
                    if (this.value.match(/^#[0-9A-Fa-f]{6}$/)) {
                        document.getElementById('base-color').value = this.value;
                    }
                });
            }, 200);
        });

        // Lorem Ipsum Generator Functions
        let loremIpsumGenerator = null;

        // Initialize Lorem Ipsum Generator
        function initializeLoremIpsumGenerator() {
            try {
                if (typeof LoremIpsumGenerator !== 'undefined') {
                    loremIpsumGenerator = new LoremIpsumGenerator();
                    console.log('‚úÖ Lorem Ipsum Generator initialized successfully');
                } else {
                    console.error('‚ùå LoremIpsumGenerator class not found');
                }
            } catch (error) {
                console.error('‚ùå Error initializing Lorem Ipsum Generator:', error);
            }
        }

        // Generate Lorem Ipsum
        function generateLoremIpsum() {
            if (!loremIpsumGenerator) {
                alert('Lorem Ipsum Generator not initialized. Please refresh the page.');
                return;
            }

            const language = document.getElementById('lorem-language').value;
            const type = document.getElementById('lorem-type').value;
            const count = parseInt(document.getElementById('lorem-count').value);
            const format = document.getElementById('lorem-format').value;
            const startWithLorem = document.getElementById('start-with-lorem').checked;

            const result = loremIpsumGenerator.generateText({
                language: language,
                type: type,
                count: count,
                startWithLorem: startWithLorem,
                format: format
            });

            if (result.success) {
                displayLoremOutput(result.text);
                displayLoremStats(result.stats);
                loremIpsumGenerator.addToHistory('generate', `${language}-${type}-${count}`, result.text);
            } else {
                alert('Error generating Lorem Ipsum: ' + result.error);
            }
        }

        // Generate Random Lorem Ipsum
        function generateRandomLorem() {
            const languages = ['latin', 'english', 'spanish', 'french', 'german', 'japanese'];
            const types = ['words', 'sentences', 'paragraphs'];
            
            const randomLanguage = languages[Math.floor(Math.random() * languages.length)];
            const randomType = types[Math.floor(Math.random() * types.length)];
            const randomCount = Math.floor(Math.random() * 100) + 10; // 10-110
            
            document.getElementById('lorem-language').value = randomLanguage;
            document.getElementById('lorem-type').value = randomType;
            document.getElementById('lorem-count').value = randomCount;
            updateCountDescription();
            
            generateLoremIpsum();
        }

        // Display Lorem Output
        function displayLoremOutput(text) {
            const output = document.getElementById('lorem-output');
            output.value = text;
            updateLoremLineNumbers();
        }

        // Display Lorem Stats
        function displayLoremStats(stats) {
            const resultsDiv = document.getElementById('lorem-stats-results');
            const contentDiv = document.getElementById('lorem-stats-content');
            
            let html = '<div class="grid grid-cols-2 md:grid-cols-3 gap-4">';
            html += `<div class="bg-white p-3 rounded-lg border"><div class="text-2xl font-bold text-blue-600">${stats.characters}</div><div class="text-sm text-gray-600">Characters</div></div>`;
            html += `<div class="bg-white p-3 rounded-lg border"><div class="text-2xl font-bold text-green-600">${stats.words}</div><div class="text-sm text-gray-600">Words</div></div>`;
            html += `<div class="bg-white p-3 rounded-lg border"><div class="text-2xl font-bold text-purple-600">${stats.sentences}</div><div class="text-sm text-gray-600">Sentences</div></div>`;
            html += `<div class="bg-white p-3 rounded-lg border"><div class="text-2xl font-bold text-orange-600">${stats.paragraphs}</div><div class="text-sm text-gray-600">Paragraphs</div></div>`;
            html += `<div class="bg-white p-3 rounded-lg border"><div class="text-2xl font-bold text-red-600">${stats.averageWordsPerSentence}</div><div class="text-sm text-gray-600">Avg Words/Sentence</div></div>`;
            html += `<div class="bg-white p-3 rounded-lg border"><div class="text-2xl font-bold text-teal-600">${stats.averageSentencesPerParagraph}</div><div class="text-sm text-gray-600">Avg Sentences/Paragraph</div></div>`;
            html += '</div>';
            
            contentDiv.innerHTML = html;
            resultsDiv.classList.remove('hidden');
        }

        // Update Lorem Line Numbers
        function updateLoremLineNumbers() {
            const output = document.getElementById('lorem-output');
            const lines = document.getElementById('lorem-output-lines');
            
            const lineCount = Math.max(1, output.value.split('\n').length);
            lines.innerHTML = '';
            
            for (let i = 1; i <= lineCount; i++) {
                const lineDiv = document.createElement('div');
                lineDiv.textContent = i;
                lineDiv.className = 'text-xs text-gray-500 text-center';
                lineDiv.style.height = '24px';
                lineDiv.style.lineHeight = '24px';
                lineDiv.style.display = 'flex';
                lineDiv.style.alignItems = 'center';
                lineDiv.style.justifyContent = 'center';
                lines.appendChild(lineDiv);
            }
        }

        // Copy Lorem Output
        function copyLoremOutput() {
            const output = document.getElementById('lorem-output');
            output.select();
            document.execCommand('copy');
            
            // Show feedback
            const button = event.target;
            const originalText = button.textContent;
            button.textContent = 'Copied!';
            button.classList.add('bg-green-500');
            setTimeout(() => {
                button.textContent = originalText;
                button.classList.remove('bg-green-500');
            }, 1000);
        }

        // Download Lorem Output
        function downloadLoremOutput() {
            const output = document.getElementById('lorem-output');
            const text = output.value;
            
            if (!text) {
                alert('No text to download.');
                return;
            }
            
            const blob = new Blob([text], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'lorem-ipsum.txt';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // Update Count Description
        function updateCountDescription() {
            const type = document.getElementById('lorem-type').value;
            const count = document.getElementById('lorem-count').value;
            const description = document.getElementById('count-description');
            
            let text = count + ' ';
            if (type === 'words') {
                text += 'words';
            } else if (type === 'sentences') {
                text += 'sentences';
            } else if (type === 'paragraphs') {
                text += 'paragraphs';
            }
            
            description.textContent = text;
        }

        // Initialize Lorem Ipsum Generator on page load
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                initializeLoremIpsumGenerator();
                
                // Set up event listeners
                document.getElementById('lorem-type').addEventListener('change', updateCountDescription);
                document.getElementById('lorem-count').addEventListener('input', updateCountDescription);
            }, 200);
        });

        // Study Timer Functions
        let studyTimer = null;
        let currentSessionType = 'work';
        let updateInterval = null;

        // Initialize Study Timer
        function initializeStudyTimer() {
            try {
                if (typeof StudyTimer !== 'undefined') {
                    studyTimer = new StudyTimer();
                    console.log('‚úÖ Study Timer initialized successfully');
                    updateDailyStats();
                    updateSessionHistory();
                } else {
                    console.error('‚ùå StudyTimer class not found');
                }
            } catch (error) {
                console.error('‚ùå Error initializing Study Timer:', error);
            }
        }

        // Start Study Timer
        function startStudyTimer() {
            if (!studyTimer) {
                alert('Study Timer not initialized. Please refresh the page.');
                return;
            }

            // Check if timer is already running
            const status = studyTimer.getTimerStatus();
            if (status.isRunning) {
                alert('Timer is already running. Please stop or reset the timer first.');
                return;
            }

            const focusMode = document.getElementById('focus-mode').value;
            const result = studyTimer.startTimer(null, currentSessionType);

            if (result.success) {
                updateTimerDisplay();
                updateTimerControls(true);
                updateInterval = setInterval(updateTimerDisplay, 1000);
                studyTimer.addToHistory('start', currentSessionType, result.message);
            } else {
                alert('Error starting timer: ' + result.error);
            }
        }

        // Pause Study Timer
        function pauseStudyTimer() {
            if (!studyTimer) return;

            const result = studyTimer.pauseTimer();
            if (result.success) {
                updateTimerControls(false, true);
                if (updateInterval) {
                    clearInterval(updateInterval);
                }
            } else {
                alert('Error pausing timer: ' + result.error);
            }
        }

        // Resume Study Timer
        function resumeStudyTimer() {
            if (!studyTimer) return;

            const result = studyTimer.resumeTimer();
            if (result.success) {
                updateTimerControls(true);
                updateInterval = setInterval(updateTimerDisplay, 1000);
            } else {
                alert('Error resuming timer: ' + result.error);
            }
        }

        // Stop Study Timer
        function stopStudyTimer() {
            if (!studyTimer) return;

            const result = studyTimer.stopTimer();
            if (result.success) {
                updateTimerControls(false);
                if (updateInterval) {
                    clearInterval(updateInterval);
                    updateInterval = null;
                }
                updateDailyStats();
                updateSessionHistory();
                studyTimer.addToHistory('stop', currentSessionType, result.message);
            } else {
                alert('Error stopping timer: ' + result.error);
            }
        }

        // Reset Study Timer
        function resetStudyTimer() {
            if (!studyTimer) return;

            const result = studyTimer.resetTimer();
            if (result.success) {
                updateTimerControls(false);
                if (updateInterval) {
                    clearInterval(updateInterval);
                    updateInterval = null;
                }
                updateTimerDisplay();
                studyTimer.addToHistory('reset', currentSessionType, result.message);
            } else {
                alert('Error resetting timer: ' + result.error);
            }
        }

        // Set Session Type
        function setSessionType(type) {
            currentSessionType = type;
            
            // Update button styles
            document.querySelectorAll('[id$="-session"], [id$="-break"]').forEach(btn => {
                btn.classList.remove('ring-4', 'ring-blue-500');
            });
            
            if (type === 'work') {
                document.getElementById('work-session').classList.add('ring-4', 'ring-blue-500');
            } else if (type === 'shortBreak') {
                document.getElementById('short-break').classList.add('ring-4', 'ring-green-500');
            } else if (type === 'longBreak') {
                document.getElementById('long-break').classList.add('ring-4', 'ring-purple-500');
            }
        }

        // Start Quick Session
        function startQuickSession(duration) {
            if (!studyTimer) return;

            const result = studyTimer.startTimer(duration, 'work');
            if (result.success) {
                updateTimerDisplay();
                updateTimerControls(true);
                updateInterval = setInterval(updateTimerDisplay, 1000);
                studyTimer.addToHistory('quick_start', `${duration}min`, result.message);
            } else {
                alert('Error starting quick session: ' + result.error);
            }
        }

        // Update Timer Display
        function updateTimerDisplay() {
            if (!studyTimer) return;

            const status = studyTimer.getTimerStatus();
            const display = document.getElementById('timer-display');
            const progressBar = document.getElementById('progress-bar');
            const statusText = document.getElementById('timer-status');

            if (display) {
                display.textContent = status.timeRemaining.formatted;
            }

            if (progressBar) {
                progressBar.style.width = status.progress + '%';
            }

            if (statusText) {
                if (status.isRunning) {
                    statusText.textContent = status.isPaused ? 'Paused' : 'Running';
                } else {
                    statusText.textContent = 'Ready to start';
                }
            }

            // Auto-stop when timer reaches 0
            if (status.currentTime <= 0 && status.isRunning) {
                if (updateInterval) {
                    clearInterval(updateInterval);
                    updateInterval = null;
                }
                stopStudyTimer();
                showTimerComplete();
            }
        }

        // Update Timer Controls
        function updateTimerControls(isRunning, isPaused = false) {
            const startBtn = document.getElementById('start-btn');
            const pauseBtn = document.getElementById('pause-btn');
            const stopBtn = document.getElementById('stop-btn');

            if (isRunning) {
                startBtn.disabled = true;
                startBtn.textContent = isPaused ? 'Resume' : 'Running';
                startBtn.onclick = isPaused ? resumeStudyTimer : null;
                pauseBtn.disabled = false;
                stopBtn.disabled = false;
            } else {
                startBtn.disabled = false;
                startBtn.textContent = 'Start';
                startBtn.onclick = startStudyTimer;
                pauseBtn.disabled = true;
                stopBtn.disabled = true;
            }
        }

        // Update Daily Stats
        function updateDailyStats() {
            if (!studyTimer) return;

            const stats = studyTimer.getDailyStats();
            
            document.getElementById('today-study-time').textContent = stats.totalStudyTime;
            document.getElementById('today-sessions').textContent = stats.sessionsCompleted;
            document.getElementById('today-breaks').textContent = stats.breaksTaken;
            document.getElementById('focus-score').textContent = stats.focusScore;
        }

        // Update Session History
        function updateSessionHistory() {
            if (!studyTimer) return;

            const history = studyTimer.getSessionHistory(10);
            const container = document.getElementById('session-history');
            
            if (history.length === 0) {
                container.innerHTML = '<div class="text-gray-500 text-center py-4">No sessions yet</div>';
                return;
            }

            let html = '';
            history.forEach(session => {
                const startTime = new Date(session.startTime).toLocaleTimeString();
                const duration = session.duration || 0;
                const typeClass = session.type === 'work' ? 'bg-blue-100 text-blue-800' : 
                                session.type === 'shortBreak' ? 'bg-green-100 text-green-800' : 
                                'bg-purple-100 text-purple-800';
                
                html += `
                    <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                        <div>
                            <span class="px-2 py-1 rounded text-xs font-medium ${typeClass}">${session.type}</span>
                            <span class="ml-2 text-sm text-gray-600">${startTime}</span>
                        </div>
                        <div class="text-sm font-medium">${duration}min</div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        // Show Timer Complete
        function showTimerComplete() {
            const status = studyTimer.getTimerStatus();
            if (status.currentSession && status.currentSession.type === 'work') {
                // Auto-schedule break
                const nextSession = studyTimer.scheduleNextSession();
                if (nextSession) {
                    alert(`üéâ Work session complete! ${nextSession.message}`);
                    setSessionType(nextSession.type);
                }
            } else {
                alert('‚è∞ Timer complete! Great job!');
            }
        }

        // Handle Focus Mode Change
        function handleFocusModeChange() {
            const mode = document.getElementById('focus-mode').value;
            const customSettings = document.getElementById('custom-settings');
            
            if (mode === 'custom') {
                customSettings.classList.remove('hidden');
            } else {
                customSettings.classList.add('hidden');
                studyTimer.setFocusMode(mode);
            }
        }

        // Update Custom Settings
        function updateCustomSettings() {
            const work = parseInt(document.getElementById('custom-work').value);
            const shortBreak = parseInt(document.getElementById('custom-short').value);
            const longBreak = parseInt(document.getElementById('custom-long').value);
            
            studyTimer.updateCustomSettings(work, shortBreak, longBreak);
        }

        // Initialize Study Timer on page load
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                initializeStudyTimer();
                
                // Set up event listeners
                document.getElementById('focus-mode').addEventListener('change', handleFocusModeChange);
                document.getElementById('custom-work').addEventListener('change', updateCustomSettings);
                document.getElementById('custom-short').addEventListener('change', updateCustomSettings);
                document.getElementById('custom-long').addEventListener('change', updateCustomSettings);
                
                // Set default session type
                setSessionType('work');
            }, 200);
        });

        // Note-Taking & Summarizer Functions
        let noteTaker = null;

        // Initialize Note Taker
        function initializeNoteTaker() {
            try {
                if (typeof NoteTaker !== 'undefined') {
                    noteTaker = new NoteTaker();
                    console.log('‚úÖ Note Taker initialized successfully');
                    updateNotesLibrary();
                } else {
                    console.error('‚ùå NoteTaker class not found');
                }
            } catch (error) {
                console.error('‚ùå Error initializing Note Taker:', error);
            }
        }

        // Summarize Text
        function summarizeText() {
            if (!noteTaker) {
                alert('Note Taker not initialized. Please refresh the page.');
                return;
            }

            const text = document.getElementById('note-text').value.trim();
            if (!text) {
                alert('Please enter text to summarize.');
                return;
            }

            const mode = document.getElementById('summary-mode').value;
            const result = noteTaker.summarizeText(text, mode);

            if (result.success) {
                showSummaryResults(result);
            } else {
                alert('Error summarizing text: ' + result.error);
            }
        }

        // Extract Key Points
        function extractKeyPoints() {
            if (!noteTaker) {
                alert('Note Taker not initialized. Please refresh the page.');
                return;
            }

            const text = document.getElementById('note-text').value.trim();
            if (!text) {
                alert('Please enter text to analyze.');
                return;
            }

            const maxPoints = parseInt(document.getElementById('key-points-count').value);
            const result = noteTaker.extractKeyPoints(text, maxPoints);

            if (result.success) {
                showKeyPointsResults(result);
            } else {
                alert('Error extracting key points: ' + result.error);
            }
        }

        // Analyze Text
        function analyzeText() {
            if (!noteTaker) {
                alert('Note Taker not initialized. Please refresh the page.');
                return;
            }

            const text = document.getElementById('note-text').value.trim();
            if (!text) {
                alert('Please enter text to analyze.');
                return;
            }

            const result = noteTaker.analyzeText(text);

            if (result.success) {
                showAnalysisResults(result);
            } else {
                alert('Error analyzing text: ' + result.error);
            }
        }

        // Create Structured Notes
        function createStructuredNotes() {
            if (!noteTaker) {
                alert('Note Taker not initialized. Please refresh the page.');
                return;
            }

            const text = document.getElementById('note-text').value.trim();
            if (!text) {
                alert('Please enter text for notes.');
                return;
            }

            const title = prompt('Enter a title for your notes:', 'Untitled Note');
            if (!title) return;

            const result = noteTaker.createStructuredNotes(text, title);

            if (result.success) {
                showNotesResults(result);
                updateNotesLibrary();
            } else {
                alert('Error creating notes: ' + result.error);
            }
        }

        // Show Summary Results
        function showSummaryResults(result) {
            hideAllNoteResults();
            
            document.getElementById('summary-content').textContent = result.summary;
            document.getElementById('summary-stats').innerHTML = `
                <strong>${result.mode}</strong> | 
                ${result.originalLength} ‚Üí ${result.summaryLength} words | 
                ${Math.round(result.compressionRatio * 100)}% reduction | 
                ${result.sentencesUsed}/${result.totalSentences} sentences used
            `;
            document.getElementById('summary-results').classList.remove('hidden');
        }

        // Show Key Points Results
        function showKeyPointsResults(result) {
            hideAllNoteResults();
            
            const container = document.getElementById('key-points-content');
            container.innerHTML = '';
            
            result.keyPoints.forEach((point, index) => {
                const pointDiv = document.createElement('div');
                pointDiv.className = 'flex items-start space-x-2';
                pointDiv.innerHTML = `
                    <span class="bg-green-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm font-bold">${index + 1}</span>
                    <span class="text-gray-700">${point.text}</span>
                `;
                container.appendChild(pointDiv);
            });
            
            document.getElementById('key-points-stats').textContent = 
                `Extracted ${result.totalPoints} key points from ${result.originalLength} words`;
            document.getElementById('key-points-results').classList.remove('hidden');
        }

        // Show Analysis Results
        function showAnalysisResults(result) {
            hideAllNoteResults();
            
            const analysis = result.analysis;
            const container = document.getElementById('analysis-content');
            container.innerHTML = `
                <div class="bg-white p-3 rounded-lg">
                    <div class="text-sm font-semibold text-gray-600">Word Count</div>
                    <div class="text-2xl font-bold text-blue-600">${analysis.wordCount}</div>
                </div>
                <div class="bg-white p-3 rounded-lg">
                    <div class="text-sm font-semibold text-gray-600">Sentences</div>
                    <div class="text-2xl font-bold text-green-600">${analysis.sentenceCount}</div>
                </div>
                <div class="bg-white p-3 rounded-lg">
                    <div class="text-sm font-semibold text-gray-600">Reading Time</div>
                    <div class="text-2xl font-bold text-purple-600">${analysis.readingTime.formatted}</div>
                </div>
                <div class="bg-white p-3 rounded-lg">
                    <div class="text-sm font-semibold text-gray-600">Complexity</div>
                    <div class="text-2xl font-bold text-orange-600">${analysis.complexityScore}/100</div>
                </div>
                <div class="bg-white p-3 rounded-lg">
                    <div class="text-sm font-semibold text-gray-600">Readability</div>
                    <div class="text-2xl font-bold text-indigo-600">${analysis.readabilityScore.level}</div>
                </div>
                <div class="bg-white p-3 rounded-lg">
                    <div class="text-sm font-semibold text-gray-600">Keywords</div>
                    <div class="text-sm text-gray-700">${analysis.keywords.slice(0, 5).join(', ')}</div>
                </div>
            `;
            
            document.getElementById('analysis-stats').textContent = 
                `Analyzed ${analysis.wordCount} words in ${analysis.sentenceCount} sentences`;
            document.getElementById('analysis-results').classList.remove('hidden');
        }

        // Show Notes Results
        function showNotesResults(result) {
            hideAllNoteResults();
            
            const note = result.note;
            const container = document.getElementById('notes-content');
            container.innerHTML = `
                <div class="bg-white p-4 rounded-lg">
                    <h5 class="font-bold text-lg text-gray-800 mb-2">${note.title}</h5>
                    <div class="text-sm text-gray-600 mb-3">Created: ${new Date(note.createdAt).toLocaleString()}</div>
                    
                    <div class="mb-3">
                        <h6 class="font-semibold text-gray-700 mb-1">Summary:</h6>
                        <p class="text-gray-600 text-sm">${note.summary}</p>
                    </div>
                    
                    <div class="mb-3">
                        <h6 class="font-semibold text-gray-700 mb-1">Key Points:</h6>
                        <ul class="text-sm text-gray-600 space-y-1">
                            ${note.keyPoints.map((point, index) => 
                                `<li>${index + 1}. ${point.text}</li>`
                            ).join('')}
                        </ul>
                    </div>
                    
                    <div class="flex flex-wrap gap-2">
                        ${note.tags.map(tag => 
                            `<span class="bg-indigo-100 text-indigo-800 text-xs px-2 py-1 rounded">${tag}</span>`
                        ).join('')}
                    </div>
                </div>
            `;
            
            document.getElementById('notes-results').classList.remove('hidden');
        }

        // Hide All Note Results
        function hideAllNoteResults() {
            document.getElementById('summary-results').classList.add('hidden');
            document.getElementById('key-points-results').classList.add('hidden');
            document.getElementById('analysis-results').classList.add('hidden');
            document.getElementById('notes-results').classList.add('hidden');
        }

        // Clear Note Text
        function clearNoteText() {
            document.getElementById('note-text').value = '';
            hideAllNoteResults();
        }

        // Load Sample Text
        function loadSampleText() {
            const sampleText = `Artificial Intelligence (AI) has revolutionized numerous industries and continues to shape the future of technology. AI refers to the simulation of human intelligence in machines that are programmed to think and learn like humans. The field encompasses machine learning, deep learning, natural language processing, and computer vision.

Machine learning is a subset of AI that enables computers to learn and improve from experience without being explicitly programmed. Deep learning, a subset of machine learning, uses neural networks with multiple layers to process data and make decisions. These technologies have applications in healthcare, finance, transportation, and entertainment.

The benefits of AI include increased efficiency, automation of repetitive tasks, and the ability to process vast amounts of data quickly. However, challenges such as job displacement, ethical concerns, and the need for proper regulation must be addressed. As AI continues to evolve, it will play an increasingly important role in solving complex global problems.`;
            
            document.getElementById('note-text').value = sampleText;
        }

        // Copy Note Text
        function copyNoteText() {
            const text = document.getElementById('note-text').value;
            navigator.clipboard.writeText(text).then(() => {
                alert('Text copied to clipboard!');
            });
        }

        // Copy Summary
        function copySummary() {
            const summary = document.getElementById('summary-content').textContent;
            navigator.clipboard.writeText(summary).then(() => {
                alert('Summary copied to clipboard!');
            });
        }

        // Copy Key Points
        function copyKeyPoints() {
            const points = Array.from(document.querySelectorAll('#key-points-content .text-gray-700'))
                .map(el => el.textContent.trim())
                .join('\n');
            navigator.clipboard.writeText(points).then(() => {
                alert('Key points copied to clipboard!');
            });
        }

        // Download Summary
        function downloadSummary() {
            const summary = document.getElementById('summary-content').textContent;
            const stats = document.getElementById('summary-stats').textContent;
            const content = `Summary\n\n${summary}\n\n${stats}`;
            
            const blob = new Blob([content], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'summary.txt';
            a.click();
            URL.revokeObjectURL(url);
        }

        // Download Key Points
        function downloadKeyPoints() {
            const points = Array.from(document.querySelectorAll('#key-points-content .text-gray-700'))
                .map((el, index) => `${index + 1}. ${el.textContent.trim()}`)
                .join('\n');
            
            const blob = new Blob([points], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'key-points.txt';
            a.click();
            URL.revokeObjectURL(url);
        }

        // Save Notes
        function saveNotes() {
            alert('Notes saved to library!');
        }

        // Download Notes
        function downloadNotes() {
            const noteContent = document.getElementById('notes-content').innerHTML;
            const content = `Structured Notes\n\n${noteContent}`;
            
            const blob = new Blob([content], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'structured-notes.html';
            a.click();
            URL.revokeObjectURL(url);
        }

        // Update Notes Library
        function updateNotesLibrary() {
            if (!noteTaker) return;
            
            const notes = noteTaker.getNotes();
            const container = document.getElementById('notes-library');
            
            if (notes.length === 0) {
                container.innerHTML = '<div class="text-gray-500 text-center py-4">No saved notes yet</div>';
                return;
            }
            
            let html = '';
            notes.forEach(note => {
                html += `
                    <div class="bg-gray-50 p-3 rounded-lg">
                        <div class="font-semibold text-gray-800">${note.title}</div>
                        <div class="text-sm text-gray-600">${new Date(note.createdAt).toLocaleDateString()}</div>
                        <div class="text-xs text-gray-500 mt-1">${note.analysis.wordCount} words</div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        // Initialize Note Taker on page load
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                initializeNoteTaker();
            }, 200);
        });

        // Math Problem Solver Functions
        let mathSolver = null;

        // Initialize Math Solver
        function initializeMathSolver() {
            try {
                if (typeof MathSolver !== 'undefined') {
                    mathSolver = new MathSolver();
                    console.log('‚úÖ Math Solver initialized successfully');
                    updateSolutionHistory();
                } else {
                    console.error('‚ùå MathSolver class not found');
                }
            } catch (error) {
                console.error('‚ùå Error initializing Math Solver:', error);
            }
        }

        // Solve Math Problem
        function solveMathProblem() {
            if (!mathSolver) {
                alert('Math Solver not initialized. Please refresh the page.');
                return;
            }

            const problem = document.getElementById('math-problem').value.trim();
            if (!problem) {
                alert('Please enter a math problem to solve.');
                return;
            }

            const category = document.getElementById('math-category').value;
            const result = mathSolver.solveProblem(problem, category);

            if (result.success) {
                showSolutionResults(result);
                updateSolutionHistory();
            } else {
                alert('Error solving problem: ' + result.error);
            }
        }

        // Show Solution Results
        function showSolutionResults(result) {
            hideAllMathResults();
            
            document.getElementById('solution-answer').textContent = `Answer: ${result.answer}`;
            document.getElementById('solution-explanation').textContent = result.explanation;
            
            const stepsContainer = document.getElementById('solution-steps');
            stepsContainer.innerHTML = '';
            
            result.steps.forEach((step, index) => {
                const stepDiv = document.createElement('div');
                stepDiv.className = 'flex items-start space-x-2 p-2 bg-white rounded border-l-4 border-green-500';
                stepDiv.innerHTML = `
                    <span class="bg-green-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm font-bold">${index + 1}</span>
                    <span class="text-gray-700">${step}</span>
                `;
                stepsContainer.appendChild(stepDiv);
            });
            
            document.getElementById('solution-results').classList.remove('hidden');
            
            // Show graph if available
            if (result.graphData) {
                showGraphResults(result.graphData);
            }
            
            // Show problem analysis
            showProblemAnalysis(result);
        }

        // Show Graph Results
        function showGraphResults(graphData) {
            const container = document.getElementById('graph-container');
            const equation = document.getElementById('graph-equation');
            
            if (graphData.type === 'line') {
                container.innerHTML = `
                    <div class="text-center">
                        <div class="text-lg font-semibold text-gray-800 mb-2">Linear Function Graph</div>
                        <div class="text-sm text-gray-600">${graphData.equation}</div>
                        <div class="mt-4 text-sm text-gray-500">
                            Graph points: (${graphData.points.length} points from x=-10 to x=10)
                        </div>
                    </div>
                `;
            } else if (graphData.type === 'parabola') {
                container.innerHTML = `
                    <div class="text-center">
                        <div class="text-lg font-semibold text-gray-800 mb-2">Quadratic Function Graph</div>
                        <div class="text-sm text-gray-600">${graphData.equation}</div>
                        <div class="mt-4 text-sm text-gray-500">
                            Parabola points: (${graphData.points.length} points from x=-10 to x=10)
                        </div>
                    </div>
                `;
            }
            
            equation.textContent = `Equation: ${graphData.equation}`;
            document.getElementById('graph-results').classList.remove('hidden');
        }

        // Show Problem Analysis
        function showProblemAnalysis(result) {
            document.getElementById('problem-type').textContent = `Problem Type: ${result.type}`;
            document.getElementById('problem-difficulty').textContent = `Difficulty: ${getDifficultyLevel(result.type)}`;
            document.getElementById('problem-category').textContent = `Category: ${result.category}`;
            document.getElementById('analysis-results').classList.remove('hidden');
        }

        // Get Difficulty Level
        function getDifficultyLevel(type) {
            const difficulties = {
                'linear': 'Easy',
                'percentage': 'Easy',
                'fraction': 'Easy',
                'quadratic': 'Medium',
                'polynomial': 'Medium',
                'area': 'Medium',
                'volume': 'Medium',
                'derivative': 'Hard',
                'integral': 'Hard',
                'trigonometry': 'Hard',
                'statistics': 'Hard',
                'general': 'Variable'
            };
            return difficulties[type] || 'Unknown';
        }

        // Hide All Math Results
        function hideAllMathResults() {
            document.getElementById('solution-results').classList.add('hidden');
            document.getElementById('graph-results').classList.add('hidden');
            document.getElementById('analysis-results').classList.add('hidden');
        }

        // Load Template
        function loadTemplate(type) {
            const templates = {
                'linear': '2x + 5 = 13',
                'quadratic': 'x¬≤ + 3x - 4 = 0',
                'percentage': '25% of 80',
                'fraction': '3/4 + 1/2'
            };
            
            document.getElementById('math-problem').value = templates[type] || '';
        }

        // Clear Math Problem
        function clearMathProblem() {
            document.getElementById('math-problem').value = '';
            hideAllMathResults();
        }

        // Copy Math Problem
        function copyMathProblem() {
            const problem = document.getElementById('math-problem').value;
            navigator.clipboard.writeText(problem).then(() => {
                alert('Problem copied to clipboard!');
            });
        }

        // Load Sample Problem
        function loadSampleProblem() {
            const samples = [
                '2x + 5 = 13',
                'x¬≤ + 3x - 4 = 0',
                '25% of 80',
                '3/4 + 1/2',
                'Find the area of a circle with radius 5',
                'What is 15% of 200?'
            ];
            
            const randomSample = samples[Math.floor(Math.random() * samples.length)];
            document.getElementById('math-problem').value = randomSample;
        }

        // Show Math Help
        function showMathHelp() {
            const helpText = `
Math Problem Solver Help:

Supported Problem Types:
‚Ä¢ Linear Equations: 2x + 5 = 13
‚Ä¢ Quadratic Equations: x¬≤ + 3x - 4 = 0
‚Ä¢ Percentage Problems: 25% of 80
‚Ä¢ Fraction Operations: 3/4 + 1/2
‚Ä¢ Area/Volume: Find area of circle with radius 5
‚Ä¢ Basic Arithmetic: 2 + 3 * 4

Tips:
‚Ä¢ Use standard mathematical notation
‚Ä¢ Include the equals sign (=) for equations
‚Ä¢ Use x for variables
‚Ä¢ Use ^ for exponents (x^2 for x¬≤)
‚Ä¢ Be specific with your problem statement
            `;
            
            alert(helpText);
        }

        // Copy Solution
        function copySolution() {
            const answer = document.getElementById('solution-answer').textContent;
            const explanation = document.getElementById('solution-explanation').textContent;
            const steps = Array.from(document.querySelectorAll('#solution-steps .text-gray-700'))
                .map(el => el.textContent.trim())
                .join('\n');
            
            const solution = `${answer}\n\n${explanation}\n\nSteps:\n${steps}`;
            navigator.clipboard.writeText(solution).then(() => {
                alert('Solution copied to clipboard!');
            });
        }

        // Download Solution
        function downloadSolution() {
            const answer = document.getElementById('solution-answer').textContent;
            const explanation = document.getElementById('solution-explanation').textContent;
            const steps = Array.from(document.querySelectorAll('#solution-steps .text-gray-700'))
                .map(el => el.textContent.trim())
                .join('\n');
            
            const content = `Math Problem Solution\n\n${answer}\n\n${explanation}\n\nSteps:\n${steps}`;
            
            const blob = new Blob([content], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'math-solution.txt';
            a.click();
            URL.revokeObjectURL(url);
        }

        // Update Solution History
        function updateSolutionHistory() {
            if (!mathSolver) return;
            
            const solutions = mathSolver.getSolutions();
            const container = document.getElementById('solution-history');
            
            if (solutions.length === 0) {
                container.innerHTML = '<div class="text-gray-500 text-center py-4">No solutions yet</div>';
                return;
            }
            
            let html = '';
            solutions.slice(0, 5).forEach(solution => {
                html += `
                    <div class="bg-gray-50 p-3 rounded-lg">
                        <div class="font-semibold text-gray-800">${solution.problem}</div>
                        <div class="text-sm text-gray-600">Answer: ${solution.answer}</div>
                        <div class="text-xs text-gray-500 mt-1">${solution.type} ‚Ä¢ ${solution.category}</div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        // Initialize Math Solver on page load
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                initializeMathSolver();
            }, 200);
        });

        // Grade Calculator Functions
        let gradeCalculator = null;

        // Initialize Grade Calculator
        function initializeGradeCalculator() {
            try {
                if (typeof GradeCalculator !== 'undefined') {
                    gradeCalculator = new GradeCalculator();
                    console.log('‚úÖ Grade Calculator initialized successfully');
                    updateCoursesList();
                } else {
                    console.error('‚ùå GradeCalculator class not found');
                }
            } catch (error) {
                console.error('‚ùå Error initializing Grade Calculator:', error);
            }
        }

        // Add Course
        function addCourse() {
            if (!gradeCalculator) {
                alert('Grade Calculator not initialized. Please refresh the page.');
                return;
            }

            const courseData = {
                name: document.getElementById('course-name').value.trim(),
                code: document.getElementById('course-code').value.trim(),
                credits: document.getElementById('course-credits').value,
                grade: document.getElementById('course-grade').value.trim(),
                semester: document.getElementById('course-semester').value.trim() || 'Current Semester'
            };

            if (!courseData.name || !courseData.grade) {
                alert('Please fill in course name and grade.');
                return;
            }

            const result = gradeCalculator.addCourse(courseData);
            if (result.success) {
                clearCourseForm();
                updateCoursesList();
                alert('Course added successfully!');
            } else {
                alert('Error adding course: ' + result.error);
            }
        }

        // Calculate GPA
        function calculateGPA() {
            if (!gradeCalculator) {
                alert('Grade Calculator not initialized. Please refresh the page.');
                return;
            }

            const scale = document.getElementById('grade-scale').value;
            const result = gradeCalculator.calculateGPA(null, scale);

            if (result.success) {
                showGPAResults(result);
            } else {
                alert('Error calculating GPA: ' + result.error);
            }
        }

        // Calculate Grade Needed
        function calculateGradeNeeded() {
            if (!gradeCalculator) {
                alert('Grade Calculator not initialized. Please refresh the page.');
                return;
            }

            const currentGrade = document.getElementById('current-grade').value;
            const targetGrade = document.getElementById('target-grade').value;
            const remainingWeight = document.getElementById('remaining-weight').value;

            if (!currentGrade || !targetGrade || !remainingWeight) {
                alert('Please fill in all fields.');
                return;
            }

            const result = gradeCalculator.calculateGradeNeeded(currentGrade, targetGrade, remainingWeight / 100);
            if (result.success) {
                showGradeNeededResults(result);
            } else {
                alert('Error calculating grade needed: ' + result.error);
            }
        }

        // Show GPA Results
        function showGPAResults(result) {
            hideAllGradeResults();
            
            document.getElementById('gpa-display').textContent = `${result.gpa} (${result.letterGrade})`;
            document.getElementById('gpa-details').innerHTML = `
                <div>Total Points: ${result.totalPoints.toFixed(2)}</div>
                <div>Total Credits: ${result.totalCredits}</div>
                <div>Valid Courses: ${result.validCourses}/${result.totalCourses}</div>
                <div>Scale: ${result.scale}</div>
            `;
            
            const standing = gradeCalculator.getAcademicStanding(result.gpa);
            document.getElementById('academic-standing').textContent = `Academic Standing: ${standing}`;
            
            document.getElementById('gpa-results').classList.remove('hidden');
        }

        // Show Grade Needed Results
        function showGradeNeededResults(result) {
            hideAllGradeResults();
            
            document.getElementById('grade-needed-display').textContent = `${result.neededGrade}% (${result.letterGrade})`;
            document.getElementById('grade-needed-details').innerHTML = `
                <div>Current Grade: ${result.currentGrade}%</div>
                <div>Target Grade: ${result.targetGrade}%</div>
                <div>Remaining Weight: ${(result.remainingWeight * 100).toFixed(1)}%</div>
            `;
            
            document.getElementById('grade-needed-results').classList.remove('hidden');
        }

        // Hide All Grade Results
        function hideAllGradeResults() {
            document.getElementById('gpa-results').classList.add('hidden');
            document.getElementById('grade-needed-results').classList.add('hidden');
            document.getElementById('statistics-results').classList.add('hidden');
        }

        // Clear Course Form
        function clearCourseForm() {
            document.getElementById('course-name').value = '';
            document.getElementById('course-code').value = '';
            document.getElementById('course-credits').value = '';
            document.getElementById('course-grade').value = '';
            document.getElementById('course-semester').value = '';
        }

        // Clear All Courses
        function clearCourses() {
            if (!gradeCalculator) return;
            
            if (confirm('Are you sure you want to clear all courses?')) {
                gradeCalculator.clearHistory();
                updateCoursesList();
                hideAllGradeResults();
                alert('All courses cleared!');
            }
        }

        // Export Data
        function exportData() {
            if (!gradeCalculator) {
                alert('Grade Calculator not initialized. Please refresh the page.');
                return;
            }

            const result = gradeCalculator.exportData('json');
            if (result.success) {
                const dataStr = JSON.stringify(result.data, null, 2);
                const blob = new Blob([dataStr], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'grade-data.json';
                a.click();
                URL.revokeObjectURL(url);
                alert('Data exported successfully!');
            } else {
                alert('Error exporting data: ' + result.error);
            }
        }

        // Load Sample Data
        function loadSampleData() {
            if (!gradeCalculator) return;
            
            const sampleCourses = [
                { name: 'Mathematics 101', code: 'MATH101', credits: 3, grade: 'A', semester: 'Fall 2024' },
                { name: 'English Literature', code: 'ENG201', credits: 3, grade: 'B+', semester: 'Fall 2024' },
                { name: 'Physics 101', code: 'PHYS101', credits: 4, grade: 'A-', semester: 'Fall 2024' },
                { name: 'History 101', code: 'HIST101', credits: 3, grade: 'B', semester: 'Fall 2024' },
                { name: 'Computer Science 101', code: 'CS101', credits: 3, grade: 'A', semester: 'Fall 2024' }
            ];
            
            sampleCourses.forEach(course => {
                gradeCalculator.addCourse(course);
            });
            
            updateCoursesList();
            alert('Sample data loaded successfully!');
        }

        // Update Courses List
        function updateCoursesList() {
            if (!gradeCalculator) return;
            
            const courses = gradeCalculator.courses;
            const container = document.getElementById('courses-list');
            
            if (courses.length === 0) {
                container.innerHTML = '<div class="text-gray-500 text-center py-4">No courses added yet</div>';
                return;
            }
            
            let html = '';
            courses.forEach(course => {
                const gradeValue = gradeCalculator.getGradeValue(course.grade, '4.0');
                const letterGrade = gradeCalculator.getLetterGrade(gradeValue, '4.0');
                
                html += `
                    <div class="bg-gray-50 p-3 rounded-lg">
                        <div class="flex justify-between items-start">
                            <div>
                                <div class="font-semibold text-gray-800">${course.name}</div>
                                <div class="text-sm text-gray-600">${course.code} ‚Ä¢ ${course.credits} credits</div>
                                <div class="text-sm text-gray-500">${course.semester}</div>
                            </div>
                            <div class="text-right">
                                <div class="text-lg font-bold text-gray-800">${course.grade}</div>
                                <div class="text-sm text-gray-600">${letterGrade}</div>
                                <button onclick="deleteCourse(${course.id})" class="text-red-500 hover:text-red-700 text-sm">Delete</button>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        // Delete Course
        function deleteCourse(courseId) {
            if (!gradeCalculator) return;
            
            if (confirm('Are you sure you want to delete this course?')) {
                const result = gradeCalculator.deleteCourse(courseId);
                if (result.success) {
                    updateCoursesList();
                    alert('Course deleted successfully!');
                } else {
                    alert('Error deleting course: ' + result.error);
                }
            }
        }

        // Initialize Grade Calculator on page load
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                initializeGradeCalculator();
            }, 200);
        });

        // Citation Generator Functions
        let citationGenerator = null;

        // Initialize Citation Generator
        function initializeCitationGenerator() {
            try {
                if (typeof CitationGenerator !== 'undefined') {
                    citationGenerator = new CitationGenerator();
                    console.log('‚úÖ Citation Generator initialized successfully');
                    updateFormatInfo();
                    updateSourceFields();
                } else {
                    console.error('‚ùå CitationGenerator class not found');
                }
            } catch (error) {
                console.error('‚ùå Error initializing Citation Generator:', error);
            }
        }

        // Update Format Info
        function updateFormatInfo() {
            if (!citationGenerator) return;
            
            const format = document.getElementById('citation-format').value;
            const formats = citationGenerator.getCitationFormats();
            const formatInfo = formats[format];
            
            if (formatInfo) {
                document.getElementById('format-info').innerHTML = `
                    <strong>${formatInfo.name}</strong> (${formatInfo.version})<br>
                    <em>${formatInfo.description}</em>
                `;
            }
        }

        // Update Source Fields
        function updateSourceFields() {
            if (!citationGenerator) return;
            
            const sourceType = document.getElementById('source-type').value;
            const sourceTypeInfo = citationGenerator.getSourceTypeFields(sourceType);
            const container = document.getElementById('source-fields');
            
            if (!sourceTypeInfo) {
                container.innerHTML = '<div class="text-gray-500 text-center py-4">Invalid source type</div>';
                return;
            }
            
            let html = '';
            sourceTypeInfo.fields.forEach(field => {
                const isRequired = sourceTypeInfo.required.includes(field);
                const fieldLabel = field.charAt(0).toUpperCase() + field.slice(1).replace(/([A-Z])/g, ' $1');
                const fieldType = field === 'year' ? 'number' : 'text';
                const placeholder = getFieldPlaceholder(field);
                
                html += `
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">
                            ${fieldLabel} ${isRequired ? '<span class="text-red-500">*</span>' : ''}
                        </label>
                        <input type="${fieldType}" id="source-${field}" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500" placeholder="${placeholder}" ${isRequired ? 'required' : ''}>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        // Get Field Placeholder
        function getFieldPlaceholder(field) {
            const placeholders = {
                'author': 'e.g., John Smith, Jane Doe',
                'title': 'e.g., The Great Adventure',
                'publisher': 'e.g., Academic Press',
                'year': 'e.g., 2024',
                'city': 'e.g., New York',
                'pages': 'e.g., 123-145',
                'edition': 'e.g., 2nd ed.',
                'isbn': 'e.g., 978-0-123456-78-9',
                'journal': 'e.g., Journal of Science',
                'volume': 'e.g., 15',
                'issue': 'e.g., 3',
                'doi': 'e.g., 10.1000/123456',
                'website': 'e.g., Wikipedia',
                'url': 'e.g., https://example.com',
                'date': 'e.g., January 15, 2024',
                'accessDate': 'e.g., March 1, 2024',
                'newspaper': 'e.g., The New York Times',
                'conference': 'e.g., International Conference on AI',
                'location': 'e.g., San Francisco, CA',
                'degree': 'e.g., Ph.D.',
                'university': 'e.g., Harvard University',
                'platform': 'e.g., YouTube',
                'episode': 'e.g., Episode 1',
                'duration': 'e.g., 15:30',
                'podcast': 'e.g., Science Talk'
            };
            
            return placeholders[field] || `Enter ${field}`;
        }

        // Generate Citation
        function generateCitation() {
            if (!citationGenerator) {
                alert('Citation Generator not initialized. Please refresh the page.');
                return;
            }

            const format = document.getElementById('citation-format').value;
            const sourceType = document.getElementById('source-type').value;
            const sourceTypeInfo = citationGenerator.getSourceTypeFields(sourceType);
            
            if (!sourceTypeInfo) {
                alert('Invalid source type selected.');
                return;
            }

            // Collect source data
            const sourceData = { type: sourceType };
            let hasRequiredFields = true;
            
            sourceTypeInfo.fields.forEach(field => {
                const value = document.getElementById(`source-${field}`).value.trim();
                sourceData[field] = value;
                
                if (sourceTypeInfo.required.includes(field) && !value) {
                    hasRequiredFields = false;
                }
            });

            if (!hasRequiredFields) {
                alert('Please fill in all required fields.');
                return;
            }

            const result = citationGenerator.generateCitation(sourceData, format);
            if (result.success) {
                showCitationResults(result);
                updateCitationHistory();
            } else {
                alert('Error generating citation: ' + result.error);
            }
        }

        // Show Citation Results
        function showCitationResults(result) {
            document.getElementById('citation-display').textContent = result.citation;
            document.getElementById('citation-results').classList.remove('hidden');
        }

        // Copy Citation
        function copyCitation() {
            const citation = document.getElementById('citation-display').textContent;
            navigator.clipboard.writeText(citation).then(() => {
                alert('Citation copied to clipboard!');
            }).catch(err => {
                console.error('Failed to copy citation: ', err);
                alert('Failed to copy citation. Please try again.');
            });
        }

        // Download Citation
        function downloadCitation() {
            const citation = document.getElementById('citation-display').textContent;
            const format = document.getElementById('citation-format').value;
            const sourceType = document.getElementById('source-type').value;
            
            const blob = new Blob([citation], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `citation-${format}-${sourceType}.txt`;
            a.click();
            URL.revokeObjectURL(url);
            
            alert('Citation downloaded successfully!');
        }

        // Clear Citation Form
        function clearCitationForm() {
            const sourceType = document.getElementById('source-type').value;
            const sourceTypeInfo = citationGenerator.getSourceTypeFields(sourceType);
            
            if (sourceTypeInfo) {
                sourceTypeInfo.fields.forEach(field => {
                    const input = document.getElementById(`source-${field}`);
                    if (input) input.value = '';
                });
            }
            
            document.getElementById('citation-results').classList.add('hidden');
        }

        // Load Sample Data
        function loadSampleData() {
            if (!citationGenerator) return;
            
            const sourceType = document.getElementById('source-type').value;
            const sampleData = getSampleData(sourceType);
            
            if (sampleData) {
                Object.keys(sampleData).forEach(field => {
                    const input = document.getElementById(`source-${field}`);
                    if (input) input.value = sampleData[field];
                });
            }
        }

        // Get Sample Data
        function getSampleData(sourceType) {
            const samples = {
                'book': {
                    author: 'Smith, J. A.',
                    title: 'Introduction to Computer Science',
                    publisher: 'Academic Press',
                    year: '2024',
                    city: 'New York',
                    pages: '350',
                    edition: '3rd ed.',
                    isbn: '978-0-123456-78-9'
                },
                'journal': {
                    author: 'Johnson, M. B., & Wilson, K. C.',
                    title: 'Artificial Intelligence in Healthcare',
                    journal: 'Journal of Medical Technology',
                    volume: '15',
                    issue: '3',
                    pages: '123-145',
                    year: '2024',
                    doi: '10.1000/123456'
                },
                'website': {
                    author: 'Brown, A. R.',
                    title: 'The Future of Renewable Energy',
                    website: 'Energy Today',
                    url: 'https://www.energytoday.com/future-renewable-energy',
                    date: 'March 15, 2024',
                    accessDate: 'April 1, 2024'
                },
                'newspaper': {
                    author: 'Davis, L. M.',
                    title: 'Climate Change Impact on Agriculture',
                    newspaper: 'The New York Times',
                    date: 'February 20, 2024',
                    pages: 'A1, A8',
                    url: 'https://www.nytimes.com/climate-agriculture'
                },
                'conference': {
                    author: 'Garcia, R. S.',
                    title: 'Machine Learning Applications in Finance',
                    conference: 'International Conference on AI',
                    location: 'San Francisco, CA',
                    date: 'June 10-12, 2024',
                    pages: '45-52',
                    publisher: 'IEEE'
                },
                'thesis': {
                    author: 'Miller, K. L.',
                    title: 'Sustainable Urban Planning Strategies',
                    degree: 'Ph.D.',
                    university: 'Harvard University',
                    year: '2024',
                    pages: '250'
                },
                'video': {
                    author: 'TechChannel',
                    title: 'Introduction to Quantum Computing',
                    platform: 'YouTube',
                    url: 'https://www.youtube.com/watch?v=example',
                    date: 'January 15, 2024',
                    duration: '15:30'
                },
                'podcast': {
                    author: 'Science Talk',
                    title: 'The Future of Space Exploration',
                    podcast: 'Science Talk',
                    episode: 'Episode 45',
                    date: 'March 1, 2024',
                    url: 'https://www.sciencetalk.com/episode-45'
                }
            };
            
            return samples[sourceType] || null;
        }

        // Update Citation History
        function updateCitationHistory() {
            if (!citationGenerator) return;
            
            const citations = citationGenerator.getCitations();
            const container = document.getElementById('citation-history');
            
            if (citations.length === 0) {
                container.innerHTML = '<div class="text-gray-500 text-center py-4">No citations generated yet</div>';
                return;
            }
            
            let html = '';
            citations.slice(-10).reverse().forEach((citation, index) => {
                html += `
                    <div class="bg-gray-50 p-3 rounded-lg">
                        <div class="flex justify-between items-start">
                            <div class="flex-1">
                                <div class="text-sm font-semibold text-gray-800">${citation.format.toUpperCase()} - ${citation.sourceType}</div>
                                <div class="text-xs text-gray-600 mt-1">${citation.citation.substring(0, 100)}${citation.citation.length > 100 ? '...' : ''}</div>
                            </div>
                            <div class="flex space-x-1 ml-2">
                                <button onclick="copyCitationFromHistory(${index})" class="text-indigo-500 hover:text-indigo-700 text-xs">Copy</button>
                                <button onclick="deleteCitationFromHistory(${index})" class="text-red-500 hover:text-red-700 text-xs">Delete</button>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        // Copy Citation from History
        function copyCitationFromHistory(index) {
            if (!citationGenerator) return;
            
            const citations = citationGenerator.getCitations();
            const citation = citations[citations.length - 1 - index];
            
            if (citation) {
                navigator.clipboard.writeText(citation.citation).then(() => {
                    alert('Citation copied to clipboard!');
                }).catch(err => {
                    console.error('Failed to copy citation: ', err);
                    alert('Failed to copy citation. Please try again.');
                });
            }
        }

        // Delete Citation from History
        function deleteCitationFromHistory(index) {
            if (!citationGenerator) return;
            
            if (confirm('Are you sure you want to delete this citation?')) {
                const citations = citationGenerator.getCitations();
                const citation = citations[citations.length - 1 - index];
                
                if (citation) {
                    const citationIndex = citations.indexOf(citation);
                    if (citationIndex > -1) {
                        citations.splice(citationIndex, 1);
                        updateCitationHistory();
                        alert('Citation deleted successfully!');
                    }
                }
            }
        }

        // Export Citations
        function exportCitations() {
            if (!citationGenerator) {
                alert('Citation Generator not initialized. Please refresh the page.');
                return;
            }

            const result = citationGenerator.exportCitations('json');
            if (result.success) {
                const dataStr = JSON.stringify(result.data, null, 2);
                const blob = new Blob([dataStr], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'citations.json';
                a.click();
                URL.revokeObjectURL(url);
                alert('Citations exported successfully!');
            } else {
                alert('Error exporting citations: ' + result.error);
            }
        }

        // Initialize Citation Generator on page load
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                initializeCitationGenerator();
            }, 200);
        });

        // Study Planner Functions
        let studyPlanner = null;

        // Initialize Study Planner
        function initializeStudyPlanner() {
            try {
                if (typeof StudyPlanner !== 'undefined') {
                    studyPlanner = new StudyPlanner();
                    console.log('‚úÖ Study Planner initialized successfully');
                    updateUpcomingSessions();
                    updateStudyGoals();
                } else {
                    console.error('‚ùå StudyPlanner class not found');
                }
            } catch (error) {
                console.error('‚ùå Error initializing Study Planner:', error);
            }
        }

        // Add Study Session
        function addStudySession() {
            if (!studyPlanner) {
                alert('Study Planner not initialized. Please refresh the page.');
                return;
            }

            const sessionData = {
                title: document.getElementById('session-title').value.trim(),
                subject: document.getElementById('session-subject').value.trim(),
                type: document.getElementById('session-type').value,
                duration: document.getElementById('session-duration').value,
                date: document.getElementById('session-date').value,
                startTime: document.getElementById('session-start-time').value,
                priority: document.getElementById('session-priority').value,
                location: document.getElementById('session-location').value.trim()
            };

            if (!sessionData.title || !sessionData.subject || !sessionData.date) {
                alert('Please fill in all required fields.');
                return;
            }

            const result = studyPlanner.addStudySession(sessionData);
            if (result.success) {
                clearSessionForm();
                updateUpcomingSessions();
                alert('Study session added successfully!');
            } else {
                alert('Error adding study session: ' + result.error);
            }
        }

        // Add Study Goal
        function addStudyGoal() {
            if (!studyPlanner) {
                alert('Study Planner not initialized. Please refresh the page.');
                return;
            }

            const goalData = {
                title: document.getElementById('goal-title').value.trim(),
                subject: document.getElementById('goal-subject').value.trim(),
                type: document.getElementById('goal-type').value,
                target: document.getElementById('goal-target').value,
                unit: document.getElementById('goal-unit').value,
                deadline: document.getElementById('goal-deadline').value
            };

            if (!goalData.title || !goalData.subject || !goalData.target) {
                alert('Please fill in all required fields.');
                return;
            }

            const result = studyPlanner.addGoal(goalData);
            if (result.success) {
                clearGoalForm();
                updateStudyGoals();
                alert('Study goal added successfully!');
            } else {
                alert('Error adding study goal: ' + result.error);
            }
        }

        // Generate Schedule
        function generateSchedule() {
            if (!studyPlanner) {
                alert('Study Planner not initialized. Please refresh the page.');
                return;
            }

            const subjects = ['Mathematics', 'Physics', 'Chemistry', 'Biology', 'English'];
            const startDate = new Date().toISOString().split('T')[0];
            const endDate = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000).toISOString().split('T')[0];
            const studyHours = 20; // 20 hours per week
            const preferences = { skipWeekends: false };

            const result = studyPlanner.generateSchedule({
                subjects: subjects,
                startDate: startDate,
                endDate: endDate,
                studyHours: studyHours,
                preferences: preferences
            });

            if (result.success) {
                alert(`Schedule generated successfully! ${result.message}`);
                updateUpcomingSessions();
            } else {
                alert('Error generating schedule: ' + result.error);
            }
        }

        // Get Study Statistics
        function getStudyStats() {
            if (!studyPlanner) {
                alert('Study Planner not initialized. Please refresh the page.');
                return;
            }

            const result = studyPlanner.getStudyStatistics('week');
            if (result.success) {
                showStudyStats(result.statistics);
            } else {
                alert('Error getting study statistics: ' + result.error);
            }
        }

        // Show Study Statistics
        function showStudyStats(stats) {
            hideAllStudyResults();
            
            document.getElementById('study-stats-content').innerHTML = `
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <div class="text-lg font-bold text-emerald-600">${stats.totalSessions}</div>
                        <div class="text-sm text-gray-600">Total Sessions</div>
                    </div>
                    <div>
                        <div class="text-lg font-bold text-emerald-600">${stats.completedSessions}</div>
                        <div class="text-sm text-gray-600">Completed</div>
                    </div>
                    <div>
                        <div class="text-lg font-bold text-emerald-600">${stats.completionRate.toFixed(1)}%</div>
                        <div class="text-sm text-gray-600">Completion Rate</div>
                    </div>
                    <div>
                        <div class="text-lg font-bold text-emerald-600">${stats.totalHours}h</div>
                        <div class="text-sm text-gray-600">Total Hours</div>
                    </div>
                </div>
                <div class="mt-4">
                    <div class="text-sm font-semibold text-gray-700 mb-2">Subject Breakdown:</div>
                    ${Object.entries(stats.subjectStats).map(([subject, data]) => 
                        `<div class="text-sm text-gray-600">${subject}: ${data.hours.toFixed(1)}h (${data.sessions} sessions)</div>`
                    ).join('')}
                </div>
            `;
            
            document.getElementById('study-stats-results').classList.remove('hidden');
        }

        // Get Recommendations
        function getRecommendations() {
            if (!studyPlanner) {
                alert('Study Planner not initialized. Please refresh the page.');
                return;
            }

            const recommendations = studyPlanner.getStudyRecommendations();
            showStudyRecommendations(recommendations);
        }

        // Show Study Recommendations
        function showStudyRecommendations(recommendations) {
            hideAllStudyResults();
            
            if (recommendations.length === 0) {
                document.getElementById('study-recommendations-content').innerHTML = 
                    '<div class="text-sm text-gray-600">No recommendations at this time. Keep up the great work!</div>';
            } else {
                let html = '';
                recommendations.forEach(rec => {
                    const colorClass = rec.type === 'urgent' ? 'text-red-600' : 
                                     rec.type === 'warning' ? 'text-yellow-600' : 'text-blue-600';
                    
                    html += `
                        <div class="mb-3 p-3 bg-white rounded-lg border-l-4 ${rec.type === 'urgent' ? 'border-red-500' : 
                                                                           rec.type === 'warning' ? 'border-yellow-500' : 'border-blue-500'}">
                            <div class="font-semibold ${colorClass}">${rec.title}</div>
                            <div class="text-sm text-gray-600 mt-1">${rec.message}</div>
                            <div class="text-sm text-gray-500 mt-1">${rec.action}</div>
                        </div>
                    `;
                });
                document.getElementById('study-recommendations-content').innerHTML = html;
            }
            
            document.getElementById('study-recommendations-results').classList.remove('hidden');
        }

        // Hide All Study Results
        function hideAllStudyResults() {
            document.getElementById('study-stats-results').classList.add('hidden');
            document.getElementById('study-recommendations-results').classList.add('hidden');
        }

        // Clear Session Form
        function clearSessionForm() {
            document.getElementById('session-title').value = '';
            document.getElementById('session-subject').value = '';
            document.getElementById('session-duration').value = '';
            document.getElementById('session-date').value = '';
            document.getElementById('session-start-time').value = '';
            document.getElementById('session-location').value = '';
        }

        // Clear Goal Form
        function clearGoalForm() {
            document.getElementById('goal-title').value = '';
            document.getElementById('goal-subject').value = '';
            document.getElementById('goal-target').value = '';
            document.getElementById('goal-deadline').value = '';
        }

        // Update Upcoming Sessions
        function updateUpcomingSessions() {
            if (!studyPlanner) return;
            
            const upcomingSessions = studyPlanner.getUpcomingSessions(7);
            const container = document.getElementById('upcoming-sessions');
            
            if (upcomingSessions.length === 0) {
                container.innerHTML = '<div class="text-gray-500 text-center py-4">No upcoming sessions</div>';
                return;
            }
            
            let html = '';
            upcomingSessions.slice(0, 5).forEach(session => {
                const priorityColor = session.priority === 'high' ? 'text-red-600' : 
                                    session.priority === 'medium' ? 'text-yellow-600' : 'text-green-600';
                
                html += `
                    <div class="bg-gray-50 p-3 rounded-lg">
                        <div class="flex justify-between items-start">
                            <div class="flex-1">
                                <div class="font-semibold text-gray-800">${session.title}</div>
                                <div class="text-sm text-gray-600">${session.subject} ‚Ä¢ ${session.type}</div>
                                <div class="text-sm text-gray-500">${session.date} at ${session.startTime}</div>
                            </div>
                            <div class="text-right">
                                <div class="text-sm ${priorityColor} font-semibold">${session.priority}</div>
                                <div class="text-sm text-gray-600">${session.duration}min</div>
                                <button onclick="markSessionCompleted(${session.id})" class="text-emerald-500 hover:text-emerald-700 text-xs">Complete</button>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        // Update Study Goals
        function updateStudyGoals() {
            if (!studyPlanner) return;
            
            const goals = studyPlanner.goals;
            const container = document.getElementById('study-goals');
            
            if (goals.length === 0) {
                container.innerHTML = '<div class="text-gray-500 text-center py-4">No study goals set</div>';
                return;
            }
            
            let html = '';
            goals.slice(0, 5).forEach(goal => {
                const progress = (goal.progress / goal.target) * 100;
                const isCompleted = goal.isCompleted;
                
                html += `
                    <div class="bg-gray-50 p-3 rounded-lg">
                        <div class="flex justify-between items-start">
                            <div class="flex-1">
                                <div class="font-semibold text-gray-800">${goal.title}</div>
                                <div class="text-sm text-gray-600">${goal.subject} ‚Ä¢ ${goal.type}</div>
                                <div class="text-sm text-gray-500">${goal.progress}/${goal.target} ${goal.unit}</div>
                                <div class="w-full bg-gray-200 rounded-full h-2 mt-2">
                                    <div class="bg-emerald-500 h-2 rounded-full" style="width: ${Math.min(progress, 100)}%"></div>
                                </div>
                            </div>
                            <div class="text-right">
                                <div class="text-sm ${isCompleted ? 'text-green-600' : 'text-gray-600'} font-semibold">
                                    ${isCompleted ? 'Completed' : `${progress.toFixed(1)}%`}
                                </div>
                                <button onclick="updateGoalProgress(${goal.id})" class="text-emerald-500 hover:text-emerald-700 text-xs">Update</button>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        // Mark Session Completed
        function markSessionCompleted(sessionId) {
            if (!studyPlanner) return;
            
            const result = studyPlanner.markSessionCompleted(sessionId);
            if (result.success) {
                updateUpcomingSessions();
                alert('Session marked as completed!');
            } else {
                alert('Error marking session as completed: ' + result.error);
            }
        }

        // Update Goal Progress
        function updateGoalProgress(goalId) {
            if (!studyPlanner) return;
            
            const progress = prompt('Enter progress (number):');
            if (progress === null) return;
            
            const result = studyPlanner.updateGoalProgress(goalId, parseFloat(progress));
            if (result.success) {
                updateStudyGoals();
                alert('Goal progress updated!');
            } else {
                alert('Error updating goal progress: ' + result.error);
            }
        }

        // Export Study Data
        function exportStudyData() {
            if (!studyPlanner) {
                alert('Study Planner not initialized. Please refresh the page.');
                return;
            }

            const result = studyPlanner.exportSchedule('json');
            if (result.success) {
                const dataStr = JSON.stringify(result.data, null, 2);
                const blob = new Blob([dataStr], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'study-data.json';
                a.click();
                URL.revokeObjectURL(url);
                alert('Study data exported successfully!');
            } else {
                alert('Error exporting study data: ' + result.error);
            }
        }

        // Initialize Study Planner on page load
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                initializeStudyPlanner();
            }, 200);
        });

        // Flashcard Generator Functions
        let flashcardGenerator = null;

        // Initialize Flashcard Generator
        function initializeFlashcardGenerator() {
            try {
                if (typeof FlashcardGenerator !== 'undefined') {
                    flashcardGenerator = new FlashcardGenerator();
                    console.log('‚úÖ Flashcard Generator initialized successfully');
                    updateDecksList();
                    updateCardsList();
                    updateDeckSelectors();
                } else {
                    console.error('‚ùå FlashcardGenerator class not found');
                }
            } catch (error) {
                console.error('‚ùå Error initializing Flashcard Generator:', error);
            }
        }

        // Create Deck
        function createDeck() {
            if (!flashcardGenerator) {
                alert('Flashcard Generator not initialized. Please refresh the page.');
                return;
            }

            const deckData = {
                name: document.getElementById('deck-name').value.trim(),
                subject: document.getElementById('deck-subject').value.trim(),
                description: document.getElementById('deck-description').value.trim()
            };

            if (!deckData.name) {
                alert('Please enter a deck name.');
                return;
            }

            const result = flashcardGenerator.createDeck(deckData);
            if (result.success) {
                clearDeckForm();
                updateDecksList();
                updateDeckSelectors();
                alert('Deck created successfully!');
            } else {
                alert('Error creating deck: ' + result.error);
            }
        }

        // Add Flashcard
        function addFlashcard() {
            if (!flashcardGenerator) {
                alert('Flashcard Generator not initialized. Please refresh the page.');
                return;
            }

            const deckId = document.getElementById('flashcard-deck').value;
            if (!deckId) {
                alert('Please select a deck.');
                return;
            }

            const cardData = {
                deckId: parseInt(deckId),
                type: document.getElementById('card-type').value,
                front: document.getElementById('card-front').value.trim(),
                back: document.getElementById('card-back').value.trim(),
                difficulty: document.getElementById('card-difficulty').value,
                tags: document.getElementById('card-tags').value.split(',').map(tag => tag.trim()).filter(tag => tag)
            };

            if (!cardData.front || !cardData.back) {
                alert('Please fill in both front and back.');
                return;
            }

            // Handle multiple choice options
            if (cardData.type === 'multiple_choice') {
                const optionsText = document.getElementById('card-options-text').value.trim();
                if (optionsText) {
                    cardData.options = optionsText.split('\n').map(option => option.trim()).filter(option => option);
                }
            }

            const result = flashcardGenerator.addFlashcard(cardData);
            if (result.success) {
                clearCardForm();
                updateCardsList();
                alert('Flashcard added successfully!');
            } else {
                alert('Error adding flashcard: ' + result.error);
            }
        }

        // Update Card Fields
        function updateCardFields() {
            const cardType = document.getElementById('card-type').value;
            const optionsDiv = document.getElementById('card-options');
            
            if (cardType === 'multiple_choice') {
                optionsDiv.classList.remove('hidden');
            } else {
                optionsDiv.classList.add('hidden');
            }
        }

        // Start Study Session
        function startStudySession() {
            if (!flashcardGenerator) {
                alert('Flashcard Generator not initialized. Please refresh the page.');
                return;
            }

            const deckId = document.getElementById('study-deck').value;
            const mode = document.getElementById('study-mode').value;

            if (!deckId) {
                alert('Please select a deck.');
                return;
            }

            const result = flashcardGenerator.startStudySession(parseInt(deckId), mode);
            if (result.success) {
                showStudySession();
                alert(`Study session started! ${result.message}`);
            } else {
                alert('Error starting study session: ' + result.error);
            }
        }

        // Show Study Session
        function showStudySession() {
            const currentCard = flashcardGenerator.getCurrentCard();
            if (!currentCard) {
                alert('No cards available for study.');
                return;
            }

            const progress = flashcardGenerator.getStudyProgress();
            document.getElementById('study-progress').textContent = 
                `Card ${progress.current} of ${progress.total} (${progress.percentage}%)`;
            
            document.getElementById('card-question').textContent = currentCard.front;
            document.getElementById('card-answer').textContent = currentCard.back;
            document.getElementById('card-answer').classList.add('hidden');
            
            document.getElementById('study-session').classList.remove('hidden');
        }

        // Show Answer
        function showAnswer() {
            document.getElementById('card-answer').classList.remove('hidden');
        }

        // Answer Card
        function answerCard(result) {
            if (!flashcardGenerator || !flashcardGenerator.studySession) {
                alert('No active study session.');
                return;
            }

            const currentCard = flashcardGenerator.getCurrentCard();
            if (!currentCard) {
                alert('No current card.');
                return;
            }

            const difficulty = result === 'correct' ? 'easy' : 'hard';
            const answerResult = flashcardGenerator.answerCard(currentCard.id, '', difficulty);
            
            if (answerResult.success) {
                const nextResult = flashcardGenerator.nextCard();
                if (nextResult.success && nextResult.currentCard) {
                    showStudySession();
                } else {
                    // Session completed
                    const sessionResults = flashcardGenerator.completeStudySession();
                    if (sessionResults.success) {
                        alert(`Study session completed! Score: ${sessionResults.results.averageScore.toFixed(1)}%`);
                        document.getElementById('study-session').classList.add('hidden');
                    }
                }
            }
        }

        // Get Study Statistics
        function getStudyStats() {
            if (!flashcardGenerator) {
                alert('Flashcard Generator not initialized. Please refresh the page.');
                return;
            }

            const stats = flashcardGenerator.getStudyStatistics();
            showStudyStats(stats);
        }

        // Show Study Statistics
        function showStudyStats(stats) {
            hideAllFlashcardResults();
            
            document.getElementById('study-stats-content').innerHTML = `
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <div class="text-lg font-bold text-blue-600">${stats.totalCards}</div>
                        <div class="text-sm text-gray-600">Total Cards</div>
                    </div>
                    <div>
                        <div class="text-lg font-bold text-blue-600">${stats.studiedCards}</div>
                        <div class="text-sm text-gray-600">Studied</div>
                    </div>
                    <div>
                        <div class="text-lg font-bold text-blue-600">${stats.averageScore}%</div>
                        <div class="text-sm text-gray-600">Average Score</div>
                    </div>
                    <div>
                        <div class="text-lg font-bold text-blue-600">${stats.studyTime}m</div>
                        <div class="text-sm text-gray-600">Study Time</div>
                    </div>
                </div>
                <div class="mt-4">
                    <div class="text-sm font-semibold text-gray-700 mb-2">Difficulty Breakdown:</div>
                    ${Object.entries(stats.difficultyStats).map(([difficulty, data]) => 
                        `<div class="text-sm text-gray-600">${difficulty}: ${data.studied}/${data.total} cards (${data.averageScore.toFixed(1)}% avg)</div>`
                    ).join('')}
                </div>
            `;
            
            document.getElementById('study-stats-results').classList.remove('hidden');
        }

        // Hide All Flashcard Results
        function hideAllFlashcardResults() {
            document.getElementById('study-stats-results').classList.add('hidden');
        }

        // Clear Deck Form
        function clearDeckForm() {
            document.getElementById('deck-name').value = '';
            document.getElementById('deck-subject').value = '';
            document.getElementById('deck-description').value = '';
        }

        // Clear Card Form
        function clearCardForm() {
            document.getElementById('card-front').value = '';
            document.getElementById('card-back').value = '';
            document.getElementById('card-tags').value = '';
            document.getElementById('card-options-text').value = '';
        }

        // Update Decks List
        function updateDecksList() {
            if (!flashcardGenerator) return;
            
            const decks = flashcardGenerator.getDecks();
            const container = document.getElementById('decks-list');
            
            if (decks.length === 0) {
                container.innerHTML = '<div class="text-gray-500 text-center py-4">No decks created yet</div>';
                return;
            }
            
            let html = '';
            decks.slice(0, 5).forEach(deck => {
                const cardCount = flashcardGenerator.getFlashcardsByDeck(deck.id).length;
                
                html += `
                    <div class="bg-gray-50 p-3 rounded-lg">
                        <div class="flex justify-between items-start">
                            <div class="flex-1">
                                <div class="font-semibold text-gray-800">${deck.name}</div>
                                <div class="text-sm text-gray-600">${deck.subject} ‚Ä¢ ${cardCount} cards</div>
                                <div class="text-sm text-gray-500">${deck.description}</div>
                            </div>
                            <div class="text-right">
                                <div class="text-sm text-gray-600">${deck.studyCount} studies</div>
                                <button onclick="deleteDeck(${deck.id})" class="text-red-500 hover:text-red-700 text-xs">Delete</button>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        // Update Cards List
        function updateCardsList() {
            if (!flashcardGenerator) return;
            
            const cards = flashcardGenerator.flashcards.slice(-5).reverse();
            const container = document.getElementById('cards-list');
            
            if (cards.length === 0) {
                container.innerHTML = '<div class="text-gray-500 text-center py-4">No cards added yet</div>';
                return;
            }
            
            let html = '';
            cards.forEach(card => {
                const deck = flashcardGenerator.getDecks().find(d => d.id === card.deckId);
                const deckName = deck ? deck.name : 'Unknown Deck';
                
                html += `
                    <div class="bg-gray-50 p-3 rounded-lg">
                        <div class="flex justify-between items-start">
                            <div class="flex-1">
                                <div class="font-semibold text-gray-800">${card.front}</div>
                                <div class="text-sm text-gray-600">${deckName} ‚Ä¢ ${card.type}</div>
                                <div class="text-sm text-gray-500">${card.difficulty} ‚Ä¢ ${card.studyCount} studies</div>
                            </div>
                            <div class="text-right">
                                <div class="text-sm text-gray-600">${card.correctCount}/${card.studyCount}</div>
                                <button onclick="deleteCard(${card.id})" class="text-red-500 hover:text-red-700 text-xs">Delete</button>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        // Update Deck Selectors
        function updateDeckSelectors() {
            if (!flashcardGenerator) return;
            
            const decks = flashcardGenerator.getDecks();
            const selectors = ['flashcard-deck', 'study-deck'];
            
            selectors.forEach(selectorId => {
                const selector = document.getElementById(selectorId);
                if (selector) {
                    selector.innerHTML = '<option value="">Select a deck</option>' +
                        decks.map(deck => `<option value="${deck.id}">${deck.name}</option>`).join('');
                }
            });
        }

        // Delete Deck
        function deleteDeck(deckId) {
            if (!flashcardGenerator) return;
            
            if (confirm('Are you sure you want to delete this deck and all its cards?')) {
                const result = flashcardGenerator.deleteDeck(deckId);
                if (result.success) {
                    updateDecksList();
                    updateCardsList();
                    updateDeckSelectors();
                    alert('Deck deleted successfully!');
                } else {
                    alert('Error deleting deck: ' + result.error);
                }
            }
        }

        // Delete Card
        function deleteCard(cardId) {
            if (!flashcardGenerator) return;
            
            if (confirm('Are you sure you want to delete this card?')) {
                const result = flashcardGenerator.deleteFlashcard(cardId);
                if (result.success) {
                    updateCardsList();
                    alert('Card deleted successfully!');
                } else {
                    alert('Error deleting card: ' + result.error);
                }
            }
        }

        // Export Deck
        function exportDeck() {
            if (!flashcardGenerator) {
                alert('Flashcard Generator not initialized. Please refresh the page.');
                return;
            }

            const deckId = document.getElementById('study-deck').value;
            if (!deckId) {
                alert('Please select a deck to export.');
                return;
            }

            const result = flashcardGenerator.exportDeck(parseInt(deckId), 'json');
            if (result.success) {
                const dataStr = JSON.stringify(result.data, null, 2);
                const blob = new Blob([dataStr], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'flashcards.json';
                a.click();
                URL.revokeObjectURL(url);
                alert('Deck exported successfully!');
            } else {
                alert('Error exporting deck: ' + result.error);
            }
        }

        // Search Cards
        function searchCards() {
            const query = prompt('Enter search term:');
            if (!query) return;
            
            if (!flashcardGenerator) {
                alert('Flashcard Generator not initialized. Please refresh the page.');
                return;
            }

            const results = flashcardGenerator.searchFlashcards(query);
            if (results.length === 0) {
                alert('No cards found matching your search.');
                return;
            }

            alert(`Found ${results.length} cards matching "${query}"`);
        }

        // Clear All Data
        function clearAllData() {
            if (!flashcardGenerator) return;
            
            if (confirm('Are you sure you want to clear all data? This cannot be undone.')) {
                flashcardGenerator.clearHistory();
                updateDecksList();
                updateCardsList();
                updateDeckSelectors();
                alert('All data cleared successfully!');
            }
        }

        // Initialize Flashcard Generator on page load
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                initializeFlashcardGenerator();
            }, 200);
        });

        // Progress Tracker Functions
        let progressTracker = null;

        // Initialize Progress Tracker
        function initializeProgressTracker() {
            try {
                if (typeof ProgressTracker !== 'undefined') {
                    progressTracker = new ProgressTracker();
                    console.log('‚úÖ Progress Tracker initialized successfully');
                    updateSubjectsList();
                    updateAssignmentsList();
                    updateExamsList();
                    updateSubjectSelectors();
                } else {
                    console.error('‚ùå ProgressTracker class not found');
                }
            } catch (error) {
                console.error('‚ùå Error initializing Progress Tracker:', error);
            }
        }

        // Add Subject
        function addSubject() {
            if (!progressTracker) {
                alert('Progress Tracker not initialized. Please refresh the page.');
                return;
            }

            const subjectData = {
                name: document.getElementById('subject-name').value.trim(),
                code: document.getElementById('subject-code').value.trim(),
                credits: parseInt(document.getElementById('subject-credits').value) || 3,
                instructor: document.getElementById('subject-instructor').value.trim(),
                semester: document.getElementById('subject-semester').value.trim(),
                year: parseInt(document.getElementById('subject-year').value) || new Date().getFullYear()
            };

            if (!subjectData.name) {
                alert('Please enter a subject name.');
                return;
            }

            const result = progressTracker.addSubject(subjectData);
            if (result.success) {
                clearSubjectForm();
                updateSubjectsList();
                updateSubjectSelectors();
                alert('Subject added successfully!');
            } else {
                alert('Error adding subject: ' + result.error);
            }
        }

        // Add Assignment
        function addAssignment() {
            if (!progressTracker) {
                alert('Progress Tracker not initialized. Please refresh the page.');
                return;
            }

            const subjectId = document.getElementById('assignment-subject').value;
            if (!subjectId) {
                alert('Please select a subject.');
                return;
            }

            const assignmentData = {
                subjectId: parseInt(subjectId),
                title: document.getElementById('assignment-title').value.trim(),
                type: document.getElementById('assignment-type').value,
                dueDate: document.getElementById('assignment-due-date').value,
                points: parseInt(document.getElementById('assignment-points').value) || 100,
                grade: parseFloat(document.getElementById('assignment-grade').value) || 0,
                priority: document.getElementById('assignment-priority').value,
                status: document.getElementById('assignment-grade').value ? 'completed' : 'pending'
            };

            if (!assignmentData.title) {
                alert('Please enter an assignment title.');
                return;
            }

            const result = progressTracker.addAssignment(assignmentData);
            if (result.success) {
                clearAssignmentForm();
                updateAssignmentsList();
                updateSubjectsList();
                alert('Assignment added successfully!');
            } else {
                alert('Error adding assignment: ' + result.error);
            }
        }

        // Add Exam
        function addExam() {
            if (!progressTracker) {
                alert('Progress Tracker not initialized. Please refresh the page.');
                return;
            }

            const subjectId = document.getElementById('exam-subject').value;
            if (!subjectId) {
                alert('Please select a subject.');
                return;
            }

            const examData = {
                subjectId: parseInt(subjectId),
                title: document.getElementById('exam-title').value.trim(),
                type: document.getElementById('exam-type').value,
                date: document.getElementById('exam-date').value,
                duration: parseInt(document.getElementById('exam-duration').value) || 120,
                totalMarks: parseInt(document.getElementById('exam-total-marks').value) || 100,
                grade: parseFloat(document.getElementById('exam-grade').value) || 0,
                status: document.getElementById('exam-grade').value ? 'completed' : 'scheduled'
            };

            if (!examData.title) {
                alert('Please enter an exam title.');
                return;
            }

            const result = progressTracker.addExam(examData);
            if (result.success) {
                clearExamForm();
                updateExamsList();
                updateSubjectsList();
                alert('Exam added successfully!');
            } else {
                alert('Error adding exam: ' + result.error);
            }
        }

        // Get Overall Analytics
        function getOverallAnalytics() {
            if (!progressTracker) {
                alert('Progress Tracker not initialized. Please refresh the page.');
                return;
            }

            const analytics = progressTracker.getOverallAnalytics();
            showOverallAnalytics(analytics);
        }

        // Show Overall Analytics
        function showOverallAnalytics(analytics) {
            hideAllProgressResults();
            
            document.getElementById('analytics-content').innerHTML = `
                <div class="grid grid-cols-2 gap-4 mb-4">
                    <div>
                        <div class="text-lg font-bold text-blue-600">${analytics.gpa.toFixed(2)}</div>
                        <div class="text-sm text-gray-600">Overall GPA</div>
                    </div>
                    <div>
                        <div class="text-lg font-bold text-blue-600">${analytics.totalStudyTime}h</div>
                        <div class="text-sm text-gray-600">Study Time</div>
                    </div>
                    <div>
                        <div class="text-lg font-bold text-blue-600">${analytics.totalAssignments}</div>
                        <div class="text-sm text-gray-600">Assignments</div>
                    </div>
                    <div>
                        <div class="text-lg font-bold text-blue-600">${analytics.totalExams}</div>
                        <div class="text-sm text-gray-600">Exams</div>
                    </div>
                </div>
                <div class="mb-4">
                    <div class="text-sm font-semibold text-gray-700 mb-2">Performance Trend:</div>
                    <div class="text-sm text-gray-600 capitalize">${analytics.performanceTrend}</div>
                </div>
                <div class="mb-4">
                    <div class="text-sm font-semibold text-gray-700 mb-2">Strengths:</div>
                    <div class="text-sm text-gray-600">${analytics.strengths.length > 0 ? analytics.strengths.join(', ') : 'None identified'}</div>
                </div>
                <div class="mb-4">
                    <div class="text-sm font-semibold text-gray-700 mb-2">Areas for Improvement:</div>
                    <div class="text-sm text-gray-600">${analytics.weaknesses.length > 0 ? analytics.weaknesses.join(', ') : 'None identified'}</div>
                </div>
                <div>
                    <div class="text-sm font-semibold text-gray-700 mb-2">Recommendations:</div>
                    <div class="text-sm text-gray-600">
                        ${analytics.recommendations.length > 0 ? 
                            analytics.recommendations.map(rec => `<div class="mb-1">‚Ä¢ ${rec}</div>`).join('') : 
                            'No specific recommendations at this time'
                        }
                    </div>
                </div>
            `;
            
            document.getElementById('overall-analytics').classList.remove('hidden');
        }

        // Get Study Insights
        function getStudyInsights() {
            if (!progressTracker) {
                alert('Progress Tracker not initialized. Please refresh the page.');
                return;
            }

            const insights = progressTracker.getStudyInsights();
            showStudyInsights(insights);
        }

        // Show Study Insights
        function showStudyInsights(insights) {
            hideAllProgressResults();
            
            document.getElementById('insights-content').innerHTML = `
                <div class="grid grid-cols-2 gap-4 mb-4">
                    <div>
                        <div class="text-lg font-bold text-green-600">${insights.mostProductiveTime || 'N/A'}:00</div>
                        <div class="text-sm text-gray-600">Most Productive Time</div>
                    </div>
                    <div>
                        <div class="text-lg font-bold text-green-600">${insights.averageSessionLength.toFixed(1)}h</div>
                        <div class="text-sm text-gray-600">Avg Session Length</div>
                    </div>
                    <div>
                        <div class="text-lg font-bold text-green-600">${insights.studyFrequency}</div>
                        <div class="text-sm text-gray-600">Sessions This Week</div>
                    </div>
                    <div>
                        <div class="text-lg font-bold text-green-600">${insights.studyStreak}</div>
                        <div class="text-sm text-gray-600">Study Streak (days)</div>
                    </div>
                </div>
                <div class="mb-4">
                    <div class="text-sm font-semibold text-gray-700 mb-2">Total Study Time:</div>
                    <div class="text-sm text-gray-600">${insights.totalStudyTime.toFixed(1)} hours</div>
                </div>
                <div class="mb-4">
                    <div class="text-sm font-semibold text-gray-700 mb-2">Average Productivity:</div>
                    <div class="text-sm text-gray-600">${insights.averageProductivity.toFixed(1)}/10</div>
                </div>
                <div>
                    <div class="text-sm font-semibold text-gray-700 mb-2">Preferred Subjects:</div>
                    <div class="text-sm text-gray-600">
                        ${insights.preferredSubjects.length > 0 ? 
                            insights.preferredSubjects.map(subject => 
                                `<div class="mb-1">‚Ä¢ ${subject.name} (${subject.studyTime.toFixed(1)}h)</div>`
                            ).join('') : 
                            'No study data available'
                        }
                    </div>
                </div>
            `;
            
            document.getElementById('study-insights').classList.remove('hidden');
        }

        // Hide All Progress Results
        function hideAllProgressResults() {
            document.getElementById('overall-analytics').classList.add('hidden');
            document.getElementById('study-insights').classList.add('hidden');
        }

        // Clear Subject Form
        function clearSubjectForm() {
            document.getElementById('subject-name').value = '';
            document.getElementById('subject-code').value = '';
            document.getElementById('subject-credits').value = '';
            document.getElementById('subject-instructor').value = '';
            document.getElementById('subject-semester').value = '';
            document.getElementById('subject-year').value = '';
        }

        // Clear Assignment Form
        function clearAssignmentForm() {
            document.getElementById('assignment-title').value = '';
            document.getElementById('assignment-due-date').value = '';
            document.getElementById('assignment-points').value = '';
            document.getElementById('assignment-grade').value = '';
        }

        // Clear Exam Form
        function clearExamForm() {
            document.getElementById('exam-title').value = '';
            document.getElementById('exam-date').value = '';
            document.getElementById('exam-duration').value = '';
            document.getElementById('exam-total-marks').value = '';
            document.getElementById('exam-grade').value = '';
        }

        // Update Subjects List
        function updateSubjectsList() {
            if (!progressTracker) return;
            
            const subjects = progressTracker.getSubjects();
            const container = document.getElementById('subjects-list');
            
            if (subjects.length === 0) {
                container.innerHTML = '<div class="text-gray-500 text-center py-4">No subjects added yet</div>';
                return;
            }
            
            let html = '';
            subjects.slice(0, 5).forEach(subject => {
                html += `
                    <div class="bg-gray-50 p-3 rounded-lg">
                        <div class="flex justify-between items-start">
                            <div class="flex-1">
                                <div class="font-semibold text-gray-800">${subject.name}</div>
                                <div class="text-sm text-gray-600">${subject.code} ‚Ä¢ ${subject.credits} credits</div>
                                <div class="text-sm text-gray-500">${subject.instructor} ‚Ä¢ ${subject.semester}</div>
                                <div class="text-sm text-gray-500">Avg: ${subject.averageScore.toFixed(1)}% ‚Ä¢ Grade: ${subject.currentGrade}</div>
                            </div>
                            <div class="text-right">
                                <div class="text-sm text-gray-600">${subject.totalAssignments} assignments</div>
                                <div class="text-sm text-gray-600">${subject.totalExams} exams</div>
                                <button onclick="deleteSubject(${subject.id})" class="text-red-500 hover:text-red-700 text-xs">Delete</button>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        // Update Assignments List
        function updateAssignmentsList() {
            if (!progressTracker) return;
            
            const assignments = progressTracker.getAssignments().slice(-5).reverse();
            const container = document.getElementById('assignments-list');
            
            if (assignments.length === 0) {
                container.innerHTML = '<div class="text-gray-500 text-center py-4">No assignments added yet</div>';
                return;
            }
            
            let html = '';
            assignments.forEach(assignment => {
                const subject = progressTracker.getSubjects().find(s => s.id === assignment.subjectId);
                const subjectName = subject ? subject.name : 'Unknown Subject';
                
                html += `
                    <div class="bg-gray-50 p-3 rounded-lg">
                        <div class="flex justify-between items-start">
                            <div class="flex-1">
                                <div class="font-semibold text-gray-800">${assignment.title}</div>
                                <div class="text-sm text-gray-600">${subjectName} ‚Ä¢ ${assignment.type}</div>
                                <div class="text-sm text-gray-500">${assignment.points} points ‚Ä¢ ${assignment.grade}%</div>
                            </div>
                            <div class="text-right">
                                <div class="text-sm text-gray-600">${assignment.priority}</div>
                                <button onclick="deleteAssignment(${assignment.id})" class="text-red-500 hover:text-red-700 text-xs">Delete</button>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        // Update Exams List
        function updateExamsList() {
            if (!progressTracker) return;
            
            const exams = progressTracker.getExams().slice(-5).reverse();
            const container = document.getElementById('exams-list');
            
            if (exams.length === 0) {
                container.innerHTML = '<div class="text-gray-500 text-center py-4">No exams added yet</div>';
                return;
            }
            
            let html = '';
            exams.forEach(exam => {
                const subject = progressTracker.getSubjects().find(s => s.id === exam.subjectId);
                const subjectName = subject ? subject.name : 'Unknown Subject';
                
                html += `
                    <div class="bg-gray-50 p-3 rounded-lg">
                        <div class="flex justify-between items-start">
                            <div class="flex-1">
                                <div class="font-semibold text-gray-800">${exam.title}</div>
                                <div class="text-sm text-gray-600">${subjectName} ‚Ä¢ ${exam.type}</div>
                                <div class="text-sm text-gray-500">${exam.totalMarks} marks ‚Ä¢ ${exam.grade}%</div>
                            </div>
                            <div class="text-right">
                                <div class="text-sm text-gray-600">${exam.duration}min</div>
                                <button onclick="deleteExam(${exam.id})" class="text-red-500 hover:text-red-700 text-xs">Delete</button>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        // Update Subject Selectors
        function updateSubjectSelectors() {
            if (!progressTracker) return;
            
            const subjects = progressTracker.getSubjects();
            const selectors = ['assignment-subject', 'exam-subject'];
            
            selectors.forEach(selectorId => {
                const selector = document.getElementById(selectorId);
                if (selector) {
                    selector.innerHTML = '<option value="">Select a subject</option>' +
                        subjects.map(subject => `<option value="${subject.id}">${subject.name}</option>`).join('');
                }
            });
        }

        // Delete Subject
        function deleteSubject(subjectId) {
            if (!progressTracker) return;
            
            if (confirm('Are you sure you want to delete this subject and all its assignments and exams?')) {
                const result = progressTracker.deleteSubject(subjectId);
                if (result.success) {
                    updateSubjectsList();
                    updateAssignmentsList();
                    updateExamsList();
                    updateSubjectSelectors();
                    alert('Subject deleted successfully!');
                } else {
                    alert('Error deleting subject: ' + result.error);
                }
            }
        }

        // Delete Assignment
        function deleteAssignment(assignmentId) {
            if (!progressTracker) return;
            
            if (confirm('Are you sure you want to delete this assignment?')) {
                const result = progressTracker.deleteAssignment(assignmentId);
                if (result.success) {
                    updateAssignmentsList();
                    updateSubjectsList();
                    alert('Assignment deleted successfully!');
                } else {
                    alert('Error deleting assignment: ' + result.error);
                }
            }
        }

        // Delete Exam
        function deleteExam(examId) {
            if (!progressTracker) return;
            
            if (confirm('Are you sure you want to delete this exam?')) {
                const result = progressTracker.deleteExam(examId);
                if (result.success) {
                    updateExamsList();
                    updateSubjectsList();
                    alert('Exam deleted successfully!');
                } else {
                    alert('Error deleting exam: ' + result.error);
                }
            }
        }

        // Export Progress Data
        function exportProgressData() {
            if (!progressTracker) {
                alert('Progress Tracker not initialized. Please refresh the page.');
                return;
            }

            const result = progressTracker.exportData('json');
            if (result.success) {
                const dataStr = JSON.stringify(result.data, null, 2);
                const blob = new Blob([dataStr], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'progress-data.json';
                a.click();
                URL.revokeObjectURL(url);
                alert('Progress data exported successfully!');
            } else {
                alert('Error exporting data: ' + result.error);
            }
        }

        // Clear All Progress Data
        function clearAllProgressData() {
            if (!progressTracker) return;
            
            if (confirm('Are you sure you want to clear all progress data? This cannot be undone.')) {
                progressTracker.clearHistory();
                updateSubjectsList();
                updateAssignmentsList();
                updateExamsList();
                updateSubjectSelectors();
                hideAllProgressResults();
                alert('All progress data cleared successfully!');
            }
        }

        // Initialize Progress Tracker on page load
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                initializeProgressTracker();
            }, 200);
        });

        // Timestamp Converter Functions
        let timestampConverter = null;

        // Initialize Timestamp Converter
        function initializeTimestampConverter() {
            try {
                if (typeof TimestampConverter !== 'undefined') {
                    timestampConverter = new TimestampConverter();
                    console.log('‚úÖ Timestamp Converter initialized successfully');
                } else {
                    console.error('‚ùå TimestampConverter class not found');
                }
            } catch (error) {
                console.error('‚ùå Error initializing Timestamp Converter:', error);
            }
        }

        // Convert Timestamp
        function convertTimestamp() {
            if (!timestampConverter) {
                alert('Timestamp Converter not initialized. Please refresh the page.');
                return;
            }

            const input = document.getElementById('input-timestamp').value.trim();
            const fromFormat = document.getElementById('from-format').value;
            const toFormat = document.getElementById('to-format').value;
            const timezone = document.getElementById('timezone').value;

            if (!input) {
                alert('Please enter a timestamp.');
                return;
            }

            const result = timestampConverter.convertTimestamp(input, fromFormat, toFormat, timezone);
            if (result.success) {
                showTimestampConversionResults(result);
            } else {
                alert('Error converting timestamp: ' + result.error);
            }
        }

        // Show Timestamp Conversion Results
        function showTimestampConversionResults(result) {
            hideAllTimestampResults();
            
            document.getElementById('timestamp-conversion-content').innerHTML = `
                <div class="space-y-3">
                    <div>
                        <div class="font-semibold text-gray-700 mb-1">Input:</div>
                        <div class="bg-gray-100 p-2 rounded text-sm font-mono">${result.input}</div>
                    </div>
                    <div>
                        <div class="font-semibold text-gray-700 mb-1">From Format:</div>
                        <div class="text-sm text-gray-600">${result.fromFormat}</div>
                    </div>
                    <div>
                        <div class="font-semibold text-gray-700 mb-1">To Format:</div>
                        <div class="text-sm text-gray-600">${result.toFormat}</div>
                    </div>
                    <div>
                        <div class="font-semibold text-gray-700 mb-1">Timezone:</div>
                        <div class="text-sm text-gray-600">${result.timezone}</div>
                    </div>
                    <div>
                        <div class="font-semibold text-gray-700 mb-1">Converted Result:</div>
                        <div class="bg-cyan-100 p-2 rounded text-sm font-mono break-all">${result.result}</div>
                    </div>
                    <div>
                        <div class="font-semibold text-gray-700 mb-1">Parsed Date:</div>
                        <div class="text-sm text-gray-600">${result.parsedDate}</div>
                    </div>
                </div>
            `;
            
            document.getElementById('timestamp-conversion-results').classList.remove('hidden');
        }

        // Get Current Time
        function getCurrentTime() {
            if (!timestampConverter) {
                alert('Timestamp Converter not initialized. Please refresh the page.');
                return;
            }

            const format = document.getElementById('current-format').value;
            const timezone = document.getElementById('current-timezone').value;

            const result = timestampConverter.getCurrentTimestamp(format, timezone);
            if (result.success !== false) {
                showCurrentTimeResults(result, format, timezone);
            } else {
                alert('Error getting current time: ' + result.error);
            }
        }

        // Show Current Time Results
        function showCurrentTimeResults(result, format, timezone) {
            hideAllTimestampResults();
            
            document.getElementById('current-time-content').innerHTML = `
                <div class="space-y-3">
                    <div>
                        <div class="font-semibold text-gray-700 mb-1">Format:</div>
                        <div class="text-sm text-gray-600">${format}</div>
                    </div>
                    <div>
                        <div class="font-semibold text-gray-700 mb-1">Timezone:</div>
                        <div class="text-sm text-gray-600">${timezone}</div>
                    </div>
                    <div>
                        <div class="font-semibold text-gray-700 mb-1">Current Time:</div>
                        <div class="bg-blue-100 p-2 rounded text-sm font-mono break-all">${result}</div>
                    </div>
                </div>
            `;
            
            document.getElementById('current-time-results').classList.remove('hidden');
        }

        // Calculate Time Difference
        function calculateTimeDifference() {
            if (!timestampConverter) {
                alert('Timestamp Converter not initialized. Please refresh the page.');
                return;
            }

            const timestamp1 = document.getElementById('diff-timestamp1').value.trim();
            const timestamp2 = document.getElementById('diff-timestamp2').value.trim();

            if (!timestamp1 || !timestamp2) {
                alert('Please enter both timestamps.');
                return;
            }

            const result = timestampConverter.calculateTimeDifference(timestamp1, timestamp2);
            if (result.success) {
                showTimeDifferenceResults(result);
            } else {
                alert('Error calculating time difference: ' + result.error);
            }
        }

        // Show Time Difference Results
        function showTimeDifferenceResults(result) {
            hideAllTimestampResults();
            
            document.getElementById('time-difference-content').innerHTML = `
                <div class="space-y-3">
                    <div>
                        <div class="font-semibold text-gray-700 mb-1">Human Readable:</div>
                        <div class="text-sm text-gray-600">${result.humanReadable}</div>
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <div class="font-semibold text-gray-700 mb-1">Years:</div>
                            <div class="text-sm text-gray-600">${result.difference.years}</div>
                        </div>
                        <div>
                            <div class="font-semibold text-gray-700 mb-1">Months:</div>
                            <div class="text-sm text-gray-600">${result.difference.months}</div>
                        </div>
                        <div>
                            <div class="font-semibold text-gray-700 mb-1">Weeks:</div>
                            <div class="text-sm text-gray-600">${result.difference.weeks}</div>
                        </div>
                        <div>
                            <div class="font-semibold text-gray-700 mb-1">Days:</div>
                            <div class="text-sm text-gray-600">${result.difference.days}</div>
                        </div>
                        <div>
                            <div class="font-semibold text-gray-700 mb-1">Hours:</div>
                            <div class="text-sm text-gray-600">${result.difference.hours}</div>
                        </div>
                        <div>
                            <div class="font-semibold text-gray-700 mb-1">Minutes:</div>
                            <div class="text-sm text-gray-600">${result.difference.minutes}</div>
                        </div>
                        <div>
                            <div class="font-semibold text-gray-700 mb-1">Seconds:</div>
                            <div class="text-sm text-gray-600">${result.difference.seconds}</div>
                        </div>
                        <div>
                            <div class="font-semibold text-gray-700 mb-1">Milliseconds:</div>
                            <div class="text-sm text-gray-600">${result.difference.milliseconds}</div>
                        </div>
                    </div>
                    <div>
                        <div class="font-semibold text-gray-700 mb-1">Direction:</div>
                        <div class="text-sm text-gray-600">${result.isFuture ? 'Future' : 'Past'}</div>
                    </div>
                </div>
            `;
            
            document.getElementById('time-difference-results').classList.remove('hidden');
        }

        // Add Time
        function addTime() {
            if (!timestampConverter) {
                alert('Timestamp Converter not initialized. Please refresh the page.');
                return;
            }

            const timestamp = document.getElementById('add-timestamp').value.trim();
            const amount = parseFloat(document.getElementById('add-amount').value);
            const unit = document.getElementById('add-unit').value;

            if (!timestamp || isNaN(amount)) {
                alert('Please enter a valid timestamp and amount.');
                return;
            }

            const result = timestampConverter.addTime(timestamp, amount, unit);
            if (result.success) {
                showAddTimeResults(result);
            } else {
                alert('Error adding time: ' + result.error);
            }
        }

        // Show Add Time Results
        function showAddTimeResults(result) {
            hideAllTimestampResults();
            
            document.getElementById('add-time-content').innerHTML = `
                <div class="space-y-3">
                    <div>
                        <div class="font-semibold text-gray-700 mb-1">Original:</div>
                        <div class="bg-gray-100 p-2 rounded text-sm font-mono">${result.original}</div>
                    </div>
                    <div>
                        <div class="font-semibold text-gray-700 mb-1">Result:</div>
                        <div class="bg-indigo-100 p-2 rounded text-sm font-mono">${result.result}</div>
                    </div>
                    <div>
                        <div class="font-semibold text-gray-700 mb-1">Difference (ms):</div>
                        <div class="text-sm text-gray-600">${result.difference}</div>
                    </div>
                </div>
            `;
            
            document.getElementById('add-time-results').classList.remove('hidden');
        }

        // Get Timestamp Info
        function getTimestampInfo() {
            if (!timestampConverter) {
                alert('Timestamp Converter not initialized. Please refresh the page.');
                return;
            }

            const timestamp = document.getElementById('input-timestamp').value.trim();
            if (!timestamp) {
                alert('Please enter a timestamp.');
                return;
            }

            const result = timestampConverter.getTimestampInfo(timestamp, 'auto', 'UTC');
            if (result.success) {
                showTimestampInfoResults(result);
            } else {
                alert('Error getting timestamp info: ' + result.error);
            }
        }

        // Show Timestamp Info Results
        function showTimestampInfoResults(result) {
            hideAllTimestampResults();
            
            document.getElementById('timestamp-info-content').innerHTML = `
                <div class="space-y-3">
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <div class="font-semibold text-gray-700 mb-1">Unix Timestamp:</div>
                            <div class="text-sm text-gray-600">${result.unix}</div>
                        </div>
                        <div>
                            <div class="font-semibold text-gray-700 mb-1">Unix (ms):</div>
                            <div class="text-sm text-gray-600">${result.unixMs}</div>
                        </div>
                        <div>
                            <div class="font-semibold text-gray-700 mb-1">ISO 8601:</div>
                            <div class="text-sm text-gray-600 font-mono">${result.iso8601}</div>
                        </div>
                        <div>
                            <div class="font-semibold text-gray-700 mb-1">RFC 2822:</div>
                            <div class="text-sm text-gray-600 font-mono">${result.rfc2822}</div>
                        </div>
                        <div>
                            <div class="font-semibold text-gray-700 mb-1">Human Readable:</div>
                            <div class="text-sm text-gray-600">${result.human}</div>
                        </div>
                        <div>
                            <div class="font-semibold text-gray-700 mb-1">Year:</div>
                            <div class="text-sm text-gray-600">${result.year}</div>
                        </div>
                        <div>
                            <div class="font-semibold text-gray-700 mb-1">Month:</div>
                            <div class="text-sm text-gray-600">${result.month}</div>
                        </div>
                        <div>
                            <div class="font-semibold text-gray-700 mb-1">Day:</div>
                            <div class="text-sm text-gray-600">${result.day}</div>
                        </div>
                        <div>
                            <div class="font-semibold text-gray-700 mb-1">Hour:</div>
                            <div class="text-sm text-gray-600">${result.hour}</div>
                        </div>
                        <div>
                            <div class="font-semibold text-gray-700 mb-1">Minute:</div>
                            <div class="text-sm text-gray-600">${result.minute}</div>
                        </div>
                        <div>
                            <div class="font-semibold text-gray-700 mb-1">Second:</div>
                            <div class="text-sm text-gray-600">${result.second}</div>
                        </div>
                        <div>
                            <div class="font-semibold text-gray-700 mb-1">Day of Week:</div>
                            <div class="text-sm text-gray-600">${result.dayOfWeek}</div>
                        </div>
                        <div>
                            <div class="font-semibold text-gray-700 mb-1">Day of Year:</div>
                            <div class="text-sm text-gray-600">${result.dayOfYear}</div>
                        </div>
                        <div>
                            <div class="font-semibold text-gray-700 mb-1">Week of Year:</div>
                            <div class="text-sm text-gray-600">${result.weekOfYear}</div>
                        </div>
                        <div>
                            <div class="font-semibold text-gray-700 mb-1">Leap Year:</div>
                            <div class="text-sm text-gray-600">${result.isLeapYear ? 'Yes' : 'No'}</div>
                        </div>
                    </div>
                </div>
            `;
            
            document.getElementById('timestamp-info-results').classList.remove('hidden');
        }

        // Validate Timestamp
        function validateTimestamp() {
            if (!timestampConverter) {
                alert('Timestamp Converter not initialized. Please refresh the page.');
                return;
            }

            const timestamp = document.getElementById('input-timestamp').value.trim();
            const format = document.getElementById('from-format').value;

            if (!timestamp) {
                alert('Please enter a timestamp.');
                return;
            }

            const result = timestampConverter.validateTimestamp(timestamp, format);
            showTimestampValidationResults(result);
        }

        // Show Timestamp Validation Results
        function showTimestampValidationResults(result) {
            hideAllTimestampResults();
            
            document.getElementById('timestamp-validation-content').innerHTML = `
                <div class="space-y-3">
                    <div>
                        <div class="font-semibold text-gray-700 mb-1">Valid:</div>
                        <div class="text-sm ${result.valid ? 'text-green-600' : 'text-red-600'}">${result.valid ? 'Yes' : 'No'}</div>
                    </div>
                    ${result.parsed ? `
                        <div>
                            <div class="font-semibold text-gray-700 mb-1">Parsed Date:</div>
                            <div class="text-sm text-gray-600 font-mono">${result.parsed}</div>
                        </div>
                    ` : ''}
                    ${result.error ? `
                        <div>
                            <div class="font-semibold text-gray-700 mb-1">Error:</div>
                            <div class="text-sm text-red-600">${result.error}</div>
                        </div>
                    ` : ''}
                </div>
            `;
            
            document.getElementById('timestamp-validation-results').classList.remove('hidden');
        }

        // Hide All Timestamp Results
        function hideAllTimestampResults() {
            document.getElementById('timestamp-conversion-results').classList.add('hidden');
            document.getElementById('current-time-results').classList.add('hidden');
            document.getElementById('time-difference-results').classList.add('hidden');
            document.getElementById('add-time-results').classList.add('hidden');
            document.getElementById('timestamp-info-results').classList.add('hidden');
            document.getElementById('timestamp-validation-results').classList.add('hidden');
        }

        // Clear Timestamp Form
        function clearTimestampForm() {
            document.getElementById('input-timestamp').value = '';
            document.getElementById('diff-timestamp1').value = '';
            document.getElementById('diff-timestamp2').value = '';
            document.getElementById('add-timestamp').value = '';
            document.getElementById('add-amount').value = '';
            hideAllTimestampResults();
        }

        // Copy Timestamp Result
        function copyTimestampResult() {
            const resultElements = [
                'timestamp-conversion-content',
                'current-time-content',
                'time-difference-content',
                'add-time-content',
                'timestamp-info-content',
                'timestamp-validation-content'
            ];

            for (const elementId of resultElements) {
                const element = document.getElementById(elementId);
                if (element && !element.parentElement.classList.contains('hidden')) {
                    const text = element.textContent;
                    navigator.clipboard.writeText(text).then(() => {
                        alert('Result copied to clipboard!');
                    }).catch(() => {
                        alert('Failed to copy to clipboard');
                    });
                    return;
                }
            }
            alert('No results to copy');
        }

        // Initialize Timestamp Converter on page load
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                initializeTimestampConverter();
            }, 200);
        });

        // Age Calculator Functions
        let ageCalculator = null;

        // Initialize Age Calculator
        function initializeAgeCalculator() {
            try {
                if (typeof AgeCalculator !== 'undefined') {
                    ageCalculator = new AgeCalculator();
                    console.log('‚úÖ Age Calculator initialized successfully');
                } else {
                    console.error('‚ùå AgeCalculator class not found');
                }
            } catch (error) {
                console.error('‚ùå Error initializing Age Calculator:', error);
            }
        }

        // BMI Calculator Functions
        let bmiCalculator = null;

        // BMI Calculator Temporarily Unavailable Message
        function showBMITemporarilyUnavailable() {
            alert('üîß BMI Calculator - Temporarily Unavailable\n\n' +
                  'üòä Oops! Our BMI Calculator is taking a quick coffee break! ‚òï\n\n' +
                  'We\'re giving it some TLC (Tender Loving Code) and it\'ll be back stronger than ever!\n\n' +
                  'üí° Pro tip: Check out our other awesome calculators while you wait!\n\n' +
                  'Thanks for your patience! üôè');
        }

        // Initialize BMI Calculator
        function initializeBMICalculator() {
            try {
                console.log('üîç Attempting to initialize BMI Calculator...');
                console.log('BMICalculator type:', typeof BMICalculator);
                
                if (typeof BMICalculator !== 'undefined') {
                    if (!bmiCalculator) {
                        bmiCalculator = new BMICalculator();
                        console.log('‚úÖ BMI Calculator initialized successfully');
                        return true; // Success!
                    } else {
                        console.log('‚ÑπÔ∏è BMI Calculator already initialized');
                        return true; // Already initialized
                    }
                } else {
                    console.error('‚ùå BMICalculator class not found. Script may not be loaded yet.');
                    // Try again after a delay
                    setTimeout(() => {
                        console.log('üîÑ Retrying BMI Calculator initialization...');
                        if (typeof BMICalculator !== 'undefined' && !bmiCalculator) {
                            bmiCalculator = new BMICalculator();
                            console.log('‚úÖ BMI Calculator initialized successfully (retry)');
                        }
                    }, 500);
                    return false; // Failed to initialize
                }
            } catch (error) {
                console.error('‚ùå Error initializing BMI Calculator:', error);
                return false; // Failed
            }
        }

        // Calculate Age
        function calculateAge() {
            if (!ageCalculator) {
                alert('Age Calculator not initialized. Please refresh the page.');
                return;
            }

            const birthDate = document.getElementById('birth-date').value;
            const currentDate = document.getElementById('current-date').value;
            const method = document.getElementById('calculation-method').value;

            if (!birthDate) {
                alert('Please enter a birth date.');
                return;
            }

            const result = ageCalculator.calculateAge(birthDate, currentDate || null, method);
            if (result.success) {
                showAgeResults(result);
            } else {
                alert('Error calculating age: ' + result.error);
            }
        }

        // Calculate BMI
        function calculateBMI() {
            // Check if initialized, if not try to initialize
            if (!bmiCalculator) {
                console.log('üîÑ BMI Calculator not initialized, attempting initialization...');
                const initialized = initializeBMICalculator();
                
                if (!initialized || !bmiCalculator) {
                    alert('‚ùå BMI Calculator could not be loaded.\n\nPlease refresh the page and try again.\n\nIf the issue persists, check the browser console for errors.');
                    console.error('Failed to initialize BMI Calculator. Check if BMICalculator.js is loaded.');
                    return;
                }
            }

            const weight = document.getElementById('bmi-weight').value;
            const height = document.getElementById('bmi-height').value;
            const unit = document.getElementById('bmi-unit').value;
            const age = document.getElementById('bmi-age').value;
            const gender = document.getElementById('bmi-gender').value;

            if (!weight || !height) {
                alert('Please enter both weight and height.');
                return;
            }

            const result = bmiCalculator.calculateBMI(weight, height, unit);
            if (result.success) {
                showBMIResults(result);
                showHealthAnalysisResults(result);
                showBodyFatResults(result);
                showRecommendationsResults(result);
            } else {
                alert('Error calculating BMI: ' + result.error);
            }
        }

        // Show BMI Results
        function showBMIResults(result) {
            hideAllBMIResults();
            
            const data = result.result;
            document.getElementById('bmi-content').innerHTML = `
                <div class="space-y-3">
                    <div class="text-center">
                        <div class="text-3xl font-bold text-${data.category.color}-600">${data.bmi}</div>
                        <div class="text-sm text-gray-600">BMI</div>
                    </div>
                    <div class="text-center">
                        <div class="text-lg font-semibold text-${data.category.color}-600">${data.category.label}</div>
                        <div class="text-sm text-gray-600">${data.category.range}</div>
                    </div>
                    <div class="grid grid-cols-2 gap-4 text-center">
                        <div>
                            <div class="font-semibold text-gray-700">Weight</div>
                            <div class="text-sm text-gray-600">${data.weight.toFixed(1)} kg</div>
                        </div>
                        <div>
                            <div class="font-semibold text-gray-700">Height</div>
                            <div class="text-sm text-gray-600">${(data.height * 100).toFixed(1)} cm</div>
                        </div>
                    </div>
                    <div class="text-center">
                        <div class="font-semibold text-gray-700">Ideal Weight Range</div>
                        <div class="text-sm text-gray-600">${data.idealWeight.range}</div>
                    </div>
                </div>
            `;
            
            document.getElementById('bmi-results').classList.remove('hidden');
        }

        // Show Health Analysis Results
        function showHealthAnalysisResults(result) {
            const data = result.result;
            document.getElementById('health-analysis-content').innerHTML = `
                <div class="space-y-3">
                    <div>
                        <div class="font-semibold text-gray-700 mb-1">Health Risk Level:</div>
                        <div class="text-sm text-${data.category.color}-600 font-semibold">${data.category.risk}</div>
                    </div>
                    <div>
                        <div class="font-semibold text-gray-700 mb-1">Health Risks:</div>
                        <ul class="text-sm text-gray-600 space-y-1">
                            ${data.healthRisk.map(risk => `<li>‚Ä¢ ${risk}</li>`).join('')}
                        </ul>
                    </div>
                    ${data.weightToLose > 0 ? `
                        <div>
                            <div class="font-semibold text-gray-700 mb-1">Weight to Lose:</div>
                            <div class="text-sm text-orange-600">${data.weightToLose} kg</div>
                        </div>
                    ` : ''}
                    ${data.weightToGain > 0 ? `
                        <div>
                            <div class="font-semibold text-gray-700 mb-1">Weight to Gain:</div>
                            <div class="text-sm text-blue-600">${data.weightToGain} kg</div>
                        </div>
                    ` : ''}
                </div>
            `;
            
            document.getElementById('health-analysis-results').classList.remove('hidden');
        }

        // Show Body Fat Results
        function showBodyFatResults(result) {
            const data = result.result;
            document.getElementById('body-fat-content').innerHTML = `
                <div class="space-y-3">
                    <div class="text-center">
                        <div class="text-2xl font-bold text-purple-600">${data.bodyFatEstimate.percentage}%</div>
                        <div class="text-sm text-gray-600">Estimated Body Fat</div>
                    </div>
                    <div class="text-center">
                        <div class="text-lg font-semibold text-purple-600">${data.bodyFatEstimate.label}</div>
                        <div class="text-sm text-gray-600">Category</div>
                    </div>
                    <div class="text-xs text-gray-500 text-center">
                        Note: This is an estimate based on BMI. For accurate body fat measurement, consider professional assessment.
                    </div>
                </div>
            `;
            
            document.getElementById('body-fat-results').classList.remove('hidden');
        }

        // Show Recommendations Results
        function showRecommendationsResults(result) {
            const data = result.result;
            document.getElementById('recommendations-content').innerHTML = `
                <div class="space-y-4">
                    <div>
                        <div class="font-semibold text-gray-700 mb-2">üçé Diet Recommendations:</div>
                        <ul class="text-sm text-gray-600 space-y-1">
                            ${data.recommendations.diet.map(rec => `<li>‚Ä¢ ${rec}</li>`).join('')}
                        </ul>
                    </div>
                    <div>
                        <div class="font-semibold text-gray-700 mb-2">üí™ Exercise Recommendations:</div>
                        <ul class="text-sm text-gray-600 space-y-1">
                            ${data.recommendations.exercise.map(rec => `<li>‚Ä¢ ${rec}</li>`).join('')}
                        </ul>
                    </div>
                    <div>
                        <div class="font-semibold text-gray-700 mb-2">üè† Lifestyle Recommendations:</div>
                        <ul class="text-sm text-gray-600 space-y-1">
                            ${data.recommendations.lifestyle.map(rec => `<li>‚Ä¢ ${rec}</li>`).join('')}
                        </ul>
                    </div>
                </div>
            `;
            
            document.getElementById('recommendations-results').classList.remove('hidden');
        }

        // Calculate Weight Goal
        function calculateWeightGoal() {
            // Check if initialized, if not try to initialize
            if (!bmiCalculator) {
                console.log('üîÑ BMI Calculator not initialized, attempting initialization...');
                const initialized = initializeBMICalculator();
                
                if (!initialized || !bmiCalculator) {
                    alert('‚ùå BMI Calculator could not be loaded.\n\nPlease refresh the page and try again.');
                    return;
                }
            }

            const currentWeight = document.getElementById('goal-current-weight').value;
            const height = document.getElementById('goal-height').value;
            const targetBMI = document.getElementById('target-bmi').value;

            if (!currentWeight || !height || !targetBMI) {
                alert('Please enter all required fields.');
                return;
            }

            const result = bmiCalculator.calculateWeightChange(parseFloat(currentWeight), parseFloat(targetBMI), parseFloat(height));
            showWeightGoalResults(result);
        }

        // Show Weight Goal Results
        function showWeightGoalResults(result) {
            document.getElementById('weight-goal-content').innerHTML = `
                <div class="space-y-3">
                    <div class="text-center">
                        <div class="text-2xl font-bold text-orange-600">${result.targetWeight} kg</div>
                        <div class="text-sm text-gray-600">Target Weight</div>
                    </div>
                    <div class="text-center">
                        <div class="text-lg font-semibold text-${result.action === 'gain' ? 'blue' : 'red'}-600">
                            ${result.action === 'gain' ? '+' : '-'}${result.amount} kg
                        </div>
                        <div class="text-sm text-gray-600">Weight ${result.action === 'gain' ? 'to Gain' : 'to Lose'}</div>
                    </div>
                    <div class="text-xs text-gray-500 text-center">
                        Aim for gradual weight ${result.action === 'gain' ? 'gain' : 'loss'} of 0.5-1 kg per week for healthy results.
                    </div>
                </div>
            `;
            
            document.getElementById('weight-goal-results').classList.remove('hidden');
        }

        // Get BMI Statistics
        function getBMIStatistics() {
            // Check if initialized, if not try to initialize
            if (!bmiCalculator) {
                console.log('üîÑ BMI Calculator not initialized, attempting initialization...');
                const initialized = initializeBMICalculator();
                
                if (!initialized || !bmiCalculator) {
                    alert('‚ùå BMI Calculator could not be loaded.\n\nPlease refresh the page and try again.');
                    return;
                }
            }

            const statistics = bmiCalculator.getStatistics();
            alert(`BMI Statistics:\n\nTotal Calculations: ${statistics.totalCalculations}\nAverage BMI: ${statistics.averageBMI.toFixed(1)}\nLast BMI: ${statistics.lastBMI.toFixed(1)}`);
        }

        // Clear BMI Form
        function showBMIStatisticsResults(stats) {
            document.getElementById('bmi-statistics-content').innerHTML = `
                <div class="space-y-3">
                    <div class="grid grid-cols-2 gap-4">
                        <div class="text-center">
                            <div class="text-2xl font-bold text-green-600">${stats.totalCalculations}</div>
                            <div class="text-sm text-gray-600">Total Calculations</div>
                        </div>
                        <div class="text-center">
                            <div class="text-2xl font-bold text-blue-600">${stats.averageBMI}</div>
                            <div class="text-sm text-gray-600">Average BMI</div>
                        </div>
                    </div>
                    <div class="text-center">
                        <div class="text-lg font-semibold text-purple-600">${stats.mostCommonCategory}</div>
                        <div class="text-sm text-gray-600">Most Common Category</div>
                    </div>
                    <div class="text-center">
                        <div class="text-lg font-semibold text-${stats.trend === 'increasing' ? 'red' : stats.trend === 'decreasing' ? 'green' : 'gray'}-600">
                            ${stats.trend.charAt(0).toUpperCase() + stats.trend.slice(1)}
                        </div>
                        <div class="text-sm text-gray-600">BMI Trend</div>
                    </div>
                    ${stats.totalCalculations > 0 ? `
                        <div class="text-center">
                            <div class="text-sm text-gray-600">BMI Range: ${stats.bmiRange.min} - ${stats.bmiRange.max}</div>
                        </div>
                    ` : ''}
                </div>
            `;
            
            document.getElementById('bmi-statistics-results').classList.remove('hidden');
        }

        // Hide All BMI Results
        function hideAllBMIResults() {
            document.getElementById('bmi-results').classList.add('hidden');
            document.getElementById('health-analysis-results').classList.add('hidden');
            document.getElementById('body-fat-results').classList.add('hidden');
            document.getElementById('recommendations-results').classList.add('hidden');
            document.getElementById('weight-goal-results').classList.add('hidden');
            document.getElementById('bmi-statistics-results').classList.add('hidden');
        }

        // Clear BMI Form
        function clearBMIForm() {
            document.getElementById('bmi-weight').value = '';
            document.getElementById('bmi-height').value = '';
            document.getElementById('bmi-age').value = '';
            document.getElementById('goal-current-weight').value = '';
            document.getElementById('goal-height').value = '';
            document.getElementById('target-bmi').value = '22';
            hideAllBMIResults();
        }

        // Copy BMI Result
        function copyBMIResult() {
            const resultElements = [
                'bmi-content',
                'health-analysis-content',
                'body-fat-content',
                'recommendations-content',
                'weight-goal-content',
                'bmi-statistics-content'
            ];

            for (const elementId of resultElements) {
                const element = document.getElementById(elementId);
                if (element && !element.parentElement.classList.contains('hidden')) {
                    const text = element.textContent;
                    if (text && text.trim()) {
                        navigator.clipboard.writeText(text).then(() => {
                            alert('BMI result copied to clipboard!');
                        }).catch(() => {
                            alert('Failed to copy result. Please try again.');
                        });
                        return;
                    }
                }
            }
            alert('No results to copy. Please calculate BMI first.');
        }

        // Export BMI Data
        function exportBMIData() {
            if (!bmiCalculator) {
                alert('BMI Calculator not initialized. Please refresh the page.');
                return;
            }

            const history = bmiCalculator.getHistory();
            if (history.length === 0) {
                alert('No BMI data to export. Please calculate BMI first.');
                return;
            }

            const dataStr = JSON.stringify(history, null, 2);
            const blob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'bmi-data.json';
            a.click();
            URL.revokeObjectURL(url);
            alert('BMI data exported successfully!');
        }

        // Show Age Results
        function showAgeResults(result) {
            hideAllAgeResults();
            
            document.getElementById('age-content').innerHTML = `
                <div class="space-y-3">
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <div class="font-semibold text-gray-700 mb-1">Age:</div>
                            <div class="text-lg font-bold text-pink-600">${result.age.years} years, ${result.age.months} months, ${result.age.days} days</div>
                        </div>
                        <div>
                            <div class="font-semibold text-gray-700 mb-1">Total Days:</div>
                            <div class="text-sm text-gray-600">${result.age.totalDays.toLocaleString()}</div>
                        </div>
                        <div>
                            <div class="font-semibold text-gray-700 mb-1">Total Weeks:</div>
                            <div class="text-sm text-gray-600">${result.age.totalWeeks.toLocaleString()}</div>
                        </div>
                        <div>
                            <div class="font-semibold text-gray-700 mb-1">Total Months:</div>
                            <div class="text-sm text-gray-600">${result.age.totalMonths.toLocaleString()}</div>
                        </div>
                        <div>
                            <div class="font-semibold text-gray-700 mb-1">Total Hours:</div>
                            <div class="text-sm text-gray-600">${result.age.totalHours.toLocaleString()}</div>
                        </div>
                        <div>
                            <div class="font-semibold text-gray-700 mb-1">Total Minutes:</div>
                            <div class="text-sm text-gray-600">${result.age.totalMinutes.toLocaleString()}</div>
                        </div>
                    </div>
                    <div class="border-t pt-3">
                        <div class="font-semibold text-gray-700 mb-2">Additional Information:</div>
                        <div class="grid grid-cols-2 gap-4 text-sm">
                            <div>
                                <div class="font-semibold text-gray-700 mb-1">Life Stage:</div>
                                <div class="text-gray-600">${result.lifeStage.name}</div>
                            </div>
                            <div>
                                <div class="font-semibold text-gray-700 mb-1">Zodiac Sign:</div>
                                <div class="text-gray-600">${result.zodiacSign}</div>
                            </div>
                            <div>
                                <div class="font-semibold text-gray-700 mb-1">Chinese Zodiac:</div>
                                <div class="text-gray-600">${result.chineseZodiac}</div>
                            </div>
                            <div>
                                <div class="font-semibold text-gray-700 mb-1">Next Birthday:</div>
                                <div class="text-gray-600">${result.nextBirthday.daysUntil} days</div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.getElementById('age-results').classList.remove('hidden');
        }

        // Calculate Age Difference
        function calculateAgeDifference() {
            if (!ageCalculator) {
                alert('Age Calculator not initialized. Please refresh the page.');
                return;
            }

            const person1Birth = document.getElementById('person1-birth').value;
            const person2Birth = document.getElementById('person2-birth').value;

            if (!person1Birth || !person2Birth) {
                alert('Please enter both birth dates.');
                return;
            }

            const result = ageCalculator.calculateAgeDifference(person1Birth, person2Birth);
            if (result.success) {
                showAgeDifferenceResults(result);
            } else {
                alert('Error calculating age difference: ' + result.error);
            }
        }

        // Show Age Difference Results
        function showAgeDifferenceResults(result) {
            hideAllAgeResults();
            
            document.getElementById('age-difference-content').innerHTML = `
                <div class="space-y-3">
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <div class="font-semibold text-gray-700 mb-1">Person 1 Age:</div>
                            <div class="text-sm text-gray-600">${result.person1.age.years} years, ${result.person1.age.months} months</div>
                        </div>
                        <div>
                            <div class="font-semibold text-gray-700 mb-1">Person 2 Age:</div>
                            <div class="text-sm text-gray-600">${result.person2.age.years} years, ${result.person2.age.months} months</div>
                        </div>
                    </div>
                    <div class="border-t pt-3">
                        <div class="font-semibold text-gray-700 mb-2">Age Difference:</div>
                        <div class="grid grid-cols-2 gap-4 text-sm">
                            <div>
                                <div class="font-semibold text-gray-700 mb-1">Years:</div>
                                <div class="text-gray-600">${result.difference.years}</div>
                            </div>
                            <div>
                                <div class="font-semibold text-gray-700 mb-1">Months:</div>
                                <div class="text-gray-600">${result.difference.months}</div>
                            </div>
                            <div>
                                <div class="font-semibold text-gray-700 mb-1">Days:</div>
                                <div class="text-gray-600">${result.difference.days}</div>
                            </div>
                            <div>
                                <div class="font-semibold text-gray-700 mb-1">Total Days:</div>
                                <div class="text-gray-600">${result.difference.totalDays.toLocaleString()}</div>
                            </div>
                        </div>
                        <div class="mt-3">
                            <div class="font-semibold text-gray-700 mb-1">Older Person:</div>
                            <div class="text-sm text-gray-600">Person ${result.older} (${result.olderBy})</div>
                        </div>
                    </div>
                </div>
            `;
            
            document.getElementById('age-difference-results').classList.remove('hidden');
        }

        // Analyze Date
        function analyzeDate() {
            if (!ageCalculator) {
                alert('Age Calculator not initialized. Please refresh the page.');
                return;
            }

            const birthDate = document.getElementById('analysis-date').value;
            const analysisType = document.getElementById('analysis-type').value;

            if (!birthDate) {
                alert('Please enter a birth date.');
                return;
            }

            const result = ageCalculator.calculateAge(birthDate, null, 'precise');
            if (result.success) {
                showDateAnalysisResults(result, analysisType);
            } else {
                alert('Error analyzing date: ' + result.error);
            }
        }

        // Show Date Analysis Results
        function showDateAnalysisResults(result, analysisType) {
            hideAllAgeResults();
            
            let analysisContent = '';
            
            switch (analysisType) {
                case 'zodiac':
                    analysisContent = `
                        <div class="space-y-3">
                            <div>
                                <div class="font-semibold text-gray-700 mb-1">Zodiac Sign:</div>
                                <div class="text-lg font-bold text-indigo-600">${result.zodiacSign}</div>
                            </div>
                            <div>
                                <div class="font-semibold text-gray-700 mb-1">Birth Date:</div>
                                <div class="text-sm text-gray-600">${result.birthDate}</div>
                            </div>
                        </div>
                    `;
                    break;
                case 'chinese':
                    analysisContent = `
                        <div class="space-y-3">
                            <div>
                                <div class="font-semibold text-gray-700 mb-1">Chinese Zodiac:</div>
                                <div class="text-lg font-bold text-indigo-600">${result.chineseZodiac}</div>
                            </div>
                            <div>
                                <div class="font-semibold text-gray-700 mb-1">Birth Year:</div>
                                <div class="text-sm text-gray-600">${new Date(result.birthDate).getFullYear()}</div>
                            </div>
                        </div>
                    `;
                    break;
                case 'life-stage':
                    analysisContent = `
                        <div class="space-y-3">
                            <div>
                                <div class="font-semibold text-gray-700 mb-1">Life Stage:</div>
                                <div class="text-lg font-bold text-indigo-600">${result.lifeStage.name}</div>
                            </div>
                            <div>
                                <div class="font-semibold text-gray-700 mb-1">Age:</div>
                                <div class="text-sm text-gray-600">${result.age.years} years</div>
                            </div>
                        </div>
                    `;
                    break;
                case 'milestones':
                    analysisContent = `
                        <div class="space-y-3">
                            <div>
                                <div class="font-semibold text-gray-700 mb-1">Age Milestones:</div>
                                <div class="space-y-2">
                                    ${result.milestones.map(milestone => `
                                        <div class="flex justify-between items-center p-2 bg-gray-50 rounded">
                                            <span class="text-sm">${milestone.milestone}</span>
                                            <span class="text-sm font-semibold ${milestone.age <= result.age.years ? 'text-green-600' : 'text-gray-400'}">
                                                ${milestone.age <= result.age.years ? '‚úì' : milestone.age} years
                                            </span>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        </div>
                    `;
                    break;
                case 'next-birthday':
                    analysisContent = `
                        <div class="space-y-3">
                            <div>
                                <div class="font-semibold text-gray-700 mb-1">Next Birthday:</div>
                                <div class="text-lg font-bold text-indigo-600">${result.nextBirthday.date}</div>
                            </div>
                            <div>
                                <div class="font-semibold text-gray-700 mb-1">Days Until:</div>
                                <div class="text-sm text-gray-600">${result.nextBirthday.daysUntil} days</div>
                            </div>
                            <div>
                                <div class="font-semibold text-gray-700 mb-1">Age at Birthday:</div>
                                <div class="text-sm text-gray-600">${result.nextBirthday.ageAtBirthday} years</div>
                            </div>
                            <div>
                                <div class="font-semibold text-gray-700 mb-1">Day of Week:</div>
                                <div class="text-sm text-gray-600">${result.nextBirthday.dayOfWeek}</div>
                            </div>
                        </div>
                    `;
                    break;
            }
            
            document.getElementById('date-analysis-content').innerHTML = analysisContent;
            document.getElementById('date-analysis-results').classList.remove('hidden');
        }

        // Get Current Age
        function getCurrentAge() {
            if (!ageCalculator) {
                alert('Age Calculator not initialized. Please refresh the page.');
                return;
            }

            const birthDate = document.getElementById('birth-date').value;
            if (!birthDate) {
                alert('Please enter a birth date first.');
                return;
            }

            const result = ageCalculator.calculateAge(birthDate, null, 'precise');
            if (result.success) {
                showCurrentAgeResults(result);
            } else {
                alert('Error getting current age: ' + result.error);
            }
        }

        // Show Current Age Results
        function showCurrentAgeResults(result) {
            hideAllAgeResults();
            
            document.getElementById('current-age-content').innerHTML = `
                <div class="space-y-3">
                    <div>
                        <div class="font-semibold text-gray-700 mb-1">Current Age:</div>
                        <div class="text-lg font-bold text-green-600">${result.age.years} years, ${result.age.months} months, ${result.age.days} days</div>
                    </div>
                    <div class="grid grid-cols-2 gap-4 text-sm">
                        <div>
                            <div class="font-semibold text-gray-700 mb-1">Total Days:</div>
                            <div class="text-gray-600">${result.age.totalDays.toLocaleString()}</div>
                        </div>
                        <div>
                            <div class="font-semibold text-gray-700 mb-1">Total Hours:</div>
                            <div class="text-gray-600">${result.age.totalHours.toLocaleString()}</div>
                        </div>
                        <div>
                            <div class="font-semibold text-gray-700 mb-1">Life Stage:</div>
                            <div class="text-gray-600">${result.lifeStage.name}</div>
                        </div>
                        <div>
                            <div class="font-semibold text-gray-700 mb-1">Next Birthday:</div>
                            <div class="text-gray-600">${result.nextBirthday.daysUntil} days</div>
                        </div>
                    </div>
                </div>
            `;
            
            document.getElementById('current-age-results').classList.remove('hidden');
        }

        // Get Age Statistics
        function getAgeStatistics() {
            if (!ageCalculator) {
                alert('Age Calculator not initialized. Please refresh the page.');
                return;
            }

            // Sample ages for demonstration
            const sampleAges = [18, 20, 22, 25, 28, 30, 32, 35, 38, 40, 42, 45, 48, 50, 52, 55, 58, 60, 62, 65];
            const result = ageCalculator.getAgeStatistics(sampleAges);
            
            if (result.success) {
                showAgeStatisticsResults(result);
            } else {
                alert('Error getting age statistics: ' + result.error);
            }
        }

        // Show Age Statistics Results
        function showAgeStatisticsResults(result) {
            hideAllAgeResults();
            
            document.getElementById('age-statistics-content').innerHTML = `
                <div class="space-y-3">
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <div class="font-semibold text-gray-700 mb-1">Sample Size:</div>
                            <div class="text-sm text-gray-600">${result.count} ages</div>
                        </div>
                        <div>
                            <div class="font-semibold text-gray-700 mb-1">Age Range:</div>
                            <div class="text-sm text-gray-600">${result.min} - ${result.max} years</div>
                        </div>
                        <div>
                            <div class="font-semibold text-gray-700 mb-1">Average Age:</div>
                            <div class="text-sm text-gray-600">${result.mean} years</div>
                        </div>
                        <div>
                            <div class="font-semibold text-gray-700 mb-1">Median Age:</div>
                            <div class="text-sm text-gray-600">${result.median} years</div>
                        </div>
                        <div>
                            <div class="font-semibold text-gray-700 mb-1">Standard Deviation:</div>
                            <div class="text-sm text-gray-600">${result.standardDeviation}</div>
                        </div>
                        <div>
                            <div class="font-semibold text-gray-700 mb-1">Variance:</div>
                            <div class="text-sm text-gray-600">${result.variance}</div>
                        </div>
                    </div>
                </div>
            `;
            
            document.getElementById('age-statistics-results').classList.remove('hidden');
        }

        // Hide All Age Results
        function hideAllAgeResults() {
            document.getElementById('age-results').classList.add('hidden');
            document.getElementById('age-difference-results').classList.add('hidden');
            document.getElementById('date-analysis-results').classList.add('hidden');
            document.getElementById('current-age-results').classList.add('hidden');
            document.getElementById('age-statistics-results').classList.add('hidden');
        }

        // Clear Age Form
        function clearAgeForm() {
            document.getElementById('birth-date').value = '';
            document.getElementById('current-date').value = '';
            document.getElementById('person1-birth').value = '';
            document.getElementById('person2-birth').value = '';
            document.getElementById('analysis-date').value = '';
            hideAllAgeResults();
        }

        // Copy Age Result
        function copyAgeResult() {
            const resultElements = [
                'age-content',
                'age-difference-content',
                'date-analysis-content',
                'current-age-content',
                'age-statistics-content'
            ];

            for (const elementId of resultElements) {
                const element = document.getElementById(elementId);
                if (element && !element.parentElement.classList.contains('hidden')) {
                    const text = element.textContent;
                    navigator.clipboard.writeText(text).then(() => {
                        alert('Result copied to clipboard!');
                    }).catch(() => {
                        alert('Failed to copy to clipboard');
                    });
                    return;
                }
            }
            alert('No results to copy');
        }

        // Initialize Age Calculator on page load
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', function() {
                setTimeout(() => {
                    initializeAgeCalculator();
                }, 200);
            });
        } else {
            // DOM already loaded
            setTimeout(() => {
                initializeAgeCalculator();
            }, 200);
        }

        // Initialize BMI Calculator on page load
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', function() {
                setTimeout(() => {
                    initializeBMICalculator();
                }, 200);
            });
        } else {
            // DOM already loaded
            setTimeout(() => {
                initializeBMICalculator();
            }, 200);
        }

        // ============================================
        // PDF TO IMAGES FUNCTIONS
        // ============================================
        
        let pdfToImagesFile = null;
        let pdfToImagesDocument = null;
        let convertedImages = [];
        let pdfToImagesFilename = '';

        // Initialize PDF to Images functionality
        document.addEventListener('DOMContentLoaded', function() {
            const dropZone = document.getElementById('pdf-to-images-drop-zone');
            const fileInput = document.getElementById('pdf-to-images-file-input');
            const qualitySlider = document.getElementById('pdf-to-images-quality');
            const qualityValue = document.getElementById('pdf-to-images-quality-value');
            const scaleSlider = document.getElementById('pdf-to-images-scale');
            const scaleValue = document.getElementById('pdf-to-images-scale-value');
            const pageRangeInput = document.getElementById('pdf-to-images-page-range');
            const pageRadios = document.querySelectorAll('input[name="pdf-to-images-pages"]');

            if (!dropZone || !fileInput) return;

            // Click to browse
            dropZone.addEventListener('click', () => fileInput.click());

            // File input change
            fileInput.addEventListener('change', (e) => {
                if (e.target.files.length > 0) {
                    handlePdfToImagesFile(e.target.files[0]);
                }
            });

            // Drag and drop
            dropZone.addEventListener('dragover', (e) => {
                e.preventDefault();
                dropZone.classList.add('border-orange-500', 'bg-orange-50');
            });

            dropZone.addEventListener('dragleave', () => {
                dropZone.classList.remove('border-orange-500', 'bg-orange-50');
            });

            dropZone.addEventListener('drop', (e) => {
                e.preventDefault();
                dropZone.classList.remove('border-orange-500', 'bg-orange-50');
                if (e.dataTransfer.files.length > 0) {
                    handlePdfToImagesFile(e.dataTransfer.files[0]);
                }
            });

            // Quality slider
            if (qualitySlider && qualityValue) {
                qualitySlider.addEventListener('input', (e) => {
                    qualityValue.textContent = e.target.value + '%';
                });
            }

            // Scale slider
            if (scaleSlider && scaleValue) {
                scaleSlider.addEventListener('input', (e) => {
                    const scale = parseFloat(e.target.value);
                    scaleValue.textContent = scale + 'x' + (scale >= 2 ? ' (High Quality)' : '');
                });
            }

            // Page selection radio
            pageRadios.forEach(radio => {
                radio.addEventListener('change', () => {
                    if (pageRangeInput) {
                        pageRangeInput.disabled = radio.value === 'all';
                    }
                });
            });
        });

        function handlePdfToImagesFile(file) {
            if (file.type !== 'application/pdf') {
                showPdfToImagesError('Please select a valid PDF file.');
                return;
            }

            pdfToImagesFile = file;
            pdfToImagesFilename = file.name.replace('.pdf', '');

            // Update UI
            document.getElementById('pdf-to-images-filename').textContent = file.name;
            document.getElementById('pdf-to-images-filesize').textContent = 
                'Size: ' + (file.size / (1024 * 1024)).toFixed(2) + ' MB';
            document.getElementById('pdf-to-images-file-info').classList.remove('hidden');

            // Hide previous results
            document.getElementById('pdf-to-images-success').classList.add('hidden');
            document.getElementById('pdf-to-images-error').classList.add('hidden');

            // Load PDF to get page count
            loadPdfForImages(file);
        }

        async function loadPdfForImages(file) {
            try {
                const arrayBuffer = await file.arrayBuffer();
                const loadingTask = pdfjsLib.getDocument({data: arrayBuffer});
                pdfToImagesDocument = await loadingTask.promise;

                const numPages = pdfToImagesDocument.numPages;
                
                // Update UI
                document.getElementById('pdf-to-images-total-pages').textContent = numPages;
                document.getElementById('pdf-to-images-options-section').classList.remove('hidden');
                document.getElementById('pdf-to-images-convert-section').classList.remove('hidden');

            } catch (error) {
                console.error('Error loading PDF:', error);
                showPdfToImagesError('Failed to load PDF. Please try another file.');
            }
        }

        function clearPdfToImagesFile() {
            pdfToImagesFile = null;
            pdfToImagesDocument = null;
            convertedImages = [];
            pdfToImagesFilename = '';
            
            document.getElementById('pdf-to-images-file-input').value = '';
            document.getElementById('pdf-to-images-file-info').classList.add('hidden');
            document.getElementById('pdf-to-images-options-section').classList.add('hidden');
            document.getElementById('pdf-to-images-convert-section').classList.add('hidden');
            document.getElementById('pdf-to-images-success').classList.add('hidden');
            document.getElementById('pdf-to-images-error').classList.add('hidden');
            document.getElementById('pdf-to-images-progress').classList.add('hidden');
        }

        async function convertPdfToImages() {
            if (!pdfToImagesDocument) {
                showPdfToImagesError('Please upload a PDF file first.');
                return;
            }

            // Get options
            const format = document.querySelector('input[name="pdf-to-images-format"]:checked').value;
            const quality = parseInt(document.getElementById('pdf-to-images-quality').value) / 100;
            const scale = parseFloat(document.getElementById('pdf-to-images-scale').value);
            const pageSelection = document.querySelector('input[name="pdf-to-images-pages"]:checked').value;
            
            // Get page numbers to convert
            let pagesToConvert = [];
            const totalPages = pdfToImagesDocument.numPages;

            if (pageSelection === 'all') {
                for (let i = 1; i <= totalPages; i++) {
                    pagesToConvert.push(i);
                }
            } else {
                const pageRange = document.getElementById('pdf-to-images-page-range').value;
                pagesToConvert = parsePageRange(pageRange, totalPages);
                
                if (pagesToConvert.length === 0) {
                    showPdfToImagesError('Please enter valid page numbers. Example: 1,3-5,7');
                    return;
                }
            }

            // Show progress
            document.getElementById('pdf-to-images-convert-section').classList.add('hidden');
            document.getElementById('pdf-to-images-progress').classList.remove('hidden');
            document.getElementById('pdf-to-images-error').classList.add('hidden');

            convertedImages = [];

            try {
                for (let i = 0; i < pagesToConvert.length; i++) {
                    const pageNum = pagesToConvert[i];
                    
                    // Update progress
                    const progress = ((i + 1) / pagesToConvert.length) * 100;
                    document.getElementById('pdf-to-images-progress-bar').style.width = progress + '%';
                    document.getElementById('pdf-to-images-progress-percent').textContent = Math.round(progress) + '%';
                    document.getElementById('pdf-to-images-progress-text').textContent = 
                        `Converting page ${pageNum} of ${totalPages}...`;

                    // Render page to canvas
                    const page = await pdfToImagesDocument.getPage(pageNum);
                    const viewport = page.getViewport({ scale: scale });
                    
                    const canvas = document.createElement('canvas');
                    const context = canvas.getContext('2d');
                    canvas.height = viewport.height;
                    canvas.width = viewport.width;

                    await page.render({
                        canvasContext: context,
                        viewport: viewport
                    }).promise;

                    // Convert to image
                    const mimeType = format === 'png' ? 'image/png' : 'image/jpeg';
                    const imageBlob = await new Promise(resolve => {
                        canvas.toBlob(resolve, mimeType, quality);
                    });

                    convertedImages.push({
                        pageNum: pageNum,
                        blob: imageBlob,
                        format: format
                    });

                    // Small delay to prevent browser freeze
                    await new Promise(resolve => setTimeout(resolve, 10));
                }

                // Show success
                showPdfToImagesSuccess();

            } catch (error) {
                console.error('Error converting PDF to images:', error);
                showPdfToImagesError('Failed to convert PDF. Please try again.');
                document.getElementById('pdf-to-images-convert-section').classList.remove('hidden');
            } finally {
                document.getElementById('pdf-to-images-progress').classList.add('hidden');
            }
        }

        function parsePageRange(rangeStr, maxPages) {
            const pages = new Set();
            const parts = rangeStr.split(',');

            for (let part of parts) {
                part = part.trim();
                
                if (part.includes('-')) {
                    const [start, end] = part.split('-').map(n => parseInt(n.trim()));
                    if (isNaN(start) || isNaN(end) || start < 1 || end > maxPages || start > end) {
                        return [];
                    }
                    for (let i = start; i <= end; i++) {
                        pages.add(i);
                    }
                } else {
                    const num = parseInt(part);
                    if (isNaN(num) || num < 1 || num > maxPages) {
                        return [];
                    }
                    pages.add(num);
                }
            }

            return Array.from(pages).sort((a, b) => a - b);
        }

        function showPdfToImagesSuccess() {
            // Calculate total size
            let totalSize = 0;
            convertedImages.forEach(img => {
                totalSize += img.blob.size;
            });

            // Update UI
            document.getElementById('pdf-to-images-success-count').textContent = convertedImages.length;
            document.getElementById('pdf-to-images-total-size').textContent = 
                '~' + (totalSize / (1024 * 1024)).toFixed(2) + ' MB';
            document.getElementById('pdf-to-images-naming-example').textContent = 
                `${pdfToImagesFilename}-page-1.${convertedImages[0].format}, ${pdfToImagesFilename}-page-2.${convertedImages[0].format}, ...`;

            // Create preview thumbnails
            const previewContainer = document.getElementById('pdf-to-images-preview');
            previewContainer.innerHTML = '';

            convertedImages.slice(0, 10).forEach((img, index) => {
                const thumbnail = document.createElement('div');
                thumbnail.className = 'w-12 h-16 border-2 border-gray-300 rounded flex items-center justify-center text-xs font-semibold bg-gray-100';
                thumbnail.textContent = img.pageNum;
                previewContainer.appendChild(thumbnail);
            });

            if (convertedImages.length > 10) {
                const more = document.createElement('div');
                more.className = 'w-12 h-16 border-2 border-gray-300 rounded flex items-center justify-center text-xs font-semibold bg-gray-100';
                more.textContent = `+${convertedImages.length - 10}`;
                previewContainer.appendChild(more);
            }

            document.getElementById('pdf-to-images-success').classList.remove('hidden');
        }

        async function downloadImagesAsZip() {
            if (convertedImages.length === 0) {
                alert('No images to download!');
                return;
            }

            try {
                // Create ZIP file
                const zip = new JSZip();

                convertedImages.forEach((img, index) => {
                    const filename = `${pdfToImagesFilename}-page-${img.pageNum}.${img.format}`;
                    zip.file(filename, img.blob);
                });

                // Generate ZIP
                const zipBlob = await zip.generateAsync({
                    type: 'blob',
                    compression: 'DEFLATE',
                    compressionOptions: { level: 6 }
                });

                // Download
                const url = URL.createObjectURL(zipBlob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `${pdfToImagesFilename}-images.zip`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);

            } catch (error) {
                console.error('Error creating ZIP:', error);
                alert('Failed to create ZIP file. Please try again.');
            }
        }

        function showPdfToImagesError(message) {
            document.getElementById('pdf-to-images-error-message').textContent = message;
            document.getElementById('pdf-to-images-error').classList.remove('hidden');
            document.getElementById('pdf-to-images-success').classList.add('hidden');
        }

        // ============================================
        // TOOL SEARCH FUNCTIONALITY
        // ============================================

        let allToolCards = [];
        let totalToolCount = 0;

        // Initialize tool search on page load
        document.addEventListener('DOMContentLoaded', function() {
            const searchInput = document.getElementById('tool-search-input');
            const clearBtn = document.getElementById('clear-search-btn');
            
            if (!searchInput) return;

            // Get all tool cards
            allToolCards = document.querySelectorAll('.tool-card');
            totalToolCount = allToolCards.length;

            // Real-time search as user types
            searchInput.addEventListener('input', function(e) {
                const searchTerm = e.target.value.trim();
                
                // Show/hide clear button
                if (searchTerm.length > 0) {
                    clearBtn.classList.remove('hidden');
                } else {
                    clearBtn.classList.add('hidden');
                }

                // Perform search
                performToolSearch(searchTerm);
            });

            // Clear search on Escape key
            searchInput.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    clearToolSearch();
                }
            });

            // Focus search input on Ctrl+K or Cmd+K
            document.addEventListener('keydown', function(e) {
                if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
                    e.preventDefault();
                    searchInput.focus();
                }
            });
        });

        function performToolSearch(searchTerm) {
            const searchLower = searchTerm.toLowerCase();
            const unifiedResults = document.getElementById('unified-search-results');
            const unifiedGrid = document.getElementById('unified-search-grid');
            const toolSections = document.querySelectorAll('.tool-section');
            
            // If search is empty, restore original layout
            if (searchTerm === '') {
                // Hide unified results
                unifiedResults.classList.add('hidden');
                unifiedGrid.innerHTML = '';
                
                // Show all original sections
                toolSections.forEach(section => {
                    section.classList.remove('tool-section-hidden');
                });
                
                // Show all tools in their original sections
                allToolCards.forEach(card => {
                    card.classList.remove('tool-hidden');
                });
                
                return;
            }
            
            // Search is active - use unified layout
            let matchingTools = [];
            
            allToolCards.forEach(card => {
                // Get tool information
                const toolName = card.querySelector('h4')?.textContent.toLowerCase() || '';
                const toolDescription = card.querySelector('p')?.textContent.toLowerCase() || '';
                const toolFeatures = Array.from(card.querySelectorAll('.flex.items-center span'))
                    .map(span => span.textContent.toLowerCase())
                    .join(' ');

                // Check if search term matches
                const matches = 
                    toolName.includes(searchLower) || 
                    toolDescription.includes(searchLower) || 
                    toolFeatures.includes(searchLower);

                if (matches) {
                    matchingTools.push(card);
                }
            });
            
            // Hide all original sections
            toolSections.forEach(section => {
                section.classList.add('tool-section-hidden');
            });
            
            // Show unified results section
            unifiedResults.classList.remove('hidden');
            
            // Clear and populate unified grid
            unifiedGrid.innerHTML = '';
            
            if (matchingTools.length > 0) {
                matchingTools.forEach(card => {
                    // Clone the tool card and add to unified grid
                    const clone = card.cloneNode(true);
                    clone.classList.remove('tool-hidden');
                    unifiedGrid.appendChild(clone);
                });
            }
            
            // Update UI based on results
            updateSearchUI(searchTerm, matchingTools.length);
        }

        function updateSearchUI(searchTerm, visibleCount) {
            const helperText = document.getElementById('search-helper-text');
            const resultsCounter = document.getElementById('search-results-counter');
            const noResultsMsg = document.getElementById('no-results-message');
            const unifiedSubtitle = document.getElementById('unified-search-subtitle');

            if (searchTerm === '') {
                // No search - show helper text
                helperText.classList.remove('hidden');
                resultsCounter.classList.add('hidden');
                noResultsMsg.classList.add('hidden');
            } else if (visibleCount === 0) {
                // No results found
                helperText.classList.add('hidden');
                resultsCounter.classList.add('hidden');
                noResultsMsg.classList.remove('hidden');
                
                // Hide unified results section
                document.getElementById('unified-search-results').classList.add('hidden');
                
                // Show no results in main area
                noResultsMsg.classList.remove('hidden');
            } else {
                // Show results counter
                helperText.classList.add('hidden');
                resultsCounter.classList.remove('hidden');
                noResultsMsg.classList.add('hidden');
                
                if (visibleCount === totalToolCount) {
                    resultsCounter.textContent = `Showing all ${totalToolCount} tools`;
                    if (unifiedSubtitle) {
                        unifiedSubtitle.textContent = `All ${totalToolCount} tools match your search`;
                    }
                } else {
                    resultsCounter.textContent = `Showing ${visibleCount} of ${totalToolCount} tools`;
                    if (unifiedSubtitle) {
                        unifiedSubtitle.textContent = `Found ${visibleCount} matching tools`;
                    }
                }
            }
        }

        function clearToolSearch() {
            const searchInput = document.getElementById('tool-search-input');
            const clearBtn = document.getElementById('clear-search-btn');
            
            // Clear input
            searchInput.value = '';
            
            // Hide clear button
            clearBtn.classList.add('hidden');
            
            // Show all tools
            performToolSearch('');
            
            // Focus back on input
            searchInput.focus();
        }

        // ============================================
        // IMAGE TO PDF FUNCTIONS
        // ============================================
        
        let imageToPdfFiles = [];
        let imageToPdfBlob = null;

        // Initialize Image to PDF functionality
        document.addEventListener('DOMContentLoaded', function() {
            const dropZone = document.getElementById('image-to-pdf-drop-zone');
            const fileInput = document.getElementById('image-to-pdf-file-input');

            if (!dropZone || !fileInput) return;

            // Click to browse
            dropZone.addEventListener('click', () => fileInput.click());

            // File input change
            fileInput.addEventListener('change', (e) => {
                if (e.target.files.length > 0) {
                    handleImageToPdfUpload(Array.from(e.target.files));
                }
            });

            // Drag and drop
            dropZone.addEventListener('dragover', (e) => {
                e.preventDefault();
                dropZone.classList.add('border-indigo-500', 'bg-indigo-50');
            });

            dropZone.addEventListener('dragleave', () => {
                dropZone.classList.remove('border-indigo-500', 'bg-indigo-50');
            });

            dropZone.addEventListener('drop', (e) => {
                e.preventDefault();
                dropZone.classList.remove('border-indigo-500', 'bg-indigo-50');
                if (e.dataTransfer.files.length > 0) {
                    handleImageToPdfUpload(Array.from(e.dataTransfer.files));
                }
            });
        });

        function handleImageToPdfUpload(files) {
            // Filter only image files
            const imageFiles = files.filter(file => file.type.startsWith('image/'));
            
            if (imageFiles.length === 0) {
                showImageToPdfError('Please select valid image files (JPG, PNG, WebP, GIF).');
                return;
            }

            // Add to array
            imageToPdfFiles.push(...imageFiles);

            // Update UI
            displayImageToPdfPreviews();
            
            // Show settings and convert sections
            document.getElementById('image-to-pdf-settings-section').classList.remove('hidden');
            document.getElementById('image-to-pdf-convert-section').classList.remove('hidden');
            document.getElementById('image-to-pdf-success').classList.add('hidden');
            document.getElementById('image-to-pdf-error').classList.add('hidden');
        }

        function displayImageToPdfPreviews() {
            const previewSection = document.getElementById('image-to-pdf-preview-section');
            const previewGrid = document.getElementById('image-to-pdf-preview-grid');
            const countSpan = document.getElementById('image-to-pdf-count');

            previewSection.classList.remove('hidden');
            countSpan.textContent = imageToPdfFiles.length;
            previewGrid.innerHTML = '';

            imageToPdfFiles.forEach((file, index) => {
                const reader = new FileReader();
                reader.onload = (e) => {
                    const preview = document.createElement('div');
                    preview.className = 'relative group';
                    
                    preview.innerHTML = `
                        <img src="${e.target.result}" class="w-full h-24 object-cover rounded-lg border-2 border-gray-300 group-hover:border-indigo-500 transition-all">
                        <div class="absolute top-1 right-1 bg-white rounded-full p-1 shadow-lg opacity-0 group-hover:opacity-100 transition-opacity">
                            <button onclick="removeImageToPdfAtIndex(${index})" class="text-red-600 hover:text-red-700">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                </svg>
                            </button>
                        </div>
                        <div class="absolute bottom-1 left-1 bg-indigo-600 text-white text-xs px-2 py-1 rounded font-semibold">
                            ${index + 1}
                        </div>
                        <div class="absolute bottom-1 right-1 bg-black bg-opacity-70 text-white text-xs px-2 py-1 rounded">
                            ${(file.size / 1024).toFixed(1)}KB
                        </div>
                    `;

                    previewGrid.appendChild(preview);
                };
                reader.readAsDataURL(file);
            });
        }

        function removeImageToPdfAtIndex(index) {
            imageToPdfFiles.splice(index, 1);
            
            if (imageToPdfFiles.length === 0) {
                document.getElementById('image-to-pdf-preview-section').classList.add('hidden');
                document.getElementById('image-to-pdf-settings-section').classList.add('hidden');
                document.getElementById('image-to-pdf-convert-section').classList.add('hidden');
            } else {
                displayImageToPdfPreviews();
            }
        }

        function clearAllImagesForPdf() {
            imageToPdfFiles = [];
            document.getElementById('image-to-pdf-preview-section').classList.add('hidden');
            document.getElementById('image-to-pdf-settings-section').classList.add('hidden');
            document.getElementById('image-to-pdf-convert-section').classList.add('hidden');
            document.getElementById('image-to-pdf-file-input').value = '';
            document.getElementById('image-to-pdf-success').classList.add('hidden');
            document.getElementById('image-to-pdf-error').classList.add('hidden');
        }

        async function convertImagesToPdf() {
            if (imageToPdfFiles.length === 0) {
                showImageToPdfError('Please upload at least one image.');
                return;
            }

            // Get settings
            const pageSize = document.querySelector('input[name="image-to-pdf-page-size"]:checked').value;
            const orientation = document.querySelector('input[name="image-to-pdf-orientation"]:checked').value;
            const fitOption = document.querySelector('input[name="image-to-pdf-fit"]:checked').value;

            // Show progress
            document.getElementById('image-to-pdf-convert-section').classList.add('hidden');
            document.getElementById('image-to-pdf-progress').classList.remove('hidden');
            document.getElementById('image-to-pdf-error').classList.add('hidden');
            document.getElementById('image-to-pdf-success').classList.add('hidden');

            try {
                // Create PDF document
                const pdfDoc = await PDFLib.PDFDocument.create();

                // Page size dimensions (in points, 72 points = 1 inch)
                const pageSizes = {
                    a4: { width: 595, height: 842 },
                    letter: { width: 612, height: 792 },
                    a5: { width: 420, height: 595 }
                };

                let pageWidth = pageSizes[pageSize].width;
                let pageHeight = pageSizes[pageSize].height;

                // Swap dimensions for landscape
                if (orientation === 'landscape') {
                    [pageWidth, pageHeight] = [pageHeight, pageWidth];
                }

                const margin = 20; // Fixed margin

                // Process each image
                for (let i = 0; i < imageToPdfFiles.length; i++) {
                    const file = imageToPdfFiles[i];
                    
                    // Update progress
                    const progress = ((i + 1) / imageToPdfFiles.length) * 100;
                    document.getElementById('image-to-pdf-progress-bar').style.width = progress + '%';
                    document.getElementById('image-to-pdf-progress-percent').textContent = Math.round(progress) + '%';
                    document.getElementById('image-to-pdf-progress-text').textContent = 
                        `Processing image ${i + 1} of ${imageToPdfFiles.length}...`;

                    // Read image as array buffer
                    const arrayBuffer = await file.arrayBuffer();
                    
                    // Embed image based on type
                    let image;
                    if (file.type === 'image/png') {
                        image = await pdfDoc.embedPng(arrayBuffer);
                    } else {
                        // For JPEG and other formats, try JPEG embedding
                        try {
                            image = await pdfDoc.embedJpg(arrayBuffer);
                        } catch (e) {
                            // If JPG embedding fails, convert to PNG
                            const canvas = document.createElement('canvas');
                            const ctx = canvas.getContext('2d');
                            const img = new Image();
                            
                            await new Promise((resolve, reject) => {
                                img.onload = resolve;
                                img.onerror = reject;
                                img.src = URL.createObjectURL(file);
                            });
                            
                            canvas.width = img.width;
                            canvas.height = img.height;
                            ctx.drawImage(img, 0, 0);
                            
                            const pngDataUrl = canvas.toDataURL('image/png');
                            image = await pdfDoc.embedPng(pngDataUrl);
                        }
                    }

                    // Create new page
                    const page = pdfDoc.addPage([pageWidth, pageHeight]);

                    // Calculate image dimensions
                    const imageDims = image.scale(1);
                    let drawWidth, drawHeight, x, y;

                    const availableWidth = pageWidth - (margin * 2);
                    const availableHeight = pageHeight - (margin * 2);

                    if (fitOption === 'fit') {
                        // Fit to page maintaining aspect ratio
                        const scale = Math.min(
                            availableWidth / imageDims.width,
                            availableHeight / imageDims.height
                        );
                        drawWidth = imageDims.width * scale;
                        drawHeight = imageDims.height * scale;
                    } else if (fitOption === 'stretch') {
                        // Stretch to fill page
                        drawWidth = availableWidth;
                        drawHeight = availableHeight;
                    } else {
                        // Original size (but constrained to page)
                        drawWidth = Math.min(imageDims.width, availableWidth);
                        drawHeight = Math.min(imageDims.height, availableHeight);
                    }

                    // Center image on page
                    x = (pageWidth - drawWidth) / 2;
                    y = (pageHeight - drawHeight) / 2;

                    // Draw image
                    page.drawImage(image, {
                        x: x,
                        y: y,
                        width: drawWidth,
                        height: drawHeight
                    });

                    // Small delay to prevent browser freeze
                    await new Promise(resolve => setTimeout(resolve, 50));
                }

                // Save PDF
                const pdfBytes = await pdfDoc.save();
                imageToPdfBlob = new Blob([pdfBytes], { type: 'application/pdf' });

                // Show success
                const fileSizeMB = (pdfBytes.length / (1024 * 1024)).toFixed(2);
                document.getElementById('image-to-pdf-page-count').textContent = imageToPdfFiles.length;
                document.getElementById('image-to-pdf-file-size').textContent = fileSizeMB + ' MB';
                
                document.getElementById('image-to-pdf-progress').classList.add('hidden');
                document.getElementById('image-to-pdf-success').classList.remove('hidden');

            } catch (error) {
                console.error('Error converting images to PDF:', error);
                showImageToPdfError('Failed to convert images to PDF: ' + error.message);
                document.getElementById('image-to-pdf-convert-section').classList.remove('hidden');
                document.getElementById('image-to-pdf-progress').classList.add('hidden');
            }
        }

        function downloadImageToPdf() {
            if (!imageToPdfBlob) {
                alert('No PDF to download!');
                return;
            }

            const url = URL.createObjectURL(imageToPdfBlob);
            const a = document.createElement('a');
            a.href = url;
            const timestamp = new Date().toISOString().split('T')[0];
            a.download = `images-to-pdf-${timestamp}.pdf`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function showImageToPdfError(message) {
            document.getElementById('image-to-pdf-error-message').textContent = message;
            document.getElementById('image-to-pdf-error').classList.remove('hidden');
            document.getElementById('image-to-pdf-success').classList.add('hidden');
        }

        // ============================================
        // IMAGE COMPRESSOR FUNCTIONS
        // ============================================

        let compressorFiles = [];
        let compressedImages = [];

        // Initialize Image Compressor functionality
        document.addEventListener('DOMContentLoaded', function() {
            const dropZone = document.getElementById('compressor-drop-zone');
            const fileInput = document.getElementById('compressor-file-input');
            const qualitySlider = document.getElementById('compressor-quality-slider');
            const qualityValue = document.getElementById('compressor-quality-value');
            const resizeCheckbox = document.getElementById('compressor-resize-checkbox');
            const resizeOptions = document.getElementById('compressor-resize-options');

            if (!dropZone || !fileInput) return;

            // Click to browse
            dropZone.addEventListener('click', () => fileInput.click());

            // File input change
            fileInput.addEventListener('change', (e) => {
                if (e.target.files.length > 0) {
                    handleCompressorUpload(Array.from(e.target.files));
                }
            });

            // Drag and drop
            dropZone.addEventListener('dragover', (e) => {
                e.preventDefault();
                dropZone.classList.add('border-green-500', 'bg-green-50');
            });

            dropZone.addEventListener('dragleave', () => {
                dropZone.classList.remove('border-green-500', 'bg-green-50');
            });

            dropZone.addEventListener('drop', (e) => {
                e.preventDefault();
                dropZone.classList.remove('border-green-500', 'bg-green-50');
                if (e.dataTransfer.files.length > 0) {
                    handleCompressorUpload(Array.from(e.dataTransfer.files));
                }
            });

            // Quality slider
            if (qualitySlider && qualityValue) {
                qualitySlider.addEventListener('input', (e) => {
                    qualityValue.textContent = e.target.value + '%';
                });
            }

            // Resize checkbox
            if (resizeCheckbox && resizeOptions) {
                resizeCheckbox.addEventListener('change', (e) => {
                    if (e.target.checked) {
                        resizeOptions.classList.remove('hidden');
                    } else {
                        resizeOptions.classList.add('hidden');
                    }
                });
            }
        });

        function handleCompressorUpload(files) {
            // Filter only image files
            const imageFiles = files.filter(file => file.type.startsWith('image/'));
            
            if (imageFiles.length === 0) {
                showCompressorError('Please select valid image files (JPG, PNG, WebP, GIF).');
                return;
            }

            // Add to array
            compressorFiles.push(...imageFiles);

            // Update UI
            displayCompressorPreviews();
            
            // Show settings and compress sections
            document.getElementById('compressor-settings-section').classList.remove('hidden');
            document.getElementById('compressor-compress-section').classList.remove('hidden');
            document.getElementById('compressor-success').classList.add('hidden');
            document.getElementById('compressor-error').classList.add('hidden');
        }

        function displayCompressorPreviews() {
            const previewSection = document.getElementById('compressor-preview-section');
            const previewGrid = document.getElementById('compressor-preview-grid');
            const countSpan = document.getElementById('compressor-count');

            previewSection.classList.remove('hidden');
            countSpan.textContent = compressorFiles.length;
            previewGrid.innerHTML = '';

            compressorFiles.forEach((file, index) => {
                const reader = new FileReader();
                reader.onload = (e) => {
                    const preview = document.createElement('div');
                    preview.className = 'relative group';
                    
                    preview.innerHTML = `
                        <img src="${e.target.result}" class="w-full h-24 object-cover rounded-lg border-2 border-gray-300 group-hover:border-green-500 transition-all">
                        <div class="absolute top-1 right-1 bg-white rounded-full p-1 shadow-lg opacity-0 group-hover:opacity-100 transition-opacity">
                            <button onclick="removeCompressorImage(${index})" class="text-red-600 hover:text-red-700">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                </svg>
                            </button>
                        </div>
                        <div class="absolute bottom-1 left-1 bg-green-600 text-white text-xs px-2 py-1 rounded font-semibold">
                            ${index + 1}
                        </div>
                        <div class="absolute bottom-1 right-1 bg-black bg-opacity-70 text-white text-xs px-2 py-1 rounded">
                            ${(file.size / (1024 * 1024)).toFixed(2)}MB
                        </div>
                    `;

                    previewGrid.appendChild(preview);
                };
                reader.readAsDataURL(file);
            });
        }

        function removeCompressorImage(index) {
            compressorFiles.splice(index, 1);
            
            if (compressorFiles.length === 0) {
                document.getElementById('compressor-preview-section').classList.add('hidden');
                document.getElementById('compressor-settings-section').classList.add('hidden');
                document.getElementById('compressor-compress-section').classList.add('hidden');
            } else {
                displayCompressorPreviews();
            }
        }

        function clearAllCompressorImages() {
            compressorFiles = [];
            compressedImages = [];
            document.getElementById('compressor-preview-section').classList.add('hidden');
            document.getElementById('compressor-settings-section').classList.add('hidden');
            document.getElementById('compressor-compress-section').classList.add('hidden');
            document.getElementById('compressor-file-input').value = '';
            document.getElementById('compressor-success').classList.add('hidden');
            document.getElementById('compressor-error').classList.add('hidden');
        }

        async function compressAllImages() {
            if (compressorFiles.length === 0) {
                showCompressorError('Please upload at least one image.');
                return;
            }

            // Get settings
            const quality = parseInt(document.getElementById('compressor-quality-slider').value) / 100;
            const format = document.querySelector('input[name="compressor-format"]:checked').value;
            const shouldResize = document.getElementById('compressor-resize-checkbox').checked;
            const maxWidth = shouldResize ? parseInt(document.getElementById('compressor-max-width').value) : null;
            const maxHeight = shouldResize ? parseInt(document.getElementById('compressor-max-height').value) : null;

            // Show progress
            document.getElementById('compressor-compress-section').classList.add('hidden');
            document.getElementById('compressor-progress').classList.remove('hidden');
            document.getElementById('compressor-error').classList.add('hidden');
            document.getElementById('compressor-success').classList.add('hidden');

            compressedImages = [];
            let totalOriginalSize = 0;
            let totalCompressedSize = 0;

            try {
                for (let i = 0; i < compressorFiles.length; i++) {
                    const file = compressorFiles[i];
                    
                    // Update progress
                    const progress = ((i + 1) / compressorFiles.length) * 100;
                    document.getElementById('compressor-progress-bar').style.width = progress + '%';
                    document.getElementById('compressor-progress-percent').textContent = Math.round(progress) + '%';
                    document.getElementById('compressor-progress-text').textContent = 
                        `Compressing image ${i + 1} of ${compressorFiles.length}...`;

                    // Compress the image
                    const result = await compressSingleImage(file, quality, format, maxWidth, maxHeight);
                    
                    compressedImages.push(result);
                    totalOriginalSize += result.originalSize;
                    totalCompressedSize += result.compressedSize;

                    // Small delay to prevent browser freeze
                    await new Promise(resolve => setTimeout(resolve, 50));
                }

                // Calculate savings
                const savingsPercent = Math.round(((totalOriginalSize - totalCompressedSize) / totalOriginalSize) * 100);
                
                // Display results
                document.getElementById('compressor-total-before').textContent = (totalOriginalSize / (1024 * 1024)).toFixed(2) + ' MB';
                document.getElementById('compressor-total-after').textContent = (totalCompressedSize / (1024 * 1024)).toFixed(2) + ' MB';
                document.getElementById('compressor-total-savings').textContent = savingsPercent + '%';

                displayCompressionResults();

                document.getElementById('compressor-progress').classList.add('hidden');
                document.getElementById('compressor-success').classList.remove('hidden');

            } catch (error) {
                console.error('Error compressing images:', error);
                showCompressorError('Failed to compress images: ' + error.message);
                document.getElementById('compressor-compress-section').classList.remove('hidden');
                document.getElementById('compressor-progress').classList.add('hidden');
            }
        }

        async function compressSingleImage(file, quality, format, maxWidth, maxHeight) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                
                reader.onload = (e) => {
                    const img = new Image();
                    
                    img.onload = () => {
                        try {
                            // Calculate dimensions
                            let width = img.width;
                            let height = img.height;

                            if (maxWidth && maxHeight) {
                                const ratio = Math.min(maxWidth / width, maxHeight / height);
                                if (ratio < 1) {
                                    width = Math.round(width * ratio);
                                    height = Math.round(height * ratio);
                                }
                            }

                            // Create canvas
                            const canvas = document.createElement('canvas');
                            canvas.width = width;
                            canvas.height = height;

                            const ctx = canvas.getContext('2d');
                            ctx.drawImage(img, 0, 0, width, height);

                            // Determine MIME type
                            let mimeType = 'image/jpeg';
                            if (format === 'png') {
                                mimeType = 'image/png';
                            } else if (format === 'webp') {
                                mimeType = 'image/webp';
                            }

                            // Convert to blob
                            canvas.toBlob((blob) => {
                                if (blob) {
                                    // Create object URL for preview
                                    const url = URL.createObjectURL(blob);
                                    
                                    resolve({
                                        originalFile: file,
                                        originalSize: file.size,
                                        compressedBlob: blob,
                                        compressedSize: blob.size,
                                        compressedUrl: url,
                                        originalUrl: e.target.result,
                                        filename: file.name.replace(/\.[^/.]+$/, '') + '.' + format,
                                        savingsPercent: Math.round(((file.size - blob.size) / file.size) * 100)
                                    });
                                } else {
                                    reject(new Error('Failed to create blob'));
                                }
                            }, mimeType, quality);

                        } catch (error) {
                            reject(error);
                        }
                    };

                    img.onerror = () => reject(new Error('Failed to load image'));
                    img.src = e.target.result;
                };

                reader.onerror = () => reject(new Error('Failed to read file'));
                reader.readAsDataURL(file);
            });
        }

        function displayCompressionResults() {
            const resultsGrid = document.getElementById('compressor-results-grid');
            resultsGrid.innerHTML = '';

            compressedImages.forEach((result, index) => {
                const resultCard = document.createElement('div');
                resultCard.className = 'bg-gray-50 border-2 border-gray-300 rounded-xl p-4 hover:border-green-500 transition-all';
                
                resultCard.innerHTML = `
                    <div class="flex items-center justify-between mb-3">
                        <h5 class="font-semibold text-gray-800 truncate flex-1">${result.filename}</h5>
                        <button onclick="downloadCompressedImage(${index})" class="bg-green-600 hover:bg-green-700 text-white px-3 py-1 rounded-lg text-sm font-semibold ml-2">
                            üì• Download
                        </button>
                    </div>
                    
                    <div class="grid grid-cols-2 gap-3 mb-3">
                        <div class="text-center">
                            <img src="${result.originalUrl}" class="w-full h-32 object-cover rounded-lg border border-gray-300 mb-2">
                            <p class="text-xs font-semibold text-gray-600">BEFORE</p>
                            <p class="text-sm font-bold text-gray-800">${(result.originalSize / (1024 * 1024)).toFixed(2)} MB</p>
                        </div>
                        <div class="text-center">
                            <img src="${result.compressedUrl}" class="w-full h-32 object-cover rounded-lg border border-gray-300 mb-2">
                            <p class="text-xs font-semibold text-gray-600">AFTER</p>
                            <p class="text-sm font-bold text-green-600">${(result.compressedSize / (1024 * 1024)).toFixed(2)} MB</p>
                        </div>
                    </div>
                    
                    <div class="bg-green-100 border border-green-500 rounded-lg p-2 text-center">
                        <p class="text-sm font-bold text-green-800">
                            üíæ Saved: ${((result.originalSize - result.compressedSize) / (1024 * 1024)).toFixed(2)} MB 
                            (${result.savingsPercent}% smaller)
                        </p>
                    </div>
                `;

                resultsGrid.appendChild(resultCard);
            });
        }

        function downloadCompressedImage(index) {
            if (!compressedImages[index]) {
                alert('Image not found!');
                return;
            }

            const result = compressedImages[index];
            const url = result.compressedUrl;
            const a = document.createElement('a');
            a.href = url;
            a.download = result.filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
        }

        async function downloadAllCompressedAsZip() {
            if (compressedImages.length === 0) {
                alert('No compressed images to download!');
                return;
            }

            try {
                const zip = new JSZip();

                // Add all compressed images to ZIP
                for (let i = 0; i < compressedImages.length; i++) {
                    const result = compressedImages[i];
                    zip.file(result.filename, result.compressedBlob);
                }

                // Generate ZIP
                const zipBlob = await zip.generateAsync({ type: 'blob' });

                // Download ZIP
                const url = URL.createObjectURL(zipBlob);
                const a = document.createElement('a');
                a.href = url;
                const timestamp = new Date().toISOString().split('T')[0];
                a.download = `compressed-images-${timestamp}.zip`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);

            } catch (error) {
                console.error('Error creating ZIP:', error);
                alert('Failed to create ZIP file. Please try again.');
            }
        }

        function resetCompressor() {
            compressorFiles = [];
            compressedImages = [];
            
            // Clear file input
            document.getElementById('compressor-file-input').value = '';
            
            // Reset quality slider
            document.getElementById('compressor-quality-slider').value = 80;
            document.getElementById('compressor-quality-value').textContent = '80%';
            
            // Reset format
            document.querySelector('input[name="compressor-format"][value="jpeg"]').checked = true;
            
            // Reset resize
            document.getElementById('compressor-resize-checkbox').checked = false;
            document.getElementById('compressor-resize-options').classList.add('hidden');
            
            // Hide all sections
            document.getElementById('compressor-preview-section').classList.add('hidden');
            document.getElementById('compressor-settings-section').classList.add('hidden');
            document.getElementById('compressor-compress-section').classList.add('hidden');
            document.getElementById('compressor-success').classList.add('hidden');
            document.getElementById('compressor-error').classList.add('hidden');
        }

        function showCompressorError(message) {
            document.getElementById('compressor-error-message').textContent = message;
            document.getElementById('compressor-error').classList.remove('hidden');
            document.getElementById('compressor-success').classList.add('hidden');
        }

        // ============================================
        // IMAGE FORMAT CONVERTER FUNCTIONS
        // ============================================

        let formatConverterFiles = [];
        let formatConvertedImages = [];

        // Initialize Image Format Converter functionality
        document.addEventListener('DOMContentLoaded', function() {
            const dropZone = document.getElementById('converter-drop-zone');
            const fileInput = document.getElementById('converter-file-input');
            const qualitySlider = document.getElementById('converter-quality-slider');
            const qualityValue = document.getElementById('converter-quality-value');
            const formatRadios = document.querySelectorAll('input[name="converter-format"]');

            if (!dropZone || !fileInput) return;

            // Click to browse
            dropZone.addEventListener('click', () => fileInput.click());

            // File input change
            fileInput.addEventListener('change', (e) => {
                if (e.target.files.length > 0) {
                    handleConverterUpload(Array.from(e.target.files));
                }
            });

            // Drag and drop
            dropZone.addEventListener('dragover', (e) => {
                e.preventDefault();
                dropZone.classList.add('border-pink-500', 'bg-pink-50');
            });

            dropZone.addEventListener('dragleave', () => {
                dropZone.classList.remove('border-pink-500', 'bg-pink-50');
            });

            dropZone.addEventListener('drop', (e) => {
                e.preventDefault();
                dropZone.classList.remove('border-pink-500', 'bg-pink-50');
                if (e.dataTransfer.files.length > 0) {
                    handleConverterUpload(Array.from(e.dataTransfer.files));
                }
            });

            // Quality slider
            if (qualitySlider && qualityValue) {
                qualitySlider.addEventListener('input', (e) => {
                    qualityValue.textContent = e.target.value + '%';
                });
            }

            // Format selection change
            formatRadios.forEach(radio => {
                radio.addEventListener('change', (e) => {
                    updateFormatSettings(e.target.value);
                });
            });
        });

        function updateFormatSettings(format) {
            const qualitySection = document.getElementById('converter-quality-section');
            const backgroundSection = document.getElementById('converter-background-section');
            
            // Show quality slider for JPG and WebP (lossy formats)
            if (format === 'jpeg' || format === 'webp') {
                qualitySection.classList.remove('hidden');
            } else {
                qualitySection.classList.add('hidden');
            }

            // Show background section only when converting to JPG
            if (format === 'jpeg') {
                // Check if any PNG files are uploaded
                const hasPNG = formatConverterFiles.some(file => file.type === 'image/png');
                if (hasPNG) {
                    backgroundSection.classList.remove('hidden');
                } else {
                    backgroundSection.classList.add('hidden');
                }
            } else {
                backgroundSection.classList.add('hidden');
            }

            // Update format card borders
            const formatLabels = document.querySelectorAll('input[name="converter-format"]').forEach((radio) => {
                const label = radio.parentElement;
                if (radio.checked) {
                    label.classList.remove('border-gray-300');
                    label.classList.add('border-pink-300', 'bg-pink-50');
                } else {
                    label.classList.remove('border-pink-300', 'bg-pink-50');
                    label.classList.add('border-gray-300');
                }
            });
        }

        function handleConverterUpload(files) {
            // Filter only image files
            const imageFiles = files.filter(file => file.type.startsWith('image/'));
            
            if (imageFiles.length === 0) {
                showConverterError('Please select valid image files (JPG, PNG, WebP, GIF).');
                return;
            }

            // Add to array
            formatConverterFiles.push(...imageFiles);

            // Update UI
            displayConverterPreviews();
            
            // Show settings and convert sections
            document.getElementById('converter-settings-section').classList.remove('hidden');
            document.getElementById('converter-convert-section').classList.remove('hidden');
            document.getElementById('converter-success').classList.add('hidden');
            document.getElementById('converter-error').classList.add('hidden');

            // Update format settings based on uploaded files
            const selectedFormat = document.querySelector('input[name="converter-format"]:checked').value;
            updateFormatSettings(selectedFormat);
        }

        function getFormatBadgeColor(mimeType) {
            if (mimeType.includes('jpeg') || mimeType.includes('jpg')) return 'bg-blue-600';
            if (mimeType.includes('png')) return 'bg-green-600';
            if (mimeType.includes('webp')) return 'bg-purple-600';
            if (mimeType.includes('gif')) return 'bg-orange-600';
            return 'bg-gray-600';
        }

        function getFormatName(mimeType) {
            if (mimeType.includes('jpeg') || mimeType.includes('jpg')) return 'JPG';
            if (mimeType.includes('png')) return 'PNG';
            if (mimeType.includes('webp')) return 'WebP';
            if (mimeType.includes('gif')) return 'GIF';
            return 'Unknown';
        }

        function displayConverterPreviews() {
            const previewSection = document.getElementById('converter-preview-section');
            const previewGrid = document.getElementById('converter-preview-grid');
            const countSpan = document.getElementById('converter-count');

            previewSection.classList.remove('hidden');
            countSpan.textContent = formatConverterFiles.length;
            previewGrid.innerHTML = '';

            formatConverterFiles.forEach((file, index) => {
                const reader = new FileReader();
                reader.onload = (e) => {
                    const preview = document.createElement('div');
                    preview.className = 'relative group';
                    
                    const formatName = getFormatName(file.type);
                    const badgeColor = getFormatBadgeColor(file.type);
                    
                    preview.innerHTML = `
                        <img src="${e.target.result}" class="w-full h-24 object-cover rounded-lg border-2 border-gray-300 group-hover:border-pink-500 transition-all">
                        <div class="absolute top-1 right-1 bg-white rounded-full p-1 shadow-lg opacity-0 group-hover:opacity-100 transition-opacity">
                            <button onclick="removeConverterImage(${index})" class="text-red-600 hover:text-red-700">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                </svg>
                            </button>
                        </div>
                        <div class="absolute top-1 left-1 bg-pink-600 text-white text-xs px-2 py-1 rounded font-semibold">
                            ${index + 1}
                        </div>
                        <div class="absolute bottom-1 left-1 ${badgeColor} text-white text-xs px-2 py-1 rounded font-semibold">
                            ${formatName}
                        </div>
                        <div class="absolute bottom-1 right-1 bg-black bg-opacity-70 text-white text-xs px-2 py-1 rounded">
                            ${(file.size / (1024 * 1024)).toFixed(2)}MB
                        </div>
                    `;

                    previewGrid.appendChild(preview);
                };
                reader.readAsDataURL(file);
            });
        }

        function removeConverterImage(index) {
            formatConverterFiles.splice(index, 1);
            
            if (formatConverterFiles.length === 0) {
                document.getElementById('converter-preview-section').classList.add('hidden');
                document.getElementById('converter-settings-section').classList.add('hidden');
                document.getElementById('converter-convert-section').classList.add('hidden');
            } else {
                displayConverterPreviews();
                // Update format settings in case we removed a PNG
                const selectedFormat = document.querySelector('input[name="converter-format"]:checked').value;
                updateFormatSettings(selectedFormat);
            }
        }

        function clearAllConverterImages() {
            formatConverterFiles = [];
            formatConvertedImages = [];
            document.getElementById('converter-preview-section').classList.add('hidden');
            document.getElementById('converter-settings-section').classList.add('hidden');
            document.getElementById('converter-convert-section').classList.add('hidden');
            document.getElementById('converter-file-input').value = '';
            document.getElementById('converter-success').classList.add('hidden');
            document.getElementById('converter-error').classList.add('hidden');
        }

        async function convertAllFormats() {
            if (formatConverterFiles.length === 0) {
                showConverterError('Please upload at least one image.');
                return;
            }

            // Get settings
            const targetFormat = document.querySelector('input[name="converter-format"]:checked').value;
            const quality = parseInt(document.getElementById('converter-quality-slider').value) / 100;
            const bgColor = getBackgroundColor();

            // Show progress
            document.getElementById('converter-convert-section').classList.add('hidden');
            document.getElementById('converter-progress').classList.remove('hidden');
            document.getElementById('converter-error').classList.add('hidden');
            document.getElementById('converter-success').classList.add('hidden');

            formatConvertedImages = [];

            try {
                for (let i = 0; i < formatConverterFiles.length; i++) {
                    const file = formatConverterFiles[i];
                    
                    // Update progress
                    const progress = ((i + 1) / formatConverterFiles.length) * 100;
                    document.getElementById('converter-progress-bar').style.width = progress + '%';
                    document.getElementById('converter-progress-percent').textContent = Math.round(progress) + '%';
                    document.getElementById('converter-progress-text').textContent = 
                        `Converting ${file.name} (${i + 1} of ${formatConverterFiles.length})...`;

                    // Convert the image
                    const result = await convertSingleFormat(file, targetFormat, quality, bgColor);
                    
                    formatConvertedImages.push(result);

                    // Small delay to prevent browser freeze
                    await new Promise(resolve => setTimeout(resolve, 50));
                }

                // Display results
                document.getElementById('converter-total-count').textContent = formatConverterFiles.length;
                document.getElementById('converter-target-format').textContent = targetFormat.toUpperCase();

                displayConversionResults();

                document.getElementById('converter-progress').classList.add('hidden');
                document.getElementById('converter-success').classList.remove('hidden');

            } catch (error) {
                console.error('Error converting images:', error);
                showConverterError('Failed to convert images: ' + error.message);
                document.getElementById('converter-convert-section').classList.remove('hidden');
                document.getElementById('converter-progress').classList.add('hidden');
            }
        }

        function getBackgroundColor() {
            const bgColorRadio = document.querySelector('input[name="converter-bg-color"]:checked');
            if (!bgColorRadio) return '#ffffff';
            
            const bgColorValue = bgColorRadio.value;
            if (bgColorValue === 'white') return '#ffffff';
            if (bgColorValue === 'black') return '#000000';
            if (bgColorValue === 'custom') {
                return document.getElementById('converter-custom-color').value;
            }
            return '#ffffff';
        }

        async function convertSingleFormat(file, targetFormat, quality, bgColor) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                
                reader.onload = (e) => {
                    const img = new Image();
                    
                    img.onload = () => {
                        try {
                            const canvas = document.createElement('canvas');
                            canvas.width = img.width;
                            canvas.height = img.height;

                            const ctx = canvas.getContext('2d');

                            // If converting to JPG and source might have transparency, add background
                            if (targetFormat === 'jpeg' && (file.type === 'image/png' || file.type === 'image/webp')) {
                                ctx.fillStyle = bgColor;
                                ctx.fillRect(0, 0, canvas.width, canvas.height);
                            }

                            ctx.drawImage(img, 0, 0);

                            // Determine MIME type and extension
                            let mimeType = 'image/jpeg';
                            let extension = 'jpg';
                            if (targetFormat === 'png') {
                                mimeType = 'image/png';
                                extension = 'png';
                            } else if (targetFormat === 'webp') {
                                mimeType = 'image/webp';
                                extension = 'webp';
                            }

                            // Convert to blob
                            canvas.toBlob((blob) => {
                                if (blob) {
                                    const url = URL.createObjectURL(blob);
                                    const originalFormat = getFormatName(file.type);
                                    
                                    resolve({
                                        originalFile: file,
                                        originalFormat: originalFormat,
                                        originalSize: file.size,
                                        convertedBlob: blob,
                                        convertedSize: blob.size,
                                        convertedUrl: url,
                                        originalUrl: e.target.result,
                                        filename: file.name.replace(/\.[^/.]+$/, '') + '.' + extension,
                                        targetFormat: targetFormat.toUpperCase(),
                                        sizeChange: blob.size - file.size,
                                        sizeChangePercent: Math.round(((blob.size - file.size) / file.size) * 100)
                                    });
                                } else {
                                    reject(new Error('Failed to create blob'));
                                }
                            }, mimeType, quality);

                        } catch (error) {
                            reject(error);
                        }
                    };

                    img.onerror = () => reject(new Error('Failed to load image'));
                    img.src = e.target.result;
                };

                reader.onerror = () => reject(new Error('Failed to read file'));
                reader.readAsDataURL(file);
            });
        }

        function displayConversionResults() {
            const resultsGrid = document.getElementById('converter-results-grid');
            resultsGrid.innerHTML = '';

            formatConvertedImages.forEach((result, index) => {
                const resultCard = document.createElement('div');
                resultCard.className = 'bg-gray-50 border-2 border-gray-300 rounded-xl p-4 hover:border-pink-500 transition-all';
                
                const sizeChangeText = result.sizeChange >= 0 
                    ? `+${(result.sizeChange / (1024 * 1024)).toFixed(2)} MB (+${result.sizeChangePercent}%)`
                    : `${(result.sizeChange / (1024 * 1024)).toFixed(2)} MB (${result.sizeChangePercent}%)`;
                
                const sizeChangeColor = result.sizeChange >= 0 ? 'text-orange-600' : 'text-green-600';
                
                resultCard.innerHTML = `
                    <div class="flex items-center justify-between mb-3">
                        <h5 class="font-semibold text-gray-800 truncate flex-1">${result.filename}</h5>
                        <button onclick="downloadConvertedImage(${index})" class="bg-pink-600 hover:bg-pink-700 text-white px-3 py-1 rounded-lg text-sm font-semibold ml-2">
                            üì• Download
                        </button>
                    </div>
                    
                    <div class="grid grid-cols-2 gap-3 mb-3">
                        <div class="text-center">
                            <img src="${result.originalUrl}" class="w-full h-32 object-cover rounded-lg border border-gray-300 mb-2">
                            <p class="text-xs font-semibold text-gray-600">BEFORE</p>
                            <p class="text-sm font-bold text-gray-800">${result.originalFormat}</p>
                            <p class="text-xs text-gray-600">${(result.originalSize / (1024 * 1024)).toFixed(2)} MB</p>
                        </div>
                        <div class="text-center">
                            <img src="${result.convertedUrl}" class="w-full h-32 object-cover rounded-lg border border-gray-300 mb-2">
                            <p class="text-xs font-semibold text-gray-600">AFTER</p>
                            <p class="text-sm font-bold text-pink-600">${result.targetFormat}</p>
                            <p class="text-xs text-gray-600">${(result.convertedSize / (1024 * 1024)).toFixed(2)} MB</p>
                        </div>
                    </div>
                    
                    <div class="bg-pink-100 border border-pink-500 rounded-lg p-2 text-center">
                        <p class="text-sm font-bold text-pink-800">
                            üîÑ Format: ${result.originalFormat} ‚Üí ${result.targetFormat}
                        </p>
                        <p class="text-xs ${sizeChangeColor} mt-1">
                            Size change: ${sizeChangeText}
                        </p>
                    </div>
                `;

                resultsGrid.appendChild(resultCard);
            });
        }

        function downloadConvertedImage(index) {
            if (!formatConvertedImages[index]) {
                alert('Image not found!');
                return;
            }

            const result = formatConvertedImages[index];
            const url = result.convertedUrl;
            const a = document.createElement('a');
            a.href = url;
            a.download = result.filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
        }

        async function downloadAllConvertedAsZip() {
            if (formatConvertedImages.length === 0) {
                alert('No converted images to download!');
                return;
            }

            try {
                const zip = new JSZip();

                // Add all converted images to ZIP
                for (let i = 0; i < formatConvertedImages.length; i++) {
                    const result = formatConvertedImages[i];
                    zip.file(result.filename, result.convertedBlob);
                }

                // Generate ZIP
                const zipBlob = await zip.generateAsync({ type: 'blob' });

                // Download ZIP
                const url = URL.createObjectURL(zipBlob);
                const a = document.createElement('a');
                a.href = url;
                const timestamp = new Date().toISOString().split('T')[0];
                const targetFormat = document.querySelector('input[name="converter-format"]:checked').value;
                a.download = `converted-to-${targetFormat}-${timestamp}.zip`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);

            } catch (error) {
                console.error('Error creating ZIP:', error);
                alert('Failed to create ZIP file. Please try again.');
            }
        }

        function resetConverter() {
            formatConverterFiles = [];
            formatConvertedImages = [];
            
            // Clear file input
            document.getElementById('converter-file-input').value = '';
            
            // Reset quality slider
            document.getElementById('converter-quality-slider').value = 90;
            document.getElementById('converter-quality-value').textContent = '90%';
            
            // Reset format
            document.querySelector('input[name="converter-format"][value="jpeg"]').checked = true;
            updateFormatSettings('jpeg');
            
            // Reset background color
            document.querySelector('input[name="converter-bg-color"][value="white"]').checked = true;
            
            // Hide all sections
            document.getElementById('converter-preview-section').classList.add('hidden');
            document.getElementById('converter-settings-section').classList.add('hidden');
            document.getElementById('converter-convert-section').classList.add('hidden');
            document.getElementById('converter-success').classList.add('hidden');
            document.getElementById('converter-error').classList.add('hidden');
        }

        function showConverterError(message) {
            document.getElementById('converter-error-message').textContent = message;
            document.getElementById('converter-error').classList.remove('hidden');
            document.getElementById('converter-success').classList.add('hidden');
        }

        // ============================================
        // IMAGE RESIZER FUNCTIONS
        // ============================================

        let resizerFiles = [];
        let resizedImages = [];
        let aspectRatioLocked = true;
        let originalAspectRatio = null;

        // Initialize Image Resizer functionality
        document.addEventListener('DOMContentLoaded', function() {
            const dropZone = document.getElementById('resizer-drop-zone');
            const fileInput = document.getElementById('resizer-file-input');
            const widthInput = document.getElementById('resizer-width');
            const heightInput = document.getElementById('resizer-height');
            const qualitySlider = document.getElementById('resizer-quality-slider');
            const qualityValue = document.getElementById('resizer-quality-value');
            const percentageSlider = document.getElementById('resizer-percentage-slider');
            const percentageValue = document.getElementById('resizer-percentage-value');
            const methodRadios = document.querySelectorAll('input[name="resizer-method"]');

            if (!dropZone || !fileInput) return;

            // Click to browse
            dropZone.addEventListener('click', () => fileInput.click());

            // File input change
            fileInput.addEventListener('change', (e) => {
                if (e.target.files.length > 0) {
                    handleResizerUpload(Array.from(e.target.files));
                }
            });

            // Drag and drop
            dropZone.addEventListener('dragover', (e) => {
                e.preventDefault();
                dropZone.classList.add('border-cyan-500', 'bg-cyan-50');
            });

            dropZone.addEventListener('dragleave', () => {
                dropZone.classList.remove('border-cyan-500', 'bg-cyan-50');
            });

            dropZone.addEventListener('drop', (e) => {
                e.preventDefault();
                dropZone.classList.remove('border-cyan-500', 'bg-cyan-50');
                if (e.dataTransfer.files.length > 0) {
                    handleResizerUpload(Array.from(e.dataTransfer.files));
                }
            });

            // Dimension inputs with aspect ratio lock
            if (widthInput && heightInput) {
                widthInput.addEventListener('input', (e) => {
                    if (aspectRatioLocked && originalAspectRatio) {
                        const newWidth = parseInt(e.target.value) || 1;
                        const newHeight = Math.round(newWidth / originalAspectRatio);
                        heightInput.value = newHeight;
                    }
                });

                heightInput.addEventListener('input', (e) => {
                    if (aspectRatioLocked && originalAspectRatio) {
                        const newHeight = parseInt(e.target.value) || 1;
                        const newWidth = Math.round(newHeight * originalAspectRatio);
                        widthInput.value = newWidth;
                    }
                });
            }

            // Quality slider
            if (qualitySlider && qualityValue) {
                qualitySlider.addEventListener('input', (e) => {
                    qualityValue.textContent = e.target.value + '%';
                });
            }

            // Percentage slider
            if (percentageSlider && percentageValue) {
                percentageSlider.addEventListener('input', (e) => {
                    percentageValue.textContent = e.target.value + '%';
                });
            }

            // Method selection change
            methodRadios.forEach(radio => {
                radio.addEventListener('change', (e) => {
                    updateResizeMethod(e.target.value);
                });
            });
        });

        function updateResizeMethod(method) {
            const customSection = document.getElementById('resizer-custom-section');
            const percentageSection = document.getElementById('resizer-percentage-section');
            const presetSection = document.getElementById('resizer-preset-section');

            // Hide all sections
            customSection.classList.add('hidden');
            percentageSection.classList.add('hidden');
            presetSection.classList.add('hidden');

            // Show selected section
            if (method === 'custom') {
                customSection.classList.remove('hidden');
            } else if (method === 'percentage') {
                percentageSection.classList.remove('hidden');
            } else if (method === 'preset') {
                presetSection.classList.remove('hidden');
            }

            // Update method card borders
            document.querySelectorAll('input[name="resizer-method"]').forEach((radio) => {
                const label = radio.parentElement;
                if (radio.checked) {
                    label.classList.remove('border-gray-300');
                    label.classList.add('border-cyan-300', 'bg-cyan-50');
                } else {
                    label.classList.remove('border-cyan-300', 'bg-cyan-50');
                    label.classList.add('border-gray-300');
                }
            });
        }

        function toggleAspectRatioLock() {
            aspectRatioLocked = !aspectRatioLocked;
            const lockIcon = document.getElementById('resizer-lock-icon');
            const lockStatus = document.getElementById('resizer-lock-status');

            if (aspectRatioLocked) {
                lockIcon.textContent = 'üîí';
                lockStatus.textContent = 'üîí Aspect ratio locked';
                // Update aspect ratio based on current values
                const width = parseInt(document.getElementById('resizer-width').value) || 1920;
                const height = parseInt(document.getElementById('resizer-height').value) || 1080;
                originalAspectRatio = width / height;
            } else {
                lockIcon.textContent = 'üîì';
                lockStatus.textContent = 'üîì Aspect ratio unlocked';
            }
        }

        function setResizePercentage(percent) {
            document.getElementById('resizer-percentage-slider').value = percent;
            document.getElementById('resizer-percentage-value').textContent = percent + '%';
        }

        function applyPresetSize(width, height) {
            // Switch to custom method
            document.querySelector('input[name="resizer-method"][value="custom"]').checked = true;
            updateResizeMethod('custom');

            // Set dimensions
            document.getElementById('resizer-width').value = width;
            document.getElementById('resizer-height').value = height;

            // Update aspect ratio
            originalAspectRatio = width / height;
        }

        function handleResizerUpload(files) {
            // Filter only image files
            const imageFiles = files.filter(file => file.type.startsWith('image/'));
            
            if (imageFiles.length === 0) {
                showResizerError('Please select valid image files (JPG, PNG, WebP, GIF).');
                return;
            }

            // Add to array
            resizerFiles.push(...imageFiles);

            // Set original aspect ratio from first image
            if (resizerFiles.length > 0 && !originalAspectRatio) {
                const firstImage = new Image();
                const reader = new FileReader();
                reader.onload = (e) => {
                    firstImage.onload = () => {
                        originalAspectRatio = firstImage.width / firstImage.height;
                        // Update dimensions to match first image
                        document.getElementById('resizer-width').value = firstImage.width;
                        document.getElementById('resizer-height').value = firstImage.height;
                    };
                    firstImage.src = e.target.result;
                };
                reader.readAsDataURL(resizerFiles[0]);
            }

            // Update UI
            displayResizerPreviews();
            
            // Show settings and resize sections
            document.getElementById('resizer-settings-section').classList.remove('hidden');
            document.getElementById('resizer-resize-section').classList.remove('hidden');
            document.getElementById('resizer-success').classList.add('hidden');
            document.getElementById('resizer-error').classList.add('hidden');
        }

        function displayResizerPreviews() {
            const previewSection = document.getElementById('resizer-preview-section');
            const previewGrid = document.getElementById('resizer-preview-grid');
            const countSpan = document.getElementById('resizer-count');

            previewSection.classList.remove('hidden');
            countSpan.textContent = resizerFiles.length;
            previewGrid.innerHTML = '';

            resizerFiles.forEach((file, index) => {
                const reader = new FileReader();
                reader.onload = (e) => {
                    const img = new Image();
                    img.onload = () => {
                        const preview = document.createElement('div');
                        preview.className = 'relative group';
                        
                        preview.innerHTML = `
                            <img src="${e.target.result}" class="w-full h-24 object-cover rounded-lg border-2 border-gray-300 group-hover:border-cyan-500 transition-all">
                            <div class="absolute top-1 right-1 bg-white rounded-full p-1 shadow-lg opacity-0 group-hover:opacity-100 transition-opacity">
                                <button onclick="removeResizerImage(${index})" class="text-red-600 hover:text-red-700">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                    </svg>
                                </button>
                            </div>
                            <div class="absolute top-1 left-1 bg-cyan-600 text-white text-xs px-2 py-1 rounded font-semibold">
                                ${index + 1}
                            </div>
                            <div class="absolute bottom-1 left-1 bg-blue-600 text-white text-xs px-2 py-1 rounded font-semibold">
                                ${img.width}√ó${img.height}
                            </div>
                            <div class="absolute bottom-1 right-1 bg-black bg-opacity-70 text-white text-xs px-2 py-1 rounded">
                                ${(file.size / (1024 * 1024)).toFixed(2)}MB
                            </div>
                        `;

                        previewGrid.appendChild(preview);
                    };
                    img.src = e.target.result;
                };
                reader.readAsDataURL(file);
            });
        }

        function removeResizerImage(index) {
            resizerFiles.splice(index, 1);
            
            if (resizerFiles.length === 0) {
                document.getElementById('resizer-preview-section').classList.add('hidden');
                document.getElementById('resizer-settings-section').classList.add('hidden');
                document.getElementById('resizer-resize-section').classList.add('hidden');
                originalAspectRatio = null;
            } else {
                displayResizerPreviews();
            }
        }

        function clearAllResizerImages() {
            resizerFiles = [];
            resizedImages = [];
            originalAspectRatio = null;
            document.getElementById('resizer-preview-section').classList.add('hidden');
            document.getElementById('resizer-settings-section').classList.add('hidden');
            document.getElementById('resizer-resize-section').classList.add('hidden');
            document.getElementById('resizer-file-input').value = '';
            document.getElementById('resizer-success').classList.add('hidden');
            document.getElementById('resizer-error').classList.add('hidden');
        }

        async function resizeAllImages() {
            if (resizerFiles.length === 0) {
                showResizerError('Please upload at least one image.');
                return;
            }

            // Get settings
            const method = document.querySelector('input[name="resizer-method"]:checked').value;
            const quality = parseInt(document.getElementById('resizer-quality-slider').value) / 100;

            let targetWidth, targetHeight;

            if (method === 'custom') {
                targetWidth = parseInt(document.getElementById('resizer-width').value) || 1920;
                targetHeight = parseInt(document.getElementById('resizer-height').value) || 1080;
            } else if (method === 'percentage') {
                const percentage = parseInt(document.getElementById('resizer-percentage-slider').value) / 100;
                targetWidth = percentage; // Will be multiplied by original dimensions
                targetHeight = percentage;
            } else if (method === 'preset') {
                // Should already be set in custom section from preset button click
                targetWidth = parseInt(document.getElementById('resizer-width').value) || 1920;
                targetHeight = parseInt(document.getElementById('resizer-height').value) || 1080;
            }

            // Show progress
            document.getElementById('resizer-resize-section').classList.add('hidden');
            document.getElementById('resizer-progress').classList.remove('hidden');
            document.getElementById('resizer-error').classList.add('hidden');
            document.getElementById('resizer-success').classList.add('hidden');

            resizedImages = [];

            try {
                for (let i = 0; i < resizerFiles.length; i++) {
                    const file = resizerFiles[i];
                    
                    // Update progress
                    const progress = ((i + 1) / resizerFiles.length) * 100;
                    document.getElementById('resizer-progress-bar').style.width = progress + '%';
                    document.getElementById('resizer-progress-percent').textContent = Math.round(progress) + '%';
                    document.getElementById('resizer-progress-text').textContent = 
                        `Resizing ${file.name} (${i + 1} of ${resizerFiles.length})...`;

                    // Resize the image
                    const result = await resizeSingleImage(file, targetWidth, targetHeight, quality, method);
                    
                    resizedImages.push(result);

                    // Small delay to prevent browser freeze
                    await new Promise(resolve => setTimeout(resolve, 50));
                }

                // Display results
                document.getElementById('resizer-total-count').textContent = resizerFiles.length;

                displayResizeResults();

                document.getElementById('resizer-progress').classList.add('hidden');
                document.getElementById('resizer-success').classList.remove('hidden');

            } catch (error) {
                console.error('Error resizing images:', error);
                showResizerError('Failed to resize images: ' + error.message);
                document.getElementById('resizer-resize-section').classList.remove('hidden');
                document.getElementById('resizer-progress').classList.add('hidden');
            }
        }

        async function resizeSingleImage(file, targetWidth, targetHeight, quality, method) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                
                reader.onload = (e) => {
                    const img = new Image();
                    
                    img.onload = () => {
                        try {
                            let newWidth, newHeight;

                            if (method === 'percentage') {
                                // targetWidth and targetHeight are percentages
                                newWidth = Math.round(img.width * targetWidth);
                                newHeight = Math.round(img.height * targetHeight);
                            } else {
                                // Custom or preset - use exact dimensions
                                newWidth = targetWidth;
                                newHeight = targetHeight;
                            }

                            const canvas = document.createElement('canvas');
                            canvas.width = newWidth;
                            canvas.height = newHeight;

                            const ctx = canvas.getContext('2d');
                            ctx.drawImage(img, 0, 0, newWidth, newHeight);

                            // Determine output format
                            let mimeType = file.type;
                            let extension = file.name.split('.').pop();

                            // Convert to blob
                            canvas.toBlob((blob) => {
                                if (blob) {
                                    const url = URL.createObjectURL(blob);
                                    
                                    resolve({
                                        originalFile: file,
                                        originalWidth: img.width,
                                        originalHeight: img.height,
                                        originalSize: file.size,
                                        resizedBlob: blob,
                                        resizedWidth: newWidth,
                                        resizedHeight: newHeight,
                                        resizedSize: blob.size,
                                        resizedUrl: url,
                                        originalUrl: e.target.result,
                                        filename: file.name.replace(/\.[^/.]+$/, '') + '-resized.' + extension,
                                        sizeChange: blob.size - file.size,
                                        sizeChangePercent: Math.round(((blob.size - file.size) / file.size) * 100)
                                    });
                                } else {
                                    reject(new Error('Failed to create blob'));
                                }
                            }, mimeType, quality);

                        } catch (error) {
                            reject(error);
                        }
                    };

                    img.onerror = () => reject(new Error('Failed to load image'));
                    img.src = e.target.result;
                };

                reader.onerror = () => reject(new Error('Failed to read file'));
                reader.readAsDataURL(file);
            });
        }

        function displayResizeResults() {
            const resultsGrid = document.getElementById('resizer-results-grid');
            resultsGrid.innerHTML = '';

            resizedImages.forEach((result, index) => {
                const resultCard = document.createElement('div');
                resultCard.className = 'bg-gray-50 border-2 border-gray-300 rounded-xl p-4 hover:border-cyan-500 transition-all';
                
                const sizeChangeText = result.sizeChange >= 0 
                    ? `+${(result.sizeChange / (1024 * 1024)).toFixed(2)} MB (+${result.sizeChangePercent}%)`
                    : `${(result.sizeChange / (1024 * 1024)).toFixed(2)} MB (${result.sizeChangePercent}%)`;
                
                const sizeChangeColor = result.sizeChange >= 0 ? 'text-orange-600' : 'text-green-600';
                
                resultCard.innerHTML = `
                    <div class="flex items-center justify-between mb-3">
                        <h5 class="font-semibold text-gray-800 truncate flex-1">${result.filename}</h5>
                        <button onclick="downloadResizedImage(${index})" class="bg-cyan-600 hover:bg-cyan-700 text-white px-3 py-1 rounded-lg text-sm font-semibold ml-2">
                            üì• Download
                        </button>
                    </div>
                    
                    <div class="grid grid-cols-2 gap-3 mb-3">
                        <div class="text-center">
                            <img src="${result.originalUrl}" class="w-full h-32 object-cover rounded-lg border border-gray-300 mb-2">
                            <p class="text-xs font-semibold text-gray-600">BEFORE</p>
                            <p class="text-sm font-bold text-gray-800">${result.originalWidth} √ó ${result.originalHeight}</p>
                            <p class="text-xs text-gray-600">${(result.originalSize / (1024 * 1024)).toFixed(2)} MB</p>
                        </div>
                        <div class="text-center">
                            <img src="${result.resizedUrl}" class="w-full h-32 object-cover rounded-lg border border-gray-300 mb-2">
                            <p class="text-xs font-semibold text-gray-600">AFTER</p>
                            <p class="text-sm font-bold text-cyan-600">${result.resizedWidth} √ó ${result.resizedHeight}</p>
                            <p class="text-xs text-gray-600">${(result.resizedSize / (1024 * 1024)).toFixed(2)} MB</p>
                        </div>
                    </div>
                    
                    <div class="bg-cyan-100 border border-cyan-500 rounded-lg p-2 text-center">
                        <p class="text-sm font-bold text-cyan-800">
                            üìê Dimensions: ${result.originalWidth}√ó${result.originalHeight} ‚Üí ${result.resizedWidth}√ó${result.resizedHeight}
                        </p>
                        <p class="text-xs ${sizeChangeColor} mt-1">
                            Size change: ${sizeChangeText}
                        </p>
                    </div>
                `;

                resultsGrid.appendChild(resultCard);
            });
        }

        function downloadResizedImage(index) {
            if (!resizedImages[index]) {
                alert('Image not found!');
                return;
            }

            const result = resizedImages[index];
            const url = result.resizedUrl;
            const a = document.createElement('a');
            a.href = url;
            a.download = result.filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
        }

        async function downloadAllResizedAsZip() {
            if (resizedImages.length === 0) {
                alert('No resized images to download!');
                return;
            }

            try {
                const zip = new JSZip();

                // Add all resized images to ZIP
                for (let i = 0; i < resizedImages.length; i++) {
                    const result = resizedImages[i];
                    zip.file(result.filename, result.resizedBlob);
                }

                // Generate ZIP
                const zipBlob = await zip.generateAsync({ type: 'blob' });

                // Download ZIP
                const url = URL.createObjectURL(zipBlob);
                const a = document.createElement('a');
                a.href = url;
                const timestamp = new Date().toISOString().split('T')[0];
                a.download = `resized-images-${timestamp}.zip`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);

            } catch (error) {
                console.error('Error creating ZIP:', error);
                alert('Failed to create ZIP file. Please try again.');
            }
        }

        function resetResizer() {
            resizerFiles = [];
            resizedImages = [];
            originalAspectRatio = null;
            aspectRatioLocked = true;
            
            // Clear file input
            document.getElementById('resizer-file-input').value = '';
            
            // Reset dimensions
            document.getElementById('resizer-width').value = 1920;
            document.getElementById('resizer-height').value = 1080;
            
            // Reset quality slider
            document.getElementById('resizer-quality-slider').value = 90;
            document.getElementById('resizer-quality-value').textContent = '90%';
            
            // Reset percentage slider
            document.getElementById('resizer-percentage-slider').value = 100;
            document.getElementById('resizer-percentage-value').textContent = '100%';
            
            // Reset method
            document.querySelector('input[name="resizer-method"][value="custom"]').checked = true;
            updateResizeMethod('custom');
            
            // Reset aspect ratio lock
            document.getElementById('resizer-lock-icon').textContent = 'üîí';
            document.getElementById('resizer-lock-status').textContent = 'üîí Aspect ratio locked';
            
            // Hide all sections
            document.getElementById('resizer-preview-section').classList.add('hidden');
            document.getElementById('resizer-settings-section').classList.add('hidden');
            document.getElementById('resizer-resize-section').classList.add('hidden');
            document.getElementById('resizer-success').classList.add('hidden');
            document.getElementById('resizer-error').classList.add('hidden');
        }

        function showResizerError(message) {
            document.getElementById('resizer-error-message').textContent = message;
            document.getElementById('resizer-error').classList.remove('hidden');
            document.getElementById('resizer-success').classList.add('hidden');
        }

        // ============================================
        // DIGITAL SIGNATURE GENERATOR FUNCTIONS
        // ============================================

        // Signature canvas state
        let signatureCanvas = null;
        let signatureCtx = null;
        let isDrawing = false;
        let lastX = 0;
        let lastY = 0;
        let signatureStrokes = []; // For SVG export

        // Text signature canvas
        let textSignatureCanvas = null;
        let textSignatureCtx = null;

        // Initialize Digital Signature Generator
        document.addEventListener('DOMContentLoaded', function() {
            // Get canvas elements
            signatureCanvas = document.getElementById('signature-canvas');
            textSignatureCanvas = document.getElementById('text-signature-canvas');
            
            if (signatureCanvas) {
                signatureCtx = signatureCanvas.getContext('2d', { willReadFrequently: true });
                setupDrawingCanvas();
            }
            
            if (textSignatureCanvas) {
                textSignatureCtx = textSignatureCanvas.getContext('2d', { willReadFrequently: true });
            }

            // Pen size slider listener
            const penSizeSlider = document.getElementById('pen-size');
            if (penSizeSlider) {
                penSizeSlider.addEventListener('input', (e) => {
                    document.getElementById('pen-size-value').textContent = e.target.value;
                });
            }

            // Text size slider listener
            const textSizeSlider = document.getElementById('text-signature-size');
            if (textSizeSlider) {
                textSizeSlider.addEventListener('input', (e) => {
                    document.getElementById('text-size-value').textContent = e.target.value;
                });
            }

            // Initialize direction listeners
            document.querySelectorAll('input[name="csv-json-direction"]').forEach((radio) => {
                radio.addEventListener('change', (e) => {
                    updateCsvJsonDirection(e.target.value);
                });
            });

            // Font style change listeners
            document.querySelectorAll('input[name="signature-font"]').forEach((radio) => {
                radio.addEventListener('change', () => {
                    updateFontStyleBorders();
                });
            });
        });

        function setupDrawingCanvas() {
            if (!signatureCanvas || !signatureCtx) return;

            // Set canvas background
            setCanvasBackground();

            // Mouse events
            signatureCanvas.addEventListener('mousedown', startDrawing);
            signatureCanvas.addEventListener('mousemove', draw);
            signatureCanvas.addEventListener('mouseup', stopDrawing);
            signatureCanvas.addEventListener('mouseout', stopDrawing);

            // Touch events for mobile
            signatureCanvas.addEventListener('touchstart', (e) => {
                e.preventDefault();
                const touch = e.touches[0];
                const rect = signatureCanvas.getBoundingClientRect();
                const scaleX = signatureCanvas.width / rect.width;
                const scaleY = signatureCanvas.height / rect.height;
                lastX = (touch.clientX - rect.left) * scaleX;
                lastY = (touch.clientY - rect.top) * scaleY;
                isDrawing = true;
                signatureStrokes.push({ type: 'start', x: lastX, y: lastY });
            });

            signatureCanvas.addEventListener('touchmove', (e) => {
                e.preventDefault();
                if (!isDrawing) return;
                const touch = e.touches[0];
                const rect = signatureCanvas.getBoundingClientRect();
                const scaleX = signatureCanvas.width / rect.width;
                const scaleY = signatureCanvas.height / rect.height;
                const x = (touch.clientX - rect.left) * scaleX;
                const y = (touch.clientY - rect.top) * scaleY;
                
                const penColor = document.getElementById('pen-color').value;
                const penSize = document.getElementById('pen-size').value;
                
                signatureCtx.strokeStyle = penColor;
                signatureCtx.lineWidth = penSize;
                signatureCtx.lineCap = 'round';
                signatureCtx.lineJoin = 'round';
                
                signatureCtx.beginPath();
                signatureCtx.moveTo(lastX, lastY);
                signatureCtx.lineTo(x, y);
                signatureCtx.stroke();
                
                signatureStrokes.push({ type: 'line', x1: lastX, y1: lastY, x2: x, y2: y, color: penColor, width: penSize });
                
                lastX = x;
                lastY = y;
            });

            signatureCanvas.addEventListener('touchend', (e) => {
                e.preventDefault();
                isDrawing = false;
            });
        }

        function startDrawing(e) {
            isDrawing = true;
            const rect = signatureCanvas.getBoundingClientRect();
            const scaleX = signatureCanvas.width / rect.width;
            const scaleY = signatureCanvas.height / rect.height;
            lastX = (e.clientX - rect.left) * scaleX;
            lastY = (e.clientY - rect.top) * scaleY;
            signatureStrokes.push({ type: 'start', x: lastX, y: lastY });
        }

        function draw(e) {
            if (!isDrawing) return;
            
            const rect = signatureCanvas.getBoundingClientRect();
            const scaleX = signatureCanvas.width / rect.width;
            const scaleY = signatureCanvas.height / rect.height;
            const x = (e.clientX - rect.left) * scaleX;
            const y = (e.clientY - rect.top) * scaleY;
            
            const penColor = document.getElementById('pen-color').value;
            const penSize = document.getElementById('pen-size').value;
            
            signatureCtx.strokeStyle = penColor;
            signatureCtx.lineWidth = penSize;
            signatureCtx.lineCap = 'round';
            signatureCtx.lineJoin = 'round';
            
            signatureCtx.beginPath();
            signatureCtx.moveTo(lastX, lastY);
            signatureCtx.lineTo(x, y);
            signatureCtx.stroke();
            
            signatureStrokes.push({ type: 'line', x1: lastX, y1: lastY, x2: x, y2: y, color: penColor, width: penSize });
            
            lastX = x;
            lastY = y;
        }

        function stopDrawing() {
            isDrawing = false;
        }

        function switchSignatureType(type) {
            const drawSection = document.getElementById('draw-signature-section');
            const textSection = document.getElementById('text-signature-section');
            const drawSelector = document.getElementById('draw-signature-selector');
            const textSelector = document.getElementById('text-signature-selector');
            const downloadStepNumber = document.getElementById('download-step-number');
            
            if (type === 'draw') {
                drawSection.classList.remove('hidden');
                textSection.classList.add('hidden');
                drawSelector.classList.add('border-purple-300', 'bg-purple-50');
                drawSelector.classList.remove('border-gray-300');
                textSelector.classList.remove('border-purple-300', 'bg-purple-50');
                textSelector.classList.add('border-gray-300');
                downloadStepNumber.textContent = '3';
            } else {
                drawSection.classList.add('hidden');
                textSection.classList.remove('hidden');
                textSelector.classList.add('border-purple-300', 'bg-purple-50');
                textSelector.classList.remove('border-gray-300');
                drawSelector.classList.remove('border-purple-300', 'bg-purple-50');
                drawSelector.classList.add('border-gray-300');
                downloadStepNumber.textContent = '4';
                updateTextSignaturePreview();
            }
            
            // Hide messages
            document.getElementById('signature-success').classList.add('hidden');
            document.getElementById('signature-error').classList.add('hidden');
        }

        function clearSignatureCanvas() {
            if (!signatureCanvas || !signatureCtx) return;
            
            signatureCtx.clearRect(0, 0, signatureCanvas.width, signatureCanvas.height);
            signatureStrokes = [];
            setCanvasBackground();
            
            // Hide messages
            document.getElementById('signature-success').classList.add('hidden');
            document.getElementById('signature-error').classList.add('hidden');
        }

        function setCanvasBackground() {
            if (!signatureCanvas || !signatureCtx) return;
            
            const background = document.getElementById('canvas-background').value;
            
            if (background === 'transparent') {
                signatureCtx.clearRect(0, 0, signatureCanvas.width, signatureCanvas.height);
            } else {
                signatureCtx.fillStyle = background;
                signatureCtx.fillRect(0, 0, signatureCanvas.width, signatureCanvas.height);
            }
        }

        function setPenColorPreset() {
            const preset = document.getElementById('pen-color-preset').value;
            document.getElementById('pen-color').value = preset;
        }

        function setTextColorPreset() {
            const preset = document.getElementById('text-color-preset').value;
            document.getElementById('text-signature-color').value = preset;
            updateTextSignaturePreview();
        }

        function updateTextSignaturePreview() {
            if (!textSignatureCanvas || !textSignatureCtx) return;
            
            const text = document.getElementById('signature-text-input').value || 'Your Name';
            const font = document.querySelector('input[name="signature-font"]:checked').value;
            const color = document.getElementById('text-signature-color').value;
            const size = document.getElementById('text-signature-size').value;
            const background = document.getElementById('text-canvas-background').value;
            
            // Clear canvas
            textSignatureCtx.clearRect(0, 0, textSignatureCanvas.width, textSignatureCanvas.height);
            
            // Set background
            if (background !== 'transparent') {
                textSignatureCtx.fillStyle = background;
                textSignatureCtx.fillRect(0, 0, textSignatureCanvas.width, textSignatureCanvas.height);
            }
            
            // Draw text
            textSignatureCtx.font = `${size}px '${font}', cursive`;
            textSignatureCtx.fillStyle = color;
            textSignatureCtx.textAlign = 'center';
            textSignatureCtx.textBaseline = 'middle';
            textSignatureCtx.fillText(text, textSignatureCanvas.width / 2, textSignatureCanvas.height / 2);
        }

        function updateFontStyleBorders() {
            const fonts = ['Dancing Script', 'Great Vibes', 'Allura', 'Pacifico', 'Sacramento', 'Alex Brush'];
            fonts.forEach((font, index) => {
                const label = document.getElementById(`font-style-${index + 1}`);
                const radio = label.querySelector('input[type="radio"]');
                
                if (radio.checked) {
                    label.classList.add('border-purple-300', 'bg-purple-50');
                    label.classList.remove('border-gray-300');
                } else {
                    label.classList.remove('border-purple-300', 'bg-purple-50');
                    label.classList.add('border-gray-300');
                }
            });
        }

        function downloadSignature() {
            try {
                const signatureType = document.querySelector('input[name="signature-type"]:checked').value;
                const format = document.getElementById('signature-format').value;
                const quality = parseFloat(document.getElementById('signature-quality').value);
                const shouldTrim = document.getElementById('signature-trim').checked;
                
                let canvas;
                if (signatureType === 'draw') {
                    canvas = signatureCanvas;
                    
                    // Check if canvas is empty
                    const imageData = signatureCtx.getImageData(0, 0, canvas.width, canvas.height);
                    const pixels = imageData.data;
                    let isEmpty = true;
                    const background = document.getElementById('canvas-background').value;
                    
                    for (let i = 3; i < pixels.length; i += 4) {
                        if (pixels[i] !== 0) {
                            isEmpty = false;
                            break;
                        }
                    }
                    
                    if (isEmpty && background === 'transparent') {
                        showSignatureError('Please draw your signature first!');
                        return;
                    }
                } else {
                    canvas = textSignatureCanvas;
                    
                    const text = document.getElementById('signature-text-input').value;
                    if (!text || text.trim() === '') {
                        showSignatureError('Please enter your name first!');
                        return;
                    }
                }
                
                // Create high-resolution canvas
                const outputCanvas = document.createElement('canvas');
                const outputCtx = outputCanvas.getContext('2d');
                
                if (shouldTrim) {
                    // Get trimmed bounds
                    const bounds = getTrimBounds(canvas);
                    
                    if (bounds) {
                        outputCanvas.width = (bounds.width + 40) * quality; // Add padding
                        outputCanvas.height = (bounds.height + 40) * quality;
                        
                        // Fill background if needed
                        const background = signatureType === 'draw' 
                            ? document.getElementById('canvas-background').value 
                            : document.getElementById('text-canvas-background').value;
                        
                        if (background !== 'transparent') {
                            outputCtx.fillStyle = background;
                            outputCtx.fillRect(0, 0, outputCanvas.width, outputCanvas.height);
                        }
                        
                        // Draw trimmed signature
                        outputCtx.drawImage(
                            canvas,
                            bounds.left, bounds.top, bounds.width, bounds.height,
                            20 * quality, 20 * quality, bounds.width * quality, bounds.height * quality
                        );
                    } else {
                        showSignatureError('No signature content found to download.');
                        return;
                    }
                } else {
                    // Use full canvas
                    outputCanvas.width = canvas.width * quality;
                    outputCanvas.height = canvas.height * quality;
                    outputCtx.drawImage(canvas, 0, 0, outputCanvas.width, outputCanvas.height);
                }
                
                // Export based on format
                let dataUrl;
                let filename;
                
                if (format === 'svg' && signatureType === 'draw') {
                    // Generate SVG
                    const svg = generateSVG();
                    const blob = new Blob([svg], { type: 'image/svg+xml' });
                    dataUrl = URL.createObjectURL(blob);
                    filename = 'signature.svg';
                    
                    const link = document.createElement('a');
                    link.href = dataUrl;
                    link.download = filename;
                    link.click();
                    URL.revokeObjectURL(dataUrl);
                } else {
                    // Generate PNG or JPG
                    const mimeType = format === 'jpg' ? 'image/jpeg' : 'image/png';
                    dataUrl = outputCanvas.toDataURL(mimeType, 0.95);
                    filename = `signature.${format}`;
                    
                    const link = document.createElement('a');
                    link.href = dataUrl;
                    link.download = filename;
                    link.click();
                }
                
                // Show success message
                showSignatureSuccess();
                
            } catch (error) {
                console.error('Error downloading signature:', error);
                showSignatureError('Failed to download signature: ' + error.message);
            }
        }

        function getTrimBounds(canvas) {
            const ctx = canvas.getContext('2d');
            const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            const pixels = imageData.data;
            
            let minX = canvas.width;
            let minY = canvas.height;
            let maxX = 0;
            let maxY = 0;
            let found = false;
            
            for (let y = 0; y < canvas.height; y++) {
                for (let x = 0; x < canvas.width; x++) {
                    const i = (y * canvas.width + x) * 4;
                    const alpha = pixels[i + 3];
                    
                    if (alpha > 0) {
                        found = true;
                        if (x < minX) minX = x;
                        if (x > maxX) maxX = x;
                        if (y < minY) minY = y;
                        if (y > maxY) maxY = y;
                    }
                }
            }
            
            if (!found) return null;
            
            return {
                left: minX,
                top: minY,
                width: maxX - minX + 1,
                height: maxY - minY + 1
            };
        }

        function generateSVG() {
            const background = document.getElementById('canvas-background').value;
            const shouldTrim = document.getElementById('signature-trim').checked;
            
            let svgContent = '<?xml version="1.0" encoding="UTF-8"?>\n';
            
            if (shouldTrim && signatureStrokes.length > 0) {
                const bounds = getTrimBounds(signatureCanvas);
                if (bounds) {
                    svgContent += `<svg xmlns="http://www.w3.org/2000/svg" width="${bounds.width + 40}" height="${bounds.height + 40}" viewBox="${bounds.left - 20} ${bounds.top - 20} ${bounds.width + 40} ${bounds.height + 40}">\n`;
                } else {
                    svgContent += `<svg xmlns="http://www.w3.org/2000/svg" width="${signatureCanvas.width}" height="${signatureCanvas.height}" viewBox="0 0 ${signatureCanvas.width} ${signatureCanvas.height}">\n`;
                }
            } else {
                svgContent += `<svg xmlns="http://www.w3.org/2000/svg" width="${signatureCanvas.width}" height="${signatureCanvas.height}" viewBox="0 0 ${signatureCanvas.width} ${signatureCanvas.height}">\n`;
            }
            
            // Add background if not transparent
            if (background !== 'transparent') {
                svgContent += `  <rect width="100%" height="100%" fill="${background}"/>\n`;
            }
            
            // Add strokes
            let currentPath = '';
            let currentColor = '';
            let currentWidth = '';
            
            signatureStrokes.forEach(stroke => {
                if (stroke.type === 'start') {
                    if (currentPath) {
                        svgContent += `  <path d="${currentPath}" stroke="${currentColor}" stroke-width="${currentWidth}" fill="none" stroke-linecap="round" stroke-linejoin="round"/>\n`;
                    }
                    currentPath = `M ${stroke.x} ${stroke.y}`;
                } else if (stroke.type === 'line') {
                    currentPath += ` L ${stroke.x2} ${stroke.y2}`;
                    currentColor = stroke.color;
                    currentWidth = stroke.width;
                }
            });
            
            if (currentPath) {
                svgContent += `  <path d="${currentPath}" stroke="${currentColor}" stroke-width="${currentWidth}" fill="none" stroke-linecap="round" stroke-linejoin="round"/>\n`;
            }
            
            svgContent += '</svg>';
            return svgContent;
        }

        function showSignatureSuccess() {
            document.getElementById('signature-success').classList.remove('hidden');
            document.getElementById('signature-error').classList.add('hidden');
            
            // Auto-hide after 3 seconds
            setTimeout(() => {
                document.getElementById('signature-success').classList.add('hidden');
            }, 3000);
        }

        function showSignatureError(message) {
            document.getElementById('signature-error-message').textContent = message;
            document.getElementById('signature-error').classList.remove('hidden');
            document.getElementById('signature-success').classList.add('hidden');
        }

        // ============================================
        // CSV TO JSON CONVERTER FUNCTIONS
        // ============================================

        // Initialize CSV to JSON Converter
        document.addEventListener('DOMContentLoaded', function() {
            const directionRadios = document.querySelectorAll('input[name="csv-json-direction"]');
            const fileInput = document.getElementById('csv-json-file-input');
            const textInput = document.getElementById('csv-json-input');

            // Direction change handler
            directionRadios.forEach(radio => {
                radio.addEventListener('change', (e) => {
                    updateCsvJsonDirection(e.target.value);
                });
            });

            // File upload handler
            if (fileInput) {
                fileInput.addEventListener('change', (e) => {
                    if (e.target.files.length > 0) {
                        handleCsvJsonFileUpload(e.target.files[0]);
                    }
                });
            }

            // Input character counter
            if (textInput) {
                textInput.addEventListener('input', (e) => {
                    document.getElementById('csv-json-input-chars').textContent = e.target.value.length;
                });
            }
        });

        function updateCsvJsonDirection(direction) {
            const inputLabel = document.getElementById('csv-json-input-label');
            const outputLabel = document.getElementById('csv-json-output-label');
            const convertBtnText = document.getElementById('csv-json-convert-btn-text');
            const settingsCsv = document.getElementById('csv-json-settings-csv');
            const settingsJson = document.getElementById('csv-json-settings-json');
            const textInput = document.getElementById('csv-json-input');

            if (direction === 'csv-to-json') {
                inputLabel.textContent = 'Input CSV Data';
                outputLabel.textContent = 'Output JSON';
                convertBtnText.textContent = 'Convert to JSON';
                settingsCsv.classList.remove('hidden');
                settingsJson.classList.add('hidden');
                textInput.placeholder = 'Paste your CSV data here...\\n\\nExample:\\nName,Age,City\\nJohn,30,New York\\nJane,25,Los Angeles';
            } else {
                inputLabel.textContent = 'Input JSON Data';
                outputLabel.textContent = 'Output CSV';
                convertBtnText.textContent = 'Convert to CSV';
                settingsCsv.classList.add('hidden');
                settingsJson.classList.remove('hidden');
                textInput.placeholder = 'Paste your JSON data here...\\n\\nExample:\\n[\\n  {"Name":"John","Age":30,"City":"New York"},\\n  {"Name":"Jane","Age":25,"City":"Los Angeles"}\\n]';
            }

            // Update direction card borders
            document.querySelectorAll('input[name="csv-json-direction"]').forEach((radio) => {
                const label = radio.parentElement;
                if (radio.checked) {
                    label.classList.remove('border-gray-300');
                    label.classList.add('border-orange-300', 'bg-orange-50');
                } else {
                    label.classList.remove('border-orange-300', 'bg-orange-50');
                    label.classList.add('border-gray-300');
                }
            });

            // Clear output and errors
            document.getElementById('csv-json-output-section').classList.add('hidden');
            document.getElementById('csv-json-preview-section').classList.add('hidden');
            document.getElementById('csv-json-error').classList.add('hidden');
        }

        function handleCsvJsonFileUpload(file) {
            const reader = new FileReader();
            reader.onload = (e) => {
                document.getElementById('csv-json-input').value = e.target.result;
                document.getElementById('csv-json-input-chars').textContent = e.target.result.length;
            };
            reader.readAsText(file);
        }

        function clearCsvJsonInput() {
            document.getElementById('csv-json-input').value = '';
            document.getElementById('csv-json-input-chars').textContent = '0';
            document.getElementById('csv-json-file-input').value = '';
            document.getElementById('csv-json-output-section').classList.add('hidden');
            document.getElementById('csv-json-preview-section').classList.add('hidden');
            document.getElementById('csv-json-error').classList.add('hidden');
        }

        function pasteSampleData() {
            const direction = document.querySelector('input[name="csv-json-direction"]:checked').value;
            
            if (direction === 'csv-to-json') {
                const sampleCSV = `Name,Age,City,Country
John Doe,30,New York,USA
Jane Smith,25,Los Angeles,USA
Bob Johnson,35,Chicago,USA
Alice Williams,28,Houston,USA
Charlie Brown,42,Phoenix,USA`;
                document.getElementById('csv-json-input').value = sampleCSV;
                document.getElementById('csv-json-input-chars').textContent = sampleCSV.length;
            } else {
                const sampleJSON = `[
  {
    "Name": "John Doe",
    "Age": 30,
    "City": "New York",
    "Country": "USA"
  },
  {
    "Name": "Jane Smith",
    "Age": 25,
    "City": "Los Angeles",
    "Country": "USA"
  },
  {
    "Name": "Bob Johnson",
    "Age": 35,
    "City": "Chicago",
    "Country": "USA"
  }
]`;
                document.getElementById('csv-json-input').value = sampleJSON;
                document.getElementById('csv-json-input-chars').textContent = sampleJSON.length;
            }
        }

        function detectDelimiter(csvText) {
            const firstLine = csvText.split('\\n')[0];
            const delimiters = [',', ';', '\\t', '|'];
            let maxCount = 0;
            let detectedDelimiter = ',';

            delimiters.forEach(delimiter => {
                const count = firstLine.split(delimiter).length;
                if (count > maxCount) {
                    maxCount = count;
                    detectedDelimiter = delimiter;
                }
            });

            return detectedDelimiter;
        }

        function parseCSV(csvText, delimiter, hasHeader) {
            const lines = csvText.trim().split('\\n');
            const result = [];
            
            if (lines.length === 0) return result;

            // Handle delimiter
            if (delimiter === 'auto') {
                delimiter = detectDelimiter(csvText);
            }

            // Parse header
            const headers = lines[0].split(delimiter).map(h => h.trim().replace(/^"|"$/g, ''));
            const startLine = hasHeader ? 1 : 0;

            // Parse data rows
            for (let i = startLine; i < lines.length; i++) {
                if (!lines[i].trim()) continue;
                
                const values = lines[i].split(delimiter).map(v => v.trim().replace(/^"|"$/g, ''));
                const row = {};
                
                for (let j = 0; j < values.length; j++) {
                    const key = hasHeader ? headers[j] : `Column${j + 1}`;
                    let value = values[j];
                    
                    // Try to convert to number if possible
                    if (value && !isNaN(value)) {
                        value = Number(value);
                    }
                    
                    row[key] = value;
                }
                
                result.push(row);
            }

            return result;
        }

        function jsonToCSV(jsonData, delimiter, includeHeader) {
            if (!Array.isArray(jsonData) || jsonData.length === 0) {
                throw new Error('JSON must be an array of objects');
            }

            // Get all unique keys from all objects
            const allKeys = new Set();
            jsonData.forEach(obj => {
                Object.keys(obj).forEach(key => allKeys.add(key));
            });
            const headers = Array.from(allKeys);

            const rows = [];

            // Add header row
            if (includeHeader) {
                rows.push(headers.join(delimiter));
            }

            // Add data rows
            jsonData.forEach(obj => {
                const values = headers.map(header => {
                    let value = obj[header];
                    if (value === undefined || value === null) value = '';
                    // Escape values containing delimiter or quotes
                    value = String(value);
                    if (value.includes(delimiter) || value.includes('"') || value.includes('\\n')) {
                        value = '"' + value.replace(/"/g, '""') + '"';
                    }
                    return value;
                });
                rows.push(values.join(delimiter));
            });

            return rows.join('\\n');
        }

        function convertCsvJson() {
            const direction = document.querySelector('input[name="csv-json-direction"]:checked').value;
            const inputText = document.getElementById('csv-json-input').value.trim();

            // Hide previous results and errors
            document.getElementById('csv-json-output-section').classList.add('hidden');
            document.getElementById('csv-json-preview-section').classList.add('hidden');
            document.getElementById('csv-json-error').classList.add('hidden');

            if (!inputText) {
                showCsvJsonError('Please enter some data to convert.');
                return;
            }

            try {
                if (direction === 'csv-to-json') {
                    // CSV to JSON conversion
                    const delimiter = document.getElementById('csv-delimiter').value;
                    const hasHeader = document.getElementById('csv-has-header').checked;
                    const prettyPrint = document.getElementById('json-pretty-print').checked;

                    const jsonData = parseCSV(inputText, delimiter, hasHeader);
                    const jsonOutput = prettyPrint ? JSON.stringify(jsonData, null, 2) : JSON.stringify(jsonData);

                    // Display output
                    document.getElementById('csv-json-output').value = jsonOutput;
                    document.getElementById('csv-json-output-chars').textContent = jsonOutput.length;
                    document.getElementById('csv-json-output-lines').textContent = jsonOutput.split('\\n').length;
                    document.getElementById('csv-json-success-msg').textContent = `‚úì Converted ${jsonData.length} rows to JSON`;
                    document.getElementById('csv-json-output-section').classList.remove('hidden');

                    // Display preview table
                    displayPreviewTable(jsonData);

                } else {
                    // JSON to CSV conversion
                    const outputDelimiter = document.getElementById('csv-output-delimiter').value;
                    const includeHeader = document.getElementById('csv-include-header').checked;

                    const jsonData = JSON.parse(inputText);
                    const csvOutput = jsonToCSV(jsonData, outputDelimiter, includeHeader);

                    // Display output
                    document.getElementById('csv-json-output').value = csvOutput;
                    document.getElementById('csv-json-output-chars').textContent = csvOutput.length;
                    document.getElementById('csv-json-output-lines').textContent = csvOutput.split('\\n').length;
                    document.getElementById('csv-json-success-msg').textContent = `‚úì Converted ${jsonData.length} rows to CSV`;
                    document.getElementById('csv-json-output-section').classList.remove('hidden');

                    // Display preview table
                    displayPreviewTable(jsonData);
                }

            } catch (error) {
                console.error('Conversion error:', error);
                showCsvJsonError('Conversion failed: ' + error.message);
            }
        }

        function displayPreviewTable(data) {
            if (!Array.isArray(data) || data.length === 0) return;

            const previewSection = document.getElementById('csv-json-preview-section');
            const headerRow = document.getElementById('csv-json-preview-header');
            const bodyTable = document.getElementById('csv-json-preview-body');

            // Clear previous content
            headerRow.innerHTML = '';
            bodyTable.innerHTML = '';

            // Get headers from first object
            const headers = Object.keys(data[0]);

            // Create header
            headers.forEach(header => {
                const th = document.createElement('th');
                th.className = 'px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider';
                th.textContent = header;
                headerRow.appendChild(th);
            });

            // Create rows (max 10)
            const maxRows = Math.min(data.length, 10);
            for (let i = 0; i < maxRows; i++) {
                const tr = document.createElement('tr');
                headers.forEach(header => {
                    const td = document.createElement('td');
                    td.className = 'px-4 py-2 text-sm text-gray-900 whitespace-nowrap';
                    td.textContent = data[i][header] !== undefined ? data[i][header] : '';
                    tr.appendChild(td);
                });
                bodyTable.appendChild(tr);
            }

            previewSection.classList.remove('hidden');
        }

        function copyToClipboardCsvJson() {
            const output = document.getElementById('csv-json-output').value;
            
            navigator.clipboard.writeText(output).then(() => {
                const successMsg = document.getElementById('csv-json-success-msg');
                const originalText = successMsg.textContent;
                successMsg.textContent = '‚úì Copied to clipboard!';
                setTimeout(() => {
                    successMsg.textContent = originalText;
                }, 2000);
            }).catch(err => {
                alert('Failed to copy to clipboard: ' + err.message);
            });
        }

        function downloadCsvJsonOutput() {
            const direction = document.querySelector('input[name="csv-json-direction"]:checked').value;
            const output = document.getElementById('csv-json-output').value;
            
            const extension = direction === 'csv-to-json' ? 'json' : 'csv';
            const mimeType = direction === 'csv-to-json' ? 'application/json' : 'text/csv';
            
            const blob = new Blob([output], { type: mimeType });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            const timestamp = new Date().toISOString().split('T')[0];
            a.download = `converted-data-${timestamp}.${extension}`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function showCsvJsonError(message) {
            document.getElementById('csv-json-error-message').textContent = message;
            document.getElementById('csv-json-error').classList.remove('hidden');
        }

        // ============================================
        // MILESTONE BANNER FUNCTIONS
        // ============================================
        
        function dismissMilestoneBanner() {
            const banner = document.getElementById('milestone-banner');
            if (banner) {
                banner.style.transform = 'translateY(-100%)';
                setTimeout(() => {
                    banner.style.display = 'none';
                    // Store in localStorage so it doesn't show again
                    localStorage.setItem('milestoneBannerDismissed', 'true');
                }, 500);
            }
        }

        // Check if banner was previously dismissed
        document.addEventListener('DOMContentLoaded', function() {
            const bannerDismissed = localStorage.getItem('milestoneBannerDismissed');
            if (bannerDismissed === 'true') {
                const banner = document.getElementById('milestone-banner');
                if (banner) {
                    banner.style.display = 'none';
                }
            }
        });

    </script>
</body>
</html>
